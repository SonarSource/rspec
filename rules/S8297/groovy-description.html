<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is an issue when using <code>@Grab</code> to include JDBC driver dependencies without configuring <code>@GrabConfig(systemClassLoader=true)</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JDBC drivers use a service provider mechanism that requires them to be loaded by the system class loader to properly register with the <code>DriverManager</code>. When JDBC drivers are loaded via <code>@Grab</code> without <code>@GrabConfig(systemClassLoader=true)</code>, they are loaded by Groovy&#8217;s class loader instead of the system class loader.</p>
</div>
<div class="paragraph">
<p>This creates a classloading isolation issue where the JDBC driver cannot properly register itself with the <code>DriverManager</code>. The <code>DriverManager</code> looks for drivers in the system class loader, but the driver classes are only available in Groovy&#8217;s class loader hierarchy.</p>
</div>
<div class="paragraph">
<p>As a result, attempts to establish database connections will fail with errors like "No suitable driver found" even though the driver JAR has been successfully downloaded and is present on the classpath. This can be particularly confusing because the dependency resolution appears to work correctly, but the runtime behavior fails.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Applications will fail to establish database connections at runtime, resulting in <code>SQLException</code> with messages like "No suitable driver found for jdbc:mysql://&#8230;&#8203;" or similar database-specific errors. This can cause complete application failure when database connectivity is required.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add @GrabConfig(systemClassLoader=true) before the @Grab annotation that includes the JDBC driver dependency. This ensures the driver is loaded by the system class loader and can properly register with the DriverManager.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">@Grab(group='mysql', module='mysql-connector-java', version='8.0.33') // Noncompliant
import java.sql.DriverManager

def url = "jdbc:mysql://localhost:3306/mydb"
def connection = DriverManager.getConnection(url, "user", "password")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">@GrabConfig(systemClassLoader=true)
@Grab(group='mysql', module='mysql-connector-java', version='8.0.33')
import java.sql.DriverManager

def url = "jdbc:mysql://localhost:3306/mydb"
def connection = DriverManager.getConnection(url, "user", "password")</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Groovy Grape Documentation - JDBC Drivers - <a href="https://groovy-lang.org/grape.html#Grape-JDBCDrivers">Official Groovy documentation explaining the requirement for systemClassLoader=true with JDBC drivers</a></p>
</li>
<li>
<p>Java JDBC DriverManager Documentation - <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/DriverManager.html">Oracle documentation explaining how JDBC drivers are loaded and registered</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>JDBC 4.0 Specification - <a href="https://jcp.org/en/jsr/detail?id=221">Java specification defining JDBC driver loading mechanisms and service provider interface</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>