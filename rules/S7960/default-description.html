<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when a SOQL query is directly assigned to a single sObject variable instead of a <code>List</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you assign a SOQL query directly to a single sObject variable, Salesforce expects exactly one record to be returned. If the query returns no records, the system throws a <code>QueryException</code> with the message "List has no rows for assignment to SObject".</p>
</div>
<div class="paragraph">
<p>This exception occurs because SOQL queries always return a List internally, even when you assign the result to a single sObject variable. When the List is empty, Salesforce cannot extract a single record to assign to your variable.</p>
</div>
<div class="paragraph">
<p>This pattern is particularly risky when:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your query includes WHERE clauses that might not match any records</p>
</li>
<li>
<p>You use LIMIT clauses that could result in zero records</p>
</li>
<li>
<p>You query based on user input or dynamic conditions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The exception will cause your code to fail at runtime, potentially breaking user workflows or automated processes.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Runtime failures can occur when queries return no results, causing <code>QueryException</code> to be thrown. This can break user workflows, interrupt automated processes, and create poor user experiences. In batch processing or trigger contexts, these exceptions can cause entire transactions to fail.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use a List to capture query results and check if the List is empty before accessing elements. This prevents the QueryException and allows you to handle the no-results case gracefully.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">Account a = [SELECT Name FROM Account WHERE Name = 'XYZ' LIMIT 1]; // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">List&lt;Account&gt; accounts = [SELECT Name FROM Account WHERE Name = 'XYZ' LIMIT 1];
if (!accounts.isEmpty()) {
    Account a = accounts[0];
    // Process the account
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Salesforce SOQL and SOSL Reference - <a href="https://developer.salesforce.com/docs/atlas.en-us.soql_sosl.meta/soql_sosl/">Official Salesforce documentation for SOQL queries and best practices</a></p>
</li>
<li>
<p>Apex Exception Handling - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_exception_definition.htm">Salesforce documentation on exception handling in Apex</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-248: Uncaught Exception - <a href="https://cwe.mitre.org/data/definitions/248.html">Relates to code that can throw exceptions that are not properly handled</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>