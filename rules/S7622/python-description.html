<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when <code>boto3</code> operations that support pagination are called without using paginators or manual pagination handling.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Many AWS services use pagination to limit the number of items returned in a single API call.
For example, S3&#8217;s <code>list_objects_v2()</code> returns a maximum of <strong>1000</strong> objects per call, and DynamoDB&#8217;s <code>scan()</code> returns up to <strong>1MB</strong> of data per call.
When you call these operations through boto3 without proper pagination handling, you only receive the first page of results.
This means your application silently operates on incomplete data, which can lead to incorrect logic and missed operations on resources that exist beyond the first page.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Operating on incomplete data can cause missing critical resources, incorrect business logic based on partial datasets, and security vulnerabilities where policies or access changes are not applied to the full resource set.
These issues are often silent and difficult to detect in testing environments with smaller datasets.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use <code>boto3&#8217;s</code> built-in paginators to automatically handle pagination and retrieve all results.
Paginators provide a simple interface that handles the complexity of checking for continuation tokens and making multiple API calls.
Replace direct service calls with <code>paginator.paginate()</code> calls and iterate through all pages.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import boto3
s3 = boto3.client("s3")

def lambda_handler(event, context):
    keys = []
    response = s3.list_objects_v2(Bucket="my-bucket")  # Noncompliant
    for obj in response.get("Contents", []):
        keys.append(obj["Key"])
    return keys</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import boto3
s3 = boto3.client("s3")

def lambda_handler(event, context):
    keys = []
    paginator = s3.get_paginator("list_objects_v2")
    for page in paginator.paginate(Bucket="my-bucket"):
        for obj in page.get("Contents", []):
            keys.append(obj["Key"])
    return keys</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/paginators.html">Boto3 Paginators Guide</a></p>
</li>
<li>
<p><a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/s3/client/list_objects_v2.html">S3 list_objects_v2 API Reference</a></p>
</li>
<li>
<p><a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/dynamodb/paginator/Query.html">DynamoDB Query Paginator Reference</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use a paginator to retrieve all results from this boto3 operation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>Primary location: the boto3 method call that supports pagination</p>
</li>
<li>
<p>Secondary location: the variable assignment receiving the paginated response</p>
</li>
</ul>
</div>
</div>
</div>
</div>