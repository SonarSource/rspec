<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when a class is a Pytorch module and does not call the <code>super().__init__()</code> method in its constructor.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To provide the AutoGrad functionality, the Pytorch library needs to set up the necessary data structures in the base class. If the <code>super().__init__()</code> method is not called, the module will not be able to keep track of its parameters and other attributes.</p>
</div>
<div class="paragraph">
<p>For example, when trying to instantiate a module like <code>nn.Linear</code> without calling the <code>super().__init__()</code> method, the instantiation will fail when it tries to register it as a submodule of the parent module.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import torch.nn as nn

class MyCustomModule(nn.Module):
    def __init__(self, input_size, output_size):
        self.fc = nn.Linear(input_size, output_size)

model = MyCustomModule(10, 5) # AttributeError: cannot assign module before Module.__init__() call</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add a call to <code>super().__init__()</code> at the beginning of the constructor of the class.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import torch.nn as nn

class MyCustomModule(nn.Module):
    def __init__(self, input_size, output_size):
        self.fc = nn.Linear(input_size, output_size) # Noncompliant: creating an nn.Linear without calling super().__init__()</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import torch.nn as nn

class MyCustomModule(nn.Module):
    def __init__(self, input_size, output_size):
        super().__init__()
        self.fc = nn.Linear(input_size, output_size)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Pytorch documentation - <a href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module">torch.nn.Module</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Verify that subclasses of <code>torch.nn.Module</code> call the <code>super().__init__()</code> method in their constructor.
It also applies to classes that inherit from a class that inherits from <code>torch.nn.Module</code>.</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Primary : Add a call to <code>super().__init__()</code></p>
</div>
<div class="paragraph">
<p>Secondary : Inheritance happens here</p>
</div>
</div>
<div class="sect2">
<h3 id="_issue_location">Issue location</h3>
<div class="paragraph">
<p>Primary : First line of the constructor</p>
</div>
<div class="paragraph">
<p>Secondary : (The inheritance position of the class)</p>
</div>
</div>
<div class="sect2">
<h3 id="_quickfix">Quickfix</h3>
<div class="paragraph">
<p>Add a call to <code>super().__init__()</code> at the beginning of the constructor.
If direct child of <code>torch.nn.Module</code>, easy, no need to try to add parameters.
If indirect, try to find the parameters and match them with the same name ? Or abort if too complicatted.</p>
</div>
</div>
</div>
</div>