<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when asynchronous Apex methods (Queueable, Batchable, Future) perform individual DML operations in loops or lack proper query limits that could lead to governor limit violations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Asynchronous Apex processes run with increased governor limits compared to synchronous operations, providing more capacity for data processing. However, these increased limits don&#8217;t eliminate the need for efficient coding practices.</p>
</div>
<div class="paragraph">
<p>When asynchronous methods perform DML operations inside loops or execute unlimited SOQL queries, they can still hit governor limits, especially when processing large datasets. This leads to runtime exceptions that can cause the entire asynchronous job to fail.</p>
</div>
<div class="paragraph">
<p>Moreover, inefficient patterns in asynchronous code waste the platform&#8217;s resources and can impact overall system performance. The increased governor limits in asynchronous contexts are designed to enable bulk processing of larger datasets, not to compensate for inefficient coding practices.</p>
</div>
<div class="paragraph">
<p>Proper bulk processing patterns ensure that asynchronous jobs can handle the maximum amount of data possible within the available limits, making the most of the platform&#8217;s capabilities.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>When asynchronous Apex classes don&#8217;t handle governor limits appropriately, several issues can occur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Job failures</strong>: The asynchronous job may fail with governor limit exceptions, leaving data processing incomplete</p>
</li>
<li>
<p><strong>Data inconsistency</strong>: Partial processing due to limit violations can result in inconsistent data states</p>
</li>
<li>
<p><strong>Resource waste</strong>: Inefficient code consumes more platform resources than necessary</p>
</li>
<li>
<p><strong>Performance degradation</strong>: Poor patterns can impact overall system performance and user experience</p>
</li>
<li>
<p><strong>Maintenance overhead</strong>: Failed jobs require manual intervention and monitoring to resolve</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use bulk DML operations instead of performing DML inside loops. Collect records to process and perform DML operations on collections.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">public class AsyncProcessor implements Queueable {
    public void execute(QueueableContext context) {
        List&lt;Account&gt; accounts = [SELECT Id, Name FROM Account];
        for(Account acc : accounts) {
            acc.Name = acc.Name + ' - Updated';
            update acc; // Noncompliant
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">public class AsyncProcessor implements Queueable {
    public void execute(QueueableContext context) {
        List&lt;Account&gt; accounts = [SELECT Id, Name FROM Account LIMIT 200];
        for(Account acc : accounts) {
            acc.Name = acc.Name + ' - Updated';
        }
        update accounts; // Bulk operation
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Apex Governor Limits - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_gov_limits.htm">Official Salesforce documentation on Apex governor limits and best practices</a></p>
</li>
<li>
<p>Asynchronous Apex - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_async_overview.htm">Comprehensive guide to asynchronous Apex processing methods</a></p>
</li>
<li>
<p>Bulk Processing Best Practices - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_dml_bulk.htm">Best practices for bulk DML operations in Apex</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-400: Uncontrolled Resource Consumption - <a href="https://cwe.mitre.org/data/definitions/400.html">Relates to inefficient resource usage that can lead to system performance issues</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S5380" class="rspec-auto-link">RSPEC-5380</a> - <a href="https://rules.sonarsource.com/apex/RSPEC-5380">Related rule about governor limits in Apex code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>