Refactor this function to always return the same type.