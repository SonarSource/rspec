This rule raises an issue when a Flask application uses `app.run()` with `host='0.0.0.0'` or similar configurations that bind to all network interfaces, especially when combined with debug mode enabled.

== Why is this an issue?

When a Flask application binds to all network interfaces using `host='0.0.0.0'`, it becomes accessible from any network interface on the machine, including external networks. This creates several security risks:

**Network Exposure**: The application becomes reachable from outside the local machine, potentially exposing it to attackers on the same network or the internet.

**Debug Mode Risks**: When combined with `debug=True`, the application exposes sensitive debugging information, including stack traces, source code, and an interactive debugger that can execute arbitrary code.

**Production Misconfigurations**: Development configurations that bind to all interfaces can accidentally be deployed to production, creating unintended security vulnerabilities.

**Lack of Access Controls**: Without proper firewall rules or reverse proxy configurations, the application has no protection against unauthorized access attempts.

The `app.run()` method is primarily intended for development purposes. In production environments, Flask applications should be deployed using proper WSGI servers with appropriate security configurations.

=== What is the potential impact?

Attackers can gain unauthorized access to the application from external networks. If debug mode is enabled, they can execute arbitrary code on the server through the interactive debugger. Sensitive application data, configuration details, and system information may be exposed through error messages and debug output.

== How to fix it in Flask

For development, bind to localhost only. For production, use a proper WSGI server instead of app.run().

=== Code examples

==== Noncompliant code example

[source,python,diff-id=1,diff-type=noncompliant]
----
from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello():
    return 'Hello World!'

if __name__ == '__main__':
    app.run(host='0.0.0.0', debug=True)  # Noncompliant
----

==== Compliant solution

[source,python,diff-id=1,diff-type=compliant]
----
from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello():
    return 'Hello World!'

if __name__ == '__main__':
    app.run(host='0.0.0.0', debug=False)
----


==== Noncompliant code example

[source,python,diff-id=2,diff-type=noncompliant]
----
import os
from flask import Flask

app = Flask(__name__)

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=True)  # Noncompliant
----

==== Compliant solution

[source,python,diff-id=2,diff-type=compliant]
----
import os
from flask import Flask

app = Flask(__name__)

if __name__ == '__main__':
    app.run(host='127.0.0.1', port=5000, debug=True)
----

== Resources

=== Documentation

 * Flask Deployment Options - https://flask.palletsprojects.com/en/2.3.x/deploying/[Official Flask documentation on secure deployment practices]

 * Flask Security Considerations - https://flask.palletsprojects.com/en/2.3.x/security/[Flask security best practices and common vulnerabilities]

 * Gunicorn Documentation - https://docs.gunicorn.org/en/stable/[Production WSGI server for Python web applications]

=== Standards

 * OWASP Top 10 2021 A5 - https://owasp.org/Top10/A05_2021-Security_Misconfiguration/[Security Misconfiguration]

 * CWE 200 - https://cwe.mitre.org/data/definitions/200.html[Exposure of Sensitive Information to an Unauthorized Actor]
