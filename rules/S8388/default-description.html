<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when a Flask application uses <code>app.run()</code> with <code>host='0.0.0.0'</code> or similar configurations that bind to all network interfaces, especially when combined with debug mode enabled.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a Flask application binds to all network interfaces using <code>host='0.0.0.0'</code>, it becomes accessible from any network interface on the machine, including external networks. This creates several security risks:</p>
</div>
<div class="paragraph">
<p><strong>Network Exposure</strong>: The application becomes reachable from outside the local machine, potentially exposing it to attackers on the same network or the internet.</p>
</div>
<div class="paragraph">
<p><strong>Debug Mode Risks</strong>: When combined with <code>debug=True</code>, the application exposes sensitive debugging information, including stack traces, source code, and an interactive debugger that can execute arbitrary code.</p>
</div>
<div class="paragraph">
<p><strong>Production Misconfigurations</strong>: Development configurations that bind to all interfaces can accidentally be deployed to production, creating unintended security vulnerabilities.</p>
</div>
<div class="paragraph">
<p><strong>Lack of Access Controls</strong>: Without proper firewall rules or reverse proxy configurations, the application has no protection against unauthorized access attempts.</p>
</div>
<div class="paragraph">
<p>The <code>app.run()</code> method is primarily intended for development purposes. In production environments, Flask applications should be deployed using proper WSGI servers with appropriate security configurations.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Attackers can gain unauthorized access to the application from external networks. If debug mode is enabled, they can execute arbitrary code on the server through the interactive debugger. Sensitive application data, configuration details, and system information may be exposed through error messages and debug output.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_flask">How to fix it in Flask</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For development, bind to localhost only. For production, use a proper WSGI server instead of app.run().</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello():
    return 'Hello World!'

if __name__ == '__main__':
    app.run(host='0.0.0.0', debug=True)  # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello():
    return 'Hello World!'

if __name__ == '__main__':
    app.run(host='0.0.0.0', debug=False)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import os
from flask import Flask

app = Flask(__name__)

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=True)  # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import os
from flask import Flask

app = Flask(__name__)

if __name__ == '__main__':
    app.run(host='127.0.0.1', port=5000, debug=True)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Flask Deployment Options - <a href="https://flask.palletsprojects.com/en/2.3.x/deploying/">Official Flask documentation on secure deployment practices</a></p>
</li>
<li>
<p>Flask Security Considerations - <a href="https://flask.palletsprojects.com/en/2.3.x/security/">Flask security best practices and common vulnerabilities</a></p>
</li>
<li>
<p>Gunicorn Documentation - <a href="https://docs.gunicorn.org/en/stable/">Production WSGI server for Python web applications</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP Top 10 2021 A5 - <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">Security Misconfiguration</a></p>
</li>
<li>
<p>CWE 200 - <a href="https://cwe.mitre.org/data/definitions/200.html">Exposure of Sensitive Information to an Unauthorized Actor</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>