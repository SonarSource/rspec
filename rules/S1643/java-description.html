<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Strings are immutable objects, so concatenation doesn&#8217;t simply add the new String to the end of the existing string. Instead, in each loop iteration, the first String is converted to an intermediate object type, the second string is appended, and then the intermediate object is converted back to a String. Further, performance of these intermediate operations degrades as the String gets longer. Therefore, the use of StringBuilder is preferred.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String str = "";
for (int i = 0; i &lt; arrayOfStrings.length ; ++i) {
  str = str + arrayOfStrings[i];
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StringBuilder bld = new StringBuilder();
  for (int i = 0; i &lt; arrayOfStrings.length; ++i) {
    bld.append(arrayOfStrings[i]);
  }
  String str = bld.toString();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_benchmarks">Benchmarks</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">size</th>
<th class="tableblock halign-left valign-top">Runtime</th>
<th class="tableblock halign-left valign-top">Average time</th>
<th class="tableblock halign-left valign-top">Error margin</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">plus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temurin 21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.19 &micro;s/op</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">±0.34 &micro;s/op</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">plus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temurin 21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">377.08 &micro;s/op</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">±17.36 &micro;s/op</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">plus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temurin 21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">40221.49 &micro;s/op</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">±1342.76 &micro;s/op</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">plus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temurin 21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5286840.53 &micro;s/op</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">±185796.75 &micro;s/op</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stringBuilder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temurin 21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.97 &micro;s/op</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">±0.03 &micro;s/op</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stringBuilder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temurin 21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.25 &micro;s/op</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">±1.64 &micro;s/op</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stringBuilder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temurin 21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">93.27 &micro;s/op</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">±16.05 &micro;s/op</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stringBuilder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temurin 21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1019.91 &micro;s/op</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">±69.58 &micro;s/op</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Benchmarking code</strong></p>
</div>
<div class="paragraph">
<p>The results were generated by running the following snippet with <a href="https://github.com/openjdk/jmh">JMH</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Param({"100", "1000", "10000", "100000"})
int size;
private String word = "append";

@Benchmark
public String plus() {
  String str = "";
  for (int i = 0; i &lt; size; i++) {
    str = str + word;
  }
  return str;
}

@Benchmark
public String stringBuilder() {
  StringBuilder builder = new StringBuilder();
  for (int i = 0; i &lt; size; i++) {
    builder.append(word);
  }
  return builder.toString();
}</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use a StringBuilder instead.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_21_nov_2024_164800_alban_auzeill_wrote">on 21 Nov 2024, 16:48:00 Alban Auzeill wrote:</h3>
<div class="paragraph">
<p>[test-code-support-investigation-for-java] Decision for scope: Main &#8594; All.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_jun_2015_142927_ann_campbell_wrote">on 4 Jun 2015, 14:29:27 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk], startlingly the name of the preferred replacement class is the same in Java and C#, so I simply removed "in Java" from the description because I&#8217;m guessing the same code samples would work too&#8230;&#8203;?</p>
</div>
<div class="paragraph">
<p>If it doesn&#8217;t work, or if the bit about performance degrading as the string gets longer is not true in C#, let me know and I&#8217;ll create a sub-task.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_jun_2015_141555_tamas_vajk_wrote">on 29 Jun 2015, 14:15:55 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Do we care about letter casing mismatch? In C# <code>.toString()</code> is <code>.ToString()</code>, <code>.append()</code> is <code>.Append()</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_30_jun_2015_123634_ann_campbell_wrote">on 30 Jun 2015, 12:36:34 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk], we do care. I&#8217;ve created a subtask</p>
</div>
</div>
</div>
</div>