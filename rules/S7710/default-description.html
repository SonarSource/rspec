<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when <code>torch.tensor()</code> is called with nested list comprehensions that create empty lists, which can be replaced with <code>torch.empty()</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using nested list comprehensions to create empty tensors with specific dimensions is unnecessarily complex and harder to understand than PyTorch&#8217;s built-in alternatives.</p>
</div>
<div class="paragraph">
<p>When you write <code>torch.tensor([[[] for _ in range(3)] for _ in range(5)])</code>, you&#8217;re creating a complex nested structure just to get an empty tensor with shape <code>(5, 3, 0)</code>. This approach has several drawbacks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Readability</strong>: The nested list comprehension syntax is verbose and requires mental parsing to understand the intended dimensions</p>
</li>
<li>
<p><strong>Maintainability</strong>: Changing dimensions requires modifying the list comprehension logic rather than simple numeric parameters</p>
</li>
<li>
<p><strong>Performance</strong>: Creating intermediate list structures before converting to tensors is less efficient than direct tensor allocation</p>
</li>
<li>
<p><strong>Intent clarity</strong>: The code doesn&#8217;t clearly express that you want an empty tensor with specific dimensions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>PyTorch provides <code>torch.empty()</code> specifically for creating uninitialized tensors with given dimensions. This function is designed for exactly this use case and makes your code more idiomatic.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Using complex list comprehensions instead of <code>torch.empty()</code> makes code harder to read and maintain. It can also impact performance due to unnecessary intermediate list creation, especially when working with large tensor dimensions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_fix_in_pytorch">How to fix in PyTorch?</h3>
<div class="paragraph">
<p>Replace the nested list comprehension with <code>torch.empty()</code>, specifying the dimensions directly as arguments. The last dimension should be 0 to create an empty tensor.</p>
</div>
<div class="sect3">
<h4 id="_non_compliant_code_example">Non-compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import torch

# Complex list comprehension for empty tensor
empty_tensor = torch.tensor([[[] for _ in range(3)] for _ in range(5)])  # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_code_example">Compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import torch

# Direct empty tensor creation
empty_tensor = torch.empty(5, 3, 0)</code></pre>
</div>
</div>
<div class="paragraph">
<p>For dynamic dimensions, pass variables directly to <code>torch.empty()</code> instead of using them in list comprehensions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_non_compliant_code_example_2">Non-compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import torch

a, b = 10, 5
results = torch.tensor([[[] for _ in range(b)] for _ in range(a)])  # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_code_example_2">Compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import torch

a, b = 10, 5
results = torch.empty(a, b, 0)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>PyTorch Documentation - <a href="https://pytorch.org/docs/stable/generated/torch.empty.html">PyTorch torch.empty() function</a></p>
</li>
<li>
<p>PyTorch Documentation - <a href="https://pytorch.org/docs/stable/torch.html#creation-ops">PyTorch Tensor Creation</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>