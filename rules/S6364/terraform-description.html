<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Reducing the backup retention duration can reduce an organization&#8217;s ability to re-establish service in case of a security incident.</p>
</div>
<div class="paragraph">
<p>Data backups allow to overcome corruption or unavailability of data by recovering as efficiently as possible from a security incident.</p>
</div>
<div class="paragraph">
<p>Backup retention duration, coverage, and backup locations are essential criteria regarding functional continuity.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>This component is essential for the information system infrastructure.</p>
</li>
<li>
<p>This component is essential for mission-critical functions.</p>
</li>
<li>
<p>Compliance policies require this component to be backed up for a specific amount of time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Increase the backup retention period to an amount of time sufficient enough to be able to restore service in case of an incident.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For <a href="https://aws.amazon.com/rds/">Amazon Relational Database Service</a> clusters and instances:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "aws_db_instance" "example" {
  backup_retention_period = 2 # Sensitive
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://docs.microsoft.com/en-us/azure/cosmos-db/introduction">Azure Cosmos DB</a> accounts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "azurerm_cosmosdb_account" "example" {
  backup {
    type = "Periodic"
    retention_in_hours = 8 # Sensitive
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For <a href="https://aws.amazon.com/rds/">Amazon Relational Database Service</a> clusters and instances:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "aws_db_instance" "example" {
  backup_retention_period = 5
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://docs.microsoft.com/en-us/azure/cosmos-db/introduction">Azure Cosmos DB</a> accounts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "azurerm_cosmosdb_account" "example" {
  backup {
    type = "Periodic"
    retention_in_hours = 300
  }
}</code></pre>
</div>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>Make sure that defining a short backup retention duration is safe here.</p>
</li>
<li>
<p>Omitting "{parameter}" sets the backup retention period to 1 day. Make sure that defining a short backup retention duration is safe here.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>Highlight the resource if the configuration block is missing</p>
</li>
<li>
<p>Highlight the configuration block if the setting in the block is missing</p>
</li>
<li>
<p>Highlight the configuration value if it is too low</p>
</li>
</ul>
</div>
</div>
</div>
</div>