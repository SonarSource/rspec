<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when a Grails domain class contains a field that references a service class.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Grails domain classes should focus on data representation and basic validation logic. They should not contain references to service classes because this violates the separation of concerns principle.</p>
</div>
<div class="paragraph">
<p>When domain classes have service dependencies, it creates tight coupling between the data layer and the business logic layer. This makes the code harder to test, maintain, and understand. Domain objects become dependent on external services, which can lead to complex initialization requirements and circular dependencies.</p>
</div>
<div class="paragraph">
<p>The proper Grails architecture separates concerns clearly:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Domain classes handle data representation, constraints, and basic validation</p>
</li>
<li>
<p>Service classes contain business logic and coordinate between different components</p>
</li>
<li>
<p>Controllers handle web requests and delegate to services</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By injecting services into domain classes, you blur these boundaries and create an architecture that is harder to reason about and maintain.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>This architectural violation can lead to several problems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Tight coupling</strong>: Domain objects become dependent on service implementations, making them harder to test in isolation</p>
</li>
<li>
<p><strong>Circular dependencies</strong>: Services often work with domain objects, creating potential circular reference issues</p>
</li>
<li>
<p><strong>Complex initialization</strong>: Domain objects may require service dependencies to be properly initialized, complicating object creation</p>
</li>
<li>
<p><strong>Reduced testability</strong>: Unit testing domain logic becomes more complex when services are involved</p>
</li>
<li>
<p><strong>Architectural confusion</strong>: The clear separation between data and business logic layers becomes blurred</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Remove the service reference from the domain class. Move any business logic that uses the service to an appropriate service class instead.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">class Person {
    String firstName
    String lastName

    PersonService personService // Noncompliant

    def getFullName() {
        return personService.formatName(firstName, lastName)
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">class Person {
    String firstName
    String lastName

    // No service injection - keep domain class focused on data
    def getFullName() {
        return "${firstName} ${lastName}"
    }
}

// Business logic stays in service classes
class PersonService {
    def formatName(String firstName, String lastName) {
        return "${firstName} ${lastName}"
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Grails Domain Classes Guide - <a href="https://docs.grails.org/latest/guide/GORM.html#domainClasses">Official Grails documentation on domain classes and their proper usage</a></p>
</li>
<li>
<p>Grails Services Guide - <a href="https://docs.grails.org/latest/guide/services.html">Official Grails documentation on service classes and dependency injection</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>Separation of Concerns - <a href="https://en.wikipedia.org/wiki/Separation_of_concerns">Fundamental software engineering principle for organizing code responsibilities</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S1258" class="rspec-auto-link">RSPEC-1258</a> - <a href="https://rules.sonarsource.com/java/RSPEC-1258">Classes should not be coupled to too many other classes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>