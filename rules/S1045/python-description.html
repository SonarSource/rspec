<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when an <code>except</code> statement has had all its exceptions caught by a previous <code>except</code> clause.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Exceptions handlers (<code>except</code>) are evaluated in the order they are written. Once a match is found, the evaluation stops.</p>
</div>
<div class="paragraph">
<p>In some contexts, an except block is dead code as it will never catch any exception:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If there is a handler for a base class followed by a handler for class derived from that base class, the second handler will never trigger: The handler for the base class will match the derived class, and will be the only executed handler.</p>
</li>
<li>
<p>When multiple <code>except</code> statements try to catch the same exception class, only the first one will be executed.</p>
</li>
<li>
<p>In Python 3, <code>BaseException</code> is the parent of every exception class. When a <code>BaseException</code> is caught by an <code>except</code> clause, none of the subsequent <code>except</code> statement will catch anything. This is true as well for the bare except statement (<code>except:</code>).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When using multiple <code>except</code> statements, make sure to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Order the <code>except</code> blocks from the most specialzed exception to the most generic, i.e when wanting to catch a <code>FloatingPointError</code> and an <code>ArithemticError</code>, as <code>FloatingPointError</code> is a subclass of <code>ArithmeticError</code>, the first <code>except</code> statement should be <code>FloatingPointError</code>.</p>
</li>
<li>
<p>Catch the same exception only once.</p>
</li>
<li>
<p>Catch a <code>BaseException</code> only once with either an <code>except BaseException:</code> statement or a bare <code>except:</code> statement, as the two statements are equivalent.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def foo():
    try:
        raise FloatingPointError()
    except (ArithmeticError, RuntimeError) as e:
        print(e)
    except FloatingPointError as e: # Noncompliant: FloatingPointError is a subclass of ArithmeticError.
        print("Never executed")
    except OverflowError as e: # Noncompliant: OverflowError is a subclass of ArithmeticError.
        print("Never executed")

    try:
        raise TypeError()
    except TypeError as e:
        print(e)
    except TypeError as e: # Noncompliant: duplicate except.
        print("Never executed")

    try:
        raise ValueError()
    except BaseException as e:
        print(e)
    except: # Noncompliant: this is equivalent to "except BaseException" block.
        print("Never executed")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def foo():
    try:
        raise FloatingPointError()
    except FloatingPointError as e:
        print("Executed")
    except OverflowError as e:
        print("Executed")
    except (ArithmeticError, RuntimeError) as e:
        print(e)

    try:
        raise TypeError()
    except TypeError as e:
        print(e)

    try:
        raise ValueError()
    except BaseException as e:
        print(e)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note</strong>: <em>It is generally not recommended to try catching <code>BaseException</code>, as it is the base class for all built-in exceptions in Python, including system-exiting exceptions like <code>SystemExit</code> or <code>KeyboardInterrupt</code>, which are typically not meant to be caught. See <a href="https://www.python.org/dev/peps/pep-0352/#exception-hierarchy-changes">PEP 352</a> for more information.</em></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.python.org/3/reference/compound_stmts.html#the-try-statement">The <code>try</code> statement</a></p>
</li>
<li>
<p><a href="https://docs.python.org/3/library/exceptions.html#exception-hierarchy">Exception hierarchy</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Primary:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All exceptions which will never match because they are subclasses or duplicate of the first exception caught.</p>
</li>
<li>
<p>The "except:" statement if "BaseException" is caught before.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Secondary:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The exception class which shadows other except blocks.
message should be: 'Exceptions will be caught here.'</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>When a parent except block is caught before derived classes</p>
</li>
<li>
<p>Catch this exception only once; it is already handled by a previous except clause.</p>
</li>
<li>
<p>When the same exception class is caught multiple times:</p>
</li>
<li>
<p>Catch this exception only once; it is already handled by a previous except clause.</p>
</li>
<li>
<p>When an "BaseException" is caught in the same try-except as a bare "except:"</p>
</li>
<li>
<p>Merge this bare "except:" with the "BaseException" catch</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_relates_to_s1046">relates to: <a data-rspec-id="S1046" class="rspec-auto-link">S1046</a></h3>

</div>
<div class="sect2">
<h3 id="_on_14_oct_2014_164020_ann_campbell_wrote">on 14 Oct 2014, 16:40:20 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~samuel.mercier], please fix the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Code should be quoted in the message</p>
</li>
<li>
<p>Add a See section to the description listing the appropriate MISRA number</p>
</li>
<li>
<p>Fill in Applicability. Almost always this is both Sources and Tests</p>
</li>
<li>
<p>Make sure the appropriate MISRA C and MISRA C&#43;&#43; fields on the references tab are filled in</p>
</li>
<li>
<p>The message is worded as though there will be one issue per <code>try</code>. Instead, I would recommend/expect one issue per out-of-order <code>catch</code>. E.G. Move this "catch" for "xxx" above the "catch" for "yyy".</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_17_oct_2014_134001_ann_campbell_wrote">on 17 Oct 2014, 13:40:01 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>FYI [~samuel.mercier] I moved this to Reliability because when the <code>catch</code> blocks are out of order, the actions expected for a subtype will never be executed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_23_jan_2017_164055_jean_christophe_collet_wrote">on 23 Jan 2017, 16:40:55 Jean-Christophe Collet wrote:</h3>
<div class="paragraph">
<p>Do we need a message for the secondary catch? Right now it&#8217;s a bit misleading as there is no "conflict" in either cases.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_21_mar_2018_190657_ann_campbell_wrote">on 21 Mar 2018, 19:06:57 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>ABAP: http://www.erpworkbench.com/abap-statements/c/catc/catch_try.htm</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A CATCH block handles the exceptions of the exception classes cx_class1 cx_class2 &#8230;&#8203; that are specified after the statement CATCH as well as the exceptions of the subclasses of these exception classes. In each CATCH statement of a TRY</p>
</div>
<div class="paragraph">
<p>control structure, you can list any number of exception classes</p>
</div>
<div class="paragraph">
<p>cx_class1 cx_class2 &#8230;&#8203; , whereby more special exception classes (subclasses) must be listed before more general exception classes (superclasses). This order must be kept both within a CATCH statement and across multiple CATCH statements of a TRY control structure.</p>
</div>
<div class="paragraph">
<p><strong>Latest notes:</strong> The rule whereby CATCH special exception classes must be listed before general classes ensures that an exception is not handled by a general exception handler (superclass) if a special handler (subclass) is provided.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>