<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Accessing attributes on <code>None</code> is almost always a logical error and will raise
an <code>AttributeError</code>.
To fix this issue, make sure not to access an attribute or method on a value
that can be <code>None</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>None</code> is a built-in object that represents the absence of a value.
It is often used as a placeholder value for variables that only sometimes hold a
value or as a return value for method calls that have no result.</p>
</div>
<div class="paragraph">
<p>Attributes and methods of symbols that sometimes can be <code>None</code> should only be
accessed in circumstances where it is certain that they are not set to <code>None</code>.
Otherwise, an <code>AttributeError</code> is raised, and the program is interrupted.
Hence, this issue indicates a logical error as it results from incorrect
assumptions about the state of variables or the results of computations.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Issues of this type interrupt the normal execution of a program, causing it to
crash or putting it into an inconsistent state.
Therefore, this issue might impact the availability and reliability of your
application, or even result in data loss.</p>
</div>
<div class="paragraph">
<p>If a <code>None</code> value can be induced by user input, this issue may even be
exploited by attackers to disrupt your application or gain information from
stack traces.</p>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p><code>None</code> does support a fixed set of special attributes like <code>__class__</code> or
<code>__bool__</code>, and this issue is not raised when accessing these attributes.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If your code contains <code>if-else</code> statements or similar constructs where some
branches potentially assign the <code>None</code> value to a variable, you must ensure
that this variable is handled safely afterwards.
I.e., its attributes should not be accessed at all or only after explicitly
confirming that it is not <code>None</code>.</p>
</div>
<div class="paragraph">
<p>Similarly, for any function calls that can return <code>None</code> under certain
conditions, carefully confirm that your code avoids these conditions.
Again, the safest approach is to check for a <code>None</code> return value explicitly.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def render(file_path):
    if os.path.isfile(file_path):
        data = interpret_csv(file_path)
    else:
        data = None

    # ...

    data.plot_graph() # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def render(file_path):
    if os.path.isfile(file_path):
        data = interpret_csv(file_path)
    else:
        data = None

    # ...

    if data is not None:
        data.plot_graph()
    else:
        print("No data available.")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>In the given example, the function <code>render</code> tries to load information into a
variable <code>data</code>, depending on whether <code>file_path</code> is a path to a file.
If this is not the case, <code>None</code> is assigned to <code>data</code>.</p>
</div>
<div class="paragraph">
<p>At the end of the function, a method <code>plot_graph()</code> is called on <code>data</code>.
The call is sure to fail if <code>data</code> was assigned to <code>None</code>.
This is prevented by checking first whether <code>data</code> is not <code>None</code> before
performing the call.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>The Python Data Model on <a href="https://docs.python.org/3/reference/datamodel.html#none">None</a></p>
</li>
<li>
<p><a href="https://docs.python.org/3/library/exceptions.html#AttributeError">Attribute Error</a></p>
</li>
<li>
<p><a href="https://docs.python.org/3/reference/expressions.html#attribute-references">Attribute References</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p>CVE  - <a href="https://cwe.mitre.org/data/definitions/476">CWE-476 - NULL Pointer Dereference</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>"xxx" is null.</p>
</li>
<li>
<p>"xxx" is null on at least one execution path.</p>
</li>
<li>
<p>'xxx' can be null.</p>
</li>
<li>
<p>The value returned by method 'xxx' can be null.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Primary : the variable on which a function call can lead to a null pointer dereference (if this value is the output of another function call, this other function call must be highlighted instead)</p>
</div>
<div class="paragraph">
<p>Secondary : the last locations in the code where the nullability condition has been set on the variable. The associated location message should be either :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>So "xxxx" is null</p>
</li>
<li>
<p>So "xxxx" is nullable</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_duplicated_by_s1678">is duplicated by: <a data-rspec-id="S1678" class="rspec-auto-link">S1678</a></h3>

</div>
<div class="sect2">
<h3 id="_replaces_s2220">replaces: <a data-rspec-id="S2220" class="rspec-auto-link">S2220</a></h3>

</div>
<div class="sect2">
<h3 id="_supercedes_s1697">supercedes: <a data-rspec-id="S1697" class="rspec-auto-link">S1697</a></h3>

</div>
<div class="sect2">
<h3 id="_on_11_feb_2015_123815_sébastien_gioria_wrote">on 11 Feb 2015, 12:38:15 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>This Rule fall into :</p>
</div>
<div class="paragraph">
<p>OWASP A6 &#8658; if this expose informations</p>
</div>
<div class="paragraph">
<p>OWASP A2 &#8658; if this can give attackers capacity to bypass authentication or authorization</p>
</div>
<div class="paragraph">
<p>OWASP A1 &#8658; is this can give attacker capacity to inject something</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_11_feb_2015_131839_ann_campbell_wrote">on 11 Feb 2015, 13:18:39 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks [~sebastien.gioria]</p>
</div>
</div>
</div>
</div>