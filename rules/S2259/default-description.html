<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dereferencing a null pointer results in undefined behavior.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A pointer to null, also known as a null pointer, is created by initializing a pointer object to <code>0</code>, <code>NULL</code>, or in the case of C&#43;&#43; <code>nullptr</code>.
A null pointer does neither point to an object nor to valid memory, and as a consequence dereferencing or accessing the memory pointed by such a pointer is undefined behavior.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">int deref() {
  int* ptr = 0;
  return *ptr; // Noncompliant: deference of a null pointer
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to using the <code>*</code> operator, accessing a member of a structure (using <code>&#8594;</code>) or an element of an array (using <code>[]</code>) also leads to dereference of the pointer,
and causes undefined behavior if performed on a pointer to null.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">int subscript() {
  int* ptr = 0;
  return ptr[2]; // Noncompliant: subscript operator used on null pointer
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">struct Aggregate {
  int x;
  int y;
};

int memberAccess() {
  struct Aggregate* ptr = 0;
  return ptr-&gt;x; // Noncompliant: member access on a null pointer
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, invoking a function pointer that holds a null value, dereferences the pointer, and too results in undefined behavior.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">void call() {
  void (*func)(int) = NULL; // func is a pointer to a function
  func(10); // Noncompliant: the invocation of a null function pointer
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>The behavior of a program that dereferences a null pointer is undefined.
In that case, the compiler no longer needs to adhere to the language standard
and the program has no meaning assigned to it.</p>
</div>
<div class="paragraph">
<p>In practice, dereferencing a null pointer may lead to program crashes, or the application may appear to execute correctly while losing data or producing incorrect results.</p>
</div>
<div class="paragraph">
<p>Besides affecting the application&#8217;s availability, null pointer dereferences may lead to code execution, in rare circumstances.
If null is equivalent to the <code>0x0</code> memory address that can be accessed by privileged code, writing, and reading memory is possible, which compromises the integrity and confidentiality of the application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ensure that any pointer that is dereferenced by the program <em>is not</em> null.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">char *p1 = ... ;
if (p1 == NULL &amp;&amp; *p1 == '\t') { // Noncompliant: p1 will be dereferenced IFF it is null
  // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">char *p1 = ... ;
if (p1 != NULL &amp;&amp; *p1 == '\t') { // Compliant: *p1 cannot be evaluated if p1 is NULL
  // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">char *p2 = ... ;
if (p2 != NULL) {
    // ...
}
p2[2] = '\t'; // Noncompliant: potential null-dereference</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">char *p2 = ... ;
if (p2 != NULL) {
    // ...
  p2[2] = '\t'; // Compliant: p2 is known to be non-null
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_going_the_extra_mile">Going the extra mile</h3>
<div class="paragraph">
<p>In C&#43;&#43;, it is preferred to use reference parameters (<code>Type const&amp;</code> or <code>Type&amp;</code>), or pass objects by value (<code>Type</code>), instead of a pointer (<code>Type const*</code> or <code>Type*</code>), if the argument is expected to never be null.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">// Precondition: graph != null
bool isDAG(Graph const* graph);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preferred signature would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">bool isDAG(Graph const&amp; graph);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CERT - <a href="https://wiki.sei.cmu.edu/confluence/x/QdcxBQ">EXP34-C.Do not dereference null pointers</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/476">CWE-476 NULL Pointer Dereference</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_external_coding_guidelines">External coding guidelines</h3>
<div class="ulist">
<ul>
<li>
<p>C&#43;&#43; Core Guidelines - <a href="https://github.com/isocpp/CppCoreGuidelines/blob/e49158a/CppCoreGuidelines.md#f16-for-in-parameters-pass-cheaply-copied-types-by-value-and-others-by-reference-to-const">F.16: For "in" parameters, pass cheaply-copied types by value and others by reference to <code>const</code></a></p>
</li>
<li>
<p>C&#43;&#43; Core Guidelines - <a href="https://github.com/isocpp/CppCoreGuidelines/blob/e49158a/CppCoreGuidelines.md#f17-for-in-out-parameters-pass-by-reference-to-non-const">F.17: For "in-out" parameters, pass by reference to non-<code>const</code></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S3807" class="rspec-auto-link">S3807</a> detects calls to C library functions that require valid, non-null pointers with null pointer arguments</p>
</li>
<li>
<p><a data-rspec-id="S2637" class="rspec-auto-link">S2637</a> detects uses of null pointers as arguments for parameters that are annotated with <code>nonnull</code></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>"xxx" is null.</p>
</li>
<li>
<p>"xxx" is null on at least one execution path.</p>
</li>
<li>
<p>'xxx' can be null.</p>
</li>
<li>
<p>The value returned by method 'xxx' can be null.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Primary : the variable on which a function call can lead to a null pointer dereference (if this value is the output of another function call, this other function call must be highlighted instead)</p>
</div>
<div class="paragraph">
<p>Secondary : the last locations in the code where the nullability condition has been set on the variable. The associated location message should be either :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>So "xxxx" is null</p>
</li>
<li>
<p>So "xxxx" is nullable</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_duplicated_by_s1678">is duplicated by: <a data-rspec-id="S1678" class="rspec-auto-link">S1678</a></h3>

</div>
<div class="sect2">
<h3 id="_replaces_s2220">replaces: <a data-rspec-id="S2220" class="rspec-auto-link">S2220</a></h3>

</div>
<div class="sect2">
<h3 id="_supercedes_s1697">supercedes: <a data-rspec-id="S1697" class="rspec-auto-link">S1697</a></h3>

</div>
<div class="sect2">
<h3 id="_on_11_feb_2015_123815_sébastien_gioria_wrote">on 11 Feb 2015, 12:38:15 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>This Rule fall into :</p>
</div>
<div class="paragraph">
<p>OWASP A6 &#8658; if this expose informations</p>
</div>
<div class="paragraph">
<p>OWASP A2 &#8658; if this can give attackers capacity to bypass authentication or authorization</p>
</div>
<div class="paragraph">
<p>OWASP A1 &#8658; is this can give attacker capacity to inject something</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_11_feb_2015_131839_ann_campbell_wrote">on 11 Feb 2015, 13:18:39 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks [~sebastien.gioria]</p>
</div>
</div>
</div>
</div>