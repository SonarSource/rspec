<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In JavaScript, <code>null</code> and <code>undefined</code> are primitive values that do not have properties or methods. When accessing a property on a <code>null</code> or <code>undefined</code> value, JavaScript tries to access the property of an object that does not exist, which results in a <code>TypeError</code>.</p>
</div>
<div class="paragraph">
<p>This can cause the program to crash or behave unexpectedly, which can be difficult to debug.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">let foo = null;
console.log(foo.bar); // Noncompliant: TypeError will be thrown</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="paragraph">
<p>The simplest solution is to check in a <code>if</code> condition the equality to <code>null</code> or <code>undefined</code>.
With the <a href="https://262.ecma-international.org/6.0/#sec-abstract-equality-comparison">abstract equality operator</a> it is not
required to check both, as these operators consider <code>null</code> and <code>undefined</code> to be equals.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">let foo;
if (foo != null) {
  console.log(foo.bar);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, the logical AND operator (<code>&amp;&amp;</code>) can be used to check if a variable is truthy before attempting to access its properties.
The expression will short-circuit and return the falsy value instead of attempting to access its properties.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">let foo = null;
console.log(foo &amp;&amp; foo.bar);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, use the optional chaining operator (<code>?.</code>) to check if the variable is <code>null</code> or <code>undefined</code> before attempting to access its property. This operator is more readable and concise, especially when dealing with nested properties.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">let foo = null;
console.log(foo?.bar);</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>MDN web docs - <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined"><code>undefined</code></a></p>
</li>
<li>
<p>MDN web docs - <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/null"><code>null</code></a></p>
</li>
<li>
<p>MDN web docs - <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError"><code>TypeError</code></a></p>
</li>
<li>
<p>MDN web docs - <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/No_properties">TypeError: "x" has no properties</a></p>
</li>
<li>
<p>MDN web docs - <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining">Optional chaining (<code>?.</code>)</a></p>
</li>
<li>
<p>MDN web docs - <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Logical_AND">Logical AND (<code>&amp;&amp;</code>)</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>"xxx" is null.</p>
</li>
<li>
<p>"xxx" is null on at least one execution path.</p>
</li>
<li>
<p>'xxx' can be null.</p>
</li>
<li>
<p>The value returned by method 'xxx' can be null.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Primary : the variable on which a function call can lead to a null pointer dereference (if this value is the output of another function call, this other function call must be highlighted instead)</p>
</div>
<div class="paragraph">
<p>Secondary : the last locations in the code where the nullability condition has been set on the variable. The associated location message should be either :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>So "xxxx" is null</p>
</li>
<li>
<p>So "xxxx" is nullable</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_15_mar_2016_094514_pierre_yves_nicolas_wrote">on 15 Mar 2016, 09:45:14 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>Useful links:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>https://javascriptweblog.wordpress.com/2010/08/16/understanding-undefined-and-preventing-referenceerrors/</p>
</li>
<li>
<p>https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We could make this rule also cover invalid function calls, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>var x = 42;
x(); // Noncompliant: TypeError will be thrown</pre>
</div>
</div>
<div class="paragraph">
<p>However, there may be some overlap with <a data-rspec-id="S2999" class="rspec-auto-link">RSPEC-2999</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_is_duplicated_by_s1678">is duplicated by: <a data-rspec-id="S1678" class="rspec-auto-link">S1678</a></h3>

</div>
<div class="sect2">
<h3 id="_replaces_s2220">replaces: <a data-rspec-id="S2220" class="rspec-auto-link">S2220</a></h3>

</div>
<div class="sect2">
<h3 id="_supercedes_s1697">supercedes: <a data-rspec-id="S1697" class="rspec-auto-link">S1697</a></h3>

</div>
<div class="sect2">
<h3 id="_on_11_feb_2015_123815_sébastien_gioria_wrote">on 11 Feb 2015, 12:38:15 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>This Rule fall into :</p>
</div>
<div class="paragraph">
<p>OWASP A6 &#8658; if this expose informations</p>
</div>
<div class="paragraph">
<p>OWASP A2 &#8658; if this can give attackers capacity to bypass authentication or authorization</p>
</div>
<div class="paragraph">
<p>OWASP A1 &#8658; is this can give attacker capacity to inject something</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_11_feb_2015_131839_ann_campbell_wrote">on 11 Feb 2015, 13:18:39 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks [~sebastien.gioria]</p>
</div>
</div>
</div>
</div>