<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when Rails model validations are bypassed using methods like <code>save(validate: false)</code>, <code>update_attribute</code>, or <code>update_column</code> without clear justification.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Rails model validations are a crucial part of maintaining data integrity in your application. They ensure that only valid data is stored in your database and that business rules are consistently enforced.</p>
</div>
<div class="paragraph">
<p>When you bypass validations using methods like <code>save(validate: false)</code>, <code>update_attribute</code>, or <code>update_column</code>, you&#8217;re essentially telling Rails to skip these important checks. This can lead to several problems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Invalid data storage</strong>: Data that doesn&#8217;t meet your validation criteria can be saved to the database</p>
</li>
<li>
<p><strong>Inconsistent business logic</strong>: Validations often encode important business rules that get ignored</p>
</li>
<li>
<p><strong>Unexpected application behavior</strong>: Other parts of your code may assume that data is valid, leading to errors or security issues</p>
</li>
<li>
<p><strong>Data corruption</strong>: Over time, invalid data can accumulate and cause problems</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Methods like <code>update_column</code> also skip callbacks, which means important side effects (like updating timestamps or triggering notifications) won&#8217;t happen.</p>
</div>
<div class="paragraph">
<p>While there are legitimate reasons to bypass validations (such as system migrations, bulk operations, or performance-critical updates), these cases should be rare and well-documented. In most situations, it&#8217;s better to fix the underlying validation issue or handle validation errors properly.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Bypassing model validations can lead to data integrity issues, inconsistent business logic enforcement, and unexpected application behavior. Invalid data stored in the database may cause errors in other parts of the application or create security vulnerabilities.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_rails">How to fix it in Rails</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use standard Rails update methods that respect validations. Handle validation errors appropriately instead of bypassing them.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">def update_user_status
  user = User.find(params[:id])
  user.status = 'inactive'
  user.save(validate: false) # Noncompliant
end

def quick_update
  user.update_attribute(:status, 'inactive') # Noncompliant
end</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">def update_user_status
  user = User.find(params[:id])
  user.status = 'inactive'

  if user.save
    # Handle success
  else
    # Handle validation errors appropriately
    handle_validation_errors(user.errors)
  end
end

def update_with_validation
  if user.update(status: 'inactive')
    # Handle success
  else
    # Handle validation errors
  end
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>When bypassing validations is necessary, document the reason clearly and consider the implications.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_code_examples_2">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">def bulk_deactivate
  users.each do |user|
    user.update_column(:status, 'inactive') # Noncompliant
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">def bulk_deactivate
  # Bypassing validations for performance in bulk operation
  # Data is pre-validated and this is a system-level update
  users.each do |user|
    user.update_column(:status, 'inactive')
  end
end</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Rails Active Record Validations - <a href="https://guides.rubyonrails.org/active_record_validations.html">Official Rails guide on model validations and their importance</a></p>
</li>
<li>
<p>Rails Active Record Persistence - <a href="https://guides.rubyonrails.org/active_record_basics.html#create">Documentation on Rails model persistence methods and their behavior</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-20: Improper Input Validation - <a href="https://cwe.mitre.org/data/definitions/20.html">Bypassing validations can lead to improper input validation vulnerabilities</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>