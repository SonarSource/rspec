<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using compound operators as well as increments and decrements (and toggling, in the case of <code>boolean</code>s) on primitive fields are not atomic operations. That is, they don&#8217;t happen in a single step. For instance, when a <code>volatile</code> primitive field is incremented or decremented you run the risk of data loss if threads interleave in the steps of the update. Instead, use a guaranteed-atomic class such as <code>AtomicInteger</code>, or synchronize the access.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">private volatile int count = 0;
private volatile boolean boo = false;

public void incrementCount() {
  count++;  // Noncompliant
}

public void toggleBoo(){
  boo = !boo;  // Noncompliant
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">private AtomicInteger count = 0;
private boolean boo = false;

public void incrementCount() {
  count.incrementAndGet();
}

public synchronized void toggleBoo() {
  boo = !boo;
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/SjdGBQ">CERT, VNA02-J.</a> - Ensure that compound operations on shared variables are atomic</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use an "Atomic[Integer|Long]" for this field; its operations are atomic.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_18_jun_2015_183453_nicolas_peru_wrote">on 18 Jun 2015, 18:34:53 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Title was a bit ambiguous I let you modify it if you think it is a bit redundant.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_18_jun_2015_183655_ann_campbell_wrote">on 18 Jun 2015, 18:36:55 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thank you [~nicolas.peru]. That&#8217;s what I get for writing the title before I fully understand what the description should say. :)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_jun_2015_155031_ann_campbell_wrote">on 19 Jun 2015, 15:50:31 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.peru] I just realized that in response to your 'redundant' comment I simply undid the change you had made. But at root, is there a 'safe' way to increment a <code>volatile</code> var?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_13_oct_2015_080659_nicolas_peru_wrote">on 13 Oct 2015, 08:06:59 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Modified title.</p>
</div>
</div>
</div>
</div>