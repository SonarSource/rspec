<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>Optional</code> value can hold either a value or not. The value held in the <code>Optional</code> can be accessed using the <code>get()</code> method, but it will throw a</p>
</div>
<div class="paragraph">
<p><code>NoSuchElementException</code> if there is no value present. To avoid the exception, calling the <code>isPresent()</code> or <code>! isEmpty()</code> method should always be done before any call to <code>get()</code>.</p>
</div>
<div class="paragraph">
<p>Alternatively, note that other methods such as <code>orElse(...)</code>, <code>orElseGet(...)</code> or <code>orElseThrow(...)</code> can be used to specify what to do with an empty <code>Optional</code>.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Optional&lt;String&gt; value = this.getOptionalValue();

// ...

String stringValue = value.get(); // Noncompliant</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">if (methodThatReturnsOptional().isEmpty()) {
  throw new NotFoundException();
}
String value = methodThatReturnsOptional().get(); // Noncompliant: indirect access, we consider that two consecutive calls can return different values.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">this.getOptionalValue().ifPresent(stringValue -&gt;
  // Do something with stringValue
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Optional&lt;String&gt; value = this.getOptionalValue();

// ...

if (value.isPresent()) {
  String stringValue = value.get();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Optional&lt;String&gt; value = this.getOptionalValue();

// ...

String stringValue = value.orElse("default");</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Optional&lt;String&gt; optional = methodThatReturnsOptional();
if (optional.isEmpty()) {
  throw new NotFoundException();
}
String value = optional.get();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/476">CWE-476 - NULL Pointer Dereference</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>call "xxx.isPresent()" before accessing the value.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_relates_to_s2966">relates to: <a data-rspec-id="S2966" class="rspec-auto-link">S2966</a></h3>

</div>
<div class="sect2">
<h3 id="_on_21_jun_2016_142134_tamas_vajk_wrote">on 21 Jun 2016, 14:21:34 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Let me know what you think.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_22_jun_2016_084016_ann_campbell_wrote">on 22 Jun 2016, 08:40:16 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk], now that the differences in the language mechanisms have had time to sink in, I&#8217;m going to leave this as a top-level RSpec.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_jun_2016_121005_freddy_mallet_wrote">on 29 Jun 2016, 12:10:05 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>Hi [~tamas.vajk], I can&#8217;t manage to understand why this rule is relevant in Java because for me there is no such concept of nullable value in Java. Or am I missing something ? Thanks cc [~michael.gumowski], [~nicolas.peru], [~ann.campbell.2]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_jun_2016_132019_nicolas_peru_wrote">on 29 Jun 2016, 13:20:19 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>\[~freddy.mallet] Optional. (<code>.get()</code> and <code>.isPresent()</code>)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_jun_2016_134730_freddy_mallet_wrote">on 29 Jun 2016, 13:47:30 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>Thanks [~nicolas.peru] !</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_jun_2016_143312_michael_gumowski_wrote">on 29 Jun 2016, 14:33:12 Michael Gumowski wrote:</h3>
<div class="paragraph">
<p>\[~freddy.mallet] I think the java aspect of this rule should be handled in a different RSPEC.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_jul_2016_183003_freddy_mallet_wrote">on 3 Jul 2016, 18:30:03 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>I think [~ann.campbell.2] is right [~michael.gumowski] : would be better for java to create a sub-task instead of creating another dedicated RSPEC.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_jul_2016_092045_michael_gumowski_wrote">on 4 Jul 2016, 09:20:45 Michael Gumowski wrote:</h3>
<div class="paragraph">
<p>Okay, fine for me [~freddy.mallet] &amp; [~ann.campbell.2]!</p>
</div>
</div>
</div>
</div>