This rule raises an issue when URLs are hardcoded as string literals in Apex code, whether they are Salesforce instance URLs or external service endpoints.

== Why is this an issue?

Hardcoded URLs in Apex code create several problems that affect maintainability, security, and reliability.

When URLs are embedded directly in the code as string literals, they become difficult to manage across different environments. Development, staging, and production environments often use different endpoints, and hardcoded URLs require code changes to switch between them.

For Salesforce instance URLs specifically, hardcoding creates a critical issue with My Domain enforcement. Salesforce is phasing out legacy host names and requiring all API calls to use My Domain URLs. Hardcoded instance URLs like `na1.salesforce.com` will break when My Domain enforcement is applied, causing API failures and integration issues.

External service URLs present additional challenges. Hardcoded external endpoints make it difficult to implement proper security controls, rotate API endpoints, or manage different service configurations across environments. They also make the code less flexible and harder to test with mock services.

From a security perspective, hardcoded URLs can expose sensitive endpoints in the source code and make it harder to implement centralized URL management and monitoring.

=== What is the potential impact?

Applications may break when Salesforce enforces My Domain requirements, causing API failures and integration issues. Hardcoded external URLs reduce flexibility in managing different environments and make it difficult to implement proper security controls or rotate endpoints when needed.

== How to fix it

For Salesforce instance URLs, use the URL.getOrgDomainUrl() method to dynamically construct URLs that work with My Domain enforcement.

=== Code examples

==== Noncompliant code example

[source,apex,diff-id=1,diff-type=noncompliant]
----
String endpoint = 'https://na1.salesforce.com/services/data/v58.0/sobjects/Account'; // Noncompliant
----

==== Compliant solution

[source,apex,diff-id=1,diff-type=compliant]
----
String endpoint = URL.getOrgDomainUrl().toExternalForm() + '/services/data/v58.0/sobjects/Account';
----

== Resources

=== Documentation

 * URL Class Methods - https://developer.salesforce.com/docs/atlas.en-us.apexref.meta/apexref/apex_methods_system_url.htm[Salesforce documentation for URL class methods including getOrgDomainUrl()]

 * Named Credentials - https://help.salesforce.com/s/articleView?id=sf.named_credentials_about.htm[Guide to using Named Credentials for secure external service integration]

 * Custom Labels - https://help.salesforce.com/s/articleView?id=sf.cl_about.htm[Documentation on using Custom Labels for configuration values]

 * My Domain Enforcement - https://help.salesforce.com/s/articleView?id=sf.domain_name_overview.htm[Information about My Domain requirements and enforcement]

=== Standards

 * CWE-547: Use of Hard-coded, Security-relevant Constants - https://cwe.mitre.org/data/definitions/547.html[Weakness related to hardcoding security-relevant constants in source code]

=== Related rules

 * S1075
