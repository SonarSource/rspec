<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true for applications that are distributed or that are open-source.</p>
</div>
<div class="paragraph">
<p>In the past, it has led to the following vulnerabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2019-13466">CVE-2019-13466</a></p>
</li>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2018-15389">CVE-2018-15389</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>
</div>
<div class="paragraph">
<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection strings, and for variable names that match any of the patterns from the provided list.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Credentials allow access to a sensitive component like a database, a file storage, an API or a service.</p>
</li>
<li>
<p>Credentials are used in production environments.</p>
</li>
<li>
<p>Application re-distribution is required before updating the credentials.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Store the credentials in a configuration file that is not pushed to the code repository.</p>
</li>
<li>
<p>Store the credentials in a database.</p>
</li>
<li>
<p>Use your cloud provider&#8217;s service for managing secrets.</p>
</li>
<li>
<p>If a password has been disclosed through the source code: change it.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">username="admin"
password="Admin123" # Sensitive
credentials="user=admin&amp;password=Admin123" # Sensitive
connection_string="mongodb://myDBReader:D1fficultP%40ssw0rd@mongodb0.example.com:27017/?authSource=admin" # Sensitive
url="scheme://user:Admin123@domain.com" # Sensitive
echo "DB_PASSWORD=Admin123" &gt;&gt; .env # Sensitive
curl -u admin:Admin123 https://example.com/api # Sensitive</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">username="admin"
password=${DB_PASSWORD}
credentials="user=${username}&amp;password=$(get_encrypted_password)"
url="scheme://${username}:${password}@domain.com"
echo "DB_PASSWORD=$(get_secret DB_PASSWORD)" &gt;&gt; .env
curl -u admin:$API_TOKEN https://example.com/api</code></pre>
</div>
</div>
</div>
</div>