<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true for applications that are distributed or that are open-source.</p>
</div>
<div class="paragraph">
<p>In the past, it has led to the following vulnerabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2019-13466">CVE-2019-13466</a></p>
</li>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2018-15389">CVE-2018-15389</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>
</div>
<div class="paragraph">
<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection strings, and for variable names that match any of the patterns from the provided list.</p>
</div>
<div class="paragraph">
<p>It&#8217;s recommended to customize the configuration of this rule with additional credential words such as "oauthToken", "secret", &#8230;&#8203;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Credentials allow access to a sensitive component like a database, a file storage, an API or a service.</p>
</li>
<li>
<p>Credentials are used in production environments.</p>
</li>
<li>
<p>Application re-distribution is required before updating the credentials.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Store the credentials in a configuration file that is not pushed to the code repository.</p>
</li>
<li>
<p>Store the credentials in a database.</p>
</li>
<li>
<p>Use your cloud provider&#8217;s service for managing secrets.</p>
</li>
<li>
<p>If a password has been disclosed through the source code: change it.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>String password = 'xxxx'; // Sensitive</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">String password = retrievePassword();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">Top 10 2021 Category A7 - Identification and Authentication Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">Top 10 2017 Category A2 - Broken Authentication</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/798">CWE-798 - Use of Hard-coded Credentials</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/259">CWE-259 - Use of Hard-coded Password</a></p>
</li>
<li>
<p>Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD">Hard Coded Password</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>"xxxxx" detected here, make sure this is not a hard-coded credential.</p>
</div>
<div class="paragraph">
<p>Review this hard-coded URI, which may contain a credential.</p>
</div>
</div>
<div class="sect2">
<h3 id="_parameters">Parameters</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">credentialWords</div>
<div class="listingblock">
<div class="content">
<pre>password, passwd, pwd, passphrase</pre>
</div>
</div>
<div class="paragraph">
<p>Comma separated list of words identifying potential credentials</p>
</div>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_25_nov_2014_203842_freddy_mallet_wrote">on 25 Nov 2014, 20:38:42 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] and [~nicolas.peru], for a first implementation, I would do the following things :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Search for all literals containing "password=xxxx"</p>
</li>
<li>
<p>Search for all local variable whose names contains 'password' and which are initialized with a hardcoded literal.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_15_dec_2014_101447_freddy_mallet_wrote">on 15 Dec 2014, 10:14:47 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>I&#8217;ve removed the tag "owasp-top10", as this vulnerability is no more part of OWASP Top 10 2013 in MITRE CWE referential</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_2_feb_2015_201155_sébastien_gioria_wrote">on 2 Feb 2015, 20:11:55 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>It&#8217;s part of OWASP Top10 2013 A2</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_feb_2015_195013_ann_campbell_wrote">on 3 Feb 2015, 19:50:13 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks [~sebastien.gioria]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_18_may_2017_150606_ann_campbell_wrote">on 18 May 2017, 15:06:06 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>In addition to "password", "passwd", &amp;etc. implementations of this rule should also look for translations (list compiled with the help of Google Translate):</p>
</div>
<div class="paragraph">
<p>achinsinsi, adgangskode, codice, contrasena, contrasenya, contrasinal, cynfrinair, facal-faire, facalfaire, fjaleklaim, focalfaire, geslo, haslo, heslo, iphasiwedi, jelszo, kalmarsirri, katalaluan, katasandi, kennwort, kode, kupuhipa, loluszais, losen, losenord, lozinka, lykilorth, mathkau, modpas, motdepasse, olelohuna, oroigbaniwole, parol, parola, parole, parool, pasahitza, pasiwedhi, passe, passord, passwort, passwuert, paswoodu, phasewete, salasana, sandi, senha, sifre, sifreya, slaptazois, tenimiafina, upufaalilolilo, wachtwoord, wachtwurd, wagwoord</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_2_mar_2018_100905_tibor_blenessy_wrote">on 2 Mar 2018, 10:09:05 Tibor Blenessy wrote:</h3>
<div class="paragraph">
<p>For posterity,  list of translated words was removed and replaced by customizable parameter, because this was raising too many false postives. See <a href="https://groups.google.com/a/sonarsource.com/forum/?utm_medium=email&amp;utm_source=footer#!msg/dogfood-rules/QFT49lKYYGM/Q5ebuctTAgAJ">dogfood</a>  and other discussions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_may_2018_182125_tibor_blenessy_wrote">on 3 May 2018, 18:21:25 Tibor Blenessy wrote:</h3>
<div class="paragraph">
<p>\[~freddy.mallet] why do you think that semantic analysis is required? Current implementations (at least in SonarJava, SonarTS, SonarGo) rely only on AST, checking literal value or identifier name.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_16_may_2018_121516_freddy_mallet_wrote">on 16 May 2018, 12:15:16 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>You&#8217;re right [~tibor.blenessy] according to the current functional scope of this rule. I&#8217;ve updated the 'Analysis Level' field. Thanks</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_oct_2019_195500_ann_campbell_wrote">on 29 Oct 2019, 19:55:00 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tolun.ardahanli] the <a href="https://docs.sonarqube.org/latest/extend/adding-coding-rules/#header-4">rule writing guide</a> says titles should be plural when possible. (Call me if you want the English language reasons.)  If there&#8217;s a reason to make this one singular, then it now needs an article.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_30_oct_2019_145647_tolun_ardahanli_wrote">on 30 Oct 2019, 14:56:47 Tolun Ardahanli wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Thank you for your sharing and suggestion. I updated.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_mar_2020_110408_pavel_mikula_wrote">on 3 Mar 2020, 11:04:08 Pavel Mikula wrote:</h3>
<div class="paragraph">
<p>Hi [~pierre-loup.tristant],</p>
</div>
<div class="paragraph">
<p>Have you considered usage of term URI instead of URL? URI seems more generic to me and RFC 3986 defines URI and userInfo part of it. So I think URI should be prefered here.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_mar_2020_151417_pierre_loup_tristant_wrote">on 3 Mar 2020, 15:14:17 Pierre-Loup Tristant wrote:</h3>
<div class="paragraph">
<p>\[~pavel.mikula] I agree with you it should be URI instead or URL. You can go for "Review this hard-coded URI, which may contain a credential." as the new issue message.</p>
</div>
</div>
</div>
</div>