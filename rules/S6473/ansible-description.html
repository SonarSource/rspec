<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Exposing administration services can lead to unauthorized access to containers
or escalation of privilege inside of containers.</p>
</div>
<div class="paragraph">
<p>Administration services like SSH might contain vulnerabilities, hard-coded
credentials, or other security issues that increase the attack surface of a
container deployment.<br>
Even if the ports of the services do not get forwarded to the host system, by
default they are reachable from other containers in the same network. A
malicious actor that gets access to one container could use such services to
escalate access and privileges.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The container starts an administration service.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to the question.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Do not start SSH, VNC, RDP or similar administration services in containers.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">- name: Podman tasks
  hosts: server
  tasks:
    - name: Start SSH server
      containers.podman.podman_container:
        name: container
        image: lscr.io/linuxserver/openssh-server:version-9.7_p1-r4
        publish:
          - "22:2222" # Sensitive</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/284">CWE-284 - Improper Access Control</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_message">Message</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Make sure that exposing administration services is safe here.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_highlighting">Highlighting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Highlight the sensitive port.</p>
</div>
<div class="sect2">
<h3 id="_parameters">Parameters</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">ports</div>
<div class="listingblock">
<div class="content">
<pre>22, 23, 3389, 5800, 5900</pre>
</div>
</div>
<div class="paragraph">
<p>Comma separated list of sensitive ports that expose administration services.</p>
</div>
</div>
</div>
<hr>
</div>
</div>
</div>