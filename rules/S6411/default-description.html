<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Maps use hashes of the keys to select a bucket to store data in.
Objects that hash to the same value will be added to the same bucket.</p>
</div>
<div class="paragraph">
<p>When the hashing function has a poor distribution, buckets can grow to very large sizes.
This may negatively affect lookup performance, as, by default, matching a key within a bucket has linear complexity.</p>
</div>
<div class="paragraph">
<p>In addition, as the default hashCode function can be selected at runtime, performance expectations cannot be maintained.</p>
</div>
<div class="paragraph">
<p>Implementing Comparable mitigates the performance issue for objects that hash to the same value.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">class MyKeyType {
    // ...
}

class Program {
    Map&lt;MyKeyType, MyValueType&gt; data = new HashMap&lt;&gt;(); // Noncompliant

    Map&lt;MyKeyType, MyValueType&gt; buildMap() { // Noncompliant
        //...
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">class MyKeyType implements Comparable&lt;MyKeyType&gt; {
    // ...
}

class MyChildKeyType extends MyKeyType {
    // ...
}

class Program {
    Map&lt;MyKeyType, MyValueType&gt; data = new HashMap&lt;&gt;();
    Map&lt;MyChildKeyType, MyValueType&gt; data = new HashMap&lt;&gt;();

    Map&lt;MyKeyType, MyValueType&gt; buildMap() {
        //...
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://dzone.com/articles/java-8-hashmaps-keys-and-the-comparable-interface" class="bare">https://dzone.com/articles/java-8-hashmaps-keys-and-the-comparable-interface</a></p>
</li>
<li>
<p><a href="https://github.com/openjdk/jdk/blob/4927ee426aedbeea0f4119bac0a342c6d3576762/src/hotspot/share/runtime/synchronizer.cpp#L760-L798" class="bare">https://github.com/openjdk/jdk/blob/4927ee426aedbeea0f4119bac0a342c6d3576762/src/hotspot/share/runtime/synchronizer.cpp#L760-L798</a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Comparable.html" class="bare">https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Comparable.html</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_implementation_specification">Implementation Specification</h3>

</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>The key type should implement Comparable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Variable type, method return type and expressions.</p>
</div>
</div>
</div>
</div>