<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The use of <code>srand</code> together with <code>rand</code> to seed the random number generator and then generate numbers usually produces low-quality randomness. Further, <code>rand</code> can only provide a number between <code>0</code> and <code>RAND_MAX</code>, and it is left to the caller  to transform the result into what is actually required (E.G. a <code>float</code> between 0 and 1 for a random percentage, an <code>int</code> between 1 and 6 for a dice game, &#8230;&#8203;), and that transformation might introduce additional biases.</p>
</div>
<div class="paragraph">
<p>C&#43;&#43;11 introduced the <code>&lt;random&gt;</code> library, which contains several high quality random value generators as well as statistical distributions you can use to put the results in the form you need. Those mechanisms should be used instead of <code>rand</code> and <code>srand</code>.</p>
</div>
<div class="paragraph">
<p>Additionally, <code>std::random_shuffle</code>, which is deprecated in C&#43;&#43;14 and removed in C&#43;&#43;17, uses <code>rand</code> and should be replaced by <code>std::shuffle</code>, which uses the random number generators provided by <code>&lt;random&gt;</code>.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;stdlib.h&gt;
#include &lt;algorithm&gt;
// ...

void f() {
  srand(time(nullptr)); // Noncompliant
  vector&lt;int&gt; v;
  int size = rand() % 1000 + 1000; // Noncompliant, note that this way of coercing the result introduces extra bias
  for (auto i = 0; i &lt; size; ++i) {
    v.push_back(i);
  }
  random_shuffle(v.begin(), v.end()); // Noncompliant
  for (auto i : v) { cout &lt;&lt; i &lt;&lt; " "; }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;algorithm&gt;
#include &lt;random&gt;
// ...

void f() {
  random_device rd;  // Will be used to obtain a seed for the random number engine
  mt19937 gen(rd()); // Standard mersenne_twister_engine seeded with rd()
  uniform_int_distribution&lt;&gt; dis(1000, 1999); // Same distribution as before, but explicit and without bias
  vector&lt;int&gt; v;
  for (auto i = 0; i &lt; dis(gen); ++i) {
    v.push_back(i);
  }
  shuffle(v.begin(), v.end(), gen);
  for (auto i : v) { cout &lt;&lt; i &lt;&lt; " "; }
}</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Replace "rand" with the facilities in &lt;random&gt;</p>
</div>
<div class="paragraph">
<p>Replace "random_shuffle" with "shuffle"</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_9_nov_2018_195300_ann_campbell_wrote">on 9 Nov 2018, 19:53:00 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Double-check my changes please, [~loic.joly]</p>
</div>
</div>
</div>
</div>