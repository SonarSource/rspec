<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Basic authentication is a vulnerable method of user authentication that should be avoided. It functions by transmitting a Base64 encoded username and password. As Base64 is easy to recognize and reverse, sensitive data may be leaked this way.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Basic authentication is a simple and widely used method of user authentication for HTTP requests. When a client sends a request to a server that requires authentication, the client includes the username and password (concatenated together and Base64 encoded) in the "Authorization" header of the HTTP request. The server verifies the credentials and grants access if they are valid. Every request sent to the server to a protected endpoint must include these credentials.</p>
</div>
<div class="paragraph">
<p>Basic authentication is considered insecure for several reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It transmits user credentials in plain text, making them susceptible to interception and eavesdropping.</p>
</li>
<li>
<p>It relies solely on the server&#8217;s ability to verify the provided credentials. There is no mechanism for additional security measures like multi-factor authentication or account lockouts after multiple failed login attempts.</p>
</li>
<li>
<p>It does not provide a way to manage user sessions securely. The client typically includes the credentials in every request, which creates more opportunities for an attacker to steal these credentials.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These security limitations make basic authentication an insecure choice for authentication or authorization over HTTP.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Basic authentication transmits passwords in plain text, which makes it vulnerable to interception by attackers.</p>
</div>
<div class="sect3">
<h4 id="_session_hijacking_and_man_in_the_middle_attack">Session hijacking and man-in-the-middle attack</h4>
<div class="paragraph">
<p>If an attacker gains access to the network traffic, they can easily capture the username and password. Basic authentication does not provide any mechanism to protect against session hijacking attacks. Once a user is authenticated, the session identifier (the username and password) is sent in clear text with each subsequent request. If attackers can intercept one request, they can use it to impersonate the authenticated user, gaining unauthorized access to their account and potentially performing malicious actions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_brute_force_attacks">Brute-force attacks</h4>
<div class="paragraph">
<p>Basic authentication does not have any built-in protection against brute-force attacks. Attackers can repeatedly guess passwords until they find the correct one, especially if weak or commonly used passwords are used. This can lead to unauthorized access to user accounts and potential data breaches.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_java_ee">How to fix it in Java EE</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="paragraph">
<p>The following code uses basic authentication to protect web server endpoints.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;!-- web.xml --&gt;
&lt;web-app&gt;
  &lt;login-config&gt;
    &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
  &lt;/login-config&gt;
&lt;/web-app&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;!-- web.xml --&gt;
&lt;web-app&gt;
  &lt;login-config&gt;
    &lt;auth-method&gt;FORM&lt;/auth-method&gt;
    &lt;form-login-config&gt;
      &lt;form-login-page&gt;/login.jsp&lt;/form-login-page&gt;
      &lt;form-error-page&gt;/login-error.jsp&lt;/form-error-page&gt;
    &lt;/form-login-config&gt;
  &lt;/login-config&gt;
&lt;/web-app&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="sect3">
<h4 id="_token_based_authentication_and_oauth">Token-based authentication and OAuth</h4>
<div class="paragraph">
<p>Token-based authentication is a safer alternative than basic authentication. A unique token is generated upon successful authentication and sent to the client, which is then included in subsequent requests. Therefore, it eliminates the need to transmit sensitive credentials with each request. OAuth also works by authenticating users via tokens. It gives even more flexibility on top of this by offering scopes, which limit an application&#8217;s access to a user&#8217;s account.</p>
</div>
<div class="paragraph">
<p>Additionally, both token-based authentication and OAuth support mechanisms for token expiration, revocation, and refresh. This gives more flexibility than basic authentication, as compromised tokens carry much less risk than a compromised password.</p>
</div>
<div class="paragraph">
<p>The Jakarta EE Security API offers robust and standardized methods to handle authentication and authorization in Jakarta EE applications. In the example, form-based authentication is applied to the <code>web.xml</code> configuration file. After a user successfully logs into the application, a session is created for the user. A session token is stored in a cookie and is used for subsequent requests.</p>
</div>
</div>
<div class="sect3">
<h4 id="_integrate_with_an_identity_and_access_management_iam_system">Integrate with an Identity and Access Management (IAM) System</h4>
<div class="paragraph">
<p>For more advanced authentication and authorization capabilities, consider integrating the backend with an IAM system. Doing so gives access to features like single sign-on (SSO), role-based access control, and centralized user management. As of Jakarta EE 10, support for OpenID Connect (OIDC) is included. Using this authentication method, several OIDC providers can be integrated easily, such as Auth0, Okta, and Azure Active Directory.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ssl_encryption_for_http_requests">SSL encryption for HTTP requests</h4>
<div class="paragraph">
<p>With basic authentication, user credentials are transmitted in plain text, which makes them vulnerable to interception and eavesdropping. However, when HTTPS is employed, the data is encrypted before transmission, making it significantly more difficult for attackers to intercept and decipher the credentials. If no other form of authentication is possible for this code, then every request must be sent over HTTPS to ensure credentials are kept safe.</p>
</div>
<div class="paragraph">
<p>In Jakarta EE, HTTPS traffic can be enabled by setting the <code>transportGuarantee</code> attribute to <code>CONFIDENTIAL</code> in <code>web.xml</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>MDN web docs - <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication">HTTP authentication</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">Top 10 2021 Category A4 - Insecure Design</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Web_Service_Security_Cheat_Sheet.html#user-authentication">OWASP Web Service Security Cheat Sheet</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/522">CWE-522 - Insufficiently Protected Credentials</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222533">Application Security and Development: V-222533</a> - The application must authenticate all network connected endpoint devices before establishing any connection.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use a more secure method than basic authentication.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_8_jun_2015_085423_nicolas_peru_wrote">on 8 Jun 2015, 08:54:23 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I was a little confused at first by the starting of the first sentence and thought you got the title of the rule wrong. I would rewrite this sentence like : "Basic authentication uses Base64 as&#8230;&#8203; "</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_jun_2015_121452_ann_campbell_wrote">on 8 Jun 2015, 12:14:52 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Better [~nicolas.peru]?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_jun_2015_121842_nicolas_peru_wrote">on 8 Jun 2015, 12:18:42 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Looks good ! :)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_23_jan_2019_110648_alexandre_gigleux_wrote">on 23 Jan 2019, 11:06:48 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>Reference HttpPost: http://hc.apache.org/httpcomponents-client-ga/tutorial/html/fundamentals.html</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_2_dec_2019_104759_alexandre_gigleux_wrote">on 2 Dec 2019, 10:47:59 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>I remove CWE-311 from this rule because CWE-311 maps to "INSECURE_CONF" SonarSource Security Category and this makes this RSPEC mapping to 2 SonarSource Security Category and we expect a given RSPEC to map to only one specific SonarSource Security Category.</p>
</div>
</div>
</div>
</div>