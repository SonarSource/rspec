include::../description.adoc[]

include::../ask-yourself.adoc[]

== Recommended Secure Coding Practices

Allowing users to execute code dynamically generally creates more problems than it solves.

Anything that can be done via dynamic code execution can usually be done via a languageâ€™s native SDK and static code.
Therefore, our suggestion is to avoid executing code dynamically.
If the application requires the execution of dynamic code, additional security measures must be taken.

When the untrusted parameters are expected to contain operators, function names or other reflection-related values, best practices would encourage using an allow list. This one would contain a list of accepted safe values that can be used as part of the dynamic code.

When receiving an untrusted parameter, the application would verify its value is contained in the configured allow list. If it is present, the parameter is accepted. Otherwise, it is rejected and an error is raised.

Another similar approach is using a binding between identifiers and accepted values. That way, users are only allowed to provide identifiers, where only valid ones can be converted to a safe value.

== Sensitive Code Example

[source,swift]
----
import Foundation

private func sayHello(_ role: String) {
    if let script = NSAppleScript(source: "say \"Hello \(role)\"") { // Sensitive
        var error: NSDictionary?
        script.executeAndReturnError(&error)
    } 
}
----


== Compliant Solution

[source,swift]
----
import Foundation

enum Role: String {
    case User = "User"
    case Admin = "Admin"
}

private func sayHello(_ role: Role) {
    if let script = NSAppleScript(source: "say \"Hello \(role.rawValue)\"") {
        var error: NSDictionary?
        script.executeAndReturnError(&error)
    } 
}
----

include::../see.adoc[]

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::../message.adoc[]

'''
== Comments And Links
(visible only on this page)

include::../comments-and-links.adoc[]

endif::env-github,rspecator-view[]
