<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, Electron automatically allows access to all the common web APIs. This includes APIs that are, in a normal browser context, subject to prior user approval.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Electron applications often require access to various web permissions to function correctly, such as accessing the user&#8217;s camera, microphone, or location. However, granting these permissions without proper scrutiny can expose the application and its users to significant security risks. Malicious websites or compromised resources could exploit these permissions to perform unauthorized actions, leading to data breaches, privacy violations, or other harmful activities.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>If dangerous web permissions are not properly filtered in an Electron application, the potential impact can be severe and multifaceted:</p>
</div>
<div class="sect3">
<h4 id="_security_breaches">Security Breaches</h4>
<div class="paragraph">
<p>Unauthorized access to sensitive resources such as the camera, microphone, or location data can lead to security breaches. Malicious actors could exploit these permissions to spy on users, capture sensitive information, or conduct other nefarious activities.</p>
</div>
</div>
<div class="sect3">
<h4 id="_privacy_violations">Privacy Violations</h4>
<div class="paragraph">
<p>Users' personal information and activities could be exposed without their consent, leading to significant privacy concerns. This can erode user trust and damage the reputation of the application and its developers.</p>
</div>
</div>
<div class="sect3">
<h4 id="_user_trust_and_retention">User Trust and Retention</h4>
<div class="paragraph">
<p>Users expect applications to safeguard their privacy and security. If an application is perceived as insecure or invasive, users are likely to abandon it in favor of more secure alternatives, negatively impacting user retention and overall success.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Implement a custom permission request handler to only allow access to those APIs that are necessary.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const { app } = require('electron/main')

const createWindowWithoutExplicitFilter = () =&gt; {
    const win = new BrowserWindow({
        width: 800,
        height: 600,
    })

    win.loadFile('index.html')
}

app.whenReady()
  .then(() =&gt; createWindowWithoutExplicitFilter()) // Noncompliant
  .catch(console.error)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const { app, session } = require('electron/main')

const addPermissionFilter = (ses) =&gt; {
    ses.setPermissionRequestHandler((webContents, permission, callback) =&gt; {
        if (permission === 'notifications') {
            callback(true)
        } else {
            callback(false)
        }
    })
}

const createWindowWithoutExplicitFilter = () =&gt; {
    const win = new BrowserWindow({
        width: 800,
        height: 600,
    })

    win.loadFile('index.html')
}

app.whenReady()
  .then(() =&gt; addPermissionFilter(session.defaultSession))
  .then(() =&gt; createWindowWithoutExplicitFilter()) // Compliant
  .catch(console.error)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>The compliant code example adds a custom permission request handler to the session that only allow access to the Notification API.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Electron - <a href="https://www.electronjs.org/docs/latest/tutorial/security#5-handle-session-permission-requests-from-remote-content">Handle session permission requests from remote content</a></p>
</li>
<li>
<p>Electron - <a href="https://www.electronjs.org/docs/latest/api/session#sessetpermissionrequesthandlerhandler">Session.setPermissionRequestHandler</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p>Doyensec - <a href="https://blog.doyensec.com/2022/09/27/electron-api-default-permissions.html">Diving Into Electron Web API Permissions</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>Add a filter for dangerous web permission requests.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Highlight the first <code>new BrowserWindow()</code> call found.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
</div>
</div>