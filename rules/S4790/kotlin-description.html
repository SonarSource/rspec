<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The MD5 algorithm and its successor, SHA-1, are no longer considered secure, because it is too easy to create hash collisions with them. That is, it takes too little computational effort to come up with a different input that produces the same MD5 or SHA-1 hash, and using the new, same-hash value gives an attacker the same access as if he had the originally-hashed value. This applies as well to the other Message-Digest algorithms: MD2, MD4, MD6, HAVAL-128, HMAC-MD5, DSA (which uses SHA-1), RIPEMD, RIPEMD-128, RIPEMD-160, HMACRIPEMD160.</p>
</div>
<div class="paragraph">
<p>The following APIs are tracked for use of obsolete crypto algorithms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.security.AlgorithmParameters</code>  (JDK)</p>
</li>
<li>
<p><code>java.security.AlgorithmParameterGenerator</code> (JDK)</p>
</li>
<li>
<p><code>java.security.MessageDigest</code> (JDK)</p>
</li>
<li>
<p><code>java.security.KeyFactory</code> (JDK)</p>
</li>
<li>
<p><code>java.security.KeyPairGenerator</code> (JDK)</p>
</li>
<li>
<p><code>java.security.Signature</code> (JDK)</p>
</li>
<li>
<p><code>javax.crypto.Mac</code> (JDK)</p>
</li>
<li>
<p><code>javax.crypto.KeyGenerator</code> (JDK)</p>
</li>
<li>
<p><code>org.apache.commons.codec.digest.DigestUtils</code>  (Apache Commons Codec)</p>
</li>
<li>
<p><code>org.springframework.util.DigestUtils</code></p>
</li>
<li>
<p><code>com.google.common.hash.Hashing</code> (Guava)</p>
</li>
<li>
<p><code>org.springframework.security.authentication.encoding.ShaPasswordEncoder</code> (Spring Security 4.2.x)</p>
</li>
<li>
<p><code>org.springframework.security.authentication.encoding.Md5PasswordEncoder</code> (Spring Security 4.2.x)</p>
</li>
<li>
<p><code>org.springframework.security.crypto.password.LdapShaPasswordEncoder</code> (Spring Security 5.0.x)</p>
</li>
<li>
<p><code>org.springframework.security.crypto.password.Md4PasswordEncoder</code> (Spring Security 5.0.x)</p>
</li>
<li>
<p><code>org.springframework.security.crypto.password.MessageDigestPasswordEncoder</code> (Spring Security 5.0.x)</p>
</li>
<li>
<p><code>org.springframework.security.crypto.password.NoOpPasswordEncoder</code> (Spring Security 5.0.x)</p>
</li>
<li>
<p><code>org.springframework.security.crypto.password.StandardPasswordEncoder</code> (Spring Security 5.0.x)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The hashed value is used in a security context like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User-password storage.</p>
</li>
<li>
<p>Security token generation (used to confirm  e-mail when registering on a website, reset password, etc &#8230;&#8203;).</p>
</li>
<li>
<p>To compute some message integrity.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it&#8217;s even better to use algorithms that do not compute too "quickly", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code> because it slows down <code>brute force attacks</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>val md1: MessageDigest = MessageDigest.getInstance("SHA");  // Sensitive:  SHA is not a standard name, for most security providers it's an alias of SHA-1
val md2: MessageDigest = MessageDigest.getInstance("SHA1");  // Sensitive</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">val md1: MessageDigest = MessageDigest.getInstance("SHA-512"); // Compliant</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">Top 10 2021 Category A2 - Cryptographic Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
<li>
<p>OWASP - <a href="https://mas.owasp.org/checklists/MASVS-CRYPTO/">Mobile AppSec Verification Standard - Cryptography Requirements</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">Mobile Top 10 2016 Category M5 - Insufficient Cryptography</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2023-risks/m10-insufficient-cryptography">Mobile Top 10 2024 Category M10 - Insufficient Cryptography</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/1240">CWE-1240 - Use of a Risky Cryptographic Primitive</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure this weak hash algorithm is not used in a sensitive context here.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>When a hash is calculated using a single function call:</p>
<div class="ulist">
<ul>
<li>
<p>The hashing function call</p>
</li>
</ul>
</div>
</li>
<li>
<p>When an object representing a weak hash function&#8230;&#8203;</p>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203; is constructed:</p>
<div class="ulist">
<ul>
<li>
<p>The object construction statement</p>
</li>
</ul>
</div>
</li>
<li>
<p>&#8230;&#8203; is returned from a factory method provided by a supported framework/library:</p>
<div class="ulist">
<ul>
<li>
<p>The factory method call that returns the object</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">byte[] hash = MD5.HashData(data);
              ^^^^^^^^^^^^^^^^^^
HashAlgorithm obj1 = new MD5CryptoServiceProvider();
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
HashAlgorithm obj2 = HashAlgorithm.Create("MD5");
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_deprecates_s2070">deprecates: <a data-rspec-id="S2070" class="rspec-auto-link">S2070</a></h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s2053">is related to: <a data-rspec-id="S2053" class="rspec-auto-link">S2053</a></h3>

</div>
<div class="sect2">
<h3 id="_on_4_sep_2018_104109_alexandre_gigleux_wrote">on 4 Sep 2018, 10:41:09 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.harraudeau] Review</p>
</div>
<div class="paragraph">
<p>Can you clarify "an attacker can steal the original information if it is secret", this is not clear to me?</p>
</div>
<div class="paragraph">
<p>When we say: "use only hashing algorithms which are known to be strong" - I believe we should already list the ones that are not strong enough as of now and make it evolving over time.</p>
</div>
</div>
</div>
</div>