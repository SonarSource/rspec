include::../common/description.adoc[]

include::../common/impact.adoc[]

include::../common/fix.adoc[]

=== Code examples

==== Noncompliant code example

[source,java,diff-id=1,diff-type=noncompliant]
----
MessageDigest md5 = MessageDigest.getInstance("MD5");  // Noncompliant
// Note: SHA is not a standard name, for most security providers it's an alias of SHA-1
MessageDigest sha = MessageDigest.getInstance("SHA");  // Noncompliant
MessageDigest sha1 = MessageDigest.getInstance("SHA1");  // Noncompliant
----

==== Compliant solution

[source,java,diff-id=1,diff-type=compliant]
----
MessageDigest sha512 = MessageDigest.getInstance("SHA-512");
----

include::../common/fix-pitfalls.adoc[]

include::../common/resources.adoc[]


ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::../common/message.adoc[]

include::../common/highlighting.adoc[]

'''
== Comments And Links
(visible only on this page)

=== on 14 Sep 2018, 19:06:56 Nicolas Harraudeau wrote:
The goal is to highlight code that initiates a hashing process. The Hash functions can be used by many different classes and it would be too complicated to list them all. Thus we detect the requests for hashing functions themselves, or the shortcut functions which hash without asking for a hash function (ex: ``++org.apache.commons.codec.digest.DigestUtils.sha1(data)++``).

include::../common/comments-and-links.adoc[]

endif::env-github,rspecator-view[]
