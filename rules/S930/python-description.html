<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Calling a function or a method with fewer or more arguments than expected will raise a <code>TypeError</code>. This is usually a bug and should be fixed.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">######################
# Positional Arguments
######################

param_args = [1, 2, 3]
param_kwargs = {'x': 1, 'y': 2}

def func(a, b=1):
    print(a, b)

def positional_unlimited(a, b=1, *args):
    print(a, b, *args)

func(1)
func(1, 42)
func(1, 2, 3)  # Noncompliant. Too many positional arguments
func()  # Noncompliant. Missing positional argument for "a"

positional_unlimited(1, 2, 3, 4, 5)

def positional_limited(a, *, b=2):
    print(a, b)

positional_limited(1, 2)  # Noncompliant. Too many positional arguments


#############################
# Unexpected Keyword argument
#############################

def keywords(a=1, b=2, *, c=3):
    print(a, b, c)

keywords(1)
keywords(1, z=42)  # Noncompliant. Unexpected keyword argument "z"

def keywords_unlimited(a=1, b=2, *, c=3, **kwargs):
    print(a, b, kwargs)

keywords_unlimited(a=1, b=2, z=42)

#################################
# Mandatory Keyword argument only
#################################

def mandatory_keyword(a, *, b):
    print(a, b)

mandatory_keyword(1, b=2)
mandatory_keyword(1)  # Noncompliant. Missing keyword argument "b"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/628">CWE-628 - Function Call with Incorrectly Specified Arguments</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>When there is one or more unexpected positional argument: "Remove XXX unexpected argument; 'foo' expects YYY positional arguments."</p>
</li>
<li>
<p>When there is one or more unexpected named argument: "Remove this unexpected named argument X"</p>
</li>
<li>
<p>When the maximum number of positional arguments is reached and *args is given: "Remove "*XXX"; maximum number of positional arguments already reached."</p>
</li>
<li>
<p>When the maximum number of keyword arguments is reached and **kwargs is given: "Remove "**XXX"; maximum number of keyword arguments already reached."</p>
</li>
<li>
<p>When there are missing positional arguments: "Add XXX missing arguments; 'foo' expects YYY positional arguments."</p>
</li>
<li>
<p>When there are missing keyword arguments: "Add the missing keyword argument XXX"</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Primary: The function name</p>
</div>
<div class="paragraph">
<p>Secondary:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The function definition</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_21_oct_2014_184410_ann_campbell_wrote">on 21 Oct 2014, 18:44:10 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~samuel.mercier]</p>
</div>
<div class="ulist">
<ul>
<li>
<p>nice use of See Also</p>
</li>
<li>
<p>please cite extra references in text or references section, but not both</p>
</li>
<li>
<p>this rule is targeted to C&#43;&#43;, but I&#8217;m not sure it&#8217;s appropriate - you can have default parameter values in C&#43;&#43; but not in C. Unless at implementation time there&#8217;s an intent to ignore the mismatch when covered by default values?</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_24_oct_2014_081643_samuel_mercier_wrote">on 24 Oct 2014, 08:16:43 Samuel Mercier wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] [~evgeny.mandrikov] [~freddy.mallet]</p>
</div>
<div class="paragraph">
<p>In c you can call a function without declaring it, so f(12, 34) is valid if f is not declared.</p>
</div>
<div class="paragraph">
<p>In C&#43;&#43; I think you need a definition or at least a prototype, so I removed it from the list of targeted languages.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_16_nov_2014_015326_evgeny_mandrikov_wrote">on 16 Nov 2014, 01:53:26 Evgeny Mandrikov wrote:</h3>
<div class="paragraph">
<p>\[~samuel.mercier], [~ann.campbell.2], [~freddy.mallet], guys, I&#8217;m a little bit puzzled about what we want to achieve here and thus about how this rule should be implemented.</p>
</div>
<div class="paragraph">
<p>According to C99 6.5.2.2p2:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>If the expression that denotes the called function has a type that includes a prototype, the number of arguments shall agree with the number of parameters.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>So one option to violate this - compiler should not conform with C99, which sounds unbelievable in 2014. But let&#8217;s try:</p>
</div>
<div class="paragraph">
<p>{noformat:title=1.c}</p>
</div>
<div class="paragraph">
<p>void fun(int p) {</p>
</div>
<div class="paragraph">
<p>}</p>
</div>
<div class="paragraph">
<p>void test() {</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fun();</pre>
</div>
</div>
<div class="paragraph">
<p>}</p>
</div>
<div class="paragraph">
<p>{noformat}</p>
</div>
<div class="paragraph">
<p>This is not accepted by GCC 4.7.3, Clang 3.5.0, ICC 14.0.3 20140422 (invoked with "-fsyntax-only --std c89") with error message "too few arguments to function call". Should we try with older compilers? How old? 1, 2, 5 years old?</p>
</div>
<div class="paragraph">
<p>Another option to violate this - do not use prototype:</p>
</div>
<div class="paragraph">
<p>{noformat:title=2.c}</p>
</div>
<div class="paragraph">
<p>void fun() {</p>
</div>
<div class="paragraph">
<p>}</p>
</div>
<div class="paragraph">
<p>void test() {</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fun(42);</pre>
</div>
</div>
<div class="paragraph">
<p>}</p>
</div>
<div class="paragraph">
<p>{noformat}</p>
</div>
<div class="paragraph">
<p>And indeed in this case no messages with GCC, but warning with Clang and ICC - "too many arguments in call to 'fun'". But then IMO this is covered by MISRA C:2004, 16.5 (<a data-rspec-id="S929" class="rspec-auto-link">RSPEC-929</a>), which clearly requires to specify "void" and so implies prototype, or MISRA C:2004, 8.1 (<a data-rspec-id="S819" class="rspec-auto-link">RSPEC-819</a>), which I assume implies requirement of prototype.</p>
</div>
<div class="paragraph">
<p>Third option to violate this - use implicit function declaration, which also means no prototype:</p>
</div>
<div class="paragraph">
<p>{noformat:title=3.c}</p>
</div>
<div class="paragraph">
<p>void test() {</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fun(42);</pre>
</div>
</div>
<div class="paragraph">
<p>}</p>
</div>
<div class="paragraph">
<p>{noformat}</p>
</div>
<div class="paragraph">
<p>Same result as in second case. But then IMO this is covered by MISRA C:2004, 8.1 (<a data-rspec-id="S819" class="rspec-auto-link">RSPEC-819</a>) as before, or by MISRA C:2012 17.3, which clearly forbids implicit function declaration and I suppose also should be part of <a data-rspec-id="S819" class="rspec-auto-link">RSPEC-819</a>.</p>
</div>
<div class="paragraph">
<p>Fourth option to violate this - use K&amp;R style of function definition, which also means no prototype:</p>
</div>
<div class="paragraph">
<p>{noformat:title=4.c}</p>
</div>
<div class="paragraph">
<p>void fun(p)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>int p;</pre>
</div>
</div>
<div class="paragraph">
<p>{</p>
</div>
<div class="paragraph">
<p>}</p>
</div>
<div class="paragraph">
<p>void test() {</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fun(42);</pre>
</div>
</div>
<div class="paragraph">
<p>}</p>
</div>
<div class="paragraph">
<p>{noformat}</p>
</div>
<div class="paragraph">
<p>Same result. But then IMO this is covered by <a data-rspec-id="S1198" class="rspec-auto-link">RSPEC-1198</a>, which clearly forbids K&amp;R style.</p>
</div>
<div class="paragraph">
<p>The difference between mentioned rules and this one - others are about declarations, whereas this about call-sites. So that if all enabled, then we&#8217;ll simply get more violations. And thus the only valid use-case for this one - when others are disabled, or when there is no way to fix declaration, i.e. when it comes from third-party header file.</p>
</div>
<div class="paragraph">
<p>Is it?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_17_nov_2014_153751_ann_campbell_wrote">on 17 Nov 2014, 15:37:51 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~evgeny.mandrikov],</p>
</div>
<div class="paragraph">
<p>I have a few responses to your comment. Rather than choosing, I&#8217;ll list them all:</p>
</div>
<div class="paragraph">
<p>1) The varargs argument is one of the things that came to mind when I read this rule, but as you&#8217;re about to point out, there&#8217;s another rule for that.</p>
</div>
<div class="paragraph">
<p>2) We can&#8217;t make assumptions about the compilers in use. Probably a frightening number of places are supporting ancient infrastructure (incl. compilers) because "it works; don&#8217;t mess with it!". (I&#8217;ve seen this in action.)</p>
</div>
<div class="paragraph">
<p>3) We have another rule already implemented that&#8217;s about code that won&#8217;t easily compile with modern compilers. If we&#8217;re going for full MISRA coverage (as full as possible, that is) adding this perhaps-nonsensical rule doesn&#8217;t seem like a big deal to me.</p>
</div>
<div class="paragraph">
<p>4) IMO, this rule is a good argument for not trying to adhere strictly to MISRA as written.</p>
</div>
<div class="paragraph">
<p>cc [~samuel.mercier], [~freddy.mallet]</p>
</div>
</div>
</div>
</div>