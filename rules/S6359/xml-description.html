<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Namespaces act as a container for grouping together permissions with a common theme or purpose. They also prevent conflicts when multiple apps want to use the same permission name.</p>
</div>
<div class="paragraph">
<p>The <code>android.permission</code> namespace holds all of the permissions defined by the Android operating system. It is not intended to be a general use container for all permissions.</p>
</div>
<div class="paragraph">
<p>Defining permissions in the <code>android.permission</code> namespace increases the risk of a permission name collision. The collision could be due to a new Android system permission, or it could be due to another app using the same permission name.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Below are some examples of the problems caused by a collision of Android permission names.</p>
</div>
<div class="sect3">
<h4 id="_app_installations_may_fail">App installations may fail</h4>
<div class="paragraph">
<p>Android will not allow multiple apps to define the same permission unless they are signed with the same key. This will be checked during when an app is installed or upgraded, and can cause the installation to fail with an <code>INSTALL_FAILED_DUPLICATE_PERMISSION</code> error.</p>
</div>
<div class="paragraph">
<p>If the permission name collision is with an Android system permission, your app will no longer be allowed to install or upgrade.</p>
</div>
<div class="paragraph">
<p>If the permission name collision is with another app, only one of the apps can be installed at a time. The presence of either app on the device will prevent the other app from being installed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_unexpected_permission_grants">Unexpected permission grants</h4>
<div class="paragraph">
<p>Permissions can be restricted so that they are only granted to apps signed with the same key. This allows apps from the same developer to work together but doesn&#8217;t expose that functionality to other apps.</p>
</div>
<div class="paragraph">
<p>When an app is granted a permission, that grant exists for as long as the app is installed. It remains in place even if the app that defined the permission is removed.</p>
</div>
<div class="paragraph">
<p>If your app reuses a permission that had previously been defined, any apps that retain the that permission will be able to bypass the signing key check.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Applications should define custom permissions in an application-specific namespace. This greatly reduces the chance of a permission name conflict.</p>
</div>
<div class="paragraph">
<p>It is common practice to use the application package name as part of the namespace.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.organization.app"&gt;

    &lt;permission
        android:name="android.permission.MY_PERMISSION" /&gt; &lt;!-- Noncompliant --&gt;

&lt;/manifest&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.organization.app"&gt;

    &lt;permission
        android:name="com.organization.app.permission.MY_PERMISSION" /&gt;

&lt;/manifest&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>Mobile AppSec Verification Standard - <a href="https://mas.owasp.org/checklists/MASVS-PLATFORM/">Platform Interaction Requirements</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage">Mobile Top 10 2016 Category M1 - Improper Platform Usage</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2023-risks/m3-insecure-authentication-authorization">Mobile Top 10 2024 Category M3 - Insecure Authentication/Authorization</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2023-risks/m8-security-misconfiguration">Mobile Top 10 2024 Category M8 - Security Misconfiguration</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/265">CWE-265 - Privilege Issues</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/732">CWE-732 - Incorrect Permission Assignment for Critical Resource</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_external_coding_guidelines">External coding guidelines</h3>
<div class="ulist">
<ul>
<li>
<p>Android Developers - <a href="https://developer.android.com/guide/topics/permissions/defining">Define a Custom App Permission</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use a different namespace for the 'xxx' permission.</p>
</div>
<hr>
</div>
</div>
</div>