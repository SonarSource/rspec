include::../description.adoc[]

include::../ask-yourself.adoc[]

include::../recommended.adoc[]

== Sensitive Code Example

``++NSAllowsArbitraryLoads++`` is a sensitive property that disables mixed content rules for any web request.

[source,xml]
----
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>NSAppTransportSecurity</key>
	<dict>
		<key>NSAllowsArbitraryLoads</key> <!-- Sensitive -->
		<true/>
	</dict>
</dict>
</plist>
----

``++NSAllowsArbitraryLoadsInWebContent++`` is a sensitive property that disables mixed content rules for WebView content.

[source,xml]
----
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>NSAppTransportSecurity</key>
	<dict>
		<key>NSAllowsArbitraryLoadsInWebContent</key> <!-- Sensitive -->
		<true/>
	</dict>
</dict>
</plist>
----

``++NSExceptionAllowsInsecureHTTPLoads++`` is a sensitive property that disables mixed content rules for specific URLs.

[source,xml]
----
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>NSAppTransportSecurity</key>
	<dict>
		<key>NSExceptionDomains</key>
		<dict>
			<key>example.com</key>
			<dict>
				<key>NSExceptionAllowsInsecureHTTPLoads</key> <!-- Sensitive -->
				<true/>
				<key>NSIncludesSubdomains</key>
				<true/>
			</dict>
		</dict>
	</dict>
</dict>
</plist>
----

== Compliant Solution

To disable the sensitive properties, simply remove them from the property list. They are off by default.

include::../see.adoc[]

* Apple Developer Documentation - https://developer.apple.com/documentation/bundleresources/information-property-list/nsapptransportsecurity/nsallowsarbitraryloads[NSAllowsArbitraryLoads]
* Apple Developer Documentation - https://developer.apple.com/documentation/bundleresources/information-property-list/nsapptransportsecurity/nsallowsarbitraryloadsinwebcontent[NSAllowsArbitraryLoadsInWebContent]
* Apple Developer Documentation - https://developer.apple.com/documentation/bundleresources/information-property-list/nsexceptionallowsinsecurehttploads[NSExceptionAllowsInsecureHTTPLoads]
