include::../description.adoc[]

include::../ask-yourself.adoc[]

include::../recommended.adoc[]

== Sensitive Code Example

On Apple platforms, App Transport Security (ATS) is a network security feature used to enforce secure connections.
It is used to guarantee a certain level of privacy and data integrity for all apps and app extensions.
It can be configured using the `Info.plist` file of the application.

``++NSAllowsArbitraryLoads++`` is a sensitive property that disables all ATS restrictions for all network connections.

[source,xml]
----
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>NSAppTransportSecurity</key>
	<dict>
		<key>NSAllowsArbitraryLoads</key> <!-- Sensitive -->
		<true/>
	</dict>
</dict>
</plist>
----

``++NSAllowsArbitraryLoadsInWebContent++`` is a sensitive property that disables all ATS restrictions for WebView content.

[source,xml]
----
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>NSAppTransportSecurity</key>
	<dict>
		<key>NSAllowsArbitraryLoadsInWebContent</key> <!-- Sensitive -->
		<true/>
	</dict>
</dict>
</plist>
----

``++NSExceptionAllowsInsecureHTTPLoads++`` is a sensitive property that allows insecure HTTP to be loaded from specific domains.

[source,xml]
----
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>NSAppTransportSecurity</key>
	<dict>
		<key>NSExceptionDomains</key>
		<dict>
			<key>example.com</key>
			<dict>
				<key>NSExceptionAllowsInsecureHTTPLoads</key> <!-- Sensitive -->
				<true/>
			</dict>
		</dict>
	</dict>
</dict>
</plist>
----

== Compliant Solution

To disable the sensitive properties, simply remove them from the property list. They are off by default.

== See

include::../common/resources/articles.adoc[]

* Apple Developer Documentation - https://developer.apple.com/documentation/security/preventing-insecure-network-connections[Preventing Insecure Network Connections]

include::../common/resources/standards-mobile.adoc[]

