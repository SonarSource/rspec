<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Data in a web session is considered inside the "trust boundary". That is, it is assumed to be trustworthy. But storing unvetted data from an unauthenticated user violates the trust boundary, and may lead to that data being used inappropriately.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when data from <code>Cookie</code>s or <code>HttpServletRequest</code>s is stored in a session.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">login = request.getParameter("login");
session.setAttribute("login", login);  // Noncompliant</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">Top 10 2021 Category A4 - Insecure Design</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/501">CWE-501 - Trust Boundary Violation</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure the user is authenticated before this data is stored in the session.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_1_oct_2015_123922_ann_campbell_wrote">on 1 Oct 2015, 12:39:22 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Since you&#8217;ve implemented the rule [~michael.gumowski], I&#8217;m unassigning the RSpec on the assumption that it looks good to you. :-)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_mar_2018_111157_sébastien_gioria_appsecfr_wrote">on 19 Mar 2018, 11:11:57 Sébastien GIORIA - AppSecFR wrote:</h3>
<div class="paragraph">
<p>Could be tagged A1:2017 more than A3:2017. This could lead to a injection. Storing data in a session on the server is not really a leak</p>
</div>
</div>
</div>
</div>