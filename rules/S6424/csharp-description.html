<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The recommended way to access Azure Durable Entities is through generated proxy objects with the help of interfaces.</p>
</div>
<div class="paragraph">
<p>The following restrictions, during interface design, are enforced:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entity interfaces must be defined in the same assembly as the entity class. This is not detected by the rule.</p>
</li>
<li>
<p>Entity interfaces must only define methods.</p>
</li>
<li>
<p>Entity interfaces must not contain generic parameters.</p>
</li>
<li>
<p>Entity interface methods must not have more than one parameter.</p>
</li>
<li>
<p>Entity interface methods must return void, Task, or Task&lt;T&gt;.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any of these rules are violated, an <code>InvalidOperationException</code> is thrown at runtime when the interface is used as a type argument to <code>IDurableEntityContext.SignalEntity&lt;TEntityInterface&gt;</code>, <code>IDurableEntityClient.SignalEntityAsync&lt;TEntityInterface&gt;</code> or <code>IDurableOrchestrationContext.CreateEntityProxy&lt;TEntityInterface&gt;</code>. The exception message explains which rule was broken.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue in case any of the restrictions above is not respected.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">namespace Foo // Noncompliant, must be defined in the same assembly as the entity class that implements it
{
    public interface ICounter&lt;T&gt; // Noncompliant, interfaces cannot contain generic parameters
    {
        string Name { get; set; } // Noncompliant, interface must only define methods
        void Add(int amount, int secondParameter); // Noncompliant, methods must not have more than one parameter
        int Get(); // Noncompliant, methods must return void, Task, or Task&lt;T&gt;
    }
}

namespace Bar
{
    public class Counter : ICounter
    {
        // do stuff
    }

    public static class AddToCounterFromQueue
    {
        [FunctionName("AddToCounterFromQueue")]
        public static Task Run(
            [QueueTrigger("durable-function-trigger")] string input,
            [DurableClient] IDurableEntityClient client)
        {
            var entityId = new EntityId("Counter", "myCounter");
            int amount = int.Parse(input);
            return client.SignalEntityAsync&lt;ICounter&gt;(entityId, proxy =&gt; proxy.Add(amount, 10));
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">namespace Bar
{
    public interface ICounter
    {
        void Add(int amount);
        Task&lt;int&gt; Get();
    }
}

namespace Bar
{
    public class Counter : ICounter
    {
        // do stuff
    }

    public static class AddToCounterFromQueue
    {
        [FunctionName("AddToCounterFromQueue")]
        public static Task Run(
            [QueueTrigger("durable-function-trigger")] string input,
            [DurableClient] IDurableEntityClient client)
        {
            var entityId = new EntityId("Counter", "myCounter");
            int amount = int.Parse(input);
            return client.SignalEntityAsync&lt;ICounter&gt;(entityId, proxy =&gt; proxy.Add(amount));
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.microsoft.com/en-us/azure/azure-functions/durable/durable-functions-dotnet-entities#restrictions-on-entity-interfaces">Restrictions on Entity Interfaces</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/en-us/azure/azure-functions/durable/durable-functions-entities?tabs=csharp">Durable Entities</a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.azure.webjobs.extensions.durabletask.idurableentitycontext.signalentity?view=azure-dotnet">IDurableEntityContext.SignalEntity</a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.azure.webjobs.extensions.durabletask.idurableentityclient.signalentityasync?view=azure-dotnet">IDurableEntityClient.SignalEntityAsync</a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.azure.webjobs.extensions.durabletask.idurableorchestrationcontext.createentityproxy?view=azure-dotnet">IDurableOrchestrationContext.CreateEntity</a></p>
</li>
</ul>
</div>
</div>
</div>