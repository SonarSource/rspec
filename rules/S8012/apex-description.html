<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when asynchronous Apex methods like <code>@future</code> methods, batch classes, or queueable jobs do not include proper exception handling around their main logic.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Asynchronous operations in Salesforce run in the background, separate from the main execution thread. When these operations encounter exceptions without proper handling, they fail silently.</p>
</div>
<div class="paragraph">
<p>This silent failure creates several problems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Debugging becomes extremely difficult</strong> - Without exception handling, there&#8217;s no record of what went wrong or when the failure occurred.</p>
</li>
<li>
<p><strong>Data inconsistencies may occur</strong> - Partial processing can leave your data in an inconsistent state, with some records updated and others not.</p>
</li>
<li>
<p><strong>Business processes may break</strong> - Critical background operations might fail without anyone knowing, disrupting important workflows.</p>
</li>
<li>
<p><strong>Governor limit violations go unnoticed</strong> - Asynchronous methods can hit Salesforce limits, but without proper handling, these failures are invisible.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Salesforce provides several mechanisms for asynchronous processing (<code>@future</code> methods, Batch Apex, Queueable Apex, and Schedulable Apex), but none of them automatically handle exceptions. It&#8217;s the developer&#8217;s responsibility to implement proper error handling to ensure reliable background processing.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Silent failures in asynchronous operations can lead to data corruption, incomplete business processes, and difficult-to-diagnose production issues. Without proper exception handling, critical background operations may fail unnoticed, potentially affecting data integrity and business continuity.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_batch_apex">How to fix it in Batch Apex</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Batch Apex classes, implement exception handling in the execute method. Use the Database.RaisesPlatformEvents interface to track batch job failures.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">public class AccountBatch implements Database.Batchable&lt;sObject&gt; {
    public Database.QueryLocator start(Database.BatchableContext bc) {
        return Database.getQueryLocator('SELECT Id, Name FROM Account');
    }

    public void execute(Database.BatchableContext bc, List&lt;Account&gt; accounts) {
        for (Account acc : accounts) {
            acc.Name = acc.Name + ' - Batch Processed';
        }
        update accounts; // Noncompliant
    }

    public void finish(Database.BatchableContext bc) {}
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">public class AccountBatch implements Database.Batchable&lt;sObject&gt; {
    public Database.QueryLocator start(Database.BatchableContext bc) {
        return Database.getQueryLocator('SELECT Id, Name FROM Account');
    }

    public void execute(Database.BatchableContext bc, List&lt;Account&gt; accounts) {
        try {
            for (Account acc : accounts) {
                acc.Name = acc.Name + ' - Batch Processed';
            }
            update accounts;
        } catch (Exception e) {
            System.debug('Batch execution error: ' + e.getMessage());
            // Log error details for monitoring
        }
    }

    public void finish(Database.BatchableContext bc) {}
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_queueable_apex">How to fix it in Queueable Apex</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Queueable classes, wrap the execute method logic in try-catch blocks. Consider implementing retry logic by re-queuing the job with modified parameters.</p>
</div>
<div class="sect2">
<h3 id="_code_examples_2">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">public class DataProcessor implements Queueable {
    private Set&lt;Id&gt; recordIds;

    public DataProcessor(Set&lt;Id&gt; recordIds) {
        this.recordIds = recordIds;
    }

    public void execute(QueueableContext context) {
        List&lt;Account&gt; accounts = [SELECT Id, Name FROM Account WHERE Id IN :recordIds];
        for (Account acc : accounts) {
            acc.Name = acc.Name + ' - Queued';
        }
        update accounts; // Noncompliant
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">public class DataProcessor implements Queueable {
    private Set&lt;Id&gt; recordIds;
    private Integer retryCount;

    public DataProcessor(Set&lt;Id&gt; recordIds) {
        this(recordIds, 0);
    }

    public DataProcessor(Set&lt;Id&gt; recordIds, Integer retryCount) {
        this.recordIds = recordIds;
        this.retryCount = retryCount;
    }

    public void execute(QueueableContext context) {
        try {
            List&lt;Account&gt; accounts = [SELECT Id, Name FROM Account WHERE Id IN :recordIds];
            for (Account acc : accounts) {
                acc.Name = acc.Name + ' - Queued';
            }
            update accounts;
        } catch (Exception e) {
            System.debug('Queueable execution error: ' + e.getMessage());
            if (retryCount &lt; 3) {
                System.enqueueJob(new DataProcessor(recordIds, retryCount + 1));
            }
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Apex Developer Guide - Future Methods - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_invoking_future_methods.htm">Official Salesforce documentation on future methods and best practices</a></p>
</li>
<li>
<p>Apex Developer Guide - Batch Apex - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_batch.htm">Comprehensive guide to implementing and monitoring Batch Apex</a></p>
</li>
<li>
<p>Apex Developer Guide - Queueable Apex - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_queueing_jobs.htm">Documentation on Queueable Apex implementation and error handling</a></p>
</li>
<li>
<p>Apex Developer Guide - Exception Handling - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_exception_handling.htm">Best practices for exception handling in Apex</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-248: Uncaught Exception - <a href="https://cwe.mitre.org/data/definitions/248.html">Weakness related to uncaught exceptions that can lead to application crashes or unexpected behavior</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>