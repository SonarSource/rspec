<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Performing math on variables that are declared - explicitly or implicitly - as <code>DISPLAY</code> or <code>NATIONAL</code> is much less efficient than on <code>COMPUTATIONAL</code>, <code>COMP</code>, or <code>BINARY</code> variables. That&#8217;s because <code>COMP</code> variables, for instance, are defined for binary storage, which makes math on them more efficient. That&#8217;s why values that are going to be used primarily for math should be declared with a math type. When math isn&#8217;t a primary use, it may not make sense to change the declared type, but <code>MOVE</code>ing the value to a <code>COMP</code> variable and performing the math on it instead would.</p>
</div>
<div class="paragraph">
<p>It is important to note however, that <code>COMPUTATIONAL</code>, <code>COMP</code>, and <code>BINARY</code> formats should be used with caution if the variable will be passed to other systems which may not use the same storage format.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cobol" data-lang="cobol">01 W-AMOUNT-VALUE PIC 9(17).
01 W-AMOUNT-DECIMAL PIC 9.

COMPUTE W-CONV-AMOUNT = W-AMOUNT-VALUE * 10 ** W-AMOUNT-DECIMAL  *&gt; Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cobol" data-lang="cobol">01 W-AMOUNT-VALUE PIC 9(17) COMP-5.
01 W-AMOUNT-DECIMAL PIC 9 COMP-5.

COMPUTE W-CONV-AMOUNT = W-AMOUNT-VALUE * 10 ** W-AMOUNT-DECIMAL</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Change the declaration of "xxx" to have a computational format.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>math operator and variable name</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_24_mar_2016_144638_ann_campbell_wrote">on 24 Mar 2016, 14:46:38 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Open question: what is the best action to take? Is some sort of cast or conversion available or must the declaration be changed?</p>
</div>
<div class="paragraph">
<p>Also, it would be nice to have an understanding of <em>why</em> it&#8217;s inefficient.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_apr_2016_101358_pierre_yves_nicolas_wrote">on 29 Apr 2016, 10:13:58 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2], Microfocus has some documentation on <a href="https://supportline.microfocus.com/documentation/books/sx51/prwrit.htm">Writing Efficient Programs</a>.</p>
</div>
<div class="paragraph">
<p>The IBM COBOL Programming guide has a section on <a href="http://www.ibm.com/support/knowledgecenter/SS6SG3_6.1.0/com.ibm.cobol61.ent.doc/PGandLR/tasks/tpeff05a.html">Choosing efficient computational data items</a>.</p>
</div>
<div class="paragraph">
<p>I think we should not activate this rule by default as the real performance impact may depend on the context.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_apr_2016_165224_ann_campbell_wrote">on 29 Apr 2016, 16:52:24 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~pierre-yves.nicolas] thanks for the references! I&#8217;ve expanded the description some based mostly on the Microfocus reference. I&#8217;m wondering how broadly it applies though. Specifically, do you think this bit applies beyond Microfocus:?</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>In native code programs, it is more efficient to move integer data items that are not COMP-X or COMP-5 to COMP-5 data items before doing arithmetic operations on them.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_apr_2016_172413_pierre_yves_nicolas_wrote">on 29 Apr 2016, 17:24:13 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2], my understanding is that this always applies unless when compiling a program to <a href="https://supportline.microfocus.com/documentation/books/sx51/pracmp.htm">"intermediate code"</a>. I think that "intermediate code" is specific to Microfocus because they target multiple operating systems.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_apr_2016_174420_ann_campbell_wrote">on 29 Apr 2016, 17:44:20 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>I think I&#8217;m done [~pierre-yves.nicolas]. Take a look.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_2_may_2016_132011_pierre_yves_nicolas_wrote">on 2 May 2016, 13:20:11 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>Looks good, thanks [~ann.campbell.2].</p>
</div>
</div>
</div>
</div>