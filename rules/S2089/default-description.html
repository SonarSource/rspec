<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fields in an HTTP request are putty in the hands of an attacker, and you cannot rely on them to tell you the truth about anything. While it may be safe to store such values after they have been neutralized, decisions should never be made based on their contents.</p>
</div>
<div class="paragraph">
<p>This rule flags uses of the referer header field.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class MyServlet extends HttpServlet {
  protected void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    String referer = request.getHeader("referer");  // Noncompliant
    if(isTrustedReferer(referer)){
      //..
    }
    //...
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">Top 10 2017 Category A2 - Broken Authentication</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/807">CWE-807 - Reliance on Untrusted Inputs in a Security Decision</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/293">CWE-293 - Using Referer Field for Authentication</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>"referer" header should not be relied on</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_2_oct_2014_193247_nicolas_peru_wrote">on 2 Oct 2014, 19:32:47 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>This is slightly different than what we discussed, in my mind, this rule should detect calls to request.getHeader("referer"). So a compliant solution should not have this call at all.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_oct_2014_140720_ann_campbell_wrote">on 3 Oct 2014, 14:07:20 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.peru] I&#8217;m assuming it&#8217;s the code samples, rather than the description that you take issue with. Better now?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_oct_2014_072853_nicolas_peru_wrote">on 8 Oct 2014, 07:28:53 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Ok ! :)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_dec_2014_205157_sébastien_gioria_wrote">on 12 Dec 2014, 20:51:57 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.peru]: I disagree. You could have calls to request.getHeader("referer"); but you should never use the value returned to perform an authentication or autorization.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_dec_2014_205602_nicolas_peru_wrote">on 12 Dec 2014, 20:56:02 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>\[~sebastien.gioria]I agree but how would you distiguish risky calls from correct one ? Idea here is to raise all calls to this method to let the security auditor mute the acceptable ones.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_dec_2014_210738_sébastien_gioria_wrote">on 12 Dec 2014, 21:07:38 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>It the job of the security auditor ;) to distinguish it. If the idea is to trigger attention of the Security auditor, this could be OK.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_17_feb_2021_090311_eric_therond_wrote">on 17 Feb 2021, 09:03:11 Eric Therond wrote:</h3>
<div class="paragraph">
<p>This rule is not in SonarWay</p>
</div>
<div class="paragraph">
<p>we can safely deprecate it because taint analysis rules do a better job (referer header is a source) than this rule.</p>
</div>
</div>
</div>
</div>