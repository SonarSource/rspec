<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If the denominator to a division or modulo operation is zero, a
<code>ZeroDivisionError</code> is raised.</p>
</div>
<div class="paragraph">
<p>This error will crash your program in most cases.
To fix it, you need to ensure that the denominator value in all division
operations is always non-zero, or check the value against zero before performing
the division.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A division (<code>/</code>) or modulo operation (<code>%</code>) by zero indicates a bug or logical
error.
This is because in Python, a division or modulo operation where the denominator
is zero always results in a <code>ZeroDivisionError</code> being raised.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Issues of this type interrupt the normal execution of a program, causing it to
crash or putting it into an inconsistent state.
Therefore, this issue might impact the availability and reliability of your
application, or even result in data loss.</p>
</div>
<div class="paragraph">
<p>If the computation of the denominator is tied to user input data, this issue can
potentially even be exploited by attackers to disrupt your application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The goal is to ensure that a zero value never reaches the denominator.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def foo():
    z = 0
    if (unknown()):
        z = 4
        ...
    else:
        # (z is not reassigned to a non-zero value here)
        ...
    z = 1 / z # Noncompliant: divisor can be 0</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def foo():
    z = 0
    if (unknown()):
        z = 4
        ...
    else:
        z = 1
        ...
    z = 1 / z</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def report_average():
    sum = compute_sum()
    denominator = population()
    print(sum / denominator) # Noncompliant: divisor can be 0

def population():
    size = read_size()
    return size if size is not None else 0</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def report_average():
    sum = compute_sum()
    denominator = population()
    if denominator == 0:
      print("We have no data.")
    else:
      print(sum / denominator)

def population():
    size = read_size()
    return size if size is not None else 0</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>One approach is to inspect every possible execution path that affects the
denominator and adjust them such that none of them lead to a zero value.
The first example illustrates this by ensuring that for all the paths that can
define the variable z, none assign it zero.
Thus, we are sure that the issue is fixed.</p>
</div>
<div class="paragraph">
<p>In other cases it might be necessary and safer to check and explicitly handle
the case of a zero denominator.
For instance, in the second example, an error message is displayed to the user
if the denominator is zero.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.python.org/3/reference/expressions.html#binary-arithmetic-operations">Binary arithmetic operations</a></p>
</li>
<li>
<p><a href="https://docs.python.org/3/library/exceptions.html#ZeroDivisionError">ZeroDivisionError</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/369">CWE-369 - Divide by zero</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222612">Application Security and Development: V-222612</a> - The application must not be vulnerable to overflow attacks.</p>
</li>
</ul>
</div>
</div>
</div>
</div>