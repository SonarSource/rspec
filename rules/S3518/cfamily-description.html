<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ensure that integer division and remainder operations do not result in divide-by-zero errors.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If the denominator to a division or modulo operation is zero, the behavior of the application is undefined.</p>
</div>
<div class="paragraph">
<p>Operator <code>/</code> is used for division and <code>%</code> for modulo operation.
Division and modulo operations are susceptible to divide-by-zero (and signed integer overflow) errors.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">int foo(int a, int b) {
  if (b == 0) {
    a = 1;
  }
  return a / b; // Noncompliant: potential divide-by-zero error
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Integer division or remainder operations that result in divide-by-zero errors lead to <strong>undefined behavior</strong>.</p>
</div>
<div class="paragraph">
<p>For programs that exercise undefined behavior, the compiler is no longer bound by the language specification.
The application may crash or, even worse, the application may appear to execute correctly while losing data or producing incorrect results.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Employ adequate checks that prevent divide-by-zero errors when using integer division or remainder operations.</p>
</div>
<div class="paragraph">
<p>Alternatively, replace integer division with floating-point division for which the divide-by-zero case is well defined and does not introduce undefined behavior.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;limits&gt;
#include &lt;optional&gt;

std::optional&lt;int&gt; safe_division(int a, int b) {
  // While the following check correctly prevents signed integer overflows,
  // it fails to prevent divide-by-zero errors. If `b` is equal to `0`, the
  // application emits undefined behavior.
  if ((a == std::numeric_limits&lt;int&gt;::min()) &amp;&amp; (b == -1)) {
    return std::nullopt;
  }
  return a / b; // Noncompliant: causes undefined behavior if `b` is zero
}

std::optional&lt;int&gt; foo(int a, int b) {
  if (b == 0) {
    a = 1;
  }
  return safe_division(a, b);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;limits&gt;
#include &lt;optional&gt;

std::optional&lt;int&gt; safe_division(int a, int b) {
  if ((b == 0) || ((a == std::numeric_limits&lt;int&gt;::min()) &amp;&amp; (b == -1))) {
    return std::nullopt;
  }
  return a / b; // Compliant: check correctly prevents divide-by-zero and signed integer overflows
}

std::optional&lt;int&gt; foo(int a, int b) {
  if (b == 0) {
    a = 1;
  }
  return safe_division(a, b);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;limits&gt;
#include &lt;optional&gt;

std::optional&lt;int&gt; safe_division(int a, int b) {
  if ((a == std::numeric_limits&lt;int&gt;::min()) &amp;&amp; (b == -1)) {
    return std::nullopt;
  }
  return a / b; // Compliant: check to prevent divide-by-zero in the caller
}

std::optional&lt;int&gt; foo(int a, int b) {
  if (b == 0) {
    return std::nullopt;
  }
  return safe_division(a, b);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">double foo(int a, int b) {
  return a / static_cast&lt;double&gt;(b); // Compliant: replace integer division by floating-point division
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_going_the_extra_mile">Going the extra mile</h3>
<div class="paragraph">
<p>Besides divide-by-zero errors, signed integer division is susceptible to overflows, too.
When the dividend is the minimum value for the signed integer type and the divisor is equal to <code>-1</code> an overflow is provoked due to two&#8217;s complement representation.
This frequently causes hard-to-track bugs.</p>
</div>
<div class="paragraph">
<p>The checks shown in the following code snippet correctly protect the division operation against divide-by-zero <em>and</em> signed integer overflow errors:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;limits&gt;
#include &lt;optional&gt;

std::optional&lt;int&gt; safe_division(int a, int b) {
  if ((b == 0) || ((a == std::numeric_limits&lt;int&gt;::min()) &amp;&amp; (b == -1))) {
    return std::nullopt;
  }
  return a / b; // Compliant: prevents divide-by-zero _and_ signed integer overflows
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CERT - <a href="https://wiki.sei.cmu.edu/confluence/display/c/INT32-C.+Ensure+that+operations+on+signed+integers+do+not+result+in+overflow">INT32-C. Ensure that operations on signed integers do not result in overflow</a></p>
</li>
<li>
<p>CERT - <a href="https://wiki.sei.cmu.edu/confluence/x/ftYxBQ">INT33-C. Ensure that division and remainder operations do not result in divide-by-zero errors</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/369">CWE-369 - Divide by zero</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222612">Application Security and Development: V-222612</a> - The application must not be vulnerable to overflow attacks.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_external_coding_guidelines">External coding guidelines</h3>
<div class="ulist">
<ul>
<li>
<p>C&#43;&#43; Core Guidelines - <a href="https://github.com/isocpp/CppCoreGuidelines/blob/e49158a/CppCoreGuidelines.md#es105-dont-divide-by-integer-zero">ES.105: Don&#8217;t divide by integer zero</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Consider reviewing data-flow - possible division by zero.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>primary: The denominator</p>
</li>
<li>
<p>secondary: where the denominator is set to 0</p>
<div class="ulist">
<ul>
<li>
<p>tertiary: where the denom is conditionally reset &gt; 0</p>
<div class="ulist">
<ul>
<li>
<p>message: Happens conditionally</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>secondary: where the denominator is received as a parameter</p>
<div class="ulist">
<ul>
<li>
<p>message: Could be 0</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_related_to_s3652">is related to: <a data-rspec-id="S3652" class="rspec-auto-link">S3652</a></h3>

</div>
<div class="sect2">
<h3 id="_on_2_feb_2016_145345_ann_campbell_wrote">on 2 Feb 2016, 14:53:45 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~freddy.mallet] I&#8217;ve removed modulo from the title since the first part of that operation is division</p>
</div>
</div>
</div>
</div>