This rule raises an issue when a shell script lacks a shebang line or uses an incorrect interpreter specification that doesn't match the script's features.

== Why is this an issue?

Shell scripts without proper shebang lines rely on automatic interpreter detection, which can lead to unpredictable behavior across different systems and environments.

When a script lacks a shebang line, the system may:

* Use the current shell to execute the script, which might not support the script's syntax
* Fall back to `/bin/sh`, which may not have the features your script requires
* Behave differently on different systems where the default shell varies

Using `#!/bin/sh` when your script contains bash-specific features (like `[[` tests, arrays, or process substitution) creates compatibility issues. The `/bin/sh` interpreter on many systems is a minimal POSIX shell that doesn't support these advanced features, causing your script to fail with cryptic error messages.

Proper shebang specification ensures that:

* Your script always runs with the intended interpreter
* The behavior is consistent across different systems and environments
* Other developers can immediately see which shell features are available
* System administrators can identify dependencies and requirements

=== What is the potential impact?

Scripts without proper shebang lines may fail unexpectedly when executed in different environments, leading to:

* Runtime errors when bash-specific features are used with `/bin/sh`
* Inconsistent behavior across different systems
* Difficult-to-debug issues where scripts work in development but fail in production
* Security vulnerabilities if scripts behave differently than expected

=== How to fix?


Add a proper shebang line at the beginning of your script. Use `#!/bin/bash` for bash-specific scripts or `#!/usr/bin/env bash` for better portability across systems.

==== Non-compliant code example

[source,shell,diff-id=1,diff-type=noncompliant]
----
echo "Hello World"
if [[ -n "$var" ]]; then  # Noncompliant: no shebang, uses bash-specific syntax
  echo "Variable is set"
fi
----

==== Compliant code example

[source,shell,diff-id=1,diff-type=compliant]
----
#!/bin/bash
echo "Hello World"
if [[ -n "$var" ]]; then
  echo "Variable is set"
fi
----

=== Documentation

 * Bash Manual - Invoking Bash - https://www.gnu.org/software/bash/manual/html_node/Invoking-Bash.html[Official documentation on how bash is invoked and the role of shebang lines]
 * Google Shell Style Guide - https://google.github.io/styleguide/shellguide.html[Google's comprehensive shell scripting style guide including shebang recommendations]
 * Advanced Bash-Scripting Guide - Starting Off With a Sha-Bang - https://tldp.org/LDP/abs/html/sha-bang.html[Detailed explanation of shebang lines and their importance in shell scripting]

=== Standards

 * POSIX.1-2017 - Shell Command Language - https://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html[POSIX standard defining shell command language and interpreter behavior]

