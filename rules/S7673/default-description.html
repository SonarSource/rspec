<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when a shell script lacks a shebang line or uses an incorrect interpreter specification that doesn&#8217;t match the script&#8217;s features.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
</div>
<div class="paragraph">
<p>Shell scripts without proper shebang lines rely on automatic interpreter detection, which can lead to unpredictable behavior across different systems and environments.</p>
</div>
<div class="paragraph">
<p>When a script lacks a shebang line, the system may:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the current shell to execute the script, which might not support the script&#8217;s syntax</p>
</li>
<li>
<p>Fall back to <code>/bin/sh</code>, which may not have the features your script requires</p>
</li>
<li>
<p>Behave differently on different systems where the default shell varies</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using <code>#!/bin/sh</code> when your script contains bash-specific features (like <code>[[</code> tests, arrays, or process substitution) creates compatibility issues. The <code>/bin/sh</code> interpreter on many systems is a minimal POSIX shell that doesn&#8217;t support these advanced features, causing your script to fail with cryptic error messages.</p>
</div>
<div class="paragraph">
<p>Proper shebang specification ensures that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your script always runs with the intended interpreter</p>
</li>
<li>
<p>The behavior is consistent across different systems and environments</p>
</li>
<li>
<p>Other developers can immediately see which shell features are available</p>
</li>
<li>
<p>System administrators can identify dependencies and requirements</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Scripts without proper shebang lines may fail unexpectedly when executed in different environments, leading to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Runtime errors when bash-specific features are used with <code>/bin/sh</code></p>
</li>
<li>
<p>Inconsistent behavior across different systems</p>
</li>
<li>
<p>Difficult-to-debug issues where scripts work in development but fail in production</p>
</li>
<li>
<p>Security vulnerabilities if scripts behave differently than expected</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_fix">How to fix?</h3>
</div>
Add a proper shebang line at the beginning of your script. Use !/bin/bash for bash-specific scripts or <code>!/usr/bin/env bash</code> for better portability across systems.

<div class="sect3">
<h4 id="_non_compliant_code_example">Non-compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">echo "Hello World"
if [[ -n "$var" ]]; then  # Noncompliant: no shebang, uses bash-specific syntax
  echo "Variable is set"
fi</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_code_example">Compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#!/bin/bash
echo "Hello World"
if [[ -n "$var" ]]; then
  echo "Variable is set"
fi</code></pre>
</div>
</div>
</div>

<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Bash Manual - Invoking Bash - <a href="https://www.gnu.org/software/bash/manual/html_node/Invoking-Bash.html">Official documentation on how bash is invoked and the role of shebang lines</a></p>
</li>
<li>
<p>Google Shell Style Guide - <a href="https://google.github.io/styleguide/shellguide.html">Google&#8217;s comprehensive shell scripting style guide including shebang recommendations</a></p>
</li>
<li>
<p>Advanced Bash-Scripting Guide - Starting Off With a Sha-Bang - <a href="https://tldp.org/LDP/abs/html/sha-bang.html">Detailed explanation of shebang lines and their importance in shell scripting</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>POSIX.1-2017 - Shell Command Language - <a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html">POSIX standard defining shell command language and interpreter behavior</a></p>
</li>
</ul>
</div>
</div>

