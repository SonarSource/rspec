This rule raises an issue when the `random` module is used to generate values that appear to be security-sensitive, such as tokens, passwords, or API keys.

== Why is this an issue?

The `random` module in Python is designed for modeling and simulation purposes. It uses a pseudorandom number generator that is deterministic and not cryptographically secure. This means that with enough observations or knowledge of the internal state, an attacker could predict future values.

When generating security-sensitive values like authentication tokens, session IDs, passwords, or API keys, predictable randomness creates serious security vulnerabilities. An attacker who can predict these values could:

* Hijack user sessions by guessing session tokens
* Gain unauthorized access by predicting API keys
* Compromise accounts by guessing password reset tokens

The `secrets` module was introduced in Python 3.6 specifically to address this need. It provides access to the most secure source of randomness that the operating system provides, making it suitable for cryptographic use cases.

=== What is the potential impact?

Using predictable random values for security purposes can lead to:

* **Session hijacking**: Attackers can predict session tokens and impersonate users
* **Unauthorized access**: Predictable API keys or authentication tokens allow attackers to bypass security controls
* **Account takeover**: Guessable password reset tokens enable attackers to compromise user accounts
* **Data breaches**: Weak randomness in encryption keys or salts can compromise data protection

== How to fix it

Replace `random` module functions with their `secrets` module equivalents when generating security-sensitive values.

=== Code examples

==== Noncompliant code example

[source,python,diff-id=1,diff-type=noncompliant]
----
import random
import string

def generate_api_key():
    return ''.join(random.choice(string.ascii_letters + string.digits) for _ in range(32))  # Noncompliant

def generate_session_token():
    return random.randint(100000, 999999)  # Noncompliant
----

==== Compliant solution

[source,python,diff-id=1,diff-type=compliant]
----
import secrets
import string

def generate_api_key():
    return ''.join(secrets.choice(string.ascii_letters + string.digits) for _ in range(32))

def generate_session_token():
    return secrets.randbelow(900000) + 100000
----

== Resources

=== Documentation

 * Python secrets module documentation - https://docs.python.org/3/library/secrets.html[Official documentation for Python's secrets module]

 * Python random module documentation - https://docs.python.org/3/library/random.html[Official documentation explaining that random module is not suitable for security purposes]

=== Standards

 * CWE 338 - https://cwe.mitre.org/data/definitions/338.html[Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)]

 * OWASP Top 10 2021 A2 - https://owasp.org/Top10/A02_2021-Cryptographic_Failures/[Cryptographic Failures]
