
include::../../../shared_content/secrets/description.adoc[]

== Why is this an issue?

include::../../../shared_content/secrets/rationale.adoc[]

=== What is the potential impact?

Below are some real-world scenarios that illustrate some impacts of an attacker
exploiting the secret.

:secret_type: secret

include::../../../shared_content/secrets/impact/non_repudiation.adoc[]

include::../../../shared_content/secrets/impact/data_modification.adoc[]

include::../../../shared_content/secrets/impact/exceed_rate_limits.adoc[]

== How to fix it

include::../../../shared_content/secrets/fix/revoke.adoc[]

include::../../../shared_content/secrets/fix/vault.adoc[]

**Use templating to insert values during deployment**

Some deployment scenarios may require secrets to be stored in files on disk. In
these cases, the configuration file should be modified during deployment so that
it contains secrets appropriate for the environment.

The safest way to create configuration files is to use a templating engine
during the deployment process. These engines provide a reliable method for
replacing placeholders inside the template, ensuring that no placeholder is
missed. They also typically raise warnings a configuration value is missing,
helping to identify and diagnose bad deployments.

=== Code examples

==== Noncompliant code example

In `kafka-sasl.conf`:
[source,diff-id=1,diff-type=noncompliant,subs="attributes"]
----
spring.kafka.properties.sasl.jaas.config=org.apache.kafka.common.security.plain.PlainLoginModule required username='admin' password='P@ssw0rd!'; // Noncompliant
----

==== Compliant solution

In `kafka-sasl.conf.template`:
[source,diff-id=1,diff-type=compliant,subs="attributes"]
----
spring.kafka.properties.sasl.jaas.config=org.apache.kafka.common.security.plain.PlainLoginModule required username='{{KAFKA_USER}}' password='{{KAFKA_PASSWORD}}';
----


//=== How does this work?

//=== Pitfalls

//=== Going the extra mile

== Resources

include::../../../shared_content/secrets/resources/standards.adoc[]

//=== Benchmarks
