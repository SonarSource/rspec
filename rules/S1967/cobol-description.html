<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Moving a large number into a small field will result in data truncation. Generally, numeric values are truncated from the left. However, in the case of floating point values, when the target field has too little precision to hold the value being moved to it, decimals will be truncated (not rounded!) from the right.</p>
</div>
<div class="paragraph">
<p>In any case, data loss is always the result when too-large values are moved to too-small fields.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cobol" data-lang="cobol">01 NUM-A   PIC 9(2)V9.
*&gt; ...

    MOVE 88.89   TO NUM-A  *&gt; Noncompliant. Becomes 88.8
    MOVE 178.7   TO NUM-A  *&gt; Noncompliant. Becomes 78.7
    MOVE 999.99 TO NUM-A  *&gt; Noncompliant. Truncated on both ends; becomes 99.9</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cobol" data-lang="cobol">01 NUM-A   PIC 9(3)V99.
*&gt; ...

    MOVE 88.89   TO NUM-A
    MOVE 178.7   TO NUM-A
    MOVE 999.99 TO NUM-A</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/704">CWE-704 - Incorrect Type Conversion or Cast</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S3921" class="rspec-auto-link">S3921</a> - for truncation of string values</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Increase the size of "YYY" or do not "MOVE" ("XXX"|this literal value) to it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_parameters">Parameters</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">onlyLiteralValues</div>
<div class="listingblock">
<div class="content">
<pre>false</pre>
</div>
</div>
<div class="paragraph">
<p>True to apply the rule only to literal values</p>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">ignoredDataItemRegex</div>
<div class="paragraph">
<p>Regular expression describing sending fields to ignore</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>primary <code>MOVE xx TO yy</code></p>
</li>
<li>
<p>secondary1: xx</p>
<div class="ulist">
<ul>
<li>
<p>message: xx is x_width</p>
</li>
</ul>
</div>
</li>
<li>
<p>secondary2: yy</p>
<div class="ulist">
<ul>
<li>
<p>message: yy is y_width.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_relates_to_s3921">relates to: <a data-rspec-id="S3921" class="rspec-auto-link">S3921</a></h3>

</div>
<div class="sect2">
<h3 id="_on_19_sep_2014_154206_freddy_mallet_wrote">on 19 Sep 2014, 15:42:06 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>@Ann, perhaps we could associate this rule to http://cwe.mitre.org/data/definitions/704.html ? This is a bit controversial as CWE-704 is Weakness Class.</p>
</div>
</div>
</div>
</div>