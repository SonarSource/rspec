include::../../summary.adoc[]

== Why is this an issue?

include::../../rationale.adoc[]

include::../../impact.adoc[]

include::../../threats.adoc[]

== How to fix it?

[cols="a,a"]
|===
|
[source,csharp]
----
using System.Web;
using System.Web.Mvc;

public class HelloController : Controller
{
    [HttpGet]
    public void Hello(string name, HttpResponse response)
    {
        string html = "<h1>Hello"+ name +"</h1>"
        response.Write(html);
    }
}
----
|
[source,csharp]
----
using System.Web;
using System.Web.Mvc;

public class HelloController : Controller
{
    [HttpGet]
    public void Hello(string name, HttpResponse response)

    {
        string html = "<h1>Hello"+ HttpUtility.HtmlEncode(name) +"</h1>"
        response.Write(html);
    }
}
----
|===


=== How does this work?

In case the response consists of HTML code, it is highly recommended to use https://docs.microsoft.com/en-us/aspnet/web-pages/overview/getting-started/introducing-razor-syntax-c[Razor-based view templates] to generate it. A proper template engine does not only separate the view from the business logic and thus results in a more maintainable application. It also automatically encodes variable output and thus drastically decreases the chance of introducing cross-site scripting vulnerabilities.


include::../../common/fix/data_encoding.adoc[]

`System.Web.HttpUtility.HtmlEncode` is the recommended method to encode HTML entities.

=== Pitfalls

include::../../common/pitfalls/validation.adoc[]

== Resources

include::../../common/resources/docs.adoc[]

include::../../common/resources/articles.adoc[]

include::../../common/resources/presentations.adoc[]

include::../../common/resources/standards.adoc[]

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::../../message.adoc[]

include::../../highlighting.adoc[]

'''
== Comments And Links
(visible only on this page)

include::../../comments-and-links.adoc[]
endif::env-github,rspecator-view[]
