include::../../summary.adoc[]

== Why is this an issue?

include::../../rationale.adoc[]

include::../../impact.adoc[]

include::../../threat.adoc[]

== How to fix it?

In case the response should contain HTML code, it is highly recommended to use a template engine like https://twig.symfony.com/[Twig] to generate it.
A proper template engine does not only separate the view from the business logic and thus results in a more maintainable application. It also automatically encodes variable output and thus drastically decreases the chance of introducing Cross-Site Scripting vulnerabilities.

If you do not intend to send HTML code to the client, the issue can be resolved by telling the clients what data they are receiving.
For example, you can use the class `JsonResponse` to safely return JSON messages.
The class sets the content-type automatically to `application/json`.
This tells the browser that the response does not contain HTML code and should not be parsed and interpreted as HTML.
Thus, it is not vulnerable to reflected Cross-Site Scripting.

[source,php]
----
use Symfony\Component\HttpFoundation\JsonResponse;

$response = new JsonResponse(['data' => 123]);
----

If no predefined response class matches the desired type, it is also possible to set the content-type to a secure value manually using the `headers` attribute.
For example, setting the content-type to `text/plain` allows to safely reflect user input since browsers will not try to parse and execute the response.

[source,php]
----
use Symfony\Component\HttpFoundation\Response;

$response = new Response();
$response->headers->set('Content-Type', 'text/plain');
----

== How does this work?

=== Pitfalls

=== Going the extra mile

include::../../resources.adoc[]

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::../../message.adoc[]

include::../../highlighting.adoc[]

'''
== Comments And Links
(visible only on this page)

include::../../comments-and-links.adoc[]
endif::env-github,rspecator-view[]
