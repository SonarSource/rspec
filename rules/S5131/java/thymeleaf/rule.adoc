include::../../summary.adoc[]

== Why is this an issue?

include::../../rationale.adoc[]

include::../../impact.adoc[]

include::../../threats.adoc[]

== How to fix it?

The following code is vulnerable to Cross-Site Scripting.

User input embedded in HTML code should be HTML-encoded to prevent the injection of additional code.

[source,html]
----
<body>
    <p th:utext="|Hello, ${thirdPartyData}!|" /> <!-- Noncompliant -->
    <p>Hello, [(${thirdPartyData})]!</p>         <!-- Noncompliant -->
</body>
----

[source,html]
----
<body>
    <p th:text="|Hello, ${thirdPartyData}!|" />
    <p>Hello, [[${thirdPartyData}]]!</p>
</body>
----

=== How does this work?

For HTML encoding, Javascript encoding, and CSS encoding, the documentation
allows the use of `unescaped text`, in only two different ways:

* with the attribute `th:utext`.
* with the inline expression `[(...)]`.

If you insert third party data into the pages, the regular attributes are
preferable:

* with the attribute `th:text`.
* The inline expression `[[...]]`.

They ensure that the correct encoding is used, regardless of the context in
which the third-party data is inserted. Thus, it is not necessary to specify a
particular encoder.

=== Pitfalls

include::../../common/pitfalls/deny-lists.adoc[]

=== Going the extra mile

== Resources

=== Documentation

* https://www.thymeleaf.org/doc/tutorials/2.1/usingthymeleaf.html[Thymeleaf.org, Tutorial: Using Thymeleaf]

include::../../common/resources/articles.adoc[]

include::../../common/resources/presentations.adoc[]

include::../../common/resources/standards.adoc[]


ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::../../message.adoc[]

include::../../highlighting.adoc[]

'''
== Comments And Links
(visible only on this page)

include::../../comments-and-links.adoc[]
endif::env-github,rspecator-view[]

