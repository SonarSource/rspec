<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when Go HTTP servers use blocking server calls without implementing proper signal handling and graceful shutdown mechanisms.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>HTTP servers that don&#8217;t implement graceful shutdown can cause significant problems in production environments. When a service is restarted or terminated without graceful shutdown, ongoing requests are abruptly cut off, potentially causing data loss, incomplete transactions, and poor user experience.</p>
</div>
<div class="paragraph">
<p>Consider a user uploading a file or submitting a form when the server restarts. Without graceful shutdown, their request dies mid-stream, leaving them confused and potentially losing their work. This creates a poor user experience and can lead to data inconsistency.</p>
</div>
<div class="paragraph">
<p>Graceful shutdown ensures that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The server stops accepting new requests</p>
</li>
<li>
<p>Existing requests are allowed to complete within a reasonable timeout</p>
</li>
<li>
<p>Resources like database connections are properly closed</p>
</li>
<li>
<p>The application exits cleanly</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Go provides excellent tools for this through the <code>os/signal</code> package for catching termination signals (SIGINT, SIGTERM) and the <code>context</code> package for managing timeouts. The <code>http.Server</code> type includes a <code>Shutdown()</code> method specifically designed for graceful termination.</p>
</div>
<div class="paragraph">
<p>Without implementing this pattern, applications become unreliable in production environments where deployments, scaling events, and maintenance operations require service restarts.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Applications without graceful shutdown can experience:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Data Loss</strong>: Incomplete requests may result in partial data writes or lost user input</p>
</li>
<li>
<p><strong>Poor User Experience</strong>: Users may see connection errors or timeouts during deployments</p>
</li>
<li>
<p><strong>Service Reliability Issues</strong>: Abrupt termination can leave resources in inconsistent states</p>
</li>
<li>
<p><strong>Deployment Problems</strong>: Rolling updates become disruptive to active users</p>
</li>
<li>
<p><strong>Resource Leaks</strong>: Database connections and other resources may not be properly cleaned up</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Implement graceful shutdown by running the HTTP server in a goroutine, setting up signal handling for termination signals, and using the server&#8217;s Shutdown method with a timeout context.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">func main() {
    http.HandleFunc("/", handler)
    log.Fatal(http.ListenAndServe(":8080", nil)) // Noncompliant
}

func handler(w http.ResponseWriter, r *http.Request) {
    w.Write([]byte("Hello"))
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">func main() {
    server := &amp;http.Server{Addr: ":8080"}
    http.HandleFunc("/", handler)

    go func() {
        if err := server.ListenAndServe(); err != nil &amp;&amp; err != http.ErrServerClosed {
            log.Fatal(err)
        }
    }()

    // Graceful shutdown
    quit := make(chan os.Signal, 1)
    signal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)
    &lt;-quit

    ctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)
    defer cancel()
    server.Shutdown(ctx)
}

func handler(w http.ResponseWriter, r *http.Request) {
    w.Write([]byte("Hello"))
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Go HTTP Server Shutdown - <a href="https://pkg.go.dev/net/http#Server.Shutdown">Official documentation for the http.Server.Shutdown method</a></p>
</li>
<li>
<p>Go Signal Package - <a href="https://pkg.go.dev/os/signal">Documentation for handling OS signals in Go applications</a></p>
</li>
<li>
<p>Go Context Package - <a href="https://pkg.go.dev/context">Documentation for Go&#8217;s context package for managing timeouts and cancellation</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>