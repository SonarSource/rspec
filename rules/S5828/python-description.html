<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when an invalid "mode" is provided to the <code>open</code> builtin function.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>open</code> builtin function can open files in different modes. These modes are provided as a combination of characters. Using an invalid sequence of characters will make <code>open</code> fail with a <code>ValueError</code>.</p>
</div>
<div class="paragraph">
<p>A valid mode:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>should contain only one of the following characters: <code>r</code> (read), <code>w</code> (write), <code>a</code> (append), <code>x</code> (create).</p>
</li>
<li>
<p>should contain zero or one of the following characters: <code>t</code> (text), <code>b</code> (binary).</p>
</li>
<li>
<p>should contain zero or one <code>+</code> character (open for updating)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example: <code>a</code>, <code>rt</code>, <code>r+</code> and <code>w+b</code> are valid modes.</p>
</div>
<div class="paragraph">
<p>If no <code>t</code> or <code>b</code> character is provided the mode will default to <code>t</code> (text), so specifying <code>r</code> is equivalent to <code>rt</code>.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong>: <em>In Python 2, providing an incorrect mode may have an undefined behavior (ex: it might ignore some characters)</em></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Make sure to provide a valid mode to the <code>open</code> builtin function.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="paragraph">
<p>In Python 3 the following program will throw a <code>ValueError</code>.</p>
</div>
<div class="paragraph">
<p>In Python 2.7.16 on MacOs, <code>open</code> will just ignore the <code>w</code> flag.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">with open("test.txt", "aw") as f:  # Noncompliant: ValueError
    pass</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">with open("test.txt", "a") as f:
    pass</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pitfalls">Pitfalls</h3>
<div class="paragraph">
<p>In Python 2, the character <code>U</code> (universal newlines) is available as a mode character but it cannot be combined with <code>a</code>, <code>w</code>, <code>x</code> or <code>+</code>.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong>: <em><code>U</code> has no effect in Python 3, it is deprecated and is replaced by the parameter <code>newline</code> of the <code>open</code> function. The default value of <code>newline</code> is <code>None</code>, meaning universal newlines mode is enabled.</em></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.python.org/3/library/functions.html#open">The <code>open</code> builtin function</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Fix this invalid mode string.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>The mode parameter</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_related_to_s5488">is related to: <a data-rspec-id="S5488" class="rspec-auto-link">S5488</a></h3>

</div>
</div>
</div>