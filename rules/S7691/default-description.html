<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when wildcard patterns (such as <code>*</code>, <code>?</code>, or <code>[&#8230;&#8203;]</code>) are used without being prefixed with <code>./</code> or another safe path prefix.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Wildcard expansions in shell scripts can create security vulnerabilities through option injection attacks. When wildcards expand to filenames that begin with a dash (<code>-</code>), these filenames are interpreted as command-line options by most programs rather than as file arguments.</p>
</div>
<div class="paragraph">
<p>For example, if a directory contains a file named <code>-rf</code>, the command <code>rm *.txt</code> could expand to <code>rm -rf file1.txt file2.txt</code>, which would recursively delete directories instead of just removing text files. This happens because the shell expands wildcards before passing arguments to commands, and programs cannot distinguish between intentional options and filenames that happen to start with dashes.</p>
</div>
<div class="paragraph">
<p>This vulnerability can be exploited by attackers who create malicious filenames in directories where scripts run. The attack is particularly dangerous because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It can cause data loss through unintended file operations</p>
</li>
<li>
<p>It can bypass security restrictions by injecting unexpected options</p>
</li>
<li>
<p>It can lead to privilege escalation in some scenarios</p>
</li>
<li>
<p>The behavior is often silent and difficult to detect</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The issue affects any wildcard usage where the expanded filenames are passed as arguments to external commands, including common operations like file processing, archiving, and cleanup scripts.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Option injection through wildcard expansion can lead to serious security vulnerabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Data loss</strong>: Commands may perform destructive operations when malicious filenames inject dangerous options like <code>-rf</code> or <code>--delete</code></p>
</li>
<li>
<p><strong>Security bypass</strong>: Attackers can inject options that disable security features or change command behavior</p>
</li>
<li>
<p><strong>Privilege escalation</strong>: In scripts running with elevated privileges, option injection can be used to execute unintended operations</p>
</li>
<li>
<p><strong>System compromise</strong>: Malicious options could potentially lead to code execution or system manipulation</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_fix">How to fix?</h3>
<div class="paragraph">
<p>Prefix wildcard patterns with <code>./</code> to ensure expanded filenames cannot be interpreted as command options. This forces all expanded paths to start with <code>./</code>, making them clearly identifiable as filenames rather than options.</p>
</div>
<div class="sect3">
<h4 id="_non_compliant_code_example">Non-compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"># Vulnerable to option injection
rm *.txt  # Noncompliant
cp *.log backup/  # Noncompliant
grep "pattern" *  # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_code_example">Compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"># Safe from option injection
rm ./*.txt
cp ./*.log backup/
grep "pattern" ./*</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>LinuxCommand.org Bash Coding Standards - <a href="https://linuxcommand.org/lc3_adv_standards.php">Comprehensive shell scripting standards including wildcard safety practices</a></p>
</li>
<li>
<p>Filenames and Pathnames in Shell: How to do it Correctly - <a href="https://dwheeler.com/essays/filenames-in-shell.html">Detailed guide on handling filenames safely in shell scripts</a></p>
</li>
<li>
<p>Bash Manual - Pathname Expansion - <a href="https://www.gnu.org/software/bash/manual/html_node/Pathname-Expansion.html">Official documentation on how bash expands wildcards and pathnames</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-88: Improper Neutralization of Argument Delimiters in a Command - <a href="https://cwe.mitre.org/data/definitions/88.html">Covers vulnerabilities where special characters in arguments can alter command behavior</a></p>
</li>
<li>
<p>CWE-78: Improper Neutralization of Special Elements used in an OS Command - <a href="https://cwe.mitre.org/data/definitions/78.html">Addresses OS command injection vulnerabilities including option injection</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>