include::../../../shared_content/secrets/description.adoc[]

== Why is this an issue?

include::../../../shared_content/secrets/rationale.adoc[]

If an attacker gains access to an NPM access token, they might be able to gain access to any private package linked to this token.

=== What is the potential impact?

Below are some real-world scenarios that illustrate some impacts of an attacker
exploiting the secret.

include::../../../shared_content/secrets/impact/non_repudiation.adoc[]

include::../../../shared_content/secrets/impact/banking_financial_loss.adoc[]

== How to fix it

include::../../../shared_content/secrets/fix/revoke.adoc[]

include::../../../shared_content/secrets/fix/vault.adoc[]

=== Code examples

==== Noncompliant code example

[source,yaml,diff-id=1,diff-type=noncompliant]
----
steps:
    - run: |
        npm install
    - env:
        NPM_TOKEN: npm_tCEMceczuiTXKQaBjGIaAezYQ63PqI972ANG
----

==== Compliant solution

[source,yaml,diff-id=1,diff-type=compliant]
----
steps:
    - run: |
        npm install
    - env:
        NPM_TOKEN: ${{ secrets.NPM_TOKEN }}
----

//=== How does this work?

//=== Pitfalls

//=== Going the extra mile

== Resources

=== Documentation

npm Docs - https://docs.npmjs.com/revoking-access-tokens[Revoking access tokens]

include::../../../shared_content/secrets/resources/standards.adoc[]
