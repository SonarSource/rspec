<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>During construction and destruction of an object, its final type may be different from that of the completely constructed object. The result of using an objectâ€™s dynamic type in a constructor or destructor may not be consistent with developer expectations.</p>
</div>
<div class="paragraph">
<p>The dynamic type of an object is used in the following constructs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>typeid</code> on a class with a virtual function or a virtual function in a base class.</p>
</li>
<li>
<p><code>dynamic_cast</code></p>
</li>
<li>
<p>A virtual call to a virtual function.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This rule also prohibits a call being made to a pure virtual function from within a constructor or destructor. Such calls lead to undefined behaviour.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">class B1
{
public:
  B1 ( )
  {
   typeid ( B1 ); // Compliant, B1 not polymorphic
  }
};
class B2
{
public:
  virtual ~B2 ( );
  virtual void foo ( );
  B2 ( )
  {
    typeid ( B2 ); // Noncompliant
    B2::foo ( ); // Compliant, not a virtual call
    foo ( ); // Noncompliant
    dynamic_cast&lt; B2* &gt; ( this ); // Noncompliant
  }
};</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>MISRA C&#43;&#43;:2008, 12-1-1 - An object&#8217;s dynamic type shall not be used from the body of its constructor or destructor.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Remove this [use of "typeid"|use of "dynamic_cast"|virtual call to method "xxx"]</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_14_oct_2014_181113_ann_campbell_wrote">on 14 Oct 2014, 18:11:13 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~samuel.mercier] please correct the following</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Code should be quoted in the message. Also, I don&#8217;t quite understand the use of "::" here.</p>
</li>
<li>
<p>Add a See section to the description listing the appropriate MISRA number</p>
</li>
<li>
<p>Fill in Applicability.</p>
</li>
<li>
<p>Make sure the appropriate MISRA C and MISRA C&#43;&#43; fields on the references tab are filled in</p>
</li>
<li>
<p>Please use the standard headings, e.g. Noncompliant Code Example instead of just Example</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, please consider clarifying the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"final type" during construction vs the type of "the completely constructed object"</p>
</li>
<li>
<p>the Noncompliant Code Example tells us in a comment that B2 is derived, but B2 doesn&#8217;t actually seem to extend anything.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_17_oct_2014_090051_samuel_mercier_wrote">on 17 Oct 2014, 09:00:51 Samuel Mercier wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] updated.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"final type" during construction vs the type of "the completely constructed object" : this is a copy-paste of the MISRA document, so I suspect it is meaningful and correct in the C&#43;&#43; context.</p>
</li>
<li>
<p>&#8230;&#8203; but B2 doesn&#8217;t actually seem to extend anything : that&#8217;s correct. This example says that, if B2 is extended, then during the call of constructor B2 the dynamic type is not clearly defined.</p>
</li>
</ul>
</div>
</div>
</div>
</div>