<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when <code>response.set_cookie()</code> is called without the <code>secure</code>, <code>httponly</code>, and <code>samesite</code> attributes.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cookies are small pieces of data that web applications store in users' browsers. They often contain sensitive information like session tokens, user preferences, or authentication data. Without proper security attributes, cookies become vulnerable to various attacks.</p>
</div>
<div class="paragraph">
<p>The <code>secure</code> attribute ensures cookies are only sent over encrypted HTTPS connections. Without it, cookies can be intercepted by attackers on unsecured networks, exposing sensitive data.</p>
</div>
<div class="paragraph">
<p>The <code>httponly</code> attribute prevents client-side JavaScript from accessing the cookie. This protects against Cross-Site Scripting (XSS) attacks where malicious scripts try to steal cookie data.</p>
</div>
<div class="paragraph">
<p>The <code>samesite</code> attribute controls when cookies are sent with cross-site requests. It helps prevent Cross-Site Request Forgery (CSRF) attacks by restricting how cookies are shared between different websites.</p>
</div>
<div class="paragraph">
<p>When Flask applications set cookies without these security attributes, they leave users vulnerable to session hijacking, data theft, and unauthorized actions performed on their behalf.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Attackers can intercept cookies over unencrypted connections, steal session tokens through XSS attacks, or perform unauthorized actions via CSRF attacks. This can lead to account takeover, data breaches, and unauthorized access to user accounts.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add the <code>secure</code>, <code>httponly</code>, and <code>samesite</code> attributes to the <code>set_cookie()</code> call. Set <code>secure=True</code> to ensure HTTPS-only transmission, <code>httponly=True</code> to prevent JavaScript access, and <code>samesite='Strict'</code> or <code>samesite='Lax'</code> to control cross-site cookie behavior.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from flask import make_response

def set_user_cookie():
    resp = make_response('Hello')
    resp.set_cookie('user_id', '123')  # Noncompliant
    return resp</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from flask import make_response

def set_user_cookie():
    resp = make_response('Hello')
    resp.set_cookie('user_id', '123', secure=True, httponly=True, samesite='Strict')
    return resp</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Flask Cookie Documentation - <a href="https://flask.palletsprojects.com/en/2.3.x/api/#flask.Response.set_cookie">Official Flask documentation for the set_cookie method</a></p>
</li>
<li>
<p>MDN Cookie Security - <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#security">Comprehensive guide to cookie security attributes</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP Top 10 2021 A1 - <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">Broken Access Control - includes session management vulnerabilities</a></p>
</li>
<li>
<p>CWE 614 - <a href="https://cwe.mitre.org/data/definitions/614.html">Sensitive Cookie in HTTPS Session Without 'Secure' Attribute</a></p>
</li>
<li>
<p>CWE 1004 - <a href="https://cwe.mitre.org/data/definitions/1004.html">Sensitive Cookie Without 'HttpOnly' Flag</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>