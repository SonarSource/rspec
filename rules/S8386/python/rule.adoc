This rule raises an issue when `response.set_cookie()` is called without the `secure`, `httponly`, and `samesite` attributes.

== Why is this an issue?

Cookies are small pieces of data that web applications store in users' browsers. They often contain sensitive information like session tokens, user preferences, or authentication data. Without proper security attributes, cookies become vulnerable to various attacks.

The `secure` attribute ensures cookies are only sent over encrypted HTTPS connections. Without it, cookies can be intercepted by attackers on unsecured networks, exposing sensitive data.

The `httponly` attribute prevents client-side JavaScript from accessing the cookie. This protects against Cross-Site Scripting (XSS) attacks where malicious scripts try to steal cookie data.

The `samesite` attribute controls when cookies are sent with cross-site requests. It helps prevent Cross-Site Request Forgery (CSRF) attacks by restricting how cookies are shared between different websites.

When Flask applications set cookies without these security attributes, they leave users vulnerable to session hijacking, data theft, and unauthorized actions performed on their behalf.

=== What is the potential impact?

Attackers can intercept cookies over unencrypted connections, steal session tokens through XSS attacks, or perform unauthorized actions via CSRF attacks. This can lead to account takeover, data breaches, and unauthorized access to user accounts.

== How to fix it

Add the `secure`, `httponly`, and `samesite` attributes to the `set_cookie()` call. Set `secure=True` to ensure HTTPS-only transmission, `httponly=True` to prevent JavaScript access, and `samesite='Strict'` or `samesite='Lax'` to control cross-site cookie behavior.

=== Code examples

==== Noncompliant code example

[source,python,diff-id=1,diff-type=noncompliant]
----
from flask import make_response

def set_user_cookie():
    resp = make_response('Hello')
    resp.set_cookie('user_id', '123')  # Noncompliant
    return resp
----

==== Compliant solution

[source,python,diff-id=1,diff-type=compliant]
----
from flask import make_response

def set_user_cookie():
    resp = make_response('Hello')
    resp.set_cookie('user_id', '123', secure=True, httponly=True, samesite='Strict')
    return resp
----

== Resources

=== Documentation

 * Flask Cookie Documentation - https://flask.palletsprojects.com/en/2.3.x/api/#flask.Response.set_cookie[Official Flask documentation for the set_cookie method]

 * MDN Cookie Security - https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#security[Comprehensive guide to cookie security attributes]

=== Standards

 * OWASP Top 10 2021 A1 - https://owasp.org/Top10/A01_2021-Broken_Access_Control/[Broken Access Control - includes session management vulnerabilities]

 * CWE 614 - https://cwe.mitre.org/data/definitions/614.html[Sensitive Cookie in HTTPS Session Without 'Secure' Attribute]

 * CWE 1004 - https://cwe.mitre.org/data/definitions/1004.html[Sensitive Cookie Without 'HttpOnly' Flag]
