<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A function is called reentrant if it can be interrupted in the middle of its execution and then safely called again ("re-entered") before its previous invocations complete execution.</p>
</div>
<div class="paragraph">
<p>It is especially important that multi-threaded applications do not call the same non-reentrant function from different threads.</p>
</div>
<div class="paragraph">
<p>This rule will trigger an issue each time a function in the configurable list is invoked.</p>
</div>
<div class="paragraph">
<p>A call will be matched differently depending on the presence of the scope resolution operator <code>::</code> in the function name from the configurable list.</p>
</div>
<div class="paragraph">
<p>For example, <code>namespace a { namespace b { void f(); } }</code> can be matched with "f", "b::f", "a::b::f", "::a::b::f" (fully qualified name yielding most precise results).</p>
</div>
<div class="paragraph">
<p>It is recommended to provide fully qualified names to the configurable list (i.e., start each name with <code>::</code>), even for the functions in the global namespace.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="paragraph">
<p>Given a function that includes <code>localtime</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

void print_date_and_time(struct tm *time_ptr)
{
  printf(
    "Current date and time: %d/%02d/%02d %02d:%02d:%02d\n",
    time_ptr-&gt;tm_year + 1900,
    time_ptr-&gt;tm_mon,
    time_ptr-&gt;tm_mday,
    time_ptr-&gt;tm_hour,
    time_ptr-&gt;tm_min,
    time_ptr-&gt;tm_sec);
}

void print_unix_epoch_date_and_time()
{
  time_t unix_epoch_time = (time_t)0;
  struct tm *local_time_ptr = localtime(&amp;unix_epoch_time); // Noncompliant, call to the non-reentrant localtime() function
  print_date_and_time(local_time_ptr);
}

int main(int argc, char* argv[])
{
  time_t current_time;
  struct tm *local_time_ptr;

  time(&amp;current_time);

  local_time_ptr = localtime(&amp;current_time); // Noncompliant, call to the non-reentrant localtime() function

  // As expected, this will print: Current date and time: 1970/00/01 01:00:00
  print_unix_epoch_date_and_time();

  // This will actually also print Current date and time: 1970/00/01 01:00:00
  // Indeed, localtime() is non-reentrant, and always returns the same pointer
  print_date_and_time(local_time_ptr);

  return 0;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

void print_date_and_time(struct tm *time_ptr)
{
  printf(
    "Current date and time: %d/%02d/%02d %02d:%02d:%02d\n",
    time_ptr-&gt;tm_year + 1900,
    time_ptr-&gt;tm_mon,
    time_ptr-&gt;tm_mday,
    time_ptr-&gt;tm_hour,
    time_ptr-&gt;tm_min,
    time_ptr-&gt;tm_sec);
}

void print_unix_epoch_date_and_time()
{
  time_t unix_epoch_time = (time_t)0;
  struct tm local_time;
  localtime_r(&amp;unix_epoch_time, &amp;local_time); // Compliant
  print_date_and_time(&amp;local_time);
}

int main(int argc, char* argv[])
{
  time_t current_time;
  struct tm local_time;

  time(&amp;current_time);

  localtime_r(&amp;current_time, &amp;local_time); // Compliant

  // As expected, this will print: Current date and time: 1970/00/01 01:00:00
  print_unix_epoch_date_and_time();

  // As expected, this will print the current date and time
  print_date_and_time(&amp;local_time);

  return 0;
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>C&#43;&#43; reference - <a href="https://en.cppreference.com/w/cpp/language/lookup">Name Lookup</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Replace this call to the non-reentrant "{0}" with a call to "{0}_r"</p>
</div>
</div>
<div class="sect2">
<h3 id="_parameters">Parameters</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">nonReentrantFunctionList</div>
<div class="paragraph">
<p><em>STRING</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre>::asctime,::crypt,::ctermid,::ctime,::fgetgrent,::fgetpwent,::fgetspent,::getgrent,::getgrgid,::getgrnam,::gethostbyaddr,::gethostbyname,::gethostbyname2,::gethostent,::getlogin,::getnetbyaddr,::getnetbyname,::getnetent,::getnetgrent,::getprotobyname,::getprotobynumber,::getprotoent,::getpwent,::getpwnam,::getpwuid,::getrpcbyname,::getrpcbynumber,::getrpcent,::getservbyname,::getservbyport,::getservent,::getspent,::getspnam,::gmtime,::localtime,::sgetspent,::strtok,::ttyname</pre>
</div>
</div>
<div class="paragraph">
<p>List of non-reentrant functions</p>
</div>
</div>
</div>
</div>
</div>
</div>