<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some POSIX functions take one argument that is a buffer and another one that represents the size of the buffer. It is up to the developer to make sure the two arguments do match and that the size argument does not exceed the buffer&#8217;s size.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the size argument exceeds the actual size of the buffer, the memory management functions will either read or write data past the buffer memory boundary into adjacent memory. Because the memory might be uninitialized or contain other pieces of data, the behavior of the affected function can not be predicted and will likely trigger bugs.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Buffer boundaries violations can lead to serious security issues.</p>
</div>
<div class="sect3">
<h4 id="_information_disclosure">Information disclosure</h4>
<div class="paragraph">
<p>In some scenarios, insecure functions can lead to information disclosure. For instance, if an attacker can cause a buffer overread, they might be able to disclose data in memory that they&#8217;re not supposed to have access to. This could potentially allow them to access sensitive information, such as passwords or encryption keys.
An example of a buffer overread is provided with the Heartbleed vulnerability.
==== Code execution</p>
</div>
<div class="paragraph">
<p>In some cases, an attacker can craft input in a way that allows them to gain unauthorized access to your system. For example, they might be able to overwrite a function&#8217;s return address in memory, causing your program to execute code of the attacker&#8217;s choosing. This could potentially give the attacker full control over your system.</p>
</div>
</div>
<div class="sect3">
<h4 id="_denial_of_service">Denial of service</h4>
<div class="paragraph">
<p>If an attacker can trigger a buffer overflow by providing oversized input, it can cause the program to crash. If the attacker repeats this process, it can continually disrupt the service, denying access to other users. This can be particularly damaging for services that require high availability, such as online platforms or databases.</p>
</div>
<div class="paragraph">
<p>In some cases, the input might cause the program to enter an infinite loop or consume excessive memory, slowing down the system or even causing it to become unresponsive. This type of attack is known as a resource exhaustion DoS attack.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>Functions related to sockets using the type <code>socklen_t</code> are not checked. This is because these functions are using a C-style polymorphic pattern using <code>union</code>. It relies on a mismatch between allocated memory and sizes of structures and it creates false positives.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="paragraph">
<p>In the following code example, <code>memchr</code> is used to find the first occurrence of the <code>@</code> character in a buffer, <code>array</code>. The second argument does not match the size of this buffer, so it may find an occurrence of the character after the end of the buffer and read data it is not supposed to. If the returned <code>pos</code> pointer is later used to write characters, this could unexpectedly overwrite data.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">char array[10];
initialize(array);
char *pos = memchr(array, '@', 42); // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">char array[10];
initialize(array);
char *pos = memchr(array, '@', sizeof(array));</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p>Heartbleed - <a href="https://heartbleed.com/">The Heartbleed Bug</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/119">CWE-119 - Improper Restriction of Operations within the Bounds of a Memory Buffer</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/131">CWE-131 - Incorrect Calculation of Buffer Size</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/788">CWE-788 - Access of Memory Location After End of Buffer</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222612">Application Security and Development: V-222612</a> - The application must not be vulnerable to overflow attacks.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_external_coding_guidelines">External coding guidelines</h3>
<div class="ulist">
<ul>
<li>
<p>CERT - <a href="https://wiki.sei.cmu.edu/confluence/x/wtYxBQ">ARR30-C. - Do not form or use out-of-bounds pointers or array subscripts</a></p>
</li>
<li>
<p>CERT - <a href="https://wiki.sei.cmu.edu/confluence/x/i3w-BQ">STR50-CPP. - Guarantee that storage for strings has sufficient space for character data and the null terminator</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>"vsnprintf" overflows write buffer "rawData()&#8230;&#8203;"; passed size "blabla&#8230;&#8203;" (256) exceeds buffer size (14)</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_relates_to_s3519">relates to: <a data-rspec-id="S3519" class="rspec-auto-link">S3519</a></h3>

</div>
</div>
</div>