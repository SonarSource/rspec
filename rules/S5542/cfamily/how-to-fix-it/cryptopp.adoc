== How to fix it in CryptoPP

=== Code examples

==== Noncompliant code example

Example with a symmetric cypher, AES:

[source,cpp,diff-id=1,diff-type=noncompliant]
----
#include <cryptopp/aes.h>
#include <cryptopp/modes.h>

CryptoPP::ECB_Mode<CryptoPP::AES>::Encryption(); // Noncompliant
CryptoPP::CBC_Mode<CryptoPP::AES>::Encryption(); // Noncompliant
----

Example with an asymmetric cypher, RSA:

[source,cpp,diff-id=2,diff-type=noncompliant]
----
#include <cryptopp/rsa.h>

CryptoPP::RSAES<CryptoPP::PKCS1v15>::Encryptor(); // Noncompliant
----

==== Compliant solution

For the AES symmetric cypher, use the GCM mode:

[source,cpp,diff-id=1,diff-type=noncompliant]
----
#include <cryptopp/aes.h>
#include <cryptopp/modes.h>

CryptoPP::GCM<CryptoPP::AES>::Encryption();
----

For the RSA assymmetric cypher, use the Optimal asymmetric encryption padding (OAEP):

[source,cpp,diff-id=2,diff-type=noncompliant]
----
#include <cryptopp/rsa.h>

CryptoPP::RSAES<CryptoPP::OAEP<CryptoPP::SHA1>>::Encryptor();
----

=== How does this work?


=== Pitfalls


=== Going the extra mile


