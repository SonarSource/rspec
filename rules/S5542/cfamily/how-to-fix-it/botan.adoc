== How to fix it in Botan

=== Code examples

==== Noncompliant code example

Example with a symmetric cypher, AES:

[source,cpp,diff-id=1,diff-type=noncompliant]
----
#include <botan/cipher_mode.h>
#include <botan/rng.h>

Botan::Cipher_Mode::create("AES-256/ECB"      , Botan::ENCRYPTION); // Noncompliant
Botan::Cipher_Mode::create("AES-256/CBC/PKCS7", Botan::ENCRYPTION); // Noncompliant
----

Example with an asymmetric cypher, RSA:

[source,cpp,diff-id=2,diff-type=noncompliant]
----
#include <botan/rng.h>
#include <botan/auto_rng.h>
#include <botan/rsa.h>
#include <botan/pubkey.h>

std::unique_ptr<Botan::RandomNumberGenerator>   rng(new Botan::AutoSeeded_RNG);
Botan::RSA_PrivateKey                           rsaKey(*rng.get(), 2048);

Botan::PK_Encryptor_EME(rsaKey, *rng.get(), "PKCS1v15"); // Noncompliant
----

==== Compliant solution

For the AES symmetric cypher, use the GCM mode:

[source,cpp,diff-id=1,diff-type=noncompliant]
----
#include <botan/cipher_mode.h>

Botan::Cipher_Mode::create("AES-256/GCM", Botan::ENCRYPTION);
----

For the RSA assymmetric cypher, use the Optimal asymmetric encryption padding (OAEP):

[source,cpp,diff-id=2,diff-type=noncompliant]
----
#include <botan/rng.h>
#include <botan/auto_rng.h>
#include <botan/rsa.h>
#include <botan/pubkey.h>

std::unique_ptr<Botan::RandomNumberGenerator>   rng(new Botan::AutoSeeded_RNG);
Botan::RSA_PrivateKey                           rsaKey(*rng.get(), 2048);

Botan::PK_Encryptor_EME(rsaKey, *rng.get(), "OAEP");
----

=== How does this work?


=== Pitfalls


=== Going the extra mile


