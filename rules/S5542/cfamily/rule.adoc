include::../description.adoc[]

== Noncompliant Code Example

https://github.com/randombit/botan[botan]

[source,cpp]
----
// Example for a symmetric cipher: 
// AES ECB 
Botan::Cipher_Mode::create("AES-256/ECB", Botan::ENCRYPTION); // Noncompliant
// AES CBC with padding
Botan::Cipher_Mode::create("AES-256/CBC/PKCS7", Botan::ENCRYPTION); // Noncompliant

// Example for an asymmetric cipher: RSA
std::unique_ptr<Botan::RandomNumberGenerator> rng(new Botan::AutoSeeded_RNG);
Botan::RSA_PrivateKey rsaKey(*rng.get(), 2048);

Botan::PK_Encryptor_EME(rsaKey, *rng.get(), "PKCS1v15"); // Noncompliant
----

https://software.opensuse.org/package/libcryptopp[crypto{plus}{plus}]

[source,cpp]
----
// Example for a symmetric cipher: 
// AES ECB
CryptoPP::ECB_Mode<CryptoPP::AES>::Encryption(); // Noncompliant

// AES CBC with padding
std::string cipher;
CryptoPP::CBC_Mode<CryptoPP::AES>::Encryption cbc_mode;
CryptoPP::StreamTransformationFilter(cbc_mode, new CryptoPP::StringSink(cipher),
                                    CryptoPP::StreamTransformationFilter::PKCS_PADDING); // Noncompliant

// Example for an asymmetric cipher: RSA
CryptoPP::RSAES<CryptoPP::PKCS1v15>::Encryptor(); // Noncompliant
----

https://github.com/openssl/openssl[OpenSSL]

[source,cpp]
----
// Example for a symmetric cipher: 
// AES ECB
EVP_aes_256_ecb(); // Noncompliant

// AES CBC with padding
EVP_CIPHER_CTX *ctx = EVP_CIPHER_CTX_new();
EVP_EncryptInit_ex(ctx, EVP_aes_256_cbc(), NULL, NULL, NULL);
EVP_EncryptUpdate(ctx, NULL, NULL, NULL, NULL); // Noncompliant; Padding is enabled by default.

// Example for an asymmetric cipher: RSA
RSA_public_decrypt(flen, from, to, key, RSA_PKCS1_PADDING); // Noncompliant
RSA_public_decrypt(flen, from, to, key, RSA_SSLV23_PADDING); // Noncompliant
RSA_public_decrypt(flen, from, to, key, RSA_NO_PADDING); // Noncompliant
----

== Compliant Solution

https://github.com/randombit/botan[botan]

[source,cpp]
----
// AES symmetric cipher is recommended to be used with GCM mode
Botan::Cipher_Mode::create("AES-256/GCM", Botan::ENCRYPTION);

// RSA asymmetric cipher is recommended to be used with OAEP padding
std::unique_ptr<Botan::RandomNumberGenerator> rng(new Botan::AutoSeeded_RNG);
Botan::RSA_PrivateKey rsaKey(*rng.get(), 2048);

Botan::PK_Encryptor_EME(rsaKey, *rng.get(), "OAEP");
----

https://software.opensuse.org/package/libcryptopp[crypto{plus}{plus}]

[source,cpp]
----
#include <cryptopp/gcm.h>

// AES symmetric cipher is recommended to be used with GCM mode
CryptoPP::GCM<CryptoPP::AES>::Encryption();

// RSA asymmetric cipher is recommended to be used with OAEP padding
CryptoPP::RSAES<CryptoPP::OAEP<CryptoPP::SHA256>>::Encryptor();
----

https://github.com/openssl/openssl[OpenSSL]

[source,cpp]
----
#include <openssl/evp.h>

// AES symmetric cipher is recommended to be used with GCM mode
EVP_aes_256_gcm()

// RSA asymmetric cipher is recommended be used with OAEP padding
RSA_public_decrypt(flen, from, to, key, RSA_PKCS1_OAEP_PADDING);
----

include::../see.adoc[]

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::message.adoc[]

include::highlighting.adoc[]

'''
== Comments And Links
(visible only on this page)

include::../comments-and-links.adoc[]
endif::env-github,rspecator-view[]
