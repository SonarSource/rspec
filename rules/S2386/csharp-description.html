<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>public static</code> mutable fields of classes which are accessed directly should be protected to the degree possible. This can be done by reducing the accessibility of the field or by changing the return type to an immutable type.</p>
</div>
<div class="paragraph">
<p>This rule raises issues for <code>public static</code> fields with a type inheriting/implementing <code>System.Array</code> or <code>System.Collections.Generic.ICollection&lt;T&gt;</code>.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public class A
{
    public static string[] strings1 = {"first","second"};  // Noncompliant
    public static List&lt;String&gt; strings3 = new List&lt;String&gt;();  // Noncompliant
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public class A
{
    protected static string[] strings1 = {"first","second"};
    protected static List&lt;String&gt; strings3 = new List&lt;String&gt;();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>No issue is reported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the type of the field inherits/implements one (at least) of the following types:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.objectmodel.readonlycollection-1"><code>System.Collections.ObjectModel.ReadOnlyCollection&lt;T&gt;</code></a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.objectmodel.readonlydictionary-2"><code>System.Collections.ObjectModel.ReadOnlyDictionary&lt;TKey, TValue&gt;</code></a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.frozen.frozendictionary-2"><code>System.Collections.Frozen.FrozenDictionary&lt;TKey, TValue&gt;</code></a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.frozen.frozenset-1"><code>System.Collections.Frozen.FrozenSet&lt;T&gt;</code></a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.immutable.immutablearray-1"><code>System.Collections.Immutable.ImmutableArray&lt;T&gt;</code></a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.immutable.iimmutabledictionary-2"><code>System.Collections.Immutable.IImmutableDictionary&lt;TKey, TValue&gt;</code></a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.immutable.iimmutablelist-1"><code>System.Collections.Immutable.IImmutableList&lt;T&gt;</code></a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.immutable.iimmutableset-1"><code>System.Collections.Immutable.IImmutableSet&lt;T&gt;</code></a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.immutable.iimmutablestack-1"><code>System.Collections.Immutable.IImmutableStack&lt;T&gt;</code></a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.immutable.iimmutablequeue-1"><code>System.Collections.Immutable.IImmutableQueue&lt;T&gt;</code></a></p>
</li>
</ul>
</div>
</li>
<li>
<p>If the field is <code>readonly</code> and is initialized inline with an immutable type (i.e. inherits/implements one of the types in the previous list) or null.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/582">CWE-582 - Array Declared Public, Final, and Static</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/607">CWE-607 - Public Static Final Field References Mutable Object</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use an immutable collection or reduce the accessibility of this field.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>field name</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_deprecates_s1873">deprecates: <a data-rspec-id="S1873" class="rspec-auto-link">S1873</a></h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s2385">deprecates: <a data-rspec-id="S2385" class="rspec-auto-link">S2385</a></h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s3887">is related to: <a data-rspec-id="S3887" class="rspec-auto-link">S3887</a></h3>

</div>
<div class="sect2">
<h3 id="_on_27_jan_2015_203417_freddy_mallet_wrote">on 27 Jan 2015, 20:34:17 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>What about "public final static" fields ? I would apply the same rule except when the type of the field is a java primitive type or a String.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_jul_2020_144413_alexandre_gigleux_wrote">on 29 Jul 2020, 14:44:13 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>I change the type from Vulnerability to Code Smell after discussing with AppSec bubble and the fact the same decision was taken for <a data-rspec-id="S1104" class="rspec-auto-link">RSPEC-1104</a>.</p>
</div>
</div>
</div>
</div>