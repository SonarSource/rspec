<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Security through obscurity is no security at all, and the use of Base64 encoding to obscure a password will only slow an attacker down for seconds, at the most. Instead, passwords should be encrypted with private keys that are at least 128 bits in length.</p>
</div>
<div class="paragraph">
<p>This rule checks for the use of Base64 decoding on values that are then used in database and LDAP connections.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String password = Base64.decode(retrievePassword());
DriverManager.getConnection(url, usr, password);  // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Cipher cipher = Cipher.getInstance("RSA/ECB/OAEPWithMD5AndMGF1Padding");
cipher.init(Cipher.DECRYPT_MODE, privateKey);  // key management out of scope for this example
cipher.doFinal(retrievePassword()));</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">Top 10 2021 Category A2 - Cryptographic Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/261">CWE-261 - Weak Cryptography for Passwords</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use a stronger algorithm to encrypt this password.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_relates_to_s4787">relates to: <a data-rspec-id="S4787" class="rspec-auto-link">S4787</a></h3>

</div>
<div class="sect2">
<h3 id="_on_2_oct_2014_153717_ann_campbell_wrote">on 2 Oct 2014, 15:37:17 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.peru] I&#8217;ve mapped this to find-sec-bugs:RSA_KEY_SIZE but the CWE page talks mainly about Base64 encoding. Is a key size check doable?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_oct_2014_083454_nicolas_peru_wrote">on 8 Oct 2014, 08:34:54 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>RSA_KEY_SIZE checks the <code>KeyPairGenerator</code> class and the calls to <code>getInstance</code> and <code>initialize</code> methods.</p>
</div>
<div class="paragraph">
<p>Those are a little bit different as Base64 is not an encryption mechanism whereas the other is correct but weak.</p>
</div>
<div class="paragraph">
<p>We can still squash them into one rule though.</p>
</div>
</div>
</div>
</div>