<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Having two form validation entries with the same name indicates a configuration
issue. Only one of the two configurations will be applied, which can lead to
validation gaps.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Struts, form validation is used to validate the data the application&#8217;s
clients provide as part of a form submission to the server. Configuring two
different form validations with the same name leads to unexpected behaviors.</p>
</div>
<div class="paragraph">
<p>When faced with multiple form validations with the same name, Struts will
arbitrarily choose one and apply it while discarding the others.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>The application might perform an incomplete validation of user-submitted forms.
Some parts of the validation configuration defined in discarded items will not
apply, which can have severe consequences if not duplicated in the applied one.</p>
</div>
<div class="paragraph">
<p>Missing input validation can make the application vulnerable to injection
attacks or other severe issues. They might affect the confidentiality,
integrity, or availability of the application or the data it stores.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;form-validation&gt;
  &lt;formset&gt;
    &lt;form name="BookForm"&gt; ... &lt;/form&gt;
    &lt;form name="BookForm"&gt; ... &lt;/form&gt;  &lt;!-- Noncompliant --&gt;
  &lt;/formset&gt;
&lt;/form-validation&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;form-validation&gt;
  &lt;formset&gt;
    &lt;form name="BookForm"&gt; ... &lt;/form&gt;
  &lt;/formset&gt;
&lt;/form-validation&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>Only one validation configuration should remain. Depending on what was
previously configured, one should either remove the useless validation entries
or merge all of them into a single complete one.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/102">CWE-102 - Struts: Duplicate Validation Forms</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Struts Documentation - <a href="https://svn.apache.org/repos/asf/struts/struts1/tags/STRUTS_1_1_B1/contrib/validator/docs/overview.html">Struts Validator</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-community/vulnerabilities/Improper_Data_Validation">Improper Data Validation</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Rename this form; line x holds another form declaration with the same name.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>primary: second instance of form name</p>
</li>
<li>
<p>secondary: original instance of form name</p>
<div class="ulist">
<ul>
<li>
<p>message: original</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_12_oct_2015_144934_ann_campbell_wrote">on 12 Oct 2015, 14:49:34 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>in <code>validation.xml</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_mar_2018_110446_sébastien_gioria_appsecfr_wrote">on 19 Mar 2018, 11:04:46 Sébastien GIORIA - AppSecFR wrote:</h3>
<div class="paragraph">
<p>According to [CWE-102], is a member of A1:2017 Injection.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_may_2018_170701_alexandre_gigleux_wrote">on 29 May 2018, 17:07:01 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>\[~SPoint] CWE-102 is saying "OWASP Top Ten 2004 Category A1 - Unvalidated Input" and there is no longer a category for "Unvalidated Input".</p>
</div>
</div>
</div>
</div>