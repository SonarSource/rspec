This rule raises an issue when a Django template contains a form with `method="post"` that does not include the `{% csrf_token %}` template tag.

== Why is this an issue?

Cross-Site Request Forgery (CSRF) is a type of attack where a malicious website tricks a user's browser into performing unwanted actions on a trusted site where the user is authenticated.

When a Django form lacks CSRF protection, an attacker can create a malicious webpage that submits forms to your application on behalf of authenticated users without their knowledge. For example, if a user is logged into your banking application and visits a malicious site, that site could potentially transfer money or change account settings.

Django provides built-in CSRF protection through middleware and template tags. When you include `{% csrf_token %}` in your form, Django generates a unique token that must be present in POST requests. This token is tied to the user's session and cannot be guessed by attackers.

Without this protection, your application becomes vulnerable to unauthorized actions that could compromise user data, perform unwanted transactions, or modify critical application state.

=== What is the potential impact?

Attackers can perform unauthorized actions on behalf of authenticated users, potentially leading to data breaches, unauthorized transactions, account modifications, or other malicious activities depending on the form's functionality.

=== How to fix?


Add the `{% csrf_token %}` template tag inside your POST form. This generates a hidden input field with a unique token that Django validates on form submission.

==== Non-compliant code example

[source,html,diff-id=1,diff-type=noncompliant]
----
<form method="post">
    <input type="text" name="title">
    <button type="submit">Submit</button> // Noncompliant
</form>
----

==== Compliant code example

[source,html,diff-id=1,diff-type=compliant]
----
<form method="post">
    {% csrf_token %}
    <input type="text" name="title">
    <button type="submit">Submit</button>
</form>
----

=== Documentation

 * Django CSRF Protection Documentation - https://docs.djangoproject.com/en/stable/ref/csrf/[Official Django documentation on Cross Site Request Forgery protection]
 * Django Security Best Practices - https://docs.djangoproject.com/en/stable/topics/security/[Comprehensive guide to Django security features and best practices]

=== Standards

 * OWASP Top 10:2021-A01-Broken Access Control - https://owasp.org/Top10/A01_2021-Broken_Access_Control/[OWASP guidance on preventing broken access control vulnerabilities]
 * CWE-352: Cross-Site Request Forgery (CSRF) - https://cwe.mitre.org/data/definitions/352.html[Common Weakness Enumeration entry for CSRF vulnerabilities]

