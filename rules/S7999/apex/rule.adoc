This rule raises an issue when `Messaging.sendEmail()` calls are not wrapped in try-catch blocks to handle potential exceptions.

== Why is this an issue?

Email operations in Salesforce can fail for various reasons, including invalid email addresses, governor limit violations, or configuration issues. When `Messaging.sendEmail()` encounters an error, it throws exceptions such as `EmailException` or `LimitException`.

Without proper error handling, these exceptions can cause the entire transaction to fail unexpectedly. This leads to poor user experience and makes debugging difficult when email operations fail silently or crash the application.

Proper exception handling allows your application to:

* Continue processing even when email delivery fails
* Log meaningful error messages for debugging
* Provide appropriate feedback to users
* Implement retry logic or alternative communication methods

=== What is the potential impact?

Unhandled email exceptions can cause transaction failures, poor user experience, and make it difficult to diagnose email delivery issues. Critical business processes that depend on email notifications may fail silently.

== How to fix it

Wrap the `Messaging.sendEmail()` call in a try-catch block to handle potential exceptions. Log errors appropriately and consider how your application should respond to email failures.

=== Code examples

==== Noncompliant code example

[source,apex,diff-id=1,diff-type=noncompliant]
----
public void sendMail(String[] addresses, String[] subjects, String[] messages) {
    Messaging.SingleEmailMessage[] emails = new Messaging.SingleEmailMessage[]{};
    // populate emails
    Messaging.sendEmail(emails); // Noncompliant
}
----

==== Compliant solution

[source,apex,diff-id=1,diff-type=compliant]
----
public void sendMail(String[] addresses, String[] subjects, String[] messages) {
    try {
        Messaging.SingleEmailMessage[] emails = new Messaging.SingleEmailMessage[]{};
        // populate emails
        Messaging.SendEmailResult[] results = Messaging.sendEmail(emails);
        // handle results
    } catch (Exception e) {
        System.debug('Email sending failed: ' + e.getMessage());
        // Handle the error appropriately
    }
}
----

== Resources

=== Documentation

 * Salesforce Messaging Class Documentation - https://developer.salesforce.com/docs/atlas.en-us.apexref.meta/apexref/apex_classes_email_outbound_messaging.htm[Official Salesforce documentation for the Messaging class and email operations]

 * Exception Handling in Apex - https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_exception_definition.htm[Salesforce documentation on exception handling patterns in Apex]

=== Standards

 * CWE-248: Uncaught Exception - https://cwe.mitre.org/data/definitions/248.html[Weakness related to uncaught exceptions that can lead to application crashes]
