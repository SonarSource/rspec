== Why is this an issue?

Assembling a ``++StringBuilder++`` or ``++StringBuffer++`` into a ``++String++`` merely to see if it's empty is a waste of cycles. Instead, jump right to the heart of the matter and use ``++.isEmpty++`` instead.


=== Noncompliant code example

[source,java,diff-id=1,diff-type=nonCompliant]
----
StringBuilder sb = new StringBuilder();
// ...
if ("".equals(sb.toString()) { // Noncompliant
  // ...
}
if (sb.toString().isEmpty()) { // Noncompliant
  // ...
}
----

=== Compliant solution

[source,java,diff-id=1,diff-type=compliant]
----
StringBuilder sb = new StringBuilder();
// ...
if (sb.isEmpty()) {
  // ...
}
if (sb.isEmpty()) {
  // ...
}
----

=== Benchmarks

[options="header"]
|===
| Method| Runtime| Average time| Error margin
| isEmpty| Temurin 21| 0.74 ns/op| ±0.29 ns/op
| length| Temurin 21| 0.71 ns/op| ±0.10 ns/op
| toStringIsEmpty| Temurin 21| 3.94 ns/op| ±0.59 ns/op
| toStringEquals| Temurin 21| 4.80 ns/op| ±0.78 ns/op
|===


The results were generated by running the following snippet with https://github.com/openjdk/jmh[jmh]:

[source,java]
----
private String[] str = {"a", "b", "c", "d", "e"};
private StringBuilder sb = new StringBuilder();

@Setup(Level.Iteration)
public void setup() {
  StringBuilder sb = new StringBuilder();
  for (String s : str) {
    sb.append(s);
  }
}

@Benchmark
public StringBuilder toStringEquals() {
  if ("".equals((sb.toString()))) {
    return sb;
  }
  return new StringBuilder();
}

@Benchmark
public StringBuilder toStringIsEmpty() {
  if (sb.toString().isEmpty()) {
    return sb;
  }
  return new StringBuilder();
}

@Benchmark
public StringBuilder length() {
  if (sb.length() == 0) {
    return sb;
  }
  return new StringBuilder();
}

@Benchmark
public StringBuilder isEmpty() {
  if (sb.isEmpty()) {
    return sb;
  }
  return new StringBuilder();
}
----


ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

=== Message

Test "xxx.length()" against 0 to see if "xxx" is empty.


endif::env-github,rspecator-view[]
