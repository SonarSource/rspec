<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The improper storage of passwords poses a significant security risk to software
applications. This vulnerability arises when passwords are stored in plaintext
or with a fast hashing algorithm. To exploit this vulnerability, an attacker
typically requires access to the stored passwords.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Attackers who would get access to the stored passwords could reuse them without
further attacks or with little additional effort.<br>
Obtaining the plaintext passwords, they could then gain unauthorized access to
user accounts, potentially leading to various malicious activities.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Plaintext or weakly hashed password storage poses a significant security risk
to software applications.</p>
</div>
<div class="sect3">
<h4 id="_unauthorized_access">Unauthorized Access</h4>
<div class="paragraph">
<p>When passwords are stored in plaintext or with weak hashing algorithms, an
attacker who gains access to the password database can easily retrieve and use
the passwords to gain unauthorized access to user accounts. This can lead to
various malicious activities, such as unauthorized data access, identity theft,
or even financial fraud.</p>
</div>
</div>
<div class="sect3">
<h4 id="_credential_reuse">Credential Reuse</h4>
<div class="paragraph">
<p>Many users tend to reuse passwords across multiple platforms. If an attacker
obtains plaintext or weakly hashed passwords, they can potentially use these
credentials to gain unauthorized access to other accounts held by the same
user. This can have far-reaching consequences, as sensitive personal
information or critical systems may be compromised.</p>
</div>
</div>
<div class="sect3">
<h4 id="_regulatory_compliance">Regulatory Compliance</h4>
<div class="paragraph">
<p>Many industries and jurisdictions have specific regulations and standards to
protect user data and ensure its confidentiality. Storing passwords in
plaintext or with weak hashing algorithms can lead to non-compliance with
these regulations, potentially resulting in legal consequences, financial
penalties, and damage to the reputation of the software application and its
developers.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;configuration&gt;
  &lt;system.web&gt;
    &lt;authentication mode="Forms"&gt;
      &lt;forms name="customer_login" timeout="30" loginUrl="~/Login.aspx"&gt;
        &lt;credentials passwordFormat="Clear"&gt; &lt;!-- Noncompliant --&gt;
          &lt;user name="admin" password="password" /&gt;
        &lt;/credentials&gt;
      &lt;/forms&gt;
    &lt;/authentication&gt;
  &lt;/system.web&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="paragraph">
<p>The <code>Form</code> mode of authentication supports only Clear, SHA1, and MD5. None of them
are secure, so their use is highly discouraged.</p>
</div>
<div class="paragraph">
<p>Instead, it is recommended to use another, modern authentication mechanism such as <a href="https://learn.microsoft.com/en-us/aspnet/core/security/authentication/identity?view=aspnetcore-8.0&amp;tabs=visual-studio">ASP.Net Identity</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="sect3">
<h4 id="_use_secure_password_hashing_algorithms">Use secure password hashing algorithms</h4>
<div class="paragraph">
<p>In general, you should rely on an algorithm that has no known security
vulnerabilities. The MD5 and SHA-1 algorithms should not be used.</p>
</div>
<div class="paragraph">
<p>Some algorithms, such as the SHA family functions, are considered strong for
some use cases, but are too fast in computation and therefore vulnerable to
brute force attacks, especially with bruteforce-attack-oriented hardware.</p>
</div>
<div class="paragraph">
<p>To protect passwords, it is therefore important to choose modern, slow
password-hashing algorithms. The following algorithms are, in order of strength,
the most secure password hashing algorithms to date:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Argon2</p>
</li>
<li>
<p>scrypt</p>
</li>
<li>
<p>bcrypt</p>
</li>
<li>
<p>PBKDF2</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Argon2 should be the best choice, and others should be used when the previous
one is not available. For systems that must use FIPS-140-certified algorithms,
PBKDF2 should be used.</p>
</div>
<div class="paragraph">
<p>Whenever possible, choose the strongest algorithm available. If the algorithm
currently used by your system should be upgraded, OWASP documents possible
upgrade methods here:
<a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html#upgrading-legacy-hashes">Upgrading Legacy Hashes</a>.</p>
</div>
<div class="paragraph">
<p>Fortunately, ASP.Net Identity supports PBKDF2 and uses it by default.</p>
</div>
</div>
<div class="sect3">
<h4 id="_never_store_passwords_in_plaintext">Never store passwords in plaintext</h4>
<div class="paragraph">
<p>A user password should never be stored in plaintext. Instead, a hash should be
produced from it using a secure algorithm. When dealing with password storage
security, best practices recommend relying on a slow hashing algorithm, that
will make brute force attacks more difficult. Using a hashing function with
adaptable computation and memory complexity also is recommended to be able to
increase the security level with time.</p>
</div>
<div class="paragraph">
<p>Adding a salt to the digest computation is also recommended to prevent
pre-computed table attacks (see rule <a data-rspec-id="S2053" class="rspec-auto-link">S2053</a>).</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/e01fc50a%28v%3Dvs.100%29">credentials Element for forms for authentication</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">Top 10 2021 Category A2 - Cryptographic Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">Top 10 2021 Category A4 - Insecure Design</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/256">CWE-256 - Plaintext Storage of a Password</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/916">CWE-916 - Use of Password Hash With Insufficient Computational Effort</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222542">Application Security and Development: V-222542</a> - The application must only store cryptographic representations of passwords.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use a secure password hashing algorithm.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_deprecates_s2070">deprecates: <a data-rspec-id="S2070" class="rspec-auto-link">S2070</a></h3>

</div>
</div>
</div>