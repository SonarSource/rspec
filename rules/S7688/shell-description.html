<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when the traditional <code>[</code> command (or <code>test</code> command) is used for conditional tests in Bash scripts, unless POSIX compatibility is explicitly required.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The traditional <code>[</code> command (also known as <code>test</code>) is an external command that treats its arguments as separate words, making it vulnerable to word splitting and pathname expansion issues. This can lead to unexpected behavior when variables contain spaces, special characters, or when filenames match glob patterns.</p>
</div>
<div class="paragraph">
<p>The modern <code>[[</code> construct is part of Bash syntax rather than a separate command. This means:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Word splitting and pathname expansion do not occur within <code>[[ ]]</code>, making it more robust when handling variables that might contain spaces or special characters</p>
</li>
<li>
<p>It provides better error handling and more predictable behavior</p>
</li>
<li>
<p>It offers additional features like regular expression matching with the <code>=~</code> operator</p>
</li>
<li>
<p>It&#8217;s generally faster since it doesn&#8217;t require spawning an external process</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using <code>[</code> can cause subtle bugs that are difficult to debug, especially when dealing with user input, filenames, or variables that might be empty or contain unexpected characters.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Using the traditional <code>[</code> command instead of <code>[[</code> can lead to script failures or unexpected behavior when:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Variables contain spaces, tabs, or newlines</p>
</li>
<li>
<p>Filenames contain special characters or match glob patterns</p>
</li>
<li>
<p>Variables are empty or unset</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These issues can cause scripts to behave unpredictably in production environments, potentially leading to data loss, security vulnerabilities, or system instability.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Replace the traditional <code>[</code> command with the modern <code>[[</code> construct. Update both the opening and closing brackets, and ensure proper spacing.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">if [ -z "$str" ]; then  # Noncompliant
  echo "empty"
fi

if [ "$var" = "value" ]; then  # Noncompliant
  echo "match"
fi</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">if [[ -z "$str" ]]; then
  echo "empty"
fi

if [[ "$var" = "value" ]]; then
  echo "match"
fi</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Bash Manual - Conditional Constructs - <a href="https://www.gnu.org/software/bash/manual/html_node/Conditional-Constructs.html">Official Bash manual section on conditional constructs including [[ </a>]]</p>
</li>
<li>
<p>LinuxCommand.org - Bash Coding Standards - <a href="https://linuxcommand.org/lc3_adv_standards.php">Comprehensive Bash scripting coding standards and best practices</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>POSIX.1-2017 - Shell Command Language - <a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/test.html">POSIX specification for the test command and conditional expressions</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>