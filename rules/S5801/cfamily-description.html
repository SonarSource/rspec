<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In C, a string is just a buffer of characters, normally using the <code>null</code> character as a sentinel for the end of the string. This means that the developer has to be aware of low-level details such as buffer sizes or having an extra character to store the final <code>null</code> character. Doing that correctly and consistently is notoriously difficult and any error can lead to a security vulnerability, for instance, giving access to sensitive data or allowing arbitrary code execution.</p>
</div>
<div class="paragraph">
<p>The function <code>char *strcpy(char * restrict dest, const char * restrict src);</code> copies characters from <code>src</code> to <code>dest</code>. The <code>wcscpy</code> does the same for wide characters and should be used with the same guidelines.</p>
</div>
<div class="paragraph">
<p>Note: the functions <code>strncpy</code> and <code>wcsncpy</code> might look like attractive safe replacements for <code>strcpy</code> and <code>wcscpy</code>, but they have their own set of issues (see <a data-rspec-id="S5816" class="rspec-auto-link">S5816</a>), and you should probably prefer another more adapted alternative.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>There is a possibility that either the source or the destination pointer is <code>null</code></p>
</li>
<li>
<p>There is a possibility that the source string is not correctly <code>null</code>-terminated, or that its length (including the final <code>null</code> character) can be larger than the size of the destination buffer.</p>
</li>
<li>
<p>There is an overlap between source and destination</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>C11 provides, in its annex K, the <code>strcpy_s</code> and the <code>wcscpy_s</code> that were designed as safer alternatives to <code>strcpy</code> and <code>wcscpy</code>. It&#8217;s not recommended to use them in all circumstances, because they introduce a runtime overhead and require to write more code for error handling, but they perform checks that will limit the consequences of calling the function with bad arguments.</p>
</li>
<li>
<p>Even if your compiler does not exactly support annex K, you probably have access to similar functions, for example, <code>strlcpy</code> in FreeBSD</p>
</li>
<li>
<p>If you are writing C&#43;&#43; code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>int f(char *src) {
  char dest[256];
  strcpy(dest, src); // Sensitive: might overflow
  return doSomethingWith(dest);
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">int f(char *src) {
  char *dest = malloc(strlen(src) + 1); // For the final 0
  strcpy(dest, src); // Compliant: we made sure the buffer is large enough
  int r= doSomethingWith(dest);
  free(dest);
  return r;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/120">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a></p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/HdcxBQ">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation</p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222612">Application Security and Development: V-222612</a> - The application must not be vulnerable to overflow attacks.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure use of "strcpy" is safe here.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_relates_to_s5816">relates to: <a data-rspec-id="S5816" class="rspec-auto-link">S5816</a></h3>

</div>
</div>
</div>