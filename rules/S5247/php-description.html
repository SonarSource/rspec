<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Disabling auto-escaping in templates can lead to Cross-Site Scripting (XSS) vulnerabilities, as it allows untrusted user input to be rendered directly in the HTML output without proper escaping. This can enable attackers to inject malicious scripts into web pages, potentially compromising user data and application security.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_twig">How to fix it in Twig</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ensure that auto-escaping is enabled in Twig templates to automatically escape variables and user input. This helps prevent XSS vulnerabilities by ensuring that any potentially dangerous characters are properly encoded before being rendered in the HTML output.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code Examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant Code Example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">public function loadTwig()
{
  $twig = new \Twig_Environment(new \Twig_Loader_String(), [
    'autoescape' =&gt; false, // Noncompliant
  ]);

  $escaper = new \Twig_Extension_Escaper(false); // Noncompliant
  $twig-&gt;addExtension($escaper);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">public function loadTwig()
{
  $twig = new \Twig_Environment(new \Twig_Loader_String(), [
    'autoescape' =&gt; true, // Compliant
  ]);

  $escaper = new \Twig_Extension_Escaper(true); // Compliant
  $twig-&gt;addExtension($escaper);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A03_2021-Injection/">Top 10 2021 Category A3 - Injection</a></p>
</li>
<li>
<p><a href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md">OWASP Cheat Sheet</a> - XSS Prevention Cheat Sheet</p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">Top 10 2017 Category A7 - Cross-Site Scripting (XSS)</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/79">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure disabling auto-escaping feature is safe here.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_14_may_2019_220918_lars_svensson_wrote">on 14 May 2019, 22:09:18 Lars Svensson wrote:</h3>
<div class="paragraph">
<p>Reference:</p>
</div>
<div class="paragraph">
<p><a href="https://twig.symfony.com/doc/2.x/api.html" class="bare">https://twig.symfony.com/doc/2.x/api.html</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_deprecates_s5439">deprecates: <a data-rspec-id="S5439" class="rspec-auto-link">S5439</a></h3>

</div>
</div>
</div>