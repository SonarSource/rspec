== Why is this an issue?

Disabling auto-escaping in templates can lead to Cross-Site Scripting (XSS) vulnerabilities, as it allows untrusted user input to be rendered directly in the HTML output without proper escaping. This can enable attackers to inject malicious scripts into web pages, potentially compromising user data and application security.

== How to fix it in Twig

Ensure that auto-escaping is enabled in Twig templates to automatically escape variables and user input. This helps prevent XSS vulnerabilities by ensuring that any potentially dangerous characters are properly encoded before being rendered in the HTML output.

=== Code Examples

==== Noncompliant Code Example

[source,php,diff-id=1,diff-type=noncompliant]
----
public function loadTwig()
{
  $twig = new \Twig_Environment(new \Twig_Loader_String(), [
    'autoescape' => false, // Noncompliant
  ]);

  $escaper = new \Twig_Extension_Escaper(false); // Noncompliant
  $twig->addExtension($escaper);
}
----

==== Compliant Solution

[source,php,diff-id=1,diff-type=compliant]
----
public function loadTwig()
{
  $twig = new \Twig_Environment(new \Twig_Loader_String(), [
    'autoescape' => true, // Compliant
  ]);

  $escaper = new \Twig_Extension_Escaper(true); // Compliant
  $twig->addExtension($escaper);
}
----

== Resources

* OWASP - https://owasp.org/Top10/A03_2021-Injection/[Top 10 2021 Category A3 - Injection]
* https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md[OWASP Cheat Sheet] - XSS Prevention Cheat Sheet
* OWASP - https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)[Top 10 2017 Category A7 - Cross-Site Scripting (XSS)]
* CWE - https://cwe.mitre.org/data/definitions/79[CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')]


ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::../message.adoc[]

'''
== Comments And Links
(visible only on this page)

=== on 14 May 2019, 22:09:18 Lars Svensson wrote:
Reference:

https://twig.symfony.com/doc/2.x/api.html

include::../comments-and-links.adoc[]

endif::env-github,rspecator-view[]
