<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When accessing a database, an empty password should be avoided as it introduces a weakness.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a database does not require a password for authentication, it allows anyone to access and manipulate the data stored within it. Exploiting this vulnerability typically involves identifying the target database and establishing a connection to it without the need for any authentication credentials.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Once connected, an attacker can perform various malicious actions, such as viewing, modifying, or deleting sensitive information, potentially leading to data breaches or unauthorized access to critical systems. It is crucial to address this vulnerability promptly to ensure the security and integrity of the database and the data it contains.</p>
</div>
<div class="sect3">
<h4 id="_unauthorized_access_to_sensitive_data">Unauthorized Access to Sensitive Data</h4>
<div class="paragraph">
<p>When a database lacks a password for authentication, it opens the door for unauthorized individuals to gain access to sensitive data. This can include personally identifiable information (PII), financial records, intellectual property, or any other confidential information stored in the database. Without proper access controls in place, malicious actors can exploit this vulnerability to retrieve sensitive data, potentially leading to identity theft, financial loss, or reputational damage.</p>
</div>
</div>
<div class="sect3">
<h4 id="_compromise_of_system_integrity">Compromise of System Integrity</h4>
<div class="paragraph">
<p>Without a password requirement, unauthorized individuals can gain unrestricted access to a database, potentially compromising the integrity of the entire system. Attackers can inject malicious code, alter configurations, or manipulate data within the database, leading to system malfunctions, unauthorized system access, or even complete system compromise. This can disrupt business operations, cause financial losses, and expose the organization to further security risks.</p>
</div>
</div>
<div class="sect3">
<h4 id="_unwanted_modifications_or_deletions">Unwanted Modifications or Deletions</h4>
<div class="paragraph">
<p>The absence of a password for database access allows anyone to make modifications or deletions to the data stored within it. This poses a significant risk, as unauthorized changes can lead to data corruption, loss of critical information, or the introduction of malicious content. For example, an attacker could modify financial records, tamper with customer orders, or delete important files, causing severe disruptions to business processes and potentially leading to financial and legal consequences.</p>
</div>
<div class="paragraph">
<p>Overall, the lack of a password configured to access a database poses a serious security risk, enabling unauthorized access, data breaches, system compromise, and unwanted modifications or deletions. It is essential to address this vulnerability promptly to safeguard sensitive data, maintain system integrity, and protect the organization from potential harm.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_entity_framework_core">How to fix it in Entity Framework Core</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="paragraph">
<p>The following code uses an empty password to connect to a SQL Server database.</p>
</div>
<div class="paragraph">
<p>The vulnerability can be fixed by using Windows authentication (sometimes referred to as integrated security).</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
{
  optionsBuilder.UseSqlServer("Server=myServerAddress;Database=myDataBase;User Id=myUsername;Password="); // Noncompliant
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
{
  optionsBuilder.UseSqlServer("Server=myServerAddress;Database=myDataBase;Integrated Security=True");
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="sect3">
<h4 id="_windows_authentication_integrated_security">Windows authentication (integrated security)</h4>
<div class="paragraph">
<p>When the connection string includes the <code>Integrated Security=true</code> parameter, it enables Windows authentication (sometimes called integrated security) for the database connection. With integrated security, the user&#8217;s Windows credentials are used to authenticate and authorize access to the database. It eliminates the need for a separate username and password for the database connection. Integrated security simplifies authentication and leverages the existing Windows authentication infrastructure for secure database access in your C# application.</p>
</div>
<div class="paragraph">
<p>It&#8217;s important to note that when using integrated security, the user running the application must have the necessary permissions to access the database. Ensure that the user account running the application has the appropriate privileges and is granted access to the database.</p>
</div>
<div class="paragraph">
<p>The syntax employed in connection strings varies by provider:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported by</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integrated Security=true;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL Server, Oracle, Postgres</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integrated Security=SSPI;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL Server, OLE DB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integrated Security=yes;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MySQL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Trusted_Connection=true;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL Server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Trusted_Connection=yes;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ODBC</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note: Some providers such as MySQL do not support Windows authentication with .NET Core.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pitfalls">Pitfalls</h3>
<div class="sect3">
<h4 id="_hard_coded_passwords">Hard-coded passwords</h4>
<div class="paragraph">
<p>It could be tempting to replace the empty password with a hard-coded one. Hard-coding passwords in the code can pose significant security risks. Here are a few reasons why it is not recommended:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Security Vulnerability: Hard-coded passwords can be easily discovered by anyone who has access to the code, such as other developers or attackers. This can lead to unauthorized access to the database and potential data breaches.</p>
</li>
<li>
<p>Lack of Flexibility: Hard-coded passwords make it difficult to change the password without modifying the code. If the password needs to be updated, it would require recompiling and redeploying the code, which can be time-consuming and error-prone.</p>
</li>
<li>
<p>Version Control Issues: Storing passwords in code can lead to version control issues. If the code is shared or stored in a version control system, the password will be visible to anyone with access to the repository, which is a security risk.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To mitigate these risks, it is recommended to use secure methods for storing and retrieving passwords, such as using environment variables, configuration files, or secure key management systems. These methods allow for better security, flexibility, and separation of sensitive information from the codebase.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_asp_net">How to fix it in ASP.NET</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples_2">Code examples</h3>
<div class="paragraph">
<p>The following configuration file uses an empty password to connect to a database.</p>
</div>
<div class="paragraph">
<p>The vulnerability can be fixed by using Windows authentication (sometimes referred to as integrated security)</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;add name="myConnection" connectionString="Server=myServerAddress;Database=myDataBase;User Id=myUsername;Password=" /&gt; &lt;!-- Noncompliant --&gt;
  &lt;/connectionStrings&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;add name="myConnection" connectionString="Server=myServerAddress;Database=myDataBase;Integrated Security=True" /&gt;
  &lt;/connectionStrings&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work_2">How does this work?</h3>
<div class="sect3">
<h4 id="_windows_authentication_integrated_security_2">Windows authentication (integrated security)</h4>
<div class="paragraph">
<p>When the connection string includes the <code>Integrated Security=true</code> parameter, it enables Windows authentication (sometimes called integrated security) for the database connection. With integrated security, the user&#8217;s Windows credentials are used to authenticate and authorize access to the database. It eliminates the need for a separate username and password for the database connection. Integrated security simplifies authentication and leverages the existing Windows authentication infrastructure for secure database access in your C# application.</p>
</div>
<div class="paragraph">
<p>It&#8217;s important to note that when using integrated security, the user running the application must have the necessary permissions to access the database. Ensure that the user account running the application has the appropriate privileges and is granted access to the database.</p>
</div>
<div class="paragraph">
<p>The syntax employed in connection strings varies by provider:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported by</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integrated Security=true;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL Server, Oracle, Postgres</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integrated Security=SSPI;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL Server, OLE DB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integrated Security=yes;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MySQL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Trusted_Connection=true;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL Server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Trusted_Connection=yes;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ODBC</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note: Some providers such as MySQL do not support Windows authentication with .NET Core.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pitfalls_2">Pitfalls</h3>
<div class="sect3">
<h4 id="_hard_coded_passwords_2">Hard-coded passwords</h4>
<div class="paragraph">
<p>It could be tempting to replace the empty password with a hard-coded one. Hard-coding passwords in the code can pose significant security risks. Here are a few reasons why it is not recommended:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Security Vulnerability: Hard-coded passwords can be easily discovered by anyone who has access to the code, such as other developers or attackers. This can lead to unauthorized access to the database and potential data breaches.</p>
</li>
<li>
<p>Lack of Flexibility: Hard-coded passwords make it difficult to change the password without modifying the code. If the password needs to be updated, it would require recompiling and redeploying the code, which can be time-consuming and error-prone.</p>
</li>
<li>
<p>Version Control Issues: Storing passwords in code can lead to version control issues. If the code is shared or stored in a version control system, the password will be visible to anyone with access to the repository, which is a security risk.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To mitigate these risks, it is recommended to use secure methods for storing and retrieving passwords, such as using environment variables, configuration files, or secure key management systems. These methods allow for better security, flexibility, and separation of sensitive information from the codebase.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.microsoft.com/en-us/troubleshoot/aspnet/create-web-config">Create the Web.config file for an ASP.NET application</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">Top 10 2021 Category A7 - Identification and Authentication Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">Top 10 2017 Category A2 - Broken Authentication</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/521">CWE-521 - Weak Password Requirements</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use a secure password when connecting to this database.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_8_oct_2014_071442_nicolas_peru_wrote">on 8 Oct 2014, 07:14:42 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>\[~freddy.mallet] Ok for this rule in java, to detect cases such as the noncompliant one. Should such rule also be extended to check some of the classical JEE xml configuration files (using the XML plugin then) ?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_oct_2014_190817_freddy_mallet_wrote">on 12 Oct 2014, 19:08:17 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>@Ann I would make this rule also covering Findbugs rule DMI_CONSTANT_DB_PASSWORD. The title could then become :</p>
</div>
<div class="paragraph">
<p>"Databases should be password-protected and password should not be hardcoded"</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_14_oct_2014_143218_ann_campbell_wrote">on 14 Oct 2014, 14:32:18 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~freddy.mallet] I had already defined <a data-rspec-id="S2068" class="rspec-auto-link">RSPEC-2068</a> for that, and the reasonings are slightly different. Do you still want me to combine them?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_14_oct_2014_210815_freddy_mallet_wrote">on 14 Oct 2014, 21:08:15 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>Ok fine [~ann.campbell.2]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_16_jan_2015_085612_sébastien_gioria_wrote">on 16 Jan 2015, 08:56:12 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>Could be tag OWASP Top10. A6-Security Misconfiguration</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_jan_2015_084526_ann_campbell_wrote">on 19 Jan 2015, 08:45:26 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks [~sebastien.gioria], done!</p>
</div>
</div>
</div>
</div>