<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Development tools and frameworks usually have options to make debugging easier for developers. Although these features are useful during development, they should never be enabled for applications deployed in production. Debug instructions or error messages can leak detailed information about the system, like the application&#8217;s path or file names.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The code or configuration enabling the application debug features is deployed on production servers or distributed to end users.</p>
</li>
<li>
<p>The application runs by default with debug features activated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Do not enable debugging features on production servers or applications distributed to end users.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For <a href="https://pkg.go.dev/runtime/debug">debug package in Go Standard Library:</a></p>
</div>
<div class="paragraph">
<p><code>debug.PrintStack()</code> prints a stack trace to the standard error output (by default) which can expose sensitive information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">import "runtime/debug"

_, err := funcThatFails()
if err != nil {
    fmt.Printf("Error calling funcThatFails: %v\n", err)
    debug.PrintStack() // Sensitive
    return
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://pkg.go.dev/runtime/pprof">pprof package in Go Standard Library:</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">func main() {
    pprof.Lookup("goroutine").WriteTo(os.Stdout, 1) // Sensitive
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://pkg.go.dev/net/http/pprof">http/pprof package in Go Standard Library:</a></p>
</div>
<div class="paragraph">
<p>Importing <code>net/http/pprof</code> adds several <a href="https://pkg.go.dev/net/http/pprof">HTTP handlers</a> that expose runtime profiling data about the current process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">import (
    "net/http"
    _ "net/http/pprof" // Sensitive
)

func main() {
    // Start an HTTP server that will reply (because of the importation of "net/http/pprof") to various commands
    http.ListenAndServe(":6060", nil)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://pkg.go.dev/net/http/httputil">httputil package in Go Standard Library:</a></p>
</div>
<div class="paragraph">
<p><code>httputil.DumpRequest()</code> generates a dump of an HTTP request and can expose sensitive information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">func requestHandler(w http.ResponseWriter, req *http.Request) {
    dump, err := httputil.DumpRequest(req, true) // Sensitive
    if err == nil {
        fmt.Printf("%q", dump)
        return
    }
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://pkg.go.dev/gorm.io/gorm">GORM Library:</a></p>
</div>
<div class="paragraph">
<p>ORM libraries like GORM often allow logging SQL queries that may expose sensitive information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">import (
    "gorm.io/driver/sqlite"
    "gorm.io/gorm"
)

db, err := gorm.Open(sqlite.Open("test.db"), &amp;gorm.Config{
    Logger: logger.Default.LogMode(logger.Info), // Sensitive
})
if err != nil {
    panic("failed to connect database")
}

db.Debug().Create(&amp;User{Account: acccount, Password: password}) // Sensitive</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For <a href="https://pkg.go.dev/runtime/debug">debug package in Go Standard Library:</a></p>
</div>
<div class="paragraph">
<p>Stack trace should not be printed in production:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">_, err := funcThatFails()
if err != nil {
    fmt.Printf("Error calling funcThatFails: %v\n", err)
    // Compliant: Does not call debug.PrintStack()
    return
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://pkg.go.dev/runtime/pprof">pprof package in Go Standard Library:</a></p>
</div>
<div class="paragraph">
<p>Avoid calling methods such as <code>pprof.Profile.WriteTo</code> in production.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">func main() {
    // Compliant: Does not call pprof.Profile.WriteTo
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://pkg.go.dev/net/http/pprof">http/pprof package in Go Standard Library:</a></p>
</div>
<div class="paragraph">
<p>Do not import <code>net/http/pprof</code> or ensure the HTTP handlers can&#8217;t be accessed by end-users.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">import (
    "net/http"
    // Compliant: Does not import "net/http/pprof"
)

func main() {
    // Start an HTTP server
    http.ListenAndServe(":6060", nil)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://pkg.go.dev/net/http/httputil">httputil package in Go Standard Library:</a></p>
</div>
<div class="paragraph">
<p>Avoid calling methods such as <code>httputil.DumpRequest()</code> in production.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">func requestHandler(w http.ResponseWriter, req *http.Request) {
     // Compliant: Does not call httputil.DumpRequest
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://pkg.go.dev/gorm.io/gorm">GORM Library:</a></p>
</div>
<div class="paragraph">
<p>Configure loggers to not log debug-level information. GORM writes debug-level information when configured with the <code>Info</code> logging mode. Avoid using the <code>DB.Debug()</code> method as it creates a new <code>Session</code> that always logs debug-level information.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">import (
    "gorm.io/driver/sqlite"
    "gorm.io/gorm"
)

db, err := gorm.Open(sqlite.Open("test.db"), &amp;gorm.Config{
    Logger: logger.Default.LogMode(logger.Warn), // Compliant
})
if err != nil {
    panic("failed to connect database")
}

db.Create(&amp;User{Account: acccount, Password: password}) // Compliant: Debug() is not called</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">Top 10 2021 Category A5 - Security Misconfiguration</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/489">CWE-489 - Active Debug Code</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/215">CWE-215 - Information Exposure Through Debug Information</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure this debug feature is deactivated before delivering the code in production.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Highlight the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The function <code>PrintStack</code> from the package <code>runtime/debug</code>.</p>
</li>
<li>
<p>The method <code>WriteTo</code> of the type <code>Profile</code> from the package <code>runtime/pprof</code>.</p>
</li>
<li>
<p>The name of the package <code>net/http/pprof</code> when it is imported.</p>
</li>
<li>
<p>The functions <code>DumpRequest</code> and <code>DumpResponse</code> from the package <code>net/http/httputil</code>.</p>
</li>
<li>
<p>The method <code>Debug</code> of the type <code>DB</code> from the package <code>gorm.io/gorm</code>.</p>
</li>
<li>
<p>The value <code>Info</code> of the type <code>LogLevel</code> from the package <code>gorm.io/gorm</code>.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_deprecates_s3563">deprecates: <a data-rspec-id="S3563" class="rspec-auto-link">S3563</a></h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s1148">deprecates: <a data-rspec-id="S1148" class="rspec-auto-link">S1148</a></h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s1442">deprecates: <a data-rspec-id="S1442" class="rspec-auto-link">S1442</a></h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s1525">deprecates: <a data-rspec-id="S1525" class="rspec-auto-link">S1525</a></h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s1628">deprecates: <a data-rspec-id="S1628" class="rspec-auto-link">S1628</a></h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s1685">deprecates: <a data-rspec-id="S1685" class="rspec-auto-link">S1685</a></h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s1951">deprecates: <a data-rspec-id="S1951" class="rspec-auto-link">S1951</a></h3>

</div>
<div class="sect2">
<h3 id="_on_19_apr_2018_111633_alexandre_gigleux_wrote">on 19 Apr 2018, 11:16:33 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>This is a "Security Hotspot".</p>
</div>
</div>
</div>
</div>