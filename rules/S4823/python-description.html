<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using command line arguments is security-sensitive. It has led in the past to the following vulnerabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2018-7281">CVE-2018-7281</a></p>
</li>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2018-12326">CVE-2018-12326</a></p>
</li>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2011-3198">CVE-2011-3198</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Command line arguments can be dangerous just like any other user input. They should never be used without being first validated and sanitized.</p>
</div>
<div class="paragraph">
<p>Remember also that any user can retrieve the list of processes running on a system, which makes the arguments provided to them visible. Thus passing sensitive information via command line arguments should be considered as insecure.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue on every reference to <code>sys.argv</code>, call to <code>optparse.OptionParser()</code> or a call to <code>argparse.ArgumentParser()</code>. The goal is to guide security code reviews.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>any of the command line arguments are used without being sanitized first.</p>
</li>
<li>
<p>your application accepts sensitive information via command line arguments.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you answered yes to any of these questions you are at risk.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> all command line arguments before using them.</p>
</div>
<div class="paragraph">
<p>Any user or application can list running processes and see the command line arguments they were started with. There are safer ways of providing sensitive information to an application than exposing them in the command line. It is common to write them on the process' standard input, or give the path to a file containing the information.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">Top 10 2017 Category A1 - Injection</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/88">CWE-88 - Argument Injection or Modification</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/214">CWE-214 - Information Exposure Through Process Environment</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure that command line arguments are used safely here.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_4_sep_2018_105729_alexandre_gigleux_wrote">on 4 Sep 2018, 10:57:29 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.harraudeau] Review</p>
</div>
<div class="paragraph">
<p>On which part of the code are we going to raise issues? Each time there is a command line executed taking some arguments or on each arguments of the command line? This needs to be clarify maybe by providing an example of command line execution using arguments.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_25_sep_2019_165557_prakash_reddy_barri_wrote">on 25 Sep 2019, 16:55:57 Prakash Reddy Barri wrote:</h3>
<div class="paragraph">
<p>Hi Team,</p>
</div>
<div class="paragraph">
<p>We have this security hotspot in our python source code and have validators framework configured to validate the command line arguments.</p>
</div>
<div class="paragraph">
<p>Here is the sample snippet.</p>
</div>
<div class="paragraph">
<p><strong>pip install validator-collection</strong></p>
</div>
<div class="paragraph">
<p><strong>from validator_collection import validators, checkers</strong></p>
</div>
<div class="paragraph">
<p><strong>validators.ipv4(sys.argv[1])</strong></p>
</div>
<div class="paragraph">
<p>But sonar still complains about input sanity, Please let us know which framework to use.</p>
</div>
<div class="paragraph">
<p>Thanks,</p>
</div>
<div class="paragraph">
<p>ABC</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_30_sep_2019_175524_nicolas_harraudeau_wrote">on 30 Sep 2019, 17:55:24 Nicolas Harraudeau wrote:</h3>
<div class="paragraph">
<p>Hi [~prakash951],</p>
</div>
<div class="paragraph">
<p>Security Hotspots guide developers during their Code Review so that they can easily spot security sensitive code. You can find more information in [the documentation| https://docs.sonarqube.org/latest/user-guide/security-hotspots/].</p>
</div>
<div class="paragraph">
<p>Next time could you please post your question on https://community.sonarsource.com/? It is our community support forum.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_1_oct_2019_084800_prakash_reddy_barri_wrote">on 1 Oct 2019, 08:48:00 Prakash Reddy Barri wrote:</h3>
<div class="paragraph">
<p>Hi Nicolas,</p>
</div>
<div class="paragraph">
<p>Thanks for the information.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_27_may_2020_164345_eric_therond_wrote">on 27 May 2020, 16:43:45 Eric Therond wrote:</h3>
<div class="paragraph">
<p>Deprecated because it overlaps with SonarSecurity</p>
</div>
</div>
</div>
</div>