:detections: variables/fields
:defaultsensibility: 5

include::../description.adoc[]

include::../ask-yourself.adoc[]

include::../recommended.adoc[]

== Sensitive Code Example

[source,go]
----
var secret = "47828a8dd77ee1eb9dde2d5e93cb221ce8c32b37"

func main() {
    callMyService(secret)
}
----

== Compliant Solution

Using https://docs.aws.amazon.com/sdk-for-go/api/service/secretsmanager/[AWS Secrets Manager]:

[source,go]
----
import (
    "github.com/aws/aws-sdk-go-v2/aws"
    "github.com/aws/aws-sdk-go-v2/service/secretsmanager"
)

func main() {
    secretsManager := ...
    secretName := "MY_SERVICE_SECRET"
    input := &secretsmanager.GetSecretValueInput{
        SecretId: aws.String(secretName),
    }

    result, _ := secretsManager.GetSecretValue(input)

    secret := *result.SecretString
    // do something with the secret
    callMyService(secret)
}
----

Using https://learn.microsoft.com/en-us/azure/key-vault/secrets/quick-create-go?tabs=azure-cli[Azure Key Vault Secret]:

[source,go]
----
import (
    "context"
    "os"

    "github.com/Azure/azure-sdk-for-go/sdk/azidentity"
    "github.com/Azure/azure-sdk-for-go/sdk/keyvault/azsecrets"
)

func main() {
    vaultUri := fmt.Sprintf("https://%s.vault.azure.net/", os.Getenv("KEY_VAULT_NAME"))
    credential, _ := azidentity.NewDefaultAzureCredential(nil)
    client, _ := azsecrets.NewClient(vaultUri, credential, nil)

    secretName := "MY_SERVICE_SECRET"
    version := ""
    resp, _ := client.GetSecret(context.TODO(), secretName, version, nil)

    secret := *resp.Value
    // do something with the secret
    callMyService(secret)
}
----


include::../see.adoc[]

* MSC - https://wiki.sei.cmu.edu/confluence/x/OjdGBQ[MSC03-J - Never hard code sensitive information] 


ifdef::env-github,rspecator-view[]
'''
== Implementation Specification
(visible only on this page)

include::../message.adoc[]


include::../parameters.adoc[]

'''
endif::env-github,rspecator-view[]
