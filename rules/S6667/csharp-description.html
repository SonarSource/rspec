<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue on logging calls inside a <code>catch</code> clause that does not pass the raised <code>Exception</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A log entry should contain all the relevant information about the current execution context. The <a href="https://learn.microsoft.com/en-us/dotnet/api/system.exception">Exception</a> raised in a catch block not only provides the message but also:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the exception type</p>
</li>
<li>
<p>the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.exception.stacktrace">stack trace</a></p>
</li>
<li>
<p>any <a href="https://learn.microsoft.com/en-us/dotnet/api/system.exception.innerexception">inner exceptions</a></p>
</li>
<li>
<p>and more about the cause of the error.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.extensions.logging.loggerextensions">Logging methods</a> provide overloads that accept an <code>Exception</code> as a parameter and
<a href="https://learn.microsoft.com/en-us/dotnet/core/extensions/logging-providers">logging providers</a> persist the <code>Exception</code> in a structured way to facilitate the tracking of system failures. Therefore <code>Exceptions</code> should be passed to the logger.</p>
</div>
<div class="paragraph">
<p>The rule covers the following logging frameworks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Nuget package - <a href="https://www.nuget.org/packages/Castle.Core">Castle.Core</a></p>
</li>
<li>
<p>Nuget package - <a href="https://www.nuget.org/packages/Common.Logging.Core">Common.Core</a></p>
</li>
<li>
<p>Nuget package - <a href="https://www.nuget.org/packages/log4net">log4net</a></p>
</li>
<li>
<p>Nuget package - <a href="https://www.nuget.org/packages/NLog">NLog</a></p>
</li>
<li>
<p>Nuget package - <a href="https://www.nuget.org/packages/Microsoft.Extensions.Logging">Microsoft.Extensions.Logging</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public bool Save()
{
    try
    {
        DoSave();
        return true;
    }
    catch(IOException)
    {
        logger.LogError("Saving failed.");             // Noncompliant: No specifics about the error are logged
        return false;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public bool Save()
{
    try
    {
        DoSave();
        return true;
    }
    catch(IOException exception)
    {
        logger.LogError(exception, "Saving failed.");  // Compliant: Exception details are logged
        return false;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/core/extensions/logging?tabs=command-line#log-exceptions">Log exceptions</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.extensions.logging.loggerextensions">LoggerExtensions Class</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/core/extensions/logging-providers">Logging providers</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/statements/exception-handling-statements#the-try-catch-statement">The <code>try-catch</code> statement</a></p>
</li>
<li>
<p>Serilog - <a href="https://github.com/serilog/serilog/wiki/Getting-Started#example-application">Example application</a></p>
</li>
<li>
<p>Serilog Analyzer - <a href="https://github.com/Suchiman/SerilogAnalyzer#serilog001-exception-usage"><code>Serilog001</code>: Exception Usage</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>