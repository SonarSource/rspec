Disabling authentication can reduce an organization's ability to protect itself against attacks on its critical functions and data, if any.

Depending on the Azure resource, multiple choices are possible: Active Directory Authentication, TLS mutual authentication or OpenID.

Authentication Coupled with fine-grained authorizations helps follow the Defense-In-Depth principle and bring traceability to investigators of security incidents.


== Ask Yourself Whether

* This Azure resource is essential for the information system infrastructure.
* This Azure resource is essential for mission-critical functions.
* Compliance policies require access to this resource to be authenticated

There is a risk if you answered yes to any of those questions.

== Recommended Secure Coding Practices

Enable authentication in this Azure resource.

== Sensitive Code Example

For https://azure.microsoft.com/en-us/services/active-directory[Active Directory Authentication]:

----
resource "azurerm_windows_web_app" "example" {
  name = "example"

  auth_settings {
    enabled = false # Sensitive
  }
}
----

For https://docs.microsoft.com/en-us/azure/api-management/api-management-howto-protect-backend-with-aad[OpenID Authentication]:

----
resource "azurerm_api_management_api" "example" { # Sensitive, the openid_authentication block is missing
  name = "example-api"
}
----

For https://docs.microsoft.com/en-us/azure/app-service/app-service-web-configure-tls-mutual-auth[TLS Mutual Authentication]:

----
resource "azurerm_linux_web_app" "example" { # Sensitive, TLS mutual authentication disabled and set to "Optional"
  client_cert_enabled = false
  client_cert_mode = "Optional"
}
----

For https://docs.microsoft.com/en-us/azure/storage/files/storage-files-active-directory-overview[Azure Files Authentication]:

----
resource "azurerm_storage_account" "example" { # Sensitive, the azure_files_authentication block is missing
  name = "storageaccountname"
}
----

== Compliant Solution

For https://azure.microsoft.com/en-us/services/active-directory[Active Directory Authentication]:

----
resource "azurerm_windows_web_app" "example" {
  name                = "example"

  auth_settings {
    enabled = true
  }
}
----

For https://docs.microsoft.com/en-us/azure/api-management/api-management-howto-protect-backend-with-aad[OpenID Authentication]:

----
resource "azurerm_api_management_api" "example" {
  name = "example-api"
  openid_authentication {
    openid_provider_name = "google"
    bearer_token_sending_methods = "authorizationHeader"
  }
}
----

For https://docs.microsoft.com/en-us/azure/app-service/app-service-web-configure-tls-mutual-auth[TLS Mutual Authentication]:

----
resource "azurerm_linux_web_app" "example" {
  client_cert_enabled = true
  client_cert_mode = "Required"
}
----

For https://docs.microsoft.com/en-us/azure/storage/files/storage-files-active-directory-overview[Azure Files Authentication]:

----
resource "azurerm_storage_account" "example" {
  name = "storageaccountname"
  azure_files_authentication {
    directory_type = "AD"
  }
}
----


== See

* https://owasp.org/Top10/A01_2021-Broken_Access_Control/[OWASP Top 10 2021 Category A1] - Boken Access Control
* https://cwe.mitre.org/data/definitions/668.html[MITRE, CWE-668] - Exposure of Resource to Wrong Sphere

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

=== Message

Make sure that disabling authentication is safe here.


endif::env-github,rspecator-view[]
