Disabling authentication can reduce an organization's ability to protect itself against attacks on its critical functions and data, if any.

Depending on the Azure resource, multiple choices are possible: Active Directory Authentication, TLS mutual authentication or OpenID.

Authentication Coupled with fine-grained authorizations helps follow the Defense-In-Depth principle and bring traceability to investigators of security incidents.


== Ask Yourself Whether

* This Azure resource is essential for the information system infrastructure.
* This Azure resource is essential for mission-critical functions.
* Compliance policies require access to this resource to be authenticated

There is a risk if you answered yes to any of those questions.

== Recommended Secure Coding Practices

Enable authentication in this Azure resource, and disable anonymous access.

== Sensitive Code Example

For https://azure.microsoft.com/en-us/services/app-service/[App Service authentication]:

----
resource "azurerm_windows_web_app" "example" {
  name = "example"

  auth_settings {
    enabled = false # Sensitive
  }
}
----

For https://docs.microsoft.com/en-us/azure/api-management/api-management-howto-protect-backend-with-aad[OpenID Authentication]:

----
resource "azurerm_api_management_api" "example" { # Sensitive, the openid_authentication block is missing
  name = "example-api"
}
----

For https://azure.microsoft.com/en-us/services/cache/[Redis Caches]:

----
resource "azurerm_redis_cache" "example" {
  name = "example-cache"

  redis_configuration {
    enable_authentication = false # Sensitive
  }
}
----

== Compliant Solution

For https://azure.microsoft.com/en-us/services/app-service/[App Service authentication]:

----
resource "azurerm_windows_web_app" "example" {
  name = "example"

  auth_settings {
    enabled = true
  }
}
----

For https://docs.microsoft.com/en-us/azure/api-management/api-management-howto-protect-backend-with-aad[OpenID Authentication]:

----
resource "azurerm_api_management_api" "example" {
  name = "example-api"

  openid_authentication {
    openid_provider_name = azurerm_api_management_openid_connect_provider.example.name
    bearer_token_sending_methods = "authorizationHeader"
  }
}
----

For https://azure.microsoft.com/en-us/services/cache/[Redis Caches]:

----
resource "azurerm_redis_cache" "example" {
  name = "example-cache"
  
  redis_configuration {
    enable_authentication = true
  }
}
----

== See

* https://owasp.org/Top10/A01_2021-Broken_Access_Control/[OWASP Top 10 2021 Category A1] - Boken Access Control
* https://cwe.mitre.org/data/definitions/668.html[MITRE, CWE-668] - Exposure of Resource to Wrong Sphere

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

=== Message

Make sure that disabling authentication is safe here.

=== Highlighting

* For ``auth_settings`` cases: Highlight the resource or ``auth_settings->enabled = false``
* For ``api_management_api``: Highlight the resource
* For ``storage_account``: Highlight the resource
* For ``redis_cache``: Highlight ``enable_authentication = false``

endif::env-github,rspecator-view[]
