Disabling authentication can reduce an organization's ability to protect itself against attacks on its critical functions and data, if any.

Authentication Coupled with fine-grained authorizations helps follow the Defense-In-Depth principle and bring traceability to investigators of security incidents.

== Ask Yourself Whether

* This Azure resource is essential for the information system infrastructure.
* This Azure resource is essential for mission-critical functions.
* Compliance policies require this resource to have an authentication

There is a risk if you answered yes to any of those questions.

== Recommended Secure Coding Practices

Enable authentication in this Azure resource.

== Sensitive Code Example

----
resource "azurerm_windows_web_app" "sensitive_web_app" {
  name                = "sensitive"
  resource_group_name = azurerm_resource_group.example.name
  location            = azurerm_service_plan.example.location
  service_plan_id     = azurerm_service_plan.example.id

  auth_settings {
    enabled = false # Sensitive
  }
}
----

== Compliant Solution

----
resource "azurerm_windows_web_app" "web_app" {
  name                = "web_app"
  resource_group_name = azurerm_resource_group.example.name
  location            = azurerm_service_plan.example.location
  service_plan_id     = azurerm_service_plan.example.id

  auth_settings {
    enabled = true
    active_directory {
      client_id = "1a111a11-22b2-33cc-dd4d-55e55555e5e5"
    }
  }
}
----

== See

* https://owasp.org/Top10/A01_2021-Broken_Access_Control/[OWASP Top 10 2021 Category A1] - Boken Access Control
* https://cwe.mitre.org/data/definitions/668.html[MITRE, CWE-668] - Exposure of Resource to Wrong Sphere

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

=== Message

Make sure that disabling authentication is safe here.


endif::env-github,rspecator-view[]
