<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when a pointer is dereferenced, a field is accessed through a pointer, or a method is called on a pointer without first checking if the pointer is nil.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Go, pointers have a zero value of <code>nil</code>. When you try to dereference a nil pointer using the <code>*</code> operator, access a field through a nil pointer, or call a method on a nil pointer, the program will panic at runtime.</p>
</div>
<div class="paragraph">
<p>A panic is Go&#8217;s way of handling unrecoverable errors. When a panic occurs, the program stops normal execution and begins unwinding the stack, calling any deferred functions along the way. If the panic is not recovered, the program terminates.</p>
</div>
<div class="paragraph">
<p>Nil pointer dereference is one of the most common causes of runtime panics in Go programs. This can happen in several scenarios:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Direct dereferencing with the <code>*</code> operator on an uninitialized pointer</p>
</li>
<li>
<p>Accessing fields or calling methods on struct pointers that haven&#8217;t been initialized</p>
</li>
<li>
<p>Working with pointer chains where any link in the chain could be nil</p>
</li>
<li>
<p>Operations in data structures like linked lists, trees, or graphs where nodes may be nil</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These panics are particularly problematic because they can occur in production environments, potentially causing service outages or data loss. Unlike compile-time errors, nil pointer panics only surface when the specific code path is executed with nil values.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Runtime panics can cause immediate program termination, leading to service outages, data loss, or degraded user experience. In server applications, unhandled panics can crash entire services. The unpredictable nature of these failures makes them difficult to debug and can erode user trust in the application&#8217;s reliability.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add explicit nil checks before dereferencing pointers or accessing their fields. Use early returns or error handling to manage nil cases gracefully.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">var p *int
fmt.Println(*p) // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">var p *int
if p != nil {
    fmt.Println(*p)
} else {
    fmt.Println("pointer is nil")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Go Tour - Pointers - <a href="https://go.dev/tour/moretypes/1">Official Go tutorial explaining pointer basics and nil values</a></p>
</li>
<li>
<p>Go Tour - Interface values with nil underlying values - <a href="https://go.dev/tour/methods/12">Explains how Go handles nil receivers in method calls</a></p>
</li>
<li>
<p>Effective Go - Pointers vs Values - <a href="https://go.dev/doc/effective_go#pointers_vs_values">Best practices for using pointers in Go</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-476: NULL Pointer Dereference - <a href="https://cwe.mitre.org/data/definitions/476.html">Common weakness related to dereferencing null pointers</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S2259" class="rspec-auto-link">RSPEC-2259</a> - <a href="https://rules.sonarsource.com/csharp/RSPEC-2259/">Similar rule for other languages addressing null pointer dereference</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>