Exception stack traces contain sensitive data that the application's code should not disclose as error messages. 

== Why is this an issue?

Stack traces contain sensitive data like filenames or folder hierarchy. 
They can expose implementation details, including the application's architecture, logic, and potential vulnerabilities. 
Attackers can leverage these valuable insights to identify weaknesses, devise attack strategies, and exploit vulnerabilities.

== How to fix it

Implement proper error handling by reporting customized error messages that do not contain a detailed stack trace. Log the exception stack trace if needed.

=== Code examples

==== Noncompliant code example

[source,python,diff-id=1,diff-type=noncompliant]
----
@app.errorhandler(500)
def internal_server_error(error):
    error_message = traceback.format_stack()
    return render_template('error.html', error_message=error_message), 500
----

==== Compliant solution

[source,python,diff-id=1,diff-type=compliant]
----
@app.errorhandler(500)
def internal_server_error(error):
    error_message = "Internal Server Error"
    logging.exception(error_message)
    return render_template('error.html', error_message=error_message), 500
----

== Resources
=== Documentation

Python Documentation - https://docs.python.org/3/library/traceback.html[traceback â€” Print or retrieve a stack traceback]

=== Standards

* https://owasp.org/Top10/A04_2021-Insecure_Design/[OWASP Top 10 2021 Category A4] - Insecure Design
* https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure[OWASP Top 10 2017 Category A3] - Sensitive Data Exposure
* https://cwe.mitre.org/data/definitions/798[MITRE, CWE-209] - Generation of Error Message Containing Sensitive Information
* https://cwe.mitre.org/data/definitions/259[MITRE, CWE-489] - Active Debug Code
