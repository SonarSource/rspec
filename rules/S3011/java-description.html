<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Altering or bypassing the accessibility of classes, methods, or fields through reflection violates the encapsulation principle. This can break the internal contracts of the accessed target and lead to maintainability issues and runtime errors.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when reflection is used to change the visibility of a class, method or field, and when it is used to directly update a field value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void makeItPublic(String methodName) throws NoSuchMethodException {

  this.getClass().getMethod(methodName).setAccessible(true); // Noncompliant
}

public void setItAnyway(String fieldName, int value) {
  this.getClass().getDeclaredField(fieldName).setInt(this, value); // Noncompliant; bypasses controls in setter
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/Encapsulation_(computer_programming)">Wikipedia definition of Encapsulation</a></p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/_jZGBQ">CERT, SEC05-J.</a> - Do not use reflection to increase accessibility of classes, methods, or fields</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>This accessibility [update|bypass] should be removed.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_23_jul_2015_071531_nicolas_peru_wrote">on 23 Jul 2015, 07:15:31 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Not sure if it should be part of the description but it is not really clear if the rule is limited to the API in the example.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_23_jul_2015_090519_ann_campbell_wrote">on 23 Jul 2015, 09:05:19 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>FYI [~tamas.vajk]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_apr_2018_105330_alexandre_gigleux_wrote">on 19 Apr 2018, 10:53:30 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>This is a "Security Weakness".</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_sep_2018_102809_alexandre_gigleux_wrote">on 4 Sep 2018, 10:28:09 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.harraudeau] Review</p>
</div>
<div class="paragraph">
<p>I think you should ask yourself if this rule is only relevant for Java. If this is the case, it is no longer a Common Security Hotspot rule.</p>
</div>
<div class="paragraph">
<p>Check if C#, VB.Net are really excluded, I don&#8217;t think so. Also I believe PHP, Swift, Scala, Kotlin, Ruby should be in the list of Targeted Languages.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_sep_2018_112931_nicolas_harraudeau_wrote">on 4 Sep 2018, 11:29:31 Nicolas Harraudeau wrote:</h3>
<div class="paragraph">
<p>\[~alexandre.gigleux] Thanks for the review</p>
</div>
<div class="paragraph">
<p>Here are examples for the targeted languages: https://rosettacode.org/wiki/Break_OO_privacy</p>
</div>
<div class="paragraph">
<p>Ruby is a special case.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_6_apr_2020_120104_eric_therond_wrote">on 6 Apr 2020, 12:01:04 Eric Therond wrote:</h3>
<div class="paragraph">
<p>Altering accessibility at run-time is not possible if a security manager is configured (in Java) or the code doesn&#8217;t have the right permission (<a href="https://docs.microsoft.com/fr-fr/dotnet/framework/reflection-and-codedom/security-considerations-for-reflection">in C#</a>).</p>
</div>
<div class="paragraph">
<p>So a new security-hotspot rule could be relevant in the future to detect when a loose permission is granted that allow, for instance, external code to change accessibility of fields of a trusted code and thus access to private information, however here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The rule raises when the accessibility is changed, so basically "the consequence" and not the root cause of the bug is highlighted.</p>
</li>
<li>
<p>Reflection will be most of the times used to create dynamic types or to perform debugging.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So a code smell is more appropriate than a security rule.</p>
</div>
</div>
</div>
</div>