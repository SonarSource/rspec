<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>XML signatures are a method used to ensure the integrity and authenticity of XML
documents. However, if XML signatures are not validated securely, it can lead to
potential vulnerabilities.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>XML can be used for a wide variety of purposes. Using a signature on an XML
message generally indicates this message requires authenticity and integrity.
However, if the signature validation is not properly implemented this
authenticity can not be guaranteed.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>By not enforcing secure validation, the XML Digital Signature API is more
susceptible to attacks such as signature spoofing and injections.</p>
</div>
</div>
<div class="sect2">
<h3 id="_increased_vulnerability_to_signature_spoofing">Increased Vulnerability to Signature Spoofing</h3>
<div class="paragraph">
<p>By disabling secure validation, the application becomes more susceptible to
signature spoofing attacks. Attackers can potentially manipulate the XML
signature in a way that bypasses the validation process, allowing them to forge
or tamper with the signature. This can lead to the acceptance of invalid or
maliciously modified signatures, compromising the integrity and authenticity of
the XML documents.</p>
</div>
</div>
<div class="sect2">
<h3 id="_risk_of_injection_attacks">Risk of Injection Attacks</h3>
<div class="paragraph">
<p>Disabling secure validation can expose the application to injection attacks.
Attackers can inject malicious code or entities into the XML document, taking
advantage of the weakened validation process. In some cases, it can also expose
the application to denial-of-service attacks. Attackers can exploit
vulnerabilities in the validation process to cause excessive resource
consumption or system crashes, leading to service unavailability or disruption.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_signxml">How to fix it in SignXML</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="paragraph">
<p>The following noncompliant code example verifies an XML signature without
providing a trusted signing authority. This code will accept any signature
created from a generally trusted certificate, for example, a Let&#8217;s encrypt one.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from lxml import etree
from signxml import XMLVerifier

xml_file = open("signed.xml", "rb")
xml = etree.parse(xml_file)

XMLVerifier().verify(xml) # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from lxml import etree
from signxml import XMLVerifier

xml_file = open("signed.xml", "rb")
xml = etree.parse(xml_file)

cert_file = open("cert.pem", "rb")
cert = cert_file.read()
XMLVerifier().verify(xml, x509_cert=cert)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>Here, the compliant solution provides a trusted certificate to the signature validation function. This will ensure only signatures computed with the
private key associated with the provided certificate will be accepted.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Change this code to only accept signatures computed from a trusted party.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlight">Highlight</h3>
<div class="paragraph">
<p>When no <code>expect_config</code> is provided:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Highlight the call to the <code>verify</code> method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When an <code>expect_config</code> is provided:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Highlight the <code>verify</code> call.</p>
</li>
<li>
<p>As a secondary location, highlight the <code>require_x509=False</code> in the
<code>SignatureConfiguration</code> instantiation.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">Top 10:2021 A02:2021 - Cryptographic Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/347">CWE-347 - Improper Verification of Cryptographic Signature</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222608">Application Security and Development: V-222608</a> - The application must not be vulnerable to XML-oriented attacks.</p>
</li>
</ul>
</div>
</div>
</div>
</div>