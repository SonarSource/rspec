<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>webSecurity</code> flag in Electron applications controls the security settings for web content.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When this flag is disabled, it allows the application to load and execute content from any source, including potentially unsafe ones.
This vulnerability can be exploited when a user interacts with untrusted web content, such as clicking on a malicious link or opening a compromised webpage.
The attacker can then inject harmful scripts or code into the application, bypassing the usual security restrictions.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>When the <code>webSecurity</code> flag is disabled, it opens the door to various types of attacks that can compromise the integrity and security of the application and its users.</p>
</div>
<div class="sect3">
<h4 id="_code_execution">Code Execution</h4>
<div class="paragraph">
<p>When the <code>webSecurity</code> flag is off, attackers can inject malicious scripts into the application and execute arbitrary code.
These scripts can steal sensitive information such as user credentials or sessions, personal data, and financial information.
This can lead to identity theft and financial loss for users.</p>
</div>
</div>
<div class="sect3">
<h4 id="_phishing_attacks">Phishing Attacks</h4>
<div class="paragraph">
<p>With the <code>webSecurity</code> flag disabled, attackers can create convincing phishing pages within the application.
These pages can trick users into providing sensitive information, believing they are interacting with a legitimate part of the application.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="paragraph">
<p>To fix the <code>webSecurity</code> flag vulnerability in Electron applications, you should not use the <code>disablewebsecurity</code> attribute for <code>webview</code> tags. The security restrictions on web content loaded by your application are enabled per default.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;webview disablewebsecurity src="page.html"&gt;&lt;/webview&gt;&lt;!-- noncompliant --&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;webview src="page.html"&gt;&lt;/webview&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>The compliant example does not disable <code>websecurity</code>. The default setting is secure.</p>
</div>
</div>
<div class="sect2">
<h3 id="_going_the_extra_mile">Going the extra mile</h3>
<div class="paragraph">
<p>A Content Security Policy helps prevent the injection of malicious content.
Define a CSP that restricts the sources of content that can be loaded by your application.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">mainWindow.webContents.session.webRequest.onHeadersReceived((details, callback) =&gt; {
  callback({
    responseHeaders: {
      ...details.responseHeaders,
      'Content-Security-Policy': ["default-src 'self'; script-src 'self' https://example.com"]
    }
  });
});</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Electron Documentation - <a href="https://www.electronjs.org/docs/latest/tutorial/security#6-do-not-disable-websecurity">Security - Do not disable webSecurity</a></p>
</li>
<li>
<p>Electron Documentation - <a href="https://www.electronjs.org/docs/latest/api/browser-window#new-browserwindowoptions">BrowserWindow - Options</a></p>
</li>
<li>
<p>Electron Documentation - <a href="https://www.electronjs.org/docs/latest/api/webview-tag#disablewebsecurity">disablewebsecurity</a></p>
</li>
<li>
<p>MDN web docs - <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">Content Security Policy (CSP)</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>Change this code to enable web security.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Highlight the <code>webSecurity</code> flag (Javascript) or the <code>disablewebsecurity</code> attribute (HTML).</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
</div>
</div>