== Why is this an issue?

https://en.wikipedia.org/wiki/Arithmetic_shift[Shifting] an integral number by 0 is equivalent to doing nothing but makes the code confusing for maintainers.

Shifting an integral number by a value greater than their count of bits minus one is equivalent to shifting by the value https://en.wikipedia.org/wiki/Modulo[modulo] the bit count of the number.

If the first operand is an `int` or `uint` (32-bit quantity), the shift count is given by the five low-order bits of the second operand. That is, the actual shift count is 0 to 31 bits. This means that numbers having the same five low-order bits are treated the same by the shift-operators.

[source,csharp]
----
var one =         0b0_00001;
var thirtyThree = 0b1_00001; // Same five low-order bits, 33 mod 32 = 1
----

Note that integral number with a less than 32-bit quantity (e.g. `short`, `ushort`...) are implicitly converted to `int` before the shifting operation and so the rule for `int`/`uint` applies.

If the first operand is a `long` or `ulong` (64-bit quantity), the shift count is given by the low-order six bits of the second operand. That is, the actual shift count is 0 to 63 bits.

include::../exceptions.adoc[]

== How to fix it

=== Code examples

==== Noncompliant code example

[source,csharp,diff-id=1,diff-type=noncompliant]
----
short s = 1;
short shortShift1 = (short)(s << 0); // Noncompliant: The value does not change
short shortShift2 = (short)(s << 33); // Noncompliant: this is equivalent to shifting by 1

int i = 1;
int intShift = i << 33; // Noncompliant: this is equivalent to shifting by 1

long lg = 1;
long longShift1 = lg << 0; // Noncompliant: the value does not change
long longShift2 = lg << 65; // Noncompliant: this is equivalent to shifting by 1
----

==== Compliant solution

[source,csharp,diff-id=1,diff-type=compliant]
----
short s = 1;
short shortShift1 = s;
short shortShift2 = (short)(s << 1);

int i = 1;
var intShift = i << 1;

long lg = 1;
var longShift1 = lg;
var longShift2 = lg << 1;
----

== Resources

* Microsoft Learn - https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/bitwise-and-shift-operators#left-shift-operator-[Bitwise and shift operators (C# reference)]
* Wikipedia - https://en.wikipedia.org/wiki/Arithmetic_shift[Arithmetic shift]
* Wikipedia - https://en.wikipedia.org/wiki/Modulo[Modulo]

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::../message.adoc[]

'''
== Comments And Links
(visible only on this page)

include::../comments-and-links.adoc[]

endif::env-github,rspecator-view[]
