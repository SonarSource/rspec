<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When working with collections that are known to be non-empty, using <a href="https://learn.microsoft.com/en-us/dotnet/api/system.linq.enumerable.first">First</a> or <a href="https://learn.microsoft.com/en-us/dotnet/api/system.linq.enumerable.single">Single</a> is generally preferred over <a href="https://learn.microsoft.com/en-us/dotnet/api/system.linq.enumerable.firstordefault">FirstOrDefault</a> or <a href="https://learn.microsoft.com/en-us/dotnet/api/system.linq.enumerable.singleordefault">SingleOrDefault</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using <code>FirstOrDefault</code> or <code>SingleOrDefault</code> on collections that are known to be non-empty is an issue due to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Code Clarity and intent: When you use <code>FirstOrDefault</code> or <code>SingleOrDefault</code>, it implies that the collection might be empty, which can be misleading if you know it is not. It can be confusing for other developers who read your code, making it harder for them to understand the actual constraints and behavior of the collection. This leads to confusion and harder-to-maintain code.</p>
</li>
<li>
<p>Error handling: If the developer&#8217;s intend is for the collection not to be empty, using <code>FirstOrDefault</code> and <code>SingleOrDefault</code> can lead to subtle bugs. These methods return a default value (<code>null</code> for reference types and <code>default</code> for value types) when the collection is empty, potentially causing issues like <code>NullReferenceException</code> later in the code. In contrast, <code>First</code> or <code>Single</code> will throw an <code>InvalidOperationException</code> immediately if the collection is empty, making it easier to detect and address issues early in the development process.</p>
</li>
<li>
<p>Code coverage: Potentially, having to check if the result is <code>null</code>, you introduces a condition that cannot be fully tested, impacting the code coverage.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">var items = new List&lt;int&gt; { 1, 2, 3 };

int firstItem = items.FirstOrDefault(); // Noncompliant, this implies the collection might be empty, when we know it is not</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">var items = new List&lt;int&gt; { 1, 2, 3 };

int firstItem = items.First(); // Compliant</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.linq.enumerable.single"><code>Single</code></a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.linq.enumerable.first"><code>First</code></a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.linq.enumerable.singleordefault"><code>SingleOrDefault</code></a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.linq.enumerable.firstordefault"><code>FirstOrDefault</code></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://medium.com/@anyanwuraphaelc/first-vs-firstordefault-single-vs-singleordefault-a-high-level-look-d24db17a2bc3">First vs FirstOrDefault, Single vs SingleOrDefault: A High-level Look</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>You should use [Single/First] instead of [SingleOrDefault/FirstOfDefault] as the collection xxx here is never empty.</p>
</div>
</div>
</div>
</div>