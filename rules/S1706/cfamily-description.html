<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While exceptions are a common feature of modern languages, there are several reasons to potentially avoid them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They make the control flow of a program more difficult to understand because they introduce additional hidden exit points.</p>
</li>
<li>
<p>It is difficult to introduce them gradually in a codebase that was not designed with exceptions in mind.</p>
</li>
<li>
<p>They add to the size of each binary produced, thereby increasing both compile time and final executable size.</p>
</li>
<li>
<p>They may incur a small performance penalty.</p>
</li>
<li>
<p>The time required to handle an exception is not easy to assess, which makes them difficult to use for hard real-time applications.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a project decides not to use exceptions, some other error-handling mechanisms must be used. One option is to immediately terminate the process when unrecoverable errors are detected. Another one is to use the return value of the functions to convey error information and explicitly check for this value at the call sites. This error information then has to be manually propagated up the call stack until reaching a point where recovery is possible.</p>
</div>
<div class="paragraph">
<p>Starting with C&#43;&#43;23, the standard library provides the <code>std::expected</code> class that allows packing into a single object either the normal return value of a function when the execution succeeded or some error information when it failed. This type also simplifies checking for errors at the call site.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an exception is thrown</p>
</li>
<li>
<p>a <code>try</code>-<code>catch</code> block is used</p>
</li>
<li>
<p>an exception specification (<code>throw(xxx)</code>) is present.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The rule applies both for C&#43;&#43; and Objective-C exception mechanisms.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">enum class MyFunctionErrors{NotALetter, NotUppercase};
double myfunction(char param) throw(MyFunctionErrors); // Noncompliant

void f() {
  try // Noncompliant
  {
    doSomething();
    throw std::runtime_error{"some error"}; // Noncompliant
  }
  catch (...)
  {
    // handle exception
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">enum class MyFunctionErrors{NotALetter, NotUppercase};
std::expected&lt;double, MyFunctionErrors&gt; myfunction(char param); // Compliant
void functionThatShallNotFail() noexcept; // Compliant

bool f() {
  if (!doSomething()); {
    // Handle the situation
    return false;
  }
  // Rest of the code
  return true;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p><code>noexcept</code> specifications are ignored because even if you choose not to use exceptions in your code, it&#8217;s important to decorate as <code>noexcept</code> certain functions (for instance, move constructors that do not <code>throw</code>, see <a data-rspec-id="S5018" class="rspec-auto-link">S5018</a>). This decoration can be detected by type traits, and some meta-programming techniques rely on this information.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Remove this exception</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_6_nov_2018_200646_ann_campbell_wrote">on 6 Nov 2018, 20:06:46 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~loic.joly] this phrase is odd to me "hard real-time applications" . I doubt "hard" is what you mean here (unless it&#8217;s an industry term I&#8217;m unaware of?).</p>
</div>
<div class="paragraph">
<p>Also, this seems to come out of nowhere:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Even if you choose not to use exceptions in your code, it&#8217;s important to decorate as noexcept some functions (for instance, move constructors that do not throw), because this decoration can be detected by type traits, and some meta-programming techniques rely on this information.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Does this mean you&#8217;ll raise an issue if I don&#8217;t use <code>noexcept</code>?. Also, <em>which</em> functions other than move constructors?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_7_nov_2018_091020_lo誰c_joly_wrote">on 7 Nov 2018, 09:10:20 Lo誰c Joly wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Hard real-time is a term I&#8217;ve heard in many places, and I&#8217;ve just checked https://en.wikipedia.org/wiki/Real-time_computing where it is present.</p>
</div>
<div class="paragraph">
<p>No, we&#8217;re not going to check anything related to noexcept (in this rule).  No longer. Current implementation flags <code>noexcept</code> as a violation, which is wrong: even if <code>noexcept</code> is something related to exceptions, it is valid to use it in a context where exception are forbidden.</p>
</div>
<div class="paragraph">
<p>I updated this RSPEC in preparation for the correction of the related false positive reported in SUPPORT-10182.</p>
</div>
<div class="paragraph">
<p>I changed the formulation, trying to make it clearer. Tell me what you think?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_7_nov_2018_201845_ann_campbell_wrote">on 7 Nov 2018, 20:18:45 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>It&#8217;s clearer [~loic.joly]. Also, it&#8217;s not immediately clear to me why catching the exceptions from the code someone else wrote that I&#8217;m forced to use would raise an issue. A little expansion on that topic might be helpful.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_nov_2018_094824_lo誰c_joly_wrote">on 8 Nov 2018, 09:48:24 Lo誰c Joly wrote:</h3>
<div class="paragraph">
<p>From what I&#8217;ve seen from people who want to avoid exceptions, it&#8217;s not that they want to avoid them in their code, they want to avoid them in the whole program (even disabling exception support in the compiler). If they use external code that might throw:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Either they make sure to use it only in way that won&#8217;t trigger an exception (just a subset of the API, or manually checking some stuff <em>before</em> calling throwing functions)</p>
</li>
<li>
<p>Or they just don&#8217;t use it</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>I&#8217;m not sure how to explain that however. I&#8217;m not even sure it needs explaining for the users who decided to opt-in this rule;)</p>
</div>
</div>
</div>
</div>