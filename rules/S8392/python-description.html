<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is an issue when a FastAPI application uses <code>uvicorn.run()</code> with <code>host="0.0.0.0"</code>, which binds the application to all available network interfaces on the host machine.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you start a FastAPI application, you need to specify which network interface it should listen on. A network interface is a connection point between your computer and a network.</p>
</div>
<div class="paragraph">
<p>The special IP address <code>0.0.0.0</code> tells the application to bind to <strong>all</strong> network interfaces on the machine. This means the application becomes accessible from:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The local machine (localhost)</p>
</li>
<li>
<p>The local network (LAN)</p>
</li>
<li>
<p>Any public-facing network interfaces</p>
</li>
<li>
<p>Virtual network interfaces</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This broad exposure violates the principle of least privilege, which states that a system should only have access to the resources it needs to function. By binding to all interfaces, you&#8217;re making your application accessible from networks where it shouldn&#8217;t be reachable.</p>
</div>
<div class="paragraph">
<p>In development environments, this is particularly risky because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Development servers often lack production security measures</p>
</li>
<li>
<p>Debug mode may be enabled, exposing sensitive information</p>
</li>
<li>
<p>Authentication and authorization might not be fully implemented</p>
</li>
<li>
<p>The application may contain test data or incomplete features</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Even in production environments, binding to <code>0.0.0.0</code> should be a deliberate choice made with proper security controls in place, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Firewalls restricting access to specific IP addresses</p>
</li>
<li>
<p>Reverse proxies handling TLS/SSL termination</p>
</li>
<li>
<p>Network segmentation isolating the application</p>
</li>
<li>
<p>Container orchestration platforms managing network access</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When these controls are absent, binding to all interfaces creates an unnecessarily large attack surface.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Binding to all network interfaces can lead to several security risks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Unauthorized access</strong>: Attackers on the same network or the internet can reach your application, potentially exploiting vulnerabilities or accessing sensitive data.</p>
</li>
<li>
<p><strong>Information disclosure</strong>: Debug endpoints, error messages, or development features may leak sensitive information about your application&#8217;s structure, dependencies, or data.</p>
</li>
<li>
<p><strong>Lateral movement</strong>: If an attacker compromises your network, an exposed development server can serve as an entry point to other systems.</p>
</li>
<li>
<p><strong>Data breaches</strong>: Unprotected applications may expose user data, API keys, database credentials, or other confidential information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The severity depends on the environment and what security controls are in place, but the risk is highest in development environments where security measures are typically minimal.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For development and local testing, bind to localhost (<code>127.0.0.1</code> or <code>localhost</code>) instead of all interfaces. This ensures the application is only accessible from your local machine.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import uvicorn
from fastapi import FastAPI

app = FastAPI()

if __name__ == "__main__":
    uvicorn.run(app, host="0.0.0.0", port=8000)  # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import uvicorn
from fastapi import FastAPI

app = FastAPI()

if __name__ == "__main__":
    uvicorn.run(app, host="127.0.0.1", port=8000)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>FastAPI Documentation - Deployment Concepts - <a href="https://fastapi.tiangolo.com/deployment/concepts/">Official FastAPI documentation on deployment concepts, including network binding considerations</a></p>
</li>
<li>
<p>Uvicorn Documentation - Deployment - <a href="https://www.uvicorn.org/deployment/">Uvicorn server documentation on deployment and configuration options</a></p>
</li>
<li>
<p>FastAPI CLI Documentation - <a href="https://fastapi.tiangolo.com/fastapi-cli/">Documentation explaining the difference between development (127.0.0.1) and production (0.0.0.0) binding</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE 668 - <a href="https://cwe.mitre.org/data/definitions/668.html">Exposure of Resource to Wrong Sphere</a></p>
</li>
<li>
<p>CIS 6.6.1 - <a href="https://www.cisecurity.org/controls/">CIS Controls - Network Security</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>