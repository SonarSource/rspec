<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A method with a <code>@RequestMapping</code> annotation part of a class annotated with <code>@Controller</code> (directly or indirectly through a meta annotation - <code>@RestController</code> from Spring Boot is a good example) will be called to handle matching web requests. That will happen even if the method is <code>private</code>, because Spring invokes such methods via reflection, without checking visibility.</p>
</div>
<div class="paragraph">
<p>So marking a sensitive method <code>private</code> may seem like a good way to control how such code is called. Unfortunately, not all Spring frameworks ignore visibility in this way. For instance, if you&#8217;ve tried to control web access to your sensitive, <code>private</code>, <code>@RequestMapping</code> method by marking it <code>@Secured</code> &#8230;&#8203; it will still be called, whether or not the user is authorized to access it. That&#8217;s because AOP proxies are not applied to private methods.</p>
</div>
<div class="paragraph">
<p>In addition to <code>@RequestMapping</code>, this rule also considers the annotations introduced in Spring Framework 4.3: <code>@GetMapping</code>, <code>@PostMapping</code>, <code>@PutMapping</code>, <code>@DeleteMapping</code>, <code>@PatchMapping</code>.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RequestMapping("/greet", method = GET)
private String greet(String greetee) {  // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RequestMapping("/greet", method = GET)
public String greet(String greetee) {</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make this method non "private".</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p><code>protected String methodName</code></p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_14_oct_2016_202104_ann_campbell_wrote">on 14 Oct 2016, 20:21:04 Ann Campbell wrote:</h3>
<div class="paragraph">
<p><a href="https://sebastian.marsching.com/blog/archives/149-Springs-RequestMapping-annotation-works-on-private-methods.html" class="bare">https://sebastian.marsching.com/blog/archives/149-Springs-RequestMapping-annotation-works-on-private-methods.html</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_on_23_feb_2018_151632_alexandre_gigleux_wrote">on 23 Feb 2018, 15:16:32 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>@Controller = org.springframework.stereotype.Controller</p>
</div>
<div class="paragraph">
<p>@RestController = org.springframework.web.bind.annotation.RestController</p>
</div>
<div class="paragraph">
<p>@RequestMapping = org.springframework.web.bind.annotation.RequestMapping</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_26_oct_2020_170517_alexandre_gigleux_wrote">on 26 Oct 2020, 17:05:17 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>I&#8217;m changing the severity from Blocker to Major because the vulnerability is not directly exploitable. No CVEs were raised in the past because of this misconfiguration which is also an indicator that the rule should not be a Blocker one.</p>
</div>
</div>
</div>
</div>