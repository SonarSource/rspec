<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when Apex code accesses or modifies sObject fields without first verifying that the current user has the necessary field-level permissions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Apex code runs in system context by default, which means it bypasses normal user permissions and field-level security (FLS) restrictions. This can lead to serious security vulnerabilities.</p>
</div>
<div class="paragraph">
<p>When developers write SOQL queries or perform DML operations without checking field permissions, they risk exposing sensitive data to unauthorized users. For example, a user might be able to access salary information, social security numbers, or other confidential fields that should be restricted based on their profile and permission sets.</p>
</div>
<div class="paragraph">
<p>Field-level security is a fundamental security control in Salesforce that ensures users can only access data they&#8217;re authorized to see. When this control is bypassed in Apex code, it creates a security gap that could be exploited.</p>
</div>
<div class="paragraph">
<p>The Salesforce platform provides built-in mechanisms to check these permissions through Schema describe methods. These methods allow developers to verify user permissions before performing data operations, ensuring that the principle of least privilege is maintained even in system context.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Unauthorized users may gain access to sensitive field data they shouldn&#8217;t be able to see or modify. This could lead to data breaches, privacy violations, and compliance issues. In regulated industries, such violations could result in significant fines and legal consequences.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before reading field data, check if the current user has read access using the <code>isAccessible()</code> method on the field&#8217;s describe result.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">List&lt;Opportunity&gt; opps = [SELECT ExpectedRevenue FROM Opportunity]; // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">if (!Schema.sObjectType.Opportunity.fields.ExpectedRevenue.isAccessible()) {
    throw new SecurityException('Insufficient field access');
}
List&lt;Opportunity&gt; opps = [SELECT ExpectedRevenue FROM Opportunity];</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Salesforce Trailhead - Write Secure Apex Controllers - <a href="https://trailhead.salesforce.com/content/learn/modules/secure-serverside-development/write-secure-apex-controllers">Official Salesforce documentation on enforcing field-level security in Apex code</a></p>
</li>
<li>
<p>DescribeSObjectResult Class - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_methods_system_sobject_describe.htm">Documentation for Schema.DescribeSObjectResult methods including isAccessible(), isCreateable(), and isUpdateable()</a></p>
</li>
<li>
<p>DescribeFieldResult Class - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_methods_system_fields_describe.htm">Documentation for Schema.DescribeFieldResult methods for field-level permission checks</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-862: Missing Authorization - <a href="https://cwe.mitre.org/data/definitions/862.html">The software does not perform an authorization check when an actor attempts to access a resource or perform an action</a></p>
</li>
<li>
<p>OWASP Top 10:2021-A01-Broken Access Control - <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">Failures related to access control that allow unauthorized access to functionality or data</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>