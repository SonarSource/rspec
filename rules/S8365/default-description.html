<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when temporary files are created in Jenkins pipelines but are not explicitly deleted after use.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jenkins pipelines often handle sensitive data through file uploads or temporary file creation. When these files are not properly cleaned up, they remain on the Jenkins master or workspace, creating security vulnerabilities.</p>
</div>
<div class="paragraph">
<p>Temporary files may contain:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Uploaded configuration files with credentials</p>
</li>
<li>
<p>User data from form submissions</p>
</li>
<li>
<p>Build artifacts with sensitive information</p>
</li>
<li>
<p>Intermediate processing files</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If these files are not deleted, they can be accessed by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Other pipeline executions</p>
</li>
<li>
<p>Users with workspace access</p>
</li>
<li>
<p>Malicious actors who gain system access</p>
</li>
<li>
<p>Automated processes that scan file systems</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Jenkins master and agent file systems are shared resources. Files left behind from one pipeline execution can be discovered and accessed by subsequent executions or other users, leading to data leakage and potential security breaches.</p>
</div>
<div class="paragraph">
<p>Proper file cleanup is essential for maintaining data confidentiality and preventing unauthorized access to sensitive information in CI/CD environments.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Sensitive data may be exposed to unauthorized users or processes. This can lead to credential theft, data breaches, or compliance violations. In shared Jenkins environments, temporary files from one project could be accessed by users of other projects.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Always delete file objects created through Jenkins input steps after processing them. Use the delete() method to remove files from the Jenkins master.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">def inputFile = input message: 'Upload file', parameters: [file(name: 'data_upload')]
writeFile(file: 'temp.dat', encoding: 'Base64', text: inputFile.read().getBytes().encodeBase64().toString())
// File is not cleaned up // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">def inputFile = input message: 'Upload file', parameters: [file(name: 'data_upload')]
writeFile(file: 'temp.dat', encoding: 'Base64', text: inputFile.read().getBytes().encodeBase64().toString())
// Remove the file from the master to avoid data leakage
inputFile.delete()</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Jenkins Pipeline File Input - <a href="https://www.jenkins.io/doc/pipeline/steps/pipeline-input-step/">Official documentation for Jenkins pipeline input step including file parameters</a></p>
</li>
<li>
<p>Jenkins Pipeline Utility Steps - <a href="https://www.jenkins.io/doc/pipeline/steps/pipeline-utility-steps/">Documentation for writeFile and other file manipulation steps in Jenkins pipelines</a></p>
</li>
<li>
<p>Jenkins Security Best Practices - <a href="https://www.jenkins.io/doc/book/security/">General security guidelines for Jenkins including file handling recommendations</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP Top 10 2021 A1 - <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">Broken Access Control - improper file cleanup can lead to unauthorized data access</a></p>
</li>
<li>
<p>CWE 200 - <a href="https://cwe.mitre.org/data/definitions/200.html">Information Exposure - temporary files may expose sensitive information</a></p>
</li>
<li>
<p>CWE 459 - <a href="https://cwe.mitre.org/data/definitions/459.html">Incomplete Cleanup - failure to properly clean up temporary files</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>