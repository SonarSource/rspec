<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when Apex classes or methods lack explicit access modifiers (<code>private</code>, <code>public</code>, or <code>global</code>).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Apex, classes and methods without explicit access modifiers default to package-private visibility. This implicit behavior can lead to several problems:</p>
</div>
<div class="paragraph">
<p><strong>Security concerns</strong>: Without explicit modifiers, you might unintentionally expose sensitive functionality or data to other classes in the same package. This creates potential security vulnerabilities where unauthorized code could access methods that should be private.</p>
</div>
<div class="paragraph">
<p><strong>Unclear intent</strong>: When access modifiers are missing, it&#8217;s unclear whether the developer intended the default visibility or simply forgot to specify it. This ambiguity makes code harder to understand and maintain.</p>
</div>
<div class="paragraph">
<p><strong>Maintenance difficulties</strong>: As your codebase grows, implicit access levels make it harder to understand the intended API boundaries. This can lead to tight coupling between classes and make refactoring more difficult.</p>
</div>
<div class="paragraph">
<p><strong>Code review challenges</strong>: Without explicit modifiers, reviewers cannot easily verify that the access level matches the intended design, potentially allowing inappropriate access patterns to slip through.</p>
</div>
<div class="paragraph">
<p>Explicit access modifiers serve as documentation of your design intent and help enforce proper encapsulation principles.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Missing access modifiers can lead to unintended exposure of sensitive methods or data, creating security vulnerabilities. It also reduces code maintainability and makes it harder for teams to understand and modify the codebase safely.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add explicit access modifiers to classes and methods based on their intended usage. Use <code>private</code> for internal implementation details, <code>public</code> for methods that should be accessible within the same package, and <code>global</code> only when cross-namespace access is required.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">class AccountHelper {
    void updateAccountStatus(Id accountId) { // Noncompliant
        Account acc = [SELECT Id, Status__c FROM Account WHERE Id = :accountId];
        acc.Status__c = 'Active';
        update acc;
    }

    String formatAccountName(String name) { // Noncompliant
        return name.toUpperCase();
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">public class AccountHelper {
    public static void updateAccountStatus(Id accountId) {
        Account acc = [SELECT Id, Status__c FROM Account WHERE Id = :accountId];
        acc.Status__c = 'Active';
        update acc;
    }

    private static String formatAccountName(String name) {
        return name.toUpperCase();
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Apex Access Modifiers - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_classes_access_modifiers.htm">Official Salesforce documentation on Apex access modifiers and their usage</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-668: Exposure of Resource to Wrong Sphere - <a href="https://cwe.mitre.org/data/definitions/668.html">Weakness related to exposing resources to unintended spheres of access</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S1784" class="rspec-auto-link">S1784</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>