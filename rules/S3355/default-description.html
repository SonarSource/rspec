<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This vulnerability exposes the application to failures of a wide range of
application-specific features the Strut filter was supposed to perform, such as
authentication, logging, encryption, and more.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Filters are used to intercept requests and responses from a server and allow
developers to manipulate them. When a <code>filter</code> is declared, but the
corresponding <code>filter assignment</code> is inadvertently not, then the code is
vulnerable to security problems or business logic instability.</p>
</div>
<div class="paragraph">
<p>If a filter is defined in the web application descriptor file <code>web.xml</code> but is
not used in a "filter mapping", this is an indication that it may have been
forgotten.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>If a filter is not used in a <code>&lt;filter-mapping&gt;</code> element, it will not be
called. Below are some examples of the impact of this oversight.</p>
</div>
<div class="sect3">
<h4 id="_unauthorized_access">Unauthorized access</h4>
<div class="paragraph">
<p>One of the main uses of Struts filters is to provide security measures such as
authentication and authorization. If a filter is forgotten in the filter
mappings, unauthorized users could gain access to sensitive data or perform
actions that they are not authorized to perform.</p>
</div>
</div>
<div class="sect3">
<h4 id="_functional_problems">Functional problems</h4>
<div class="paragraph">
<p>Filters can also be used to modify requests and responses, format data, or even
handle errors. If these features are not included in the filter mappings, they
may not work as expected, resulting in a poor user experience or even
application crash.</p>
</div>
</div>
<div class="sect3">
<h4 id="_performance_issues">Performance issues</h4>
<div class="paragraph">
<p>Some filters are designed to improve the performance of your application, such
as those that implement caching strategies. If these are not mapped, you may
experience slow response times or increased server load on your application.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;filter&gt;
    &lt;filter-name&gt;ValidationFilter&lt;/filter-name&gt; &lt;!-- Noncompliant --&gt;
    &lt;filter-class&gt;com.myco.servlet.ValidationFilter&lt;/filter-class&gt;
&lt;/filter&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;filter&gt;
    &lt;filter-name&gt;ValidationFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;com.myco.servlet.ValidationFilter&lt;/filter-class&gt;
&lt;/filter&gt;

&lt;filter-mapping&gt;
    &lt;filter-name&gt;ValidationFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Struts Docs - <a href="https://struts.apache.org/core-developers/web-xml">Web.xml Developpers Guide</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">Top 10 2021 Category A5 - Security Misconfiguration</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>"xxx" filter should have a mapping.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>