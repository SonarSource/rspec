=== How to fix it in Java Standard Edition

include::../../common/fix/code_rationale.adoc[]

[cols="a"]
|===
h| Non-compliant code example
|
[source,csharp]
----
public IActionResult authenticate(string user, string pass)
{
    using (var connection = new SqlConnection(connString))
    {
        var query = "SELECT * FROM users WHERE user = '" + user + "' AND pass = '" + pass + "'";
        
        try
        {
            var products = connection.QueryFirst<User>(sql);
        }
        catch (InvalidOperationException e)
        {
            Unauthorized();
        }
    }

    return Ok(AUTHENTICATION_SUCCESS);
}
----
h| Compliant solution
|
[source,csharp]
----
public IActionResult authenticate(string user, string pass)
{
    using (var connection = new SqlConnection(connString))
    {
        var parameters = new { UserName = user, Password = pass};
        var query      = "SELECT * FROM users WHERE user = @UserName AND password = @Password";
        
        try
        {
            var products = connection.QueryFirst<User>(sql, parameters);
        }
        catch (InvalidOperationException e)
        {
            Unauthorized();
        }
    }

    return Ok(AUTHENTICATION_SUCCESS);
}
----
|===

=== How does this work?

include::../../common/fix/prepared_statements.adoc[]

