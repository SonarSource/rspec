This rule raises an issue when Apex code references Salesforce API versions 7.0 through 30.0, which were retired after the Summer '22 release, or 21.0 through 30.0, which were retired after the Summer '25 release.


== Why is this an issue?

Salesforce retired API versions 7.0 through 20.0 after the Summer '22 release, and API version 21.0 through 30.0 after the Summer '25 release, to improve platform security, performance, and maintainability.

Using retired API versions creates several critical problems:

**Functionality Loss**: Retired API versions no longer receive updates or bug fixes. Applications relying on these versions may experience unexpected behavior or complete failure.

**Security Vulnerabilities**: Older API versions lack modern security enhancements and patches. This exposes applications to potential security risks that have been addressed in newer versions.

**Integration Failures**: External systems and third-party integrations may stop working when they attempt to connect using retired API versions. This can break critical business processes.

== How to fix it in Salesforce

Update API version references to use a supported version (21.0 or higher). Review Salesforce release notes to choose an appropriate current version that supports your required functionality.

=== Code examples

==== Noncompliant code example

[source,apex,diff-id=1,diff-type=noncompliant]
----
// Making a web service callout with retired API version
HttpRequest req = new HttpRequest();
req.setEndpoint('https://myinstance.salesforce.com/services/data/v20.0/sobjects/Account'); // Noncompliant
req.setMethod('GET');
----

==== Compliant solution

[source,apex,diff-id=1,diff-type=compliant]
----
// Making a web service callout with supported API version
HttpRequest req = new HttpRequest();
req.setEndpoint('https://myinstance.salesforce.com/services/data/v58.0/sobjects/Account');
req.setMethod('GET');
----

==== Noncompliant code example

[source,apex,diff-id=2,diff-type=noncompliant]
----
// Web service reference with retired API version
public class MyWebService {
    private static final String API_VERSION = '15.0'; // Noncompliant
    private static final String ENDPOINT = 'https://login.salesforce.com/services/Soap/u/' + API_VERSION;
}
----

==== Compliant solution

[source,apex,diff-id=2,diff-type=compliant]
----
// Web service reference with supported API version
public class MyWebService {
    private static final String API_VERSION = '58.0';
    private static final String ENDPOINT = 'https://login.salesforce.com/services/Soap/u/' + API_VERSION;
}
----

== Resources

=== Documentation

 * Salesforce documentation - https://help.salesforce.com/s/articleView?id=000380623&type=1[Salesforce Platform API Versions 7.0 through 20.0 Retirement]
 
 * Salesforce documentation - https://help.salesforce.com/s/articleView?id=000389618&type=1[Salesforce Platform API Versions 21.0 through 30.0 Retirement]