<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Non-encoded <a href="https://en.wikipedia.org/wiki/Control_character">control characters</a> and whitespace characters are often injected in the source code because of a bad manipulation. They are either invisible or difficult to recognize, which can result in bugs when the string is not what the developer expects. If you actually need to use a control character use their encoded version:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/ASCII">ASCII</a>, for example <code>\n</code> and <code>\t</code></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Unicode">Unicode</a>, for example <code>U+000D</code> and <code>U+0009</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This rule raises an issue when the following characters are seen in a <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/strings/">string literal</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/ASCII#Control_characters">ASCII control character</a>. (character index &lt; 32 or = 127)</p>
</li>
<li>
<p>Unicode <a href="https://en.wikipedia.org/wiki/Unicode_character_property#Whitespace">whitespace characters</a>.</p>
</li>
<li>
<p>Unicode <a href="https://en.wikipedia.org/wiki/C0_and_C1_control_codes">C0 control characters</a></p>
</li>
<li>
<p>Unicode characters <code>U+200B, U+200C, U+200D, U+2060, U+FEFF, U+2028, U+2029</code></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/strings/#verbatim-string-literals">Verbatim string literals</a> and <a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/strings/#raw-string-literals">raw string literals</a>, since they have no escape mechanism</p>
</li>
<li>
<p>The simple space character: Unicode <code>U+0020</code>, ASCII 32</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">string tabInside = "A	B";                 // Noncompliant: contains a tabulation
string zeroWidthSpaceInside = "foo​bar";     // Noncompliant: contains a U+200B character inside
Console.WriteLine(zeroWidthSpaceInside);    // Prints "foo?bar"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">string tabInside = "A\tB";                      // Compliant: escaped value
string zeroWidthSpaceInside = "foo\u200Bbar";   // Compliant: escaped value
Console.WriteLine(zeroWidthSpaceInside);        // Prints "foo?bar"</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/strings/">Strings and string literals</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Control_character">Control character</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Replace the control character at position XX by its escape sequence 'XX'.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_1_nov_2018_095615_jean_baptiste_lievremont_wrote">on 1 Nov 2018, 09:56:15 Jean-Baptiste Lievremont wrote:</h3>
<div class="paragraph">
<p>Could you please provide a Java-specific description?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_14_nov_2018_115604_alexandre_gigleux_wrote">on 14 Nov 2018, 11:56:04 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>\[~jeanbaptiste.lievremont] Done (/)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_30_sep_2019_113224_andrei_epure_wrote">on 30 Sep 2019, 11:32:24 Andrei Epure wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.harraudeau] - the <a href="https://github.com/SonarSource/sonar-clang/blob/master/src/core/analyzers/ControlCharacterCheck.cpp#L73">CPP implementation</a> looks at \n, \t, \r, 0, nonBreakableSpaceCharacterCode in combination with other characters and at characters with code &lt; 32.</p>
</div>
<div class="paragraph">
<p>On the other side, <a href="https://discuss.sonarsource.com/t/new-rule-multiple-language-remove-invisible-characters-from-your-string/512/5">this internal discussion</a> mentions all invisible spaces characters.</p>
</div>
<div class="paragraph">
<p>I guess we should aim for invisible spaces, right? And mention that in the RSPEC? Update the rule name (instead of control character, also invisible space?)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_oct_2019_110015_alban_auzeill_wrote">on 3 Oct 2019, 11:00:15 Alban Auzeill wrote:</h3>
<div class="paragraph">
<p>The Unicode characters set <a href="https://en.wikipedia.org/wiki/C0_and_C1_control_codes">C1</a> (from \u0080 to \u009F) is considered by some languages as control characters (e.g.: C# <a href="https://docs.microsoft.com/en-us/dotnet/api/system.char.iscontrol?view=netframework-4.8">Char.IsControl(Char)</a> ). But it&#8217;s not true for all encodings. For example, Windows-1250 code page encodes euro sign (€ unicode \u20AC) by using \u0080, and it&#8217;s not a control character. So if a source code is encoded using UTF-8, we can not guess what means characters between \u0080-\u00FF because it depends of the original code page used to write characters in this range before converting it to UTF-8.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_20_may_2020_111136_damien_urruty_wrote">on 20 May 2020, 11:11:36 Damien Urruty wrote:</h3>
<div class="paragraph">
<p>I think this rule could be extended (or maybe another one) to also check character literals. Examples in Java:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>String tabInside = "A B" + ' ';</pre>
</div>
</div>
<div class="paragraph">
<p>String zeroWidthSpaceInside = "foo​bar" + '​';</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_26_may_2020_151129_alban_auzeill_wrote">on 26 May 2020, 15:11:29 Alban Auzeill wrote:</h3>
<div class="paragraph">
<p>\[~damien.urruty] I agree and I created [SONARJAVA-3433]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_5_june_2023_164134_gregory_paidis_wrote">on 5 June 2023, 16:41:34 Gregory Paidis wrote:</h3>
<div class="paragraph">
<p>During a .NET LaYC sprint, i removed the following since they are neither implemented nor any implementation tickets exist:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ABAP</p>
</li>
<li>
<p>COBOL</p>
</li>
<li>
<p>Flex</p>
</li>
<li>
<p>Go</p>
</li>
<li>
<p>Javascript</p>
</li>
<li>
<p>PL/I</p>
</li>
<li>
<p>PHP</p>
</li>
<li>
<p>Python</p>
</li>
<li>
<p>RPG</p>
</li>
<li>
<p>Swift</p>
</li>
<li>
<p>T-SQL</p>
</li>
<li>
<p>VB6</p>
</li>
<li>
<p>VB.NET</p>
</li>
</ul>
</div>
</div>
</div>
</div>