<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>WebViews can be used to display web content as part of a mobile application. A
browser engine is used to render and display the content. Like a web
application, a mobile application that uses WebViews can be vulnerable to
Cross-Site Scripting if untrusted code is rendered. In the context of a WebView,
JavaScript code can exfiltrate local files that might be sensitive or even
worse, access exposed functions of the application that can result in more
severe vulnerabilities such as code injection. Thus JavaScript support should
not be enabled for WebViews unless it is absolutely necessary and the
authenticity of the web resources can be guaranteed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The WebWiew only renders static web content that does not require JavaScript code to be executed.</p>
</li>
<li>
<p>The WebView contains untrusted data that could cause harm when rendered.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is recommended to disable JavaScript support for WebViews unless it is
necessary to execute JavaScript code. Only trusted pages should be rendered.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using v4 and above of the <a href="https://pub.dev/packages/webview_flutter"><code>webview_flutter</code></a> package:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">import 'package:webview_flutter/webview_flutter.dart';

class _WebViewPageState extends State&lt;WebViewPage&gt; {
  final WebViewController _controller = WebViewController()
    ..setJavaScriptMode(JavaScriptMode.unrestricted) // Sensitive
    ..setBackgroundColor(const Color(0x00000000));

  @override
  Widget build(BuildContext context) =&gt; Scaffold();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using v3 and below of the <a href="https://pub.dev/packages/webview_flutter"><code>webview_flutter</code></a> package:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">import 'package:webview_flutter/webview_flutter.dart';

class _WebViewPageState extends State&lt;WebViewPage&gt; {
  final WebView _view = WebView(
    initialUrl: 'https://example.com',
    javascriptMode: JavascriptMode.unrestricted, // Sensitive
  );

  @override
  Widget build(BuildContext context) =&gt; Scaffold();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the <a href="https://pub.dev/packages/flutter_inappwebview"><code>flutter_inappwebview</code></a> package:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">import 'package:flutter_inappwebview/flutter_inappwebview.dart';

class _WebViewPageState extends State&lt;WebViewPage&gt; {
  final InAppWebViewController _controller = InAppWebViewController("id", _view)
    ..setOptions(InAppWebViewGroupOptions(
      // In flutter_inappwebview, JS is enabled by default
      crossPlatform: InAppWebViewOptions(), // Sensitive
    ));

  @override
  Widget build(BuildContext context) =&gt; Scaffold();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using v4 and above of the <a href="https://pub.dev/packages/webview_flutter"><code>webview_flutter</code></a> package:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">import 'package:webview_flutter/webview_flutter.dart';

class _WebViewPageState extends State&lt;WebViewPage&gt; {
  final WebViewController _controller = WebViewController()
    ..setBackgroundColor(const Color(0x00000000));

  @override
  Widget build(BuildContext context) =&gt; Scaffold();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using v3 and below of the <a href="https://pub.dev/packages/webview_flutter"><code>webview_flutter</code></a> package:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">import 'package:webview_flutter/webview_flutter.dart';

class _WebViewPageState extends State&lt;WebViewPage&gt; {
  final WebView _view = WebView(
    initialUrl: 'https://example.com',
  );

  @override
  Widget build(BuildContext context) =&gt; Scaffold();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the <a href="https://pub.dev/packages/flutter_inappwebview"><code>flutter_inappwebview</code></a> package:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">import 'package:flutter_inappwebview/flutter_inappwebview.dart';

class _WebViewPageState extends State&lt;WebViewPage&gt; {
  final InAppWebViewController _controller = InAppWebViewController("id", _view)
    ..setOptions(InAppWebViewGroupOptions(
      // In flutter_inappwebview, JS is enabled by default
      crossPlatform: InAppWebViewOptions(
        javaScriptEnabled: false,
      ),
    ));

  @override
  Widget build(BuildContext context) =&gt; Scaffold();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A03_2021-Injection/">Top 10 2021 Category A3 - Injection</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">Top 10 2017 Category A7 - Cross-Site Scripting (XSS)</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2023-risks/m8-security-misconfiguration">Mobile Top 10 2024 Category M8 - Security Misconfiguration</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/79">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S7409" class="rspec-auto-link">S7409</a> - Exposing Java objects through JavaScript interfaces is security-sensitive</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure that enabling JavaScript support is safe here.</p>
</div>
</div>
</div>
</div>