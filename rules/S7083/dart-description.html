<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://dart.dev/language/collections#control-flow-operators"><code>for</code> elements</a> should be preferred to <a href="https://api.dart.dev/stable/dart-core/Map/Map.fromIterable.html"><code>fromIterable</code></a> when building a <a href="https://api.dart.dev/stable/dart-core/Map/Map.html"><code>Map</code></a> from an <a href="https://api.dart.dev/stable/dart-core/Iterable-class.html"><code>Iterable</code></a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While it is possible to build a <code>Map</code> from an <code>Iterable</code> using <code>Map.fromIterable</code>, writing an explicit <code>for</code> loop with <code>for</code> elements should be used instead.</p>
</div>
<div class="paragraph">
<p>The main reason to prefer <code>for</code> elements is that it can be optimized by the Dart compiler for performance, depending on the iterable being visited.</p>
</div>
<div class="paragraph">
<p>Moreover, <code>for</code> elements are more idiomatic and generally easier to understand than <code>Map.fromIterable</code>, which requires explicit map type upfront, as well as the input iterable and two different lambda functions as parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">Map&lt;String, int&gt;.fromIterable( // Explicit Map&lt;String, int&gt; type required
  inputIterable,
  key: (item) =&gt; ...,          // Key generator
  value: (item) =&gt; ...,        // Value generator
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand, <code>for</code> elements are more flexible, look like normal <code>for</code> loops, and support better inference of the resulting <code>Map</code> type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">{
    for (final item in inputIterable)
        'The value is $v': v // Implicit Map&lt;String, int&gt; type inference
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>The rule only applies to the <code>fromIterable</code> factory method of <code>Map</code>. It does not apply to other <code>fromIterable</code> methods, such as the one from <code>LinkedHashMap&lt;T, U&gt;</code> in <code>dart:collection</code>.</p>
</div>
<div class="paragraph">
<p>Moreover, it only applies when all the arguments of the <code>Map.fromIterable</code> call are provided. If either the <code>key</code> or the <code>value</code> parameter is omitted, the rule does not apply.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">Map&lt;int, int&gt;.fromIterable(l1, key: (item) =&gt; ...); // OK
Map&lt;int, int&gt;.fromIterable(l1, value: (item) =&gt; ...); // OK</code></pre>
</div>
</div>
<div class="paragraph">
<p>The rule also does not apply when the <code>key</code> and <code>value</code> parameters are not inline function expressions, but variables defined elesewhere in the code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">final key = (item) =&gt; ...;
final value = (item) =&gt; ...;
Map&lt;int, int&gt;.fromIterable(l1, key: key, value: value);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to replace <code>Map.fromIterable</code> with <code>for</code> elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>replace the <code>Map&lt;String, int&gt;.fromIterable</code> call with a <code>for</code> loop over the input iterable, that is the first argument of the call</p>
</li>
<li>
<p>define the body of the <code>for</code> elements as a <code>key: value</code> pair, where <code>key</code> is the body of the key generator lambda, and <code>value</code> is body of the value generator lambda</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">Map&lt;String, int&gt;.fromIterable(
  [1, 2, 3],
  key: (v) =&gt; 'The value is $v',
  value: (v) =&gt; v,
);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">{
    for (final v in [1, 2, 3])
        'The value is $v': v
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Dart Docs - <a href="https://dart.dev/tools/linter-rules/prefer_for_elements_to_map_fromIterable">Linter rule - prefer_for_elements_to_map_fromIterable</a></p>
</li>
<li>
<p>Dart Docs - <a href="https://dart.dev/language/collections#control-flow-operators">Language - Control-flow operators</a></p>
</li>
<li>
<p>Dart API Reference - <a href="https://api.dart.dev/stable/dart-core/Map/Map.html">Map&lt;K, V&gt; class</a></p>
</li>
<li>
<p>Dart API Reference - <a href="https://api.dart.dev/stable/dart-core/Iterable-class.html">Iterable&lt;E&gt; class</a></p>
</li>
<li>
<p>Dart API Reference - <a href="https://api.dart.dev/stable/dart-core/Map/Map.fromIterable.html">Map&lt;K, V&gt;.fromIterable constructor</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use 'for' elements when building maps from iterables.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>The entire <code>Map.fromIterable</code> call, including parentheses and arguments: e.g. <code>Map&lt;String, int&gt;.fromIterable([1, 2, 3], key: (v) &#8658; 'The value is $v', value: (v) &#8658; v);</code>.</p>
</div>
</div>
</div>
</div>