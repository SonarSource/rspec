<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using host operating system namespaces can lead to compromise of the host systems.<br>
These attacks would target:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>host processes</p>
</li>
<li>
<p>host inter-process communication (IPC) mechanisms</p>
</li>
<li>
<p>network services of the local host system</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These three items likely include systems that support either the internal
operation of the Kubernetes cluster or the enterprise&#8217;s internal
infrastructure.</p>
</div>
<div class="paragraph">
<p>Opening these points to containers opens new attack surfaces for attackers who
have already successfully exploited services exposed by containers. Depending
on how resilient the cluster is, attackers can extend their attack to the
cluster by compromising the nodes from which the cluster started the process.</p>
</div>
<div class="paragraph">
<p>Host network sharing could provide a significant performance advantage for
workloads that require critical network performance. However, the successful
exploitation of this attack vector could have a catastrophic impact on
confidentiality within the cluster.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The services of this Pod are accessible to people who are not administrators of the Kubernetes cluster.</p>
</li>
<li>
<p>The cluster&#8217;s services performances do <strong>not</strong> rely on operating system namespaces.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Do not use host operating system namespaces.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: v1
kind: Pod
metadata:
  name: example
spec:
  containers:
    - name: web
      image: nginx
      ports:
        - name: web
          containerPort: 80
          protocol: TCP
  hostPID: true     # Sensitive
  hostIPC: true     # Sensitive
  hostNetwork: true # Sensitive</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: v1
kind: Pod
metadata:
  name: example
spec:
  containers:
    - name: web
      image: nginx
      ports:
        - name: web
          containerPort: 80
          protocol: TCP
  hostPID: false
  hostIPC: false
  hostNetwork: false</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/653">CWE-653 - Improper Isolation or Compartmentalization</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure it is safe to use host operating system namespaces here.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Highlight <code>host___: true</code>.</p>
</div>
</div>
</div>
</div>