<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a back reference in a regex refers to a capturing group that hasn&#8217;t been defined yet (or at all), it can never be matched. Named back references throw a warning in that case; numeric back references fail silently when they can&#8217;t match, simply making the match fail.</p>
</div>
<div class="paragraph">
<p>When the group is defined before the back reference but on a different control path (like in <code>(.)|\1</code> for example), this also leads to a situation where the back reference can never match.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">preg_match("/\\1(.)/", $str); // Noncompliant, group 1 is defined after the back reference
preg_match("/(.)\\2/", $str); // Noncompliant, group 2 isn't defined at all
preg_match("/(.)|\\1/", $str); // Noncompliant, group 1 and the back reference are in different branches
preg_match("/(?&lt;x&gt;.)|\k&lt;x&gt;/", $str); // Noncompliant, group x and the back reference are in different branches</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">preg_match("/(.)\\1/", $str);
preg_match("/(?&lt;x&gt;.)\\k&lt;x&gt;/", $str);</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Change this back reference, so that it refers to a group that can be matched before it.</p>
</div>
<div class="paragraph">
<p>Or:</p>
</div>
<div class="paragraph">
<p>Fix this back reference - it refers to a capturing group that doesn&#8217;t exist.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>Primary: The impossible back reference.</p>
</li>
<li>
<p>Secondary: The capturing group to which it refers (if any)</p>
</li>
</ul>
</div>
</div>
</div>
</div>