<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>C&#43;&#43; allows the traditional C-style casts  [E.G. <code>(int) f</code>] and functional notation casts [E.G. <code>int(f)</code>], but adds its own forms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>static_cast&lt;type&gt;(expression)</code></p>
</li>
<li>
<p><code>const_cast&lt;type&gt;(expression)</code></p>
</li>
<li>
<p><code>dynamic_cast&lt;type&gt;(expression)</code></p>
</li>
<li>
<p><code>reinterpret_cast&lt;type&gt;(expression)</code></p>
</li>
<li>
<p><code>std::bit_cast&lt;type&gt;(expression)</code> (since C&#43;&#43;20)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>C-style casts and functional notation casts are largely functionally equivalent. However, when they do not invoke a converting constructor, C-style casts are capable of performing dangerous conversions between unrelated types and of changing a variable&#8217;s <code>const</code>-ness. Attempt to do these things with an explicit C&#43;&#43;-style cast, and the compiler will catch the error. Use a C-style or functional notation cast, and it cannot.</p>
</div>
<div class="paragraph">
<p>Moreover, C&#43;&#43;20 has introduced a <code>std::bit_cast</code> as a way of reinterpreting a value as being of a different type of the same length preserving its binary representation. The behavior of such conversion when performed via C-style cast or <code>reinterpret_cast</code> is undefined.</p>
</div>
<div class="paragraph">
<p>Additionally, C&#43;&#43;-style casts are preferred because they are visually striking. The visual subtlety of a C-style or functional cast may mask that a cast has taken place, but a C&#43;&#43;-style cast draws attention to itself, and makes the the programmer&#8217;s intention explicit.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when C-style cast or functional notation cast is used.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;iostream&gt;

class Base { };

class Derived: public Base
{
public:
  int a;
};

void DoSomethingElse(Derived *ptr)
{
  ptr-&gt;a = 42;
}

void DoSomething(const Base *ptr)
{
  Derived* derived = (Derived*)ptr; // Noncompliant; inadvertently removes constness
  DoSomethingElse(derived);
}

void checksBits(float f)
{
    int x = *(int*)&amp;f; // Noncompliant; has undefined behavior
}

int main(int argc, char* argv[])
{
  Derived *ptr = new Derived();
  ptr-&gt;a = 1337;

  DoSomething(ptr);

  std::cout &lt;&lt; ptr-&gt;a &lt;&lt; std::endl; /* 1337 was expected, but 42 is printed */

  return 0;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">/* ... */

void DoSomething(const Base *ptr)
{
  /* error: static_cast from type 'const Base*' to type 'Derived*' casts away qualifiers */
  Derived* derived = static_cast&lt;Derived*&gt;(ptr); // Compliant. Compile fails with above error
  DoSomethingElse(derived);
}

void checksBits(float f)
{
    int x = std::bit_cast&lt;int&gt;(f);
}

/* ... */</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>This rule ignores void casts. They are a common pattern to express that an expression is dropped on purpose.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">(void)call(); // Compliant by exception
void(call()); // Compliant by exception</code></pre>
</div>
</div>
<div class="paragraph">
<p>Furthermore, this rule ignores functional casts when creating an object of the same type (copy) or when they lead to calls to a constructor. In those cases, the purpose is clear and no dangerous conversion can happen.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">class Clazz {
  Clazz(int, int);
};
Clazz create();

template&lt;typename T&gt;
void process(T&amp;&amp; t);

void foo(int i, Clazz c) {
  process(Clazz(1, 2));     // Compliant: constructor call
  process(Clazz(c));        // Compliant: copy
  process(auto(c));         // Compliant: copy
  process(Clazz(create())); // Compliant: copy
  process((Clazz)c);        // Noncompliant: C-Style cast

  process(int(i));  // Compliant: copy
  process(auto(i)); // Compliant: copy
  process((int)i);  // Noncompliant: C-style cast
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>MISRA C&#43;&#43;:2008, 5-2-4 - C-style casts (other than void casts) and functional notation casts (other than explicit constructor calls) shall not be used.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Convert this cast to the more verbose C&#43;&#43; style.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_duplicated_by_s1267">is duplicated by: <a data-rspec-id="S1267" class="rspec-auto-link">S1267</a></h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s3630">is related to: <a data-rspec-id="S3630" class="rspec-auto-link">S3630</a></h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s5303">is related to: <a data-rspec-id="S5303" class="rspec-auto-link">S5303</a></h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s6181">is related to: <a data-rspec-id="S6181" class="rspec-auto-link">S6181</a></h3>

</div>
</div>
</div>