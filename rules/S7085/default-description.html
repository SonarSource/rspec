<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Unrestricted navigation in Electron applications can lead to security issues.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, Electron allows renderers to navigate to any location. This navigation can be triggered by clicking on the link of a web content page, by dragging and dropping URLs on the applicationâ€™s window, and in other ways. This might allow navigating to malicious pages and websites that might be able to take advantage of potential render privileges (IPC events, exposed API functions, etc).</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Unrestricted navigation in Electron applications poses significant security risks. Electron apps combine web technologies with native capabilities, making them powerful but also potentially vulnerable to web-based attacks. If navigation is not properly restricted, malicious actors can exploit this to navigate to untrusted or harmful web content. This can lead to a variety of security issues, including:</p>
</div>
<div class="sect3">
<h4 id="_cross_site_scripting_xss_attacks">Cross-Site Scripting (XSS) Attacks</h4>
<div class="paragraph">
<p>Unrestricted navigation can allow attackers to inject malicious scripts into the application, leading to data theft, session hijacking, or other malicious activities.</p>
</div>
</div>
<div class="sect3">
<h4 id="_phishing_attacks">Phishing Attacks</h4>
<div class="paragraph">
<p>Users can be redirected to phishing sites that mimic legitimate services, tricking them into divulging sensitive information such as login credentials or financial details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_remote_code_execution">Remote Code Execution</h4>
<div class="paragraph">
<p>By navigating to a malicious site, an attacker might exploit vulnerabilities in the Electron app or its dependencies to execute arbitrary code on the user&#8217;s machine.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const { app, BrowserWindow } = require('electron/main')

const createWindow = () =&gt; {
  const win = new BrowserWindow({
    width: 600,
    height: 800,
  })

  win.loadUrl('https://safe.example.com')
}

app.whenReady().then(() =&gt; {
  createWindow()
})</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const { app, BrowserWindow } = require('electron/main')
const { URL } = require('url')

const createWindow = () =&gt; {
  const win = new BrowserWindow({
    width: 600,
    height: 800,
  })

  win.loadUrl('https://safe.example.com')
}

app.on('web-contents-created', (event, contents) =&gt; {
    contents.on('will-navigate', (event, navigationUrl) =&gt; {
        const parsedUrl = new URL(navigationUrl)

        if (parsedUrl.origin !== 'https://safe.example.com') {
        event.preventDefault()
        }
    })
})

app.whenReady().then(() =&gt; {
  createWindow()
})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>The compliant code adds an event listener that will check for every webcontent that will navigate,
if the target URL points to a safe host.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Electron Documentation - <a href="https://www.electronjs.org/docs/latest/tutorial/security#13-disable-or-limit-navigation">Disable or limit navigation</a></p>
</li>
<li>
<p>Electron Documentation - <a href="https://www.electronjs.org/docs/latest/api/web-contents#event-will-navigate">Event: 'will-navigate'</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>Make sure to restrict navigation targets.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Highlight the first new BrowserWindow() call that is found.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
</div>
</div>