This rule raises an issue when a project declares a dependency on an unsupported version of Django in requirements files or setup configuration.

== Why is this an issue?

Using unsupported versions of Django creates significant security and maintenance risks for your application.

When Django versions reach end-of-life, they no longer receive:

* Security patches for newly discovered vulnerabilities
* Bug fixes that could affect application stability
* Compatibility updates for newer Python versions
* Performance improvements and optimizations

This leaves your application exposed to known security vulnerabilities that attackers can exploit. Additionally, unsupported versions may become incompatible with other dependencies as they evolve, making it harder to maintain and update your project over time.

Django follows a predictable release cycle with Long Term Support (LTS) versions that receive extended support. Using these supported versions ensures your application stays secure and maintainable.

=== What is the potential impact?

Applications using unsupported Django versions are vulnerable to known security exploits that will never be patched. This can lead to data breaches, unauthorized access, or system compromise. Additionally, technical debt accumulates as the gap between your version and supported versions grows, making future upgrades more complex and expensive.

== How to fix it in Django

Update your requirements.txt to specify a supported Django version. Use version ranges to allow patch updates while staying within supported major versions.

=== Code examples

==== Noncompliant code example

[source,text,diff-id=1,diff-type=noncompliant]
----
# requirements.txt
Django==1.11.29  # Noncompliant
----

==== Compliant solution

[source,text,diff-id=1,diff-type=compliant]
----
# requirements.txt
Django>=4.2.0,<5.0
----

Update your setup.py to require a supported Django version. This ensures anyone installing your package gets a secure version.

=== Code examples

==== Noncompliant code example

[source,python,diff-id=2,diff-type=noncompliant]
----
# setup.py
install_requires=[
    'Django==2.2.28',  # Noncompliant
]
----

==== Compliant solution

[source,python,diff-id=2,diff-type=compliant]
----
# setup.py
install_requires=[
    'Django>=4.2.0,<5.0',
]
----

Update your pyproject.toml to specify a supported Django version in the dependencies section.

=== Code examples

==== Noncompliant code example

[source,toml,diff-id=3,diff-type=noncompliant]
----
[project]
dependencies = [
    "Django==3.1.14",  # Noncompliant
]
----

==== Compliant solution

[source,toml,diff-id=3,diff-type=compliant]
----
[project]
dependencies = [
    "Django>=4.2.0,<5.0",
]
----

== Resources

=== Documentation

 * Django Release Notes - https://docs.djangoproject.com/en/stable/releases/[Official Django release notes with support status information]

 * Django Supported Versions - https://www.djangoproject.com/download/[Current Django versions and their support status]

 * Django Security Policy - https://docs.djangoproject.com/en/stable/internals/security/[Django's security policy and how security issues are handled]

=== Standards

 * CWE-1104: Use of Unmaintained Third Party Components - https://cwe.mitre.org/data/definitions/1104.html[Using unmaintained third-party components can introduce security vulnerabilities]

 * OWASP Top 10:2021-A06-Vulnerable and Outdated Components - https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/[Security risks from using components with known vulnerabilities]
