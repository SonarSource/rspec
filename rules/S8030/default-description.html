<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when code accesses fields on sObject records that were not included in the original SOQL query.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Salesforce, SOQL queries only retrieve the fields explicitly specified in the SELECT clause. When you access a field that wasn&#8217;t queried, Salesforce throws a <code>System.SObjectException</code> with the message "SObject row was retrieved via SOQL without querying the requested field".</p>
</div>
<div class="paragraph">
<p>This happens because Salesforce uses lazy loading for sObject fields. Unlike some ORMs that automatically fetch all fields, Salesforce only loads what you explicitly request. This design helps optimize performance and reduce memory usage, especially when dealing with objects that have many fields.</p>
</div>
<div class="paragraph">
<p>The exception occurs at runtime, not compile time, which means this error might not be discovered until the code is executed in production. This can lead to unexpected application crashes and poor user experience.</p>
</div>
<div class="paragraph">
<p>Additionally, this pattern can indicate inefficient data access. If you need a field, it&#8217;s better to include it in the original query rather than making additional queries later, which would consume more of your SOQL query limits.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>When unqueried fields are accessed, the application will crash with a <code>System.SObjectException</code>. This can cause:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unexpected runtime failures in production</p>
</li>
<li>
<p>Poor user experience due to application crashes</p>
</li>
<li>
<p>Difficult debugging since the error only occurs when specific code paths are executed</p>
</li>
<li>
<p>Potential data inconsistency if the exception occurs during a transaction</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Include all fields that will be accessed in the SOQL SELECT clause. Review your code to identify which fields are used after the query and add them to the SELECT statement.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">Account a = [SELECT Id FROM Account LIMIT 1];
System.debug('Name: ' + a.Name); // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">Account a = [SELECT Id, Name FROM Account LIMIT 1];
System.debug('Name: ' + a.Name);</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>SOQL and SOSL Reference - <a href="https://developer.salesforce.com/docs/atlas.en-us.soql_sosl.meta/soql_sosl/">Official Salesforce documentation for SOQL queries</a></p>
</li>
<li>
<p>sObject Class - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexref.meta/apexref/apex_methods_system_sobject.htm">Apex reference for sObject methods and behavior</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-248: Uncaught Exception - <a href="https://cwe.mitre.org/data/definitions/248.html">Weakness related to uncaught exceptions that can cause application crashes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>