<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default Apex code executes without checking permissions. Hence the code will not enforce field level security, sharing rules and user permissions during execution of Apex code in Triggers, Classes and Controllers. This creates the risk that unauthorized users may get access to sensitive data records or fields.</p>
</div>
<div class="paragraph">
<p>To prevent this, developers should use <code>with sharing</code> keyword when declaring their classes if the class has SOQL or SOSL queries or DML Statements. This will ensure that current user&#8217;s permissions, field level security and sharing rules are enforced during code execution. Thus users will only see or modify records and fields which they have access to.</p>
</div>
<div class="paragraph">
<p>Use <code>without sharing</code> when a specific class should have full access to records without taking into account current user&#8217;s permissions. This should be used very carefully.</p>
</div>
<div class="paragraph">
<p>Use <code>inherited sharing</code> when the code should inherit the level of access from the calling class. This is more secure than not specifying a sharing level as the default will be equivalent to "with sharing".</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when a class containing DML, SOSL or SOQL queries has no sharing level specified (<code>with sharing</code>, <code>without sharing</code>, <code>inherited sharing</code>).</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">public class MyClass { // Noncompliant, no sharing specified
  List&lt;Case&gt; lstCases = new List&lt;Case&gt;();
  for(Case c:[SELECT Id FROM Case WHERE Status = 'In Progress']){ // SOQL query
      // ...
  }
}

public class MyClass { // Noncompliant
  List&lt;List&lt;SObject&gt;&gt; sList = [FIND 'TEST' IN ALL FIELDS
                                      RETURNING Case(Name), Contact(FirstName,LastName)]; // SOSL query

}

public class MyClass { // Noncompliant
  List&lt;Case&gt; lstCases = new List&lt;Case&gt;();
  for(Case c:[SELECT Id, Status FROM Case WHERE Status = 'In Progress']){
      c.Status = 'Closed';
      lstCasesToBeUpdated.add(c);
  }
  Update lstCasesToBeUpdated;  // DML query
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">public with sharing class MyClass {
  List&lt;Case&gt; lstCases = new List&lt;Case&gt;();
  for(Case c:[SELECT Id FROM Case WHERE Status = 'In Progress']){
      // ...
  }
}

public without sharing class MyClass {
  List&lt;List&lt;SObject&gt;&gt; sList = [FIND 'TEST' IN ALL FIELDS
                                      RETURNING Case(Name), Contact(FirstName,LastName)];
}

public inherited sharing class MyClass {
  List&lt;Case&gt; lstCases = new List&lt;Case&gt;();
  for(Case c:[SELECT Id, Status FROM Case WHERE Status = 'In Progress']){
      c.Status = 'Closed';
      lstCasesToBeUpdated.add(c);
  }
  Update lstCasesToBeUpdated;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>No issue will be raised for test classes, i.e. classes annotated with <code>@isTest</code></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_classes_keywords_sharing.htm">Using the with sharing, without sharing, and inherited sharing Keywords</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Add "with sharing", "without sharing" or "inherited sharing"</p>
</div>
</div>
</div>
</div>