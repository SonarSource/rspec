<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule reports circular dependencies between classes across different packages.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Circular dependencies occur when two classes reference each other, either directly or indirectly.
This means that the classes' dependency structure does not represent an intuitive hierarchy, which makes it harder to understand and maintain.</p>
</div>
<div class="paragraph">
<p>Compared to <a data-rspec-id="S7027" class="rspec-auto-link">S7027</a>, this issue is even more significant when a cycle crosses package boundaries because:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>It disrupts the dependency hierarchy or layer structure even between packages.</p>
</li>
<li>
<p>It spreads the problem across more distant locations in the source code.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Circular dependencies increase the architectural complexity of the code, reducing its readability, extensibility, and maintainability.
As the project grows, circular dependencies often lead to more circular dependencies, further complication of the architecture and increasing technical debt.
Over time, untangling these dependencies becomes increasingly difficult.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Extract an interface</strong>: If two classes share similar functionality, move that functionality to an interface that both can implement. This allows each class to depend on the interface rather than on each other.</p>
</li>
<li>
<p><strong>Use dependency injection</strong>: Replace direct references between classes with dependency injection. By passing necessary objects as parameters through constructors or setters, you break the circular reference, making your code more flexible and easier to test.</p>
</li>
<li>
<p><strong>Split responsibilities</strong>: Evaluate whether each class is handling too many responsibilities. If so, break them down into smaller, more focused classes. This eliminates circular dependencies and makes sure your code has fewer reasons to change, making it easier to manage and extend.</p>
</li>
<li>
<p><strong>Rethink the package structure</strong></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="paragraph">
<p>The following code contains two cycles: Order &rarr; Customer &rarr; Order, and Order &rarr; Product &rarr; Order. Furthermore, both cycles are connected to each other via class Order. This is called <em>a tangle consisting of two cycles</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">class Order {
    public Customer customer;
    public List&lt;Product&gt; products;
}
class Customer {
    public List&lt;Order&gt; orders;
}
class Product {
    public List&lt;Order&gt; orders;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="paragraph">
<p>The issue can be resolved by changing the structure. Two service functions can replace the dependencies Customer &rarr; Order and Product &rarr; Order.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">class Order {
    public Customer customer;
    public List&lt;Product&gt; products;
}
class Customer { }
class Product { }
interface OrderService {
  List&lt;Order&gt; getOrdersByCustomer(Customer customer);
  List&lt;Order&gt; getOrdersByProduct(Product product);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Wikipedia - <a href="https://en.wikipedia.org/wiki/Acyclic_dependencies_principle">Acyclic dependencies principle</a></p>
</li>
<li>
<p>STAN - <a href="https://stan4j.com/advanced/adp/">Acyclic dependencies principle</a></p>
</li>
<li>
<p>RSPEC - <a href="https://sonarsource.github.io/rspec/#/rspec/S7027/java">S7027: Circular dependencies between classes in the same package should be resolved</a></p>
</li>
</ul>
</div>
</div>
</div>