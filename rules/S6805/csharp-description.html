<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While a Blazor application is prerendering, certain actions, such as calling into JavaScript (JS), aren&#8217;t possible. Due to this it&#8217;s hilighy recommended to avoid calling the <code>JSRuntime</code> in <code>OnInitialized</code>, <code>OnParametersSet</code> methods and their async equivalents.</p>
</div>
<div class="paragraph">
<p>This rule raises when <code>IJSRuntime.InvokeAsync</code>, <code>JSRuntimeExtensions.InvokeAsync</code> methods and their overloads  are called in:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.components.componentbase.onparametersset">ComponentBase.OnParametersSet Method</a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.components.componentbase.onparameterssetasync">ComponentBase.OnParametersSetAsync Method</a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.components.componentbase.oninitialized">ComponentBase.OnInitialized Method</a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.components.componentbase.oninitializedasync">ComponentBase.OnInitializedAsync Method</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">@inject IJSRuntime JSRuntime

&lt;p role="status"&gt;Current height: @height&lt;/p&gt;

@code {
    private int height;

    protected override async Task OnInitializedAsync()
    {
        height = await JSRuntime.InvokeAsync&lt;int&gt;("getHeight"); // Noncompliant
        await InvokeAsync(StateHasChanged);
        await base.OnInitializedAsync();
    }

    protected override async Task OnParametersSetAsync()
    {
        height = await JSRuntime.InvokeAsync&lt;int&gt;("getHeight"); // Noncompliant
        await InvokeAsync(StateHasChanged);
        await base.OnParametersSetAsync();
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">@inject IJSRuntime JSRuntime

&lt;p role="status"&gt;Current height: @height&lt;/p&gt;

@code {
    private int height;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            height = await JSRuntime.InvokeAsync&lt;int&gt;("getHeight");
            await InvokeAsync(StateHasChanged);
        }
        await base.OnAfterRenderAsync(firstRender);
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/aspnet/core/blazor/components/lifecycle">ASP.NET Core Razor component lifecycle</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/aspnet/core/blazor/javascript-interoperability">ASP.NET Core Blazor JavaScript interoperability (JS interop)</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.jsinterop.ijsruntime.invokeasync#microsoft-jsinterop-ijsruntime-invokeasync-1">IJSRuntime.InvokeAsync Method</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.components.componentbase.onparametersset">ComponentBase.OnParametersSet Method</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.components.componentbase.onparameterssetasync">ComponentBase.OnParametersSetAsync Method</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.components.componentbase.oninitialized">ComponentBase.OnInitialized Method</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.components.componentbase.oninitializedasync">ComponentBase.OnInitializedAsync Method</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>