<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>Map</code> and <code>SequencedMap</code> interfaces provide methods to get views of their entries, keys and values.
The view collections returned by such methods are backed by the respective map objects and changes are reflected in both directions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>Collection</code> object returned by <code>Map.entrySet()</code>, <code>Map.keySet()</code> and <code>Map.values()</code>,
and <code>SequencedMap.sequencedEntrySet()</code>, <code>SequencedMap.sequencedKeySet()</code> and <code>SequencedMap.sequencedValues()</code>,
do not support the <code>.add()</code> and <code>.addAll()</code> methods, and they will throw an <code>UnsupportedOperationException</code> when invoked.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue whenever <code>.add()</code> or <code>.addAll()</code> are invoked on collections that were retrieved this way.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Map&lt;Integer, String&gt; map = new HashMap&lt;&gt;();
map.keySet().add(2); // Noncompliant, will throw UnsupportedOperationException
map.keySet().addAll(List.of(1, 2, 3)); // Noncompliant, will throw UnsupportedOperationException

SequencedMap&lt;Integer, String&gt; sequencedMap = new LinkedHashMap&lt;&gt;();
sequencedMap.sequencedValues().add("1"); // Noncompliant, will throw UnsupportedOperationException
sequencedMap.sequencedValues().addAll(List.of("1", "2", "3")); // Noncompliant, will throw UnsupportedOperationException</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Java Documentation - <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html#keySet()">Map.keySet()</a></p>
</li>
<li>
<p>Java Documentation - <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html#values()">Map.values()</a></p>
</li>
<li>
<p>Java Documentation - <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html#entrySet()">Map.entrySet()</a></p>
</li>
<li>
<p>Java Documentation - <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/SequencedMap.html#sequencedKeySet()">SequencedMap.sequencedKeySet()</a></p>
</li>
<li>
<p>Java Documentation - <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/SequencedMap.html#sequencedValues()">SequencedMap.sequencedValues()</a></p>
</li>
<li>
<p>Java Documentation - <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/SequencedMap.html#sequencedEntrySet()">SequencedMap.sequencedEntrySet()</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="paragraph">
<p>lpilastri: set status to "closed" as explained in <a href="https://sonarsource.atlassian.net/browse/SONARJAVA-4785">SONARJAVA-4785</a></p>
</div>
</div>
</div>