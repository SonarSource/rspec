<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when a method used as a Rails model callback (such as <code>before_save</code>, <code>after_create</code>, <code>after_update</code>, etc.) is declared as a public method instead of private.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Rails applications, callback methods are internal implementation details that should not be part of a model&#8217;s public interface. When callback methods are declared as public, they can be called directly from outside the model, which violates the principle of encapsulation and can lead to several problems.</p>
</div>
<div class="paragraph">
<p>Callback methods are designed to be invoked automatically by the Rails framework at specific points in an object&#8217;s lifecycle. They often contain logic that assumes certain preconditions or state changes that only occur during the normal Rails callback chain. When these methods are called directly, they may not work as expected or could cause data inconsistency.</p>
</div>
<div class="paragraph">
<p>Additionally, public callback methods expose internal implementation details that other parts of the application might inadvertently depend on. This creates tight coupling and makes the code harder to refactor or maintain over time.</p>
</div>
<div class="paragraph">
<p>Following the Rails convention of making callback methods private also improves code readability by clearly distinguishing between the model&#8217;s public API and its internal implementation details.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>When callback methods are public, they can be called directly from outside the model, potentially bypassing important validation or state management logic. This can lead to data inconsistency, unexpected behavior, or security vulnerabilities if the callback methods contain sensitive operations that should only be triggered through the normal Rails lifecycle.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_rails">How to fix it in Rails</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Move the callback method below a <code>private</code> declaration to make it inaccessible from outside the model. This follows Rails conventions and prevents the method from being called directly.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">class Article &lt; ApplicationRecord
  before_save :normalize_title

  def normalize_title # Noncompliant
    self.title = title.downcase.titleize
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">class Article &lt; ApplicationRecord
  before_save :normalize_title

  private

  def normalize_title
    self.title = title.downcase.titleize
  end
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>For models with multiple callback methods, group them together under the <code>private</code> section to maintain clear separation between public and private methods.</p>
</div>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">class Board &lt; ApplicationRecord
  after_update :notify_stage_change
  before_destroy :cleanup_resources

  def notify_stage_change # Noncompliant
    BoardNotificationService.new(self).notify_stage_update
  end

  def cleanup_resources # Noncompliant
    associated_items.destroy_all
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">class Board &lt; ApplicationRecord
  after_update :notify_stage_change
  before_destroy :cleanup_resources

  private

  def notify_stage_change
    BoardNotificationService.new(self).notify_stage_update
  end

  def cleanup_resources
    associated_items.destroy_all
  end
end</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Rails Guides - Active Record Callbacks - <a href="https://guides.rubyonrails.org/active_record_callbacks.html">Official Rails documentation on Active Record callbacks and best practices</a></p>
</li>
<li>
<p>Ruby Access Control - <a href="https://ruby-doc.org/3.4.1/syntax/modules_and_classes_rdoc.html#label-Visibility">Ruby documentation on method visibility and access control</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>