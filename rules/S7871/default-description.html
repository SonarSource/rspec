<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is an issue when using <code>Array#include?</code> for frequent membership testing, using Hash with nil values for membership operations, or combining <code>Array#include?</code> with <code>Array#push</code> for uniqueness checks.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using <code>Array#include?</code> for membership testing has O(n) time complexity because it must scan through the entire array to find an element. This becomes a significant performance bottleneck when dealing with large collections or frequent lookups.</p>
</div>
<div class="paragraph">
<p>When you combine <code>Array#include?</code> with <code>Array#push</code> to maintain unique elements, each insertion requires checking the entire array first. In loops, this creates O(n²) complexity, where performance degrades quadratically as the collection grows.</p>
</div>
<div class="paragraph">
<p>Using Hash with nil values for membership testing works efficiently (O(1) lookup), but it&#8217;s semantically confusing. The code doesn&#8217;t clearly express that you&#8217;re testing membership - it looks like you&#8217;re storing key-value pairs when you only care about the keys.</p>
</div>
<div class="paragraph">
<p>Ruby&#8217;s Set class is specifically designed for these use cases. It provides O(1) lookup time for membership testing and automatically handles uniqueness. The code becomes both more efficient and more expressive of your intent.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Performance can degrade significantly with large collections. Array membership testing scales linearly (O(n)), while uniqueness patterns with arrays can scale quadratically (O(n²)). This can cause noticeable slowdowns in applications processing large datasets or performing frequent membership checks.</p>
</div>
<div class="paragraph">
<p>Using Hash with nil values creates maintenance overhead because the code&#8217;s intent is unclear to other developers.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Replace Array#include? with Set for membership testing. Convert your array to a Set using <code>to_set</code> method and use the same <code>include?</code> method for O(1) lookup performance.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"># Inefficient: O(n) lookup for membership testing
valid_ids = [1, 2, 3, 4, 5]

def process_item(item_id, valid_ids)
  return unless valid_ids.include?(item_id)  # Noncompliant
  # Process the item
end</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">require 'set'

# Efficient: O(1) lookup for membership testing
valid_ids = [1, 2, 3, 4, 5].to_set

def process_item(item_id, valid_ids)
  return unless valid_ids.include?(item_id)  # O(1) lookup
  # Process the item
end</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Ruby Set Class Documentation - <a href="https://ruby-doc.org/stdlib/libdoc/set/rdoc/Set.html">Official Ruby documentation for the Set class, including methods and usage examples</a></p>
</li>
<li>
<p>Ruby Array Documentation - <a href="https://ruby-doc.org/core/Array.html#method-i-include-3F">Official documentation for Array#include? method and its time complexity characteristics</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>