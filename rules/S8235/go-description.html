<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is an issue when code patterns trigger false positive warnings in race detection tools, making it harder to identify genuine race conditions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Race detection tools like <code>go test -race</code> are essential for finding concurrency bugs in Go programs. However, certain coding patterns can trigger false positive warnings, creating noise that obscures real race conditions.</p>
</div>
<div class="paragraph">
<p>When race detectors report false positives, developers may:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ignore legitimate race condition warnings</p>
</li>
<li>
<p>Spend time investigating non-issues</p>
</li>
<li>
<p>Lose confidence in the race detection tools</p>
</li>
<li>
<p>Miss actual concurrency bugs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Go race detector works by tracking memory accesses and identifying unsynchronized access to shared memory. Some patterns, while functionally correct, appear to the race detector as potential data races because the synchronization is not explicit or visible to the tool.</p>
</div>
<div class="paragraph">
<p>Common patterns that cause false positives include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Direct assignment to global variables that are accessed concurrently</p>
</li>
<li>
<p>Sharing data through channels without proper synchronization markers</p>
</li>
<li>
<p>Using non-atomic operations on shared counters or flags</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By writing code that is explicitly race-detector-friendly, you make your concurrent code more maintainable and ensure that race detection tools can effectively help you find real bugs.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>False positives in race detection can mask real concurrency bugs, leading to unreliable software in production. Teams may disable race detection entirely, losing a valuable tool for catching dangerous race conditions that could cause data corruption, crashes, or security vulnerabilities.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use atomic operations for shared variables that are accessed concurrently. This makes the synchronization explicit to both the race detector and other developers.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">package main

var counter int64

func increment() {
    counter++ // Noncompliant: direct access triggers race detector
}

func getCounter() int64 {
    return counter // Noncompliant: unsynchronized read
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">package main

import "sync/atomic"

var counter int64

func increment() {
    atomic.AddInt64(&amp;counter, 1)
}

func getCounter() int64 {
    return atomic.LoadInt64(&amp;counter)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Go Race Detector - <a href="https://go.dev/doc/articles/race_detector">Official documentation on Go&#8217;s race detector tool</a></p>
</li>
<li>
<p>sync/atomic Package - <a href="https://pkg.go.dev/sync/atomic">Documentation for atomic operations in Go</a></p>
</li>
<li>
<p>Effective Go - Concurrency - <a href="https://go.dev/doc/effective_go#concurrency">Best practices for concurrent programming in Go</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-362: Concurrent Execution using Shared Resource with Improper Synchronization - <a href="https://cwe.mitre.org/data/definitions/362.html">Information about race condition vulnerabilities</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>