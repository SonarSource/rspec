<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when GINQ parallel querying is used without calling <code>shutdown</code> to release the shared thread pool resources.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>GINQ (Groovy-Integrated Query) parallel querying uses a shared thread pool to improve performance when processing large data sources. When parallel querying is enabled with <code>GQ(parallel: true)</code>, the system allocates thread pool resources that remain active even after the query completes.</p>
</div>
<div class="paragraph">
<p>If these resources are not explicitly released by calling <code>GQ { shutdown }</code>, they will continue to consume memory and system resources. Over time, this can lead to resource leaks, especially in applications that perform many parallel queries.</p>
</div>
<div class="paragraph">
<p>The GINQ documentation explicitly states that the shutdown code should be used to release resources after all GINQ statement executions are completed. Without proper shutdown, the thread pool remains active indefinitely, preventing proper garbage collection and potentially causing memory pressure in long-running applications.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Resource leaks can accumulate over time, leading to increased memory consumption and potential performance degradation. In server applications or long-running processes, this can eventually cause memory exhaustion or system instability.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add a shutdown call after completing all parallel GINQ operations to properly release the shared thread pool resources.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">GQ(parallel: true) {
    from n in 1..1000
    select n
}.toList()
// Missing shutdown - resources not released</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">GQ(parallel: true) {
    from n in 1..1000
    select n
}.toList()

// Properly release resources
GQ {
    shutdown
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>GINQ Parallel Querying Documentation - <a href="https://groovy-lang.org/using-ginq.html#_parallel_querying">Official Groovy documentation explaining parallel querying and resource management in GINQ</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-404: Improper Resource Shutdown or Release - <a href="https://cwe.mitre.org/data/definitions/404.html">Weakness related to improper resource shutdown or release</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S2095" class="rspec-auto-link">RSPEC-2095</a> - <a href="https://rules.sonarsource.com/java/RSPEC-2095/">Resources should be closed in Java - similar resource management pattern</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>