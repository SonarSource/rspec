<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cross-App Scripting is a variant of XSS that targets mobile applications using a WebView to display web content. It happens if the application accepts data from another, potentially malicious, application on the same device and passes it into its WebView without proper validation.</p>
</div>
<div class="paragraph">
<p>An attacker can exploit this by creating a malicious application that sends specially prepared data to the vulnerable app. The vulnerability is triggered when the application passes theattacker&#8217;s malicious data to one of the WebView methods that executes HTML or JavaScript.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a malicious application successfully executes its own code inside your application’s WebView, it can operate within the trusted environment of your app. This means it can misuse the permissions and access that your users have granted to your WebView. Depending on the case, an accacker could execute JavaScript, redirect to phishing pages or access application&#8217;s private files.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="sect3">
<h4 id="_theft_of_sensitive_information">Theft of Sensitive Information</h4>
<div class="paragraph">
<p>If the WebView shows private user details, such as personal information, financial data,
or confidential documents, a malicious script can copy this data and send it to an attacker.
The script can also access session information, like cookies or authentication tokens.</p>
</div>
</div>
<div class="sect3">
<h4 id="_account_takeover">Account Takeover</h4>
<div class="paragraph">
<p>If an attacker obtains a user&#8217;s session token, they can often impersonate that user.
The attacker can use the stolen token to access the user&#8217;s account from their own device
without needing the user&#8217;s password. Once inside, they could have full access to the account,
allowing them to view private data, change account settings, or lock the original user out.</p>
</div>
</div>
<div class="sect3">
<h4 id="_displaying_deceptive_content">Displaying Deceptive Content</h4>
<div class="paragraph">
<p>An attacker’s script can change the content and appearance of the page shown in the WebView.
For example, the script could display a fake login screen that looks identical to your app&#8217;s real one.
If a user enters their username and password into this fake form, the script sends the credentials
to the attacker. This technique is a form of phishing.</p>
</div>
</div>
<div class="sect3">
<h4 id="_performing_unauthorized_actions">Performing Unauthorized Actions</h4>
<div class="paragraph">
<p>Some applications set up a bridge that allows JavaScript in a WebView to communicate with the
native part of the Android application. If this is the case, a malicious script could potentially
use this bridge to perform actions on behalf of the user. Depending on your app&#8217;s features,
this could include sending messages, modifying files, or accessing contacts.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_android">How to fix it in Android</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">class ExampleActivity : AppCompatActivity() {

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        val aWebView = WebView(this)
        aWebView.settings.javaScriptEnabled = true
        setContentView(aWebView)

        val name = intent.getStringExtra("name") ?: "Guest"
        aWebView.evaluateJavascript("greeting('$name')", null) // Noncompliant
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">class ExampleActivity : AppCompatActivity() {

    // Only allow letters and spaces in the name.
    private val nameRegex = Regex("^[a-zA-Z ]+$")

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        val aWebView = WebView(this)
        aWebView.settings.javaScriptEnabled = true
        setContentView(aWebView)

        val name = intent.getStringExtra("name") ?: "Guest"
        if (name.matches(nameRegex)) {
            aWebView.evaluateJavascript("greeting('$name')", null)
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Android Documentation - <a href="https://developer.android.com/privacy-and-security/risks/cross-app-scripting">Cross-app scripting</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A03_2021-Injection/">Top 10 2021 Category A3 - Injection</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">Top 10 2017 Category A7 - Cross-Site Scripting (XSS)</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2023-risks/m4-insufficient-input-output-validation">Mobile Top 10 2024 Category M4 - Insufficient Input/Output Validation</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/79">CWE-79 - Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222602">Application Security and Development: V-222602</a> - The application must protect from Cross-Site Scripting (XSS) vulnerabilities.</p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222609">Application Security and Development: V-222609</a> - The application must not be subject to input handling vulnerabilities.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Change this code to not execute untrusted data in the WebView.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>"[varname]" is tainted (assignments and parameters)</p>
</div>
<div class="paragraph">
<p>this argument is tainted (method invocations)</p>
</div>
<div class="paragraph">
<p>the returned value is tainted (returns &amp; method invocations results)</p>
</div>
</div>
</div>
</div>