<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>File access functions in PHP are typically used to open local files. They are
also capable of reading files from remote servers using protocols such as HTTP,
HTTPS and FTP.</p>
</div>
<div class="paragraph">
<p>This behavior is controlled by the <code>allow_url_fopen</code> and <code>allow_url_include</code>
settings.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most applications do not require or expect the file access functions to download
remotely accessible files. However, attackers can abuse these remote file access
features while exploiting other vulnerabilities, such as path traversal issues.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>While activating these settings does not pose a direct threat to the
application&#8217;s security, they can make the exploitation of other vulnerabilities
easier and more severe.</p>
</div>
<div class="paragraph">
<p>If an attacker can control a file location while <code>allow_url_fopen</code> is set
to <code>1</code>, they can use this ability to perform a Server-Side Request Forgery
exploit. This allows the attacker to affect more than just the local application
and they may be able to laterally attack other assets on the local network.</p>
</div>
<div class="paragraph">
<p>If <code>allow_url_include</code> is set to <code>1</code>, the attacker will also have the ability to
download and execute arbitrary PHP code.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>allow_url_fopen</code> and <code>allow_url_include</code> should be deactivated in the main PHP
configuration file. Note that <code>allow_url_include</code> is disabled by default while
<code>allow_url_fopen</code> is not and must be explicitly disabled.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">; php.ini  Noncompliant; allow_url_fopen is enabled by default
allow_url_include=1  ; Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">; php.ini
allow_url_fopen=0
allow_url_include=0</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">Top 10 2021 Category A5 - Security Misconfiguration</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/829">CWE-16 - Inclusion of Functionality from Untrusted Control Sphere</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>Disable "xxx".</p>
</li>
<li>
<p>Disable "allow_url_fopen" explicitly; it is enabled by default.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_1_sep_2015_074252_linda_martin_wrote">on 1 Sep 2015, 07:42:52 Linda Martin wrote:</h3>
<div class="paragraph">
<p>LGTM!</p>
</div>
</div>
</div>
</div>