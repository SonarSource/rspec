<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Unnecessary calls to <code>c_str()</code> or <code>data()</code> reduce readability and performance.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the process of refactoring code from C to C++, it can easily happen that redundant calls to <code>c_str()</code>
or <code>data()</code> on standard strings get introduced when the original object could be used directly.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">void takeString(std::string const&amp; dest);

void takeStringView(std::string_view dest);

void func(std::string const&amp; src) {
  takeString(src.c_str()); // Noncompliant: redundant copy
  takeStringView(src.c_str()); // Noncompliant: redundant crossing of the content
  takeStringView(src.data());  // Noncompliant: redundant crossing of the content
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Not only is this unnecessary step a readability issue, but it will force the creation of useless intermediary strings,
or require searching the content of a string for the null-terminator, reducing the performance.
The call to <code>c_str()</code> or <code>data()</code> should be removed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">void takeString(std::string const&amp; dest);

void takeStringView(std::string_view dest);

void func(std::string const&amp; src) {
  takeString(src); // Compliant
  takeStringView(src); // Compliant
  takeStringView(src); // Compliant
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_exception">Exception</h3>
<div class="paragraph">
<p>This rule does not raise when explicitly creating a string or a string_view from <code>c_str()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">void takeString(std::string const&amp; dest);

void func(std::string const&amp; src) {
  takeString(std::string(src.c_str())); // Compliant by exception
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This operation could be done on purpose in the rare case where <code>src</code> is a string containing embedded null-terminators, in order to only keep the content up to the first null-terminator in <code>dest</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S6231" class="rspec-auto-link">S6231</a> - "std::string_view" and "std::span" parameters should be directly constructed from sequences</p>
</li>
</ul>
</div>
</div>
</div>
</div>