<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when shell variables are expanded without being enclosed in double quotes, such as <code>$var</code> or <code>${var}</code> instead of <code>"$var"</code> or <code>"${var}"</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Shell variables should always be quoted during expansion to prevent word splitting and pathname expansion. When a variable is not quoted, the shell treats its contents as separate words if it contains spaces, tabs, or newlines. This can cause commands to receive unexpected arguments or fail entirely.</p>
</div>
<div class="paragraph">
<p>For example, if a variable contains a filename with spaces like <code>my file.txt</code>, an unquoted expansion will be split into two separate arguments: <code>my</code> and <code>file.txt</code>. This is particularly dangerous with file operations, where the wrong files might be processed or deleted.</p>
</div>
<div class="paragraph">
<p>Pathname expansion (globbing) is another risk. If a variable contains characters like <code>*</code>, <code>?</code>, or <code>[]</code>, the shell will try to match them against existing files. This can lead to unintended file operations or command failures.</p>
</div>
<div class="paragraph">
<p>These issues become more severe in production environments where filenames and data are unpredictable. A script that works in testing with simple filenames might fail catastrophically when encountering real-world data containing spaces or special characters.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Unquoted variable expansions can cause:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Data loss</strong>: Commands might operate on wrong files when filenames contain spaces</p>
</li>
<li>
<p><strong>Security vulnerabilities</strong>: Malicious filenames could exploit pathname expansion to access unintended files</p>
</li>
<li>
<p><strong>Script failures</strong>: Commands receiving unexpected arguments due to word splitting</p>
</li>
<li>
<p><strong>Unpredictable behavior</strong>: Scripts working in some environments but failing in others based on data content</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_fix">How to fix?</h3>
<div class="paragraph">
<p>Wrap variable expansions in double quotes to prevent word splitting and pathname expansion. This ensures the variable&#8217;s content is treated as a single argument regardless of spaces or special characters.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">rm ${file} # Noncompliant
command $file1 $file2 # Noncompliant
echo $var # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_code_example">Compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">rm "${file}"
command "$file1" "$file2"
echo "$var"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Bash Variables - Always Quote - <a href="https://bertvv.github.io/cheat-sheets/Bash.html">Best practices for Bash scripting including variable quoting guidelines</a></p>
</li>
<li>
<p>LinuxCommand Shell Scripting Standards - <a href="https://linuxcommand.org/lc3_adv_standards.php">Comprehensive shell scripting coding standards with variable expansion guidelines</a></p>
</li>
<li>
<p>Bash Guide - Quoting - <a href="https://mywiki.wooledge.org/Quotes">Detailed explanation of quoting in Bash and when it&#8217;s necessary</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-78: Improper Neutralization of Special Elements - <a href="https://cwe.mitre.org/data/definitions/78.html">Covers injection vulnerabilities that can occur through improper handling of special characters</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>