<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After an <code>await</code>ed <code>Task</code> has executed, you can continue execution in the original, calling thread or any arbitrary thread. Unless the rest of the code needs the context from which the <code>Task</code> was spawned, <code>Task.ConfigureAwait(false)</code> should be used to keep execution in the <code>Task</code> thread to avoid the need for context switching and the possibility of deadlocks.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when code in a class library targeting .Net Framework <code>await</code>s a <code>Task</code> and continues execution in the original calling thread.</p>
</div>
<div class="paragraph">
<p>The rule does not raise for .Net Core libraries as there is no <code>SynchronizationContext</code> in .Net Core.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">var response = await httpClient.GetAsync(url);  // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">var response = await httpClient.GetAsync(url).ConfigureAwait(false);</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Add ".ConfigureAwait(false)" to this call to allow execution to continue in any thread.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_1_jul_2015_154018_ann_campbell_wrote">on 1 Jul 2015, 15:40:18 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Note [~tamas.vajk] that because I anticipate FP&#8217;s from this rule, I&#8217;ve turned it on in the Security profile but not in SonarQube Way. Unless you&#8217;re good enough to tell if execution <em>must</em> pick back up in the main thread &amp; ignore those instances?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_2_jul_2015_070220_tamas_vajk_wrote">on 2 Jul 2015, 07:02:20 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Thanks, it looks good. We&#8217;ll see the FPs: we can automatically exclude "exe" projects, &#8230;&#8203;</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_21_aug_2015_061804_tamas_vajk_wrote">on 21 Aug 2015, 06:18:04 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Do you think this is a security issue as well?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_21_aug_2015_122445_ann_campbell_wrote">on 21 Aug 2015, 12:24:45 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk] I&#8217;m kinda in a bind: Critical rules must be bugs or security-related. Since multi-threading issues can affect security, I added the security tag rather than downgrading the severity.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_21_aug_2015_122828_tamas_vajk_wrote">on 21 Aug 2015, 12:28:28 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I see. It&#8217;s more like a bug rule, but it is just a potential bug, so maybe we should reduce the severity to major.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_21_aug_2015_125053_ann_campbell_wrote">on 21 Aug 2015, 12:50:53 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Done [~tamas.vajk]</p>
</div>
</div>
</div>
</div>