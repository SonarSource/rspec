<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>XSLT Injection is a security vulnerability that occurs when an application uses
untrusted user input to construct an XSLT (Extensible Stylesheet Language
Transformations) stylesheet. XSLT engines are powerful templating tools
designed to transform XML documents</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>An attacker can provide malicious XSLT code that the application&#8217;s XML processor
will then execute, such as references to other files, embedded scripts, or
special objects.</p>
</div>
<div class="paragraph">
<p>Below are some real-world scenarios that illustrate some impacts of an attacker
exploiting the vulnerability.</p>
</div>
<div class="sect3">
<h4 id="_reading_sensitive_files">Reading Sensitive Files</h4>
<div class="paragraph">
<p>The most common impact of XSLT Injection is the ability to read files from the
server&#8217;s file system. XSLT has built-in functions that can access local or
remote XML files. An attacker can use this function to read sensitive
information.</p>
</div>
</div>
<div class="sect3">
<h4 id="_attacking_other_systems">Attacking Other Systems</h4>
<div class="paragraph">
<p>Attackers can use XSLT Injection to force the server to make network requests
to other systems on the internal network that are not accessible from the
internet.</p>
</div>
<div class="paragraph">
<p>This could allow an attacker to:
* Scan the internal network for open ports and active services.
* Access internal, unprotected administrative panels.
* Interact with cloud provider metadata services to steal access credentials.</p>
</div>
</div>
<div class="sect3">
<h4 id="_denial_of_service">Denial of Service</h4>
<div class="paragraph">
<p>A malicious stylesheet can also be designed to consume a large amount of server
resources, such as memory or CPU time. This can cause the application to slow
down or crash, making it unavailable for legitimate users.<br>
An attacker could create a recursive stylesheet that never finishes, causing
the processor to enter an infinite loop and exhaust all available CPU
resources.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">[ApiController]
[Route("Example")]
public class ExampleController : ControllerBase
{
    [HttpGet("example")]
    public IActionResult Process([FromQuery] string xslt)
    {
        var transform = new XslCompiledTransform();
        const string inputXml = "&lt;root&gt;&lt;msg&gt;Hello&lt;/msg&gt;&lt;/root&gt;";

        using (var xsltReader = XmlReader.Create(new StringReader(xslt)))
        {
            transform.Load(xsltReader); // Noncompliant
        }

        using var stringWriter = new StringWriter();
        using (var xmlReader = XmlReader.Create(new StringReader(inputXml)))
        {
            transform.Transform(xmlReader, null, stringWriter);
        }

        return Content(stringWriter.ToString(), "application/xml");
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="paragraph">
<p>These security issues can be mitigated by not accepting XslTransform objects,
XSLT style sheets, or XML source data from untrusted sources.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A03_2021-Injection/">Top 10 2021 Category A3 - Injection</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">Top 10 2017 Category A1 - Injection</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2023-risks/m4-insufficient-input-output-validation">Mobile Top 10 2024 Category M4 - Insufficient Input/Output Validation</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/20">CWE-20 - Improper Input Validation</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222609">Application Security and Development: V-222609</a> - The application must not be subject to input handling vulnerabilities.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Change this code to not construct XSLT Transforms directly from user-controlled data.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>"[varname]" is tainted (assignments and parameters)</p>
</div>
<div class="paragraph">
<p>this argument is tainted (method invocations)</p>
</div>
<div class="paragraph">
<p>the returned value is tainted (returns &amp; method invocations results)</p>
</div>
<hr>
</div>
</div>
</div>