<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Transport Layer Security (TLS) provides a secure channel between systems communicating over the internet by encrypting the data sent between them. TLS can be used with <code>http</code> and <code>git</code> URI schemes to build secure <code>https</code> and <code>git+https</code> channels respectively.</p>
</div>
<div class="paragraph">
<p>These secure protocols are essential for the confidentiality and the integrity of the communication performed when supply chain operations are performed, such as <code>dart pub get</code>, <code>flutter pub get</code>, <code>dart pub upgrade</code>, etc.</p>
</div>
<div class="paragraph">
<p>In the <a href="https://dart.dev/tools/pub/pubspec"><code>pubspec.yaml</code> file</a>, which is a file used by several Dart/Flutter commands, there&#8217;s a possibility to specify URIs in various attributes: homepage, repository, issue_tracker, dependency repositories, etc.</p>
</div>
<div class="paragraph">
<p>It is important that secure protocols are used in all these URIs. The <code>https</code> protocol provides an additional layer of security by encrypting the transferred data and verifying the server&#8217;s identity.</p>
</div>
<div class="paragraph">
<p>It is generally recommended not to use <code>http</code> or <code>git</code> URIs that will be used by Dart/Flutter commands to gather external data during any stage of the application build.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact</h3>
<div class="sect3">
<h4 id="_man_in_the_middle_mitm_attacks">Man-in-the-middle (MitM) attacks</h4>
<div class="paragraph">
<p>An attacker can intercept the communication between the client and server, allowing them to modify the data being transmitted.</p>
</div>
</div>
<div class="sect3">
<h4 id="_supply_chain_attacks">Supply chain attacks</h4>
<div class="paragraph">
<p>Without the verification provided by TLS certificates, attackers can redirect package requests to malicious servers that mimic legitimate package repositories.</p>
</div>
<div class="paragraph">
<p>For example, an attacker could inject malicious code into a package being downloaded, which would compromise the security of the application being built.</p>
</div>
<div class="paragraph">
<p>This can cause further security breaches inside the organization, but will also affect clients if the malicious code gets added to any products, as a part of a production dependency or as code generated by a tampered development dependency.</p>
</div>
<div class="paragraph">
<p>Distributing code that (unintentionally) contains backdoors or malware can lead to widespread security vulnerabilities, reputational damage, and potential legal liabilities.</p>
</div>
</div>
<div class="sect3">
<h4 id="_credential_exposure">Credential exposure</h4>
<div class="paragraph">
<p>Sensitive information, such as API keys or user credentials used to interact with the remote package repository, could be exposed during transmission. This could lead to unauthorized access to the application or its data.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Replace insecure <code>http</code> or <code>git</code> URI schemas with <code>https</code>.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">repository: http://github.com/flutter/flutter</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">repository: https://github.com/flutter/flutter</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">git:
  url: git://github.com/flutter/flutter.git</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">git:
  url: https://github.com/flutter/flutter.git</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Dart Docs - <a href="https://dart.dev/tools/linter-rules/secure_pubspec_urls">Dart Linter rule - secure_pubspec_urls</a></p>
</li>
<li>
<p>Dart Docs - <a href="https://dart.dev/tools/pub/pubspec">pubspec</a></p>
</li>
<li>
<p>Wikipedia - <a href="https://en.wikipedia.org/wiki/HTTPS">HTTPS</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">Top 10 2021 Category A2 - Cryptographic Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">Mobile Top 10 2016 Category M3 - Insecure Communication</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2023-risks/m2-inadequate-supply-chain-security">Mobile Top 10 2024 Category M2 - Inadequate Supply Chain Security</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2023-risks/m5-insecure-communication">Mobile Top 10 2024 Category M5 - Insecure Communication</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/319">CWE-319 - Cleartext Transmission of Sensitive Information</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222397">Application Security and Development: V-222397</a> - The application must implement cryptographic mechanisms to protect the integrity of remote access sessions.</p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222596">Application Security and Development: V-222596</a> - The application must protect the confidentiality and integrity of transmitted information.</p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222597">Application Security and Development: V-222597</a> - The application must implement cryptographic mechanisms to prevent unauthorized disclosure of information and/or detect changes to information during transmission unless otherwise protected by alternative physical safeguards, such as, at a minimum, a Protected Distribution System (PDS).</p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222598">Application Security and Development: V-222598</a> - The application must maintain the confidentiality and integrity of information during preparation for transmission.</p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222599">Application Security and Development: V-222599</a> - The application must maintain the confidentiality and integrity of information during reception.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>The (&lt;http&gt;|&lt;git&gt;) protocol shouldn&#8217;t be used because it isn&#8217;t secure.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>The whole url.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
</div>
</div>