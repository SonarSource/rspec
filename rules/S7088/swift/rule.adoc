== Why is this an issue?

Transport Layer Security (TLS) provides a secure channel between systems communicating over the internet by encrypting the data sent between them. HTTPS uses TLS on top of HTTP to build a secure communication channel.

This secure protocol is essential for the confidentiality and integrity of the communication during supply chain operations. This includes fetching dependencies with the Swift Package Manager (`swift package resolve`, `swift package update`, etc.).

The `Package.swift` manifest file defines a project's dependencies for the Swift Package Manager. When declaring a package dependency, a URL to its Git repository is specified.

It is important that secure schemes are used for these repository URIs. Using `https` provides an additional layer of security by encrypting transferred data and verifying the server's identity.

Using the unencrypted `http` protocol for package dependencies is not generally recommended. It makes the build process vulnerable to man-in-the-middle attacks, which could lead to using compromised dependencies.

include::../common/impact.adoc[]

== How to fix it

Replace insecure `http` URI schema with `https`.

=== Code examples

==== Noncompliant code example

[source,swift,diff-id=1,diff-type=noncompliant]
----
import PackageDescription

let package = Package(
    name: "MyLibrary",
    platforms: [
        .macOS(.v10_15),
    ],
    // ...
    dependencies: [
        .package(url: "http://example.com/my-dependency", from: "1.0.0")  // Noncompliant
    ],
    // ...
)
----

==== Compliant solution

[source,swift,diff-id=1,diff-type=compliant]
----
import PackageDescription

let package = Package(
    name: "MyLibrary",
    platforms: [
        .macOS(.v10_15),
    ],
    // ...
    dependencies: [
        .package(url: "https://example.com/my-dependency", from: "1.0.0")
    ],
    // ...
)
----

== Resources

=== Documentation

* Apple Developer Documentation - https://developer.apple.com/documentation/packagedescription/package[Package]
* Wikipedia - https://en.wikipedia.org/wiki/HTTPS[HTTPS]

include::../common/standards.adoc[]

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

=== Message

* The (<http>|<git>) protocol shouldn't be used because it isn't secure.

=== Highlighting

The whole url.

'''
== Comments And Links
(visible only on this page)

endif::env-github,rspecator-view[]
