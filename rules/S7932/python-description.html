<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when <code>return</code>, <code>break</code>, or <code>continue</code> statements are used to exit a <code>finally</code> block.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using <code>return</code>, <code>break</code>, or <code>continue</code> statements that exit a <code>finally</code> block can lead to confusing control flow and unexpected behavior. When these statements exit a <code>finally</code> block, they can mask exceptions that were raised in the corresponding <code>try</code> or <code>except</code> blocks, making debugging difficult.</p>
</div>
<div class="paragraph">
<p>Starting with Python 3.14, this pattern emits a <code>SyntaxWarning</code> as specified in PEP 765, indicating that this usage is discouraged and may become a syntax error in future Python versions. The <code>finally</code> block is intended for cleanup code that should always execute, regardless of how the <code>try</code> block exits. When control flow statements exit the <code>finally</code> block, they can interfere with this guarantee.</p>
</div>
<div class="paragraph">
<p>Additionally, this pattern can make code harder to understand and maintain, as the actual exit point becomes unclear when reading the code.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Using control flow statements that exit <code>finally</code> blocks can lead to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Debugging difficulties</strong>: The actual cause of issues may be hidden when exceptions are suppressed unexpectedly</p>
</li>
<li>
<p><strong>Future compatibility issues</strong>: Code may break in future Python versions when this becomes a syntax error</p>
</li>
<li>
<p><strong>Reduced code maintainability</strong>: Control flow becomes harder to follow and understand</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_fix">How to fix?</h3>
<div class="paragraph">
<p>Move the return statement outside the finally block and use a variable to store the return value if needed.</p>
</div>
<div class="sect3">
<h4 id="_non_compliant_code_example">Non-compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def risky_function():
    try:
        do_something()
    finally:
        cleanup()
        return "done"  # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_code_example">Compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def safe_function():
    result = None
    try:
        do_something()
        result = "done"
    finally:
        cleanup()
    return result</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Python Documentation - <a href="https://peps.python.org/pep-0765/">PEP 765</a></p>
</li>
<li>
<p>Python Documentation - <a href="https://docs.python.org/3/reference/compound_stmts.html#the-try-statement">The Try Statement</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>