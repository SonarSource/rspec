== Why is this an issue?

Using untrusted input as arguments for system commands can lead to command injection vulnerabilities, allowing attackers to execute arbitrary commands on the server. This can compromise the security and integrity of the system, leading to data breaches, unauthorized access, and other malicious activities.

== How to fix it

When using system commands, avoid passing untrusted input directly as arguments. Instead, implement an allow-list to restrict the arguments to trusted values only. This helps prevent command injection vulnerabilities by ensuring that only safe and expected inputs are used in system commands.

=== Code Examples

==== Noncompliant Code Example

Arguments like `-delete` or `-exec` for the `find` command can alter the expected behavior and result in vulnerabilities:
[source,php,diff-id=1,diff-type=noncompliant]
----
$input = $_GET['input'];
system('/usr/bin/find ' . escapeshellarg($input)); // Noncompliant
----

==== Compliant Solution

Use an allow-list to restrict the arguments to trusted values:
[source,php,diff-id=1,diff-type=compliant]
----
$input = $_GET['input'];
if (in_array($input, $allowed, true)) {
  system('/usr/bin/find ' . escapeshellarg($input));
}
----

== Resources

* OWASP - https://owasp.org/Top10/A03_2021-Injection/[Top 10 2021 Category A3 - Injection]
* OWASP - https://owasp.org/www-project-top-ten/2017/A1_2017-Injection[Top 10 2017 Category A1 - Injection]
* CWE - https://cwe.mitre.org/data/definitions/88[CWE-88 - Argument Injection or Modification]
* https://blog.sonarsource.com/php-supply-chain-attack-on-composer[CVE-2021-29472] - PHP Supply Chain Attack on Composer
* STIG Viewer - https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222609[Application Security and Development: V-222609] - The application must not be subject to input handling vulnerabilities.

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::../message.adoc[]


'''
endif::env-github,rspecator-view[]
