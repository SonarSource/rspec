<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using untrusted input as arguments for system commands can lead to command injection vulnerabilities, allowing attackers to execute arbitrary commands on the server. This can compromise the security and integrity of the system, leading to data breaches, unauthorized access, and other malicious activities.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When using system commands, avoid passing untrusted input directly as arguments. Instead, implement an allow-list to restrict the arguments to trusted values only. This helps prevent command injection vulnerabilities by ensuring that only safe and expected inputs are used in system commands.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code Examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant Code Example</h4>
<div class="paragraph">
<p>Arguments like <code>-delete</code> or <code>-exec</code> for the <code>find</code> command can alter the expected behavior and result in vulnerabilities:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">$input = $_GET['input'];
system('/usr/bin/find ' . escapeshellarg($input)); // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant Solution</h4>
<div class="paragraph">
<p>Use an allow-list to restrict the arguments to trusted values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">$input = $_GET['input'];
if (in_array($input, $allowed, true)) {
  system('/usr/bin/find ' . escapeshellarg($input));
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A03_2021-Injection/">Top 10 2021 Category A3 - Injection</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">Top 10 2017 Category A1 - Injection</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/88">CWE-88 - Argument Injection or Modification</a></p>
</li>
<li>
<p><a href="https://blog.sonarsource.com/php-supply-chain-attack-on-composer">CVE-2021-29472</a> - PHP Supply Chain Attack on Composer</p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222609">Application Security and Development: V-222609</a> - The application must not be subject to input handling vulnerabilities.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure that this user-controlled command argument doesn&#8217;t lead to unwanted behavior.</p>
</div>
<hr>
</div>
</div>
</div>