<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is a common pattern to validate required preconditions at the beginning of a function or block. There are two different kinds of preconditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Preconditions about argument values. An example is the assertion that a function argument lies within a specific range. An <code>IllegalArgumentException</code> should be thrown if these preconditions are violated.</p>
</li>
<li>
<p>Preconditions about the state of the owner or the execution context of the function. An example is when a specific method, such as <code>open</code>, <code>init</code> or <code>prepare</code>, must be called before the current method can be executed. An <code>IllegalStateException</code> should be thrown if these preconditions are violated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Kotlin standard library provides the functions <code>check()</code>, <code>require()</code>, <code>checkNotNull()</code> and <code>requireNotNull()</code> for this purpose.
They should be used instead of directly throwing an <code>IllegalArgumentException</code> or an <code>IllegalStateException</code>.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="sect3">
<h4 id="_readability_and_understanding">Readability and Understanding</h4>
<div class="paragraph">
<p>This change makes it easier to understand the code
because the semantics of <code>check()</code>, <code>require()</code>, <code>checkNotNull()</code> and <code>requireNotNull()</code>,
as well as the fact that this is a preconditions check,
are evident to the reader.
When developers share common standards and idioms, they need to spend less effort understanding each other&#8217;s code.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_redundancy">Code Redundancy</h4>
<div class="paragraph">
<p>Using a built-in language feature or a standard API is always better than a custom implementation,
because the reimplementation of something that already exists is unnecessary.</p>
</div>
</div>
<div class="sect3">
<h4 id="_consistency">Consistency</h4>
<div class="paragraph">
<p>When  <code>check()</code>, <code>require()</code>, <code>checkNotNull()</code> and <code>requireNotNull()</code> are used in an idiomatic way,
there is more consistency in what kind of exception is thrown in which situation.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 60%;">
<col style="width: 40%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Replace</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>With</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>if (!condition) throw IllegalArgumentException()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>require(condition)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>if (reference == null) throw IllegalArgumentException()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requireNotNull(reference)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>require(reference != null)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requireNotNull(reference)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>if (!condition) throw IllegalStateExceptionException()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>check(condition)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>if (reference == null) throw IllegalStateException()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>checkNotNull(reference)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>check(reference != null)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>checkNotNull(reference)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>throw IllegalStateException()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>error()</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A constructor function for the exception message can be provided
as an optional argument
for <code>check()</code>, <code>require()</code>, <code>checkNotNull()</code> and <code>requireNotNull()</code>.
This means the message is constructed only if the exception is thrown.
For the <code>error()</code> function, an optional error message parameter can be provided directly.
That is, without a parameter, because an exception is unconditionally thrown by <code>error()</code>.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">fun argumentPreconditions(argument: Int?, limit: Int?) {
    if (argument == null) throw IllegalArgumentException() // Noncompliant, replace with requireNotNull
    require(limit != null)  // Noncompliant, replace with requireNotNull
    if (argument &lt; 0) throw IllegalArgumentException()  // Noncompliant, replace with require
    if (argument &gt;= 0) throw IllegalArgumentException("Argument &lt; $limit") // Noncompliant, replace with require
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">fun argumentPreconditions(argument: Int?, limit: Int?) {
    requireNotNull(argument) // Compliant
    requireNotNull(limit) // Compliant
    require(argument &gt;= 0) // Compliant
    require(argument &lt; limit) {"Argument &lt; $limit"} // Compliant
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">fun statePreconditions() {
    if (state == null) throw IllegalStateException() // Noncompliant, replace with checkNotNull
    check(ioBuffer != null)  // Noncompliant, replace with checkNotNull
    if (state &lt; 0) throw IllegalStateException()  // Noncompliant, replace with check
    if (state == 42) throw IllegalStateException("Unknown question") // Noncompliant, replace with check

    when(state) {
        0..10 -&gt; processState1()
        11..1000 -&gt; processState2()
        else -&gt; throw IllegalStateException("Unexpected state $state") // Noncompliant, replace with error
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">fun statePreconditions() {
    checkNotNull(state) // Compliant
    checkNotNull(ioBuffer) // Compliant
    check(state &gt;= 0) // Compliant
    check(state != 42) {"Unknown question"} // Compliant

    when(state) {
        0..10 -&gt; processState1()
        11..1000 -&gt; processState2()
        else -&gt; error("Unexpected state $state") // Compliant
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/require.html">Kotlin API Docs, require</a></p>
</li>
<li>
<p><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/check.html">Kotlin API Docs, check</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://bignerdranch.com/blog/write-better-code-using-kotlins-require-check-and-assert/">Jeremy W. Sherman, Write Better Code Using Kotlinâ€™s Require, Check and Assert</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>