<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You should avoid recording time instants with the use of property <code>DateTime.Now</code>.
The property <code>DateTime.Now</code> returns the current date and time expressed in the machine&#8217;s local time without containing any timezone-related information (for example, the offset from Coordinated Universal Time).
Not having this information means that if you need to display this <code>DateTime</code> object or use it for computations in another machine placed in a different time zone, you won&#8217;t be able to reconstruct it in the second machine&#8217;s local time without knowing the origin&#8217;s offset. This will likely lead to confusion and potential bugs.</p>
</div>
<div class="paragraph">
<p>Instead, you should record the <code>DateTime</code> instants in UTC, which gives you the date and time as it is in the Coordinated Universal Time. UTC is a time standard for all time zones and is not subjected to Daylight Saving Time (DST).</p>
</div>
<div class="paragraph">
<p>Similarly, the use of the <code>DateTime.Today</code> property should also be avoided, as it can return different date values depending on the time zone.</p>
</div>
<div class="paragraph">
<p>Generally, unless the purpose is to only display the Date and Time to a user on their local machine, you should always use UTC (for example, when storing dates in a datebase or using them for calculations).</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>You can end up with <code>DateTime</code> instants that have no meaning for anyone except the machine they were recorded on.
Using UTC gives an unambiguous representation of an instant, and this UTC instant can be transformed into any equivalent local time. This operation isn&#8217;t reversible as some local times are ambiguous and can be matched to more than one UTC instant (for example, due to daylight savings).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Instead of <code>DateTime.Now</code> use any of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DateTime.UtcNow</code>,</p>
</li>
<li>
<p><code>DateTimeOffSet.Now</code> (as it contains offset information)</p>
</li>
<li>
<p><code>DateTimeOffSet.UtcNow</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Instead of <code>DateTime.Today</code> use any of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DateTime.UtcNow.Date</code>,</p>
</li>
<li>
<p><code>DateOnly.FromDateTime(DateTime.UtcNow)</code> (.NET 6.0+)</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">void LogDateTime()
{
    using var streamWriter = new StreamWriter("logs.txt", true);
    streamWriter.WriteLine($"DateTime:{DateTime.Now.ToString("o")}"); // This log won't have any meaning if it's reconstructed in a machine in a different timezone.
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">void LogDateTime()
{
    using var streamWriter = new StreamWriter("logs.txt", true);
    streamWriter.WriteLine($"DateTime:{DateTime.UtcNow.ToString("o")}");
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.datetime.now">DateTime.Now Property</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.datetime.utcnow">DateTime.UtcNow Property</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.datetime.today">DateTime.Today Property</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.datetimeoffset">DateTimeOffset Struct</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.dateonly.fromdatetime">DateOnly.FromDateTime(DateTime) Method</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/standard/datetime/resolve-ambiguous-times">How to: Resolve ambiguous times</a></p>
</li>
<li>
<p>Time and Date - <a href="https://www.timeanddate.com/time/zone/timezone/utc">Time Zone in UTC - What Is UTC?</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p>StackOverflow - <a href="https://stackoverflow.com/a/2580518">Ambiguous times by John Skeet</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>