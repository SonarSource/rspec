:example_libraries: sqflite and sqflite_sqlcipher

include::../description.adoc[]

include::../ask-yourself.adoc[]

include::../recommended.adoc[]

The encryption password should not be hard-coded in the application. There are different approaches how the password can be provided to encrypt and decrypt the database, such as using https://pub.dev/packages/flutter_secure_storage[`flutter_secure_storage`]. The password can also be provided dynamically by the user of the application or it can be fetched from a remote server if the other methods are not feasible.

== Sensitive Code Example

For the https://pub.dev/packages/sqflite[`sqflite` package]:

[source,dart]
----
import 'package:sqflite/sqflite.dart';

void openDb() async {
  final db = await openDatabase("test.db"); // Noncompliant: no password support
  await db.execute("CREATE TABLE Test (id INTEGER PRIMARY KEY, name TEXT)");
}
----

For the https://pub.dev/packages/sqflite_sqlcipher[`sqflite_sqlcipher` package]:

[source,dart]
----
import 'package:sqflite_sqlcipher/sqflite.dart';

void openDb() async {
  final db = await openDatabase("test.db"); // Noncompliant: missing password
  await db.execute("CREATE TABLE Test (id INTEGER PRIMARY KEY, name TEXT)");
}
----

== Compliant Solution

Instead of the `openDatabase` function of the `sqflite` package, you can use the equivalent function in the https://pub.dev/packages/sqflite_sqlcipher[`sqflite_sqlcipher` package], that comes with a `password` parameter to encrypt the database:

[source,dart]
----
import 'package:sqflite_sqlcipher/sqflite.dart';

void openDb() async {
  final db = await openDatabase("test.db", password: "password"); // Compliant
  await db.execute("CREATE TABLE Test (id INTEGER PRIMARY KEY, name TEXT)");
}
----

include::../see.adoc[]


ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::../message.adoc[]

endif::env-github,rspecator-view[]
