<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The function <code>size_t strlen(const char *s)</code> measures the length of the string <code>s</code> (excluding the final null character).<br>
The function <code>size_t wcslen(const wchar_t *s)</code> does the same for wide characters, and should be used with the same guidelines.</p>
</div>
<div class="paragraph">
<p>Similarly to many other functions in the standard C libraries,
<code>strlen</code> and <code>wcslen</code> assume that their argument is not a null pointer.</p>
</div>
<div class="paragraph">
<p>Additionally, they expect the strings to be null-terminated.
For example, the 5-letter string "abcde" must be stored in memory as "abcde\0" (i.e. using 6 characters) to be processed correctly.
When a string is missing the null character at the end, these functions will iterate past the end of the buffer, which is undefined behavior.</p>
</div>
<div class="paragraph">
<p>Therefore, string parameters must end with a proper null character.
The absence of this particular character can lead to security vulnerabilities that allow, for example, access to sensitive data or the execution of arbitrary code.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>There is a possibility that the pointer is null.</p>
</li>
<li>
<p>There is a possibility that the string is not correctly null-terminated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Use safer functions. The C11 functions <code>strlen_s</code> and <code>wcslen_s</code> from annex K handle typical programming errors.<br>
Note, however, that they have a runtime overhead and require more code for error handling and therefore are not suited to every case.</p>
</li>
<li>
<p>Even if your compiler does not exactly support annex K, you probably have access to similar functions.</p>
</li>
<li>
<p>If you are writing C&#43;&#43; code, using <code>std::string</code> to manipulate strings is much simpler and less error-prone.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">size_t f(char *src) {
  char dest[256];
  strncpy(dest, src, sizeof dest); // Truncation may happen
  return strlen(dest); // Sensitive: "dest" will not be null-terminated if truncation happened
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">size_t f(char *src) {
  char dest[256];
  strncpy(dest, src, sizeof dest); // Truncation may happen
  dest[sizeof dest - 1] = 0;
  return strlen(dest); // Compliant: "dest" is guaranteed to be null-terminated
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/120">CWE-120 - Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')</a></p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/HdcxBQ">CERT, STR07-C.</a> - Use the bounds-checking interfaces for string manipulation</p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222612">Application Security and Development: V-222612</a> - The application must not be vulnerable to overflow attacks.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure use of "strlen" is safe here.</p>
</div>
</div>
</div>
</div>