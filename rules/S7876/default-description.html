<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when Rails controllers load entire collections without pagination, when views render large collections without limits, or when nested associations are loaded upfront without lazy loading strategies.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Loading large datasets without pagination can cause serious performance problems in Rails applications. When controllers use methods like <code>Post.all</code> or <code>User.all</code>, they load every record from the database into memory at once. This approach becomes problematic as your data grows.</p>
</div>
<div class="paragraph">
<p>The main issues include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Memory consumption</strong>: Loading thousands of records consumes significant server memory, potentially causing out-of-memory errors</p>
</li>
<li>
<p><strong>Slow database queries</strong>: Fetching all records creates expensive database operations that block other requests</p>
</li>
<li>
<p><strong>Poor user experience</strong>: Pages take longer to load, and users may experience timeouts</p>
</li>
<li>
<p><strong>Excessive DOM size</strong>: Rendering all records creates large HTML documents that slow down browser rendering and JavaScript execution</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For nested associations, the problem compounds. Loading all comments with their replies using <code>includes(comments: :replies)</code> can result in massive data transfers and memory usage, especially for popular posts with hundreds of comments.</p>
</div>
<div class="paragraph">
<p>These performance issues become more severe as your application scales and your dataset grows, making pagination essential for maintaining good performance.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Applications may experience memory exhaustion, slow response times, database timeouts, and poor user experience. In extreme cases, servers may crash due to out-of-memory errors when handling large datasets. The browser may also become unresponsive when rendering excessive DOM elements.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_rails">How to fix it in Rails</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use pagination gems like Kaminari to limit records loaded in controllers. This prevents loading all records into memory and provides a better user experience.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">class PostsController &lt; ApplicationController
  def index
    @posts = Post.all # Noncompliant: loads all records
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">class PostsController &lt; ApplicationController
  def index
    @posts = Post.page(params[:page]).per(10)
  end
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>Apply pagination to view rendering to limit the number of elements rendered in the DOM. This prevents excessive DOM size and improves page performance.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_code_examples_2">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-erb" data-lang="erb">&lt;% @post.comments.each do |comment| %&gt;
  &lt;%= render comment %&gt; &lt;!-- Noncompliant: renders all comments --&gt;
&lt;% end %&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-erb" data-lang="erb">&lt;% @post.comments.page(params[:page]).per(10).each do |comment| %&gt;
  &lt;%= render comment %&gt;
&lt;% end %&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use lazy loading with limits for nested associations instead of loading all related data upfront. This reduces memory usage and improves query performance.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_code_examples_3">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example_3">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"># Loading all nested associations upfront
@post = Post.includes(comments: :replies).find(params[:id]) # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_3">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby"># Lazy loading with limits
@post = Post.find(params[:id])
@comments = @post.comments.includes(:user).limit(5)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Kaminari Gem Documentation - <a href="https://github.com/kaminari/kaminari">Popular pagination gem for Rails applications with flexible configuration options</a></p>
</li>
<li>
<p>Rails Active Record Query Interface - <a href="https://guides.rubyonrails.org/active_record_querying.html">Official Rails guide covering query optimization and pagination techniques</a></p>
</li>
<li>
<p>will_paginate Gem - <a href="https://github.com/mislav/will_paginate">Alternative pagination gem with simple API for Rails applications</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP Top 10:2021-A06-Vulnerable and Outdated Components - <a href="https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/">Performance issues can lead to denial of service vulnerabilities</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>