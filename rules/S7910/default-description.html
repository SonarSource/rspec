<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when lambda functions in configuration contexts perform operations without proper exception handling or state validation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Lambda functions used in configuration hashes (such as action handlers, callbacks, or operation definitions) are often executed in runtime contexts where failures can cause user-visible errors or application crashes.</p>
</div>
<div class="paragraph">
<p>When these lambda functions call methods on objects without defensive programming practices, several problems can occur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Runtime exceptions</strong>: If the underlying method fails (e.g., database constraints, validation errors), the exception propagates up and can crash the application or display error pages to users.</p>
</li>
<li>
<p><strong>Invalid state operations</strong>: Operations performed on records that are not persisted, have missing attributes, or are in invalid states can lead to unexpected behavior or data corruption.</p>
</li>
<li>
<p><strong>Nil reference errors</strong>: When objects or attributes are nil, method calls will raise <code>NoMethodError</code> exceptions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These issues are particularly problematic in configuration contexts because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The lambda functions are often called from framework code that may not have proper error handling</p>
</li>
<li>
<p>Failures occur during user interactions (like clicking buttons or performing actions)</p>
</li>
<li>
<p>The errors may not be immediately obvious during development but surface in production with real data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Defensive programming practices help ensure that lambda functions handle edge cases gracefully and maintain application stability even when underlying operations fail or data is in unexpected states.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Runtime failures can cause application crashes, display error pages to users, or result in inconsistent data states. In user-facing features like record ordering or status updates, unhandled exceptions create a poor user experience and may leave the application in an inconsistent state.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add exception handling using <code>rescue</code> to gracefully handle method failures and return safe default values.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">actions: {
  higher: -&gt; { record.move_higher }, # Noncompliant
  lower: -&gt; { record.move_lower }   # Noncompliant
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">actions: {
  higher: -&gt; { record.move_higher rescue false },
  lower: -&gt; { record.move_lower rescue false }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Ruby Exception Handling - <a href="https://ruby-doc.org/core/doc/syntax/exceptions_rdoc.html">Official Ruby documentation on exception handling with rescue clauses</a></p>
</li>
<li>
<p>Safe Navigation Operator - <a href="https://ruby-doc.org/core/doc/syntax/calling_methods_rdoc.html#label-Safe+navigation+operator">Documentation on Ruby&#8217;s safe navigation operator (&amp;.) for handling nil values</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>