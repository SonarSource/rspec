<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is an issue when Flask applications handle form data using <code>request.form</code> directly without CSRF protection or proper validation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Basic Flask form handling using <code>request.form</code> lacks essential security features that make web applications vulnerable to attacks.</p>
</div>
<div class="paragraph">
<p>The most critical missing feature is CSRF (Cross-Site Request Forgery) protection. Without CSRF tokens, malicious websites can trick users into submitting forms on your application without their knowledge. For example, a malicious site could create a hidden form that transfers money or changes user settings when the user visits the page.</p>
</div>
<div class="paragraph">
<p>Basic form handling also lacks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Built-in input validation, making it easy to accept invalid or malicious data</p>
</li>
<li>
<p>Proper error handling and user feedback mechanisms</p>
</li>
<li>
<p>Consistent form rendering and field management</p>
</li>
<li>
<p>Protection against common web vulnerabilities</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Flask-WTF addresses these issues by automatically generating and validating CSRF tokens, providing robust field validation, and offering a cleaner, more secure approach to form handling.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Applications become vulnerable to CSRF attacks where malicious websites can submit forms on behalf of authenticated users. This can lead to unauthorized actions like data modification, account changes, or financial transactions. Additionally, lack of proper validation can result in data corruption, application errors, or injection attacks.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Replace basic Flask form handling with Flask-WTF. Install Flask-WTF, create form classes with validation, and use CSRF protection.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from flask import Flask, request, render_template

app = Flask(__name__)

@app.route('/contact', methods=['GET', 'POST'])
def contact():
    if request.method == 'POST':
        name = request.form['name']  # Noncompliant
        email = request.form['email']  # Noncompliant
        # No CSRF protection or validation
        return f'Thank you {name}!'
    return render_template('contact.html')</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from flask import Flask, render_template, flash, redirect, url_for
from flask_wtf import FlaskForm
from wtforms import StringField, SubmitField
from wtforms.validators import DataRequired, Email

app = Flask(__name__)
app.secret_key = 'your-secret-key'

class ContactForm(FlaskForm):
    name = StringField('Name', validators=[DataRequired()])
    email = StringField('Email', validators=[DataRequired(), Email()])
    submit = SubmitField('Submit')

@app.route('/contact', methods=['GET', 'POST'])
def contact():
    form = ContactForm()
    if form.validate_on_submit():
        flash(f'Thank you {form.name.data}!')
        return redirect(url_for('contact'))
    return render_template('contact.html', form=form)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Flask-WTF Documentation - <a href="https://flask-wtf.readthedocs.io/">Official Flask-WTF documentation covering CSRF protection, form validation, and security features</a></p>
</li>
<li>
<p>WTForms Documentation - <a href="https://wtforms.readthedocs.io/">Documentation for WTForms library used by Flask-WTF for form field definitions and validation</a></p>
</li>
<li>
<p>Flask Security Best Practices - <a href="https://flask.palletsprojects.com/en/2.3.x/security/">Flask&#8217;s official security guidelines including CSRF protection recommendations</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP Top 10 2021 A1 - <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">Broken Access Control - includes CSRF vulnerabilities</a></p>
</li>
<li>
<p>CWE 352 - <a href="https://cwe.mitre.org/data/definitions/352.html">Cross-Site Request Forgery (CSRF)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>