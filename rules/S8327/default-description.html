<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when Jenkins pipeline scripts use direct Java or Groovy file I/O operations like <code>new File()</code>, <code>Files.copy()</code>, or <code>FileUtils</code> instead of Jenkins-provided pipeline steps.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jenkins pipelines have a unique execution model that requires special handling of file operations. Direct Java or Groovy file I/O operations cause several critical problems:</p>
</div>
<div class="paragraph">
<p><strong>Serialization failures</strong>: Jenkins pipelines must serialize their entire state to disk when they pause for asynchronous operations or when Jenkins restarts. Direct file operations create non-serializable objects that break this mechanism, causing pipeline failures during restarts.</p>
</div>
<div class="paragraph">
<p><strong>Security sandbox violations</strong>: Jenkins uses a Groovy security sandbox to prevent malicious scripts from accessing the file system directly. Direct file operations are blocked by this sandbox and require administrator approval, which defeats the security purpose.</p>
</div>
<div class="paragraph">
<p><strong>Incorrect execution location</strong>: In distributed Jenkins environments, direct file operations execute on the Jenkins master node instead of the intended build agent. This violates Jenkins' architecture where heavy operations should run on agents, not the master.</p>
</div>
<div class="paragraph">
<p><strong>Workspace management bypass</strong>: Jenkins pipeline steps are designed to work correctly with Jenkins' workspace management, handling permissions, paths, and distributed file systems properly. Direct operations bypass these safeguards.</p>
</div>
<div class="paragraph">
<p>Jenkins provides purpose-built pipeline steps like <code>readFile()</code>, <code>writeFile()</code>, and shell commands that are designed to work safely within the pipeline execution model.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Using direct file I/O operations can cause pipeline failures when Jenkins restarts, security violations that require administrator intervention, and incorrect execution on the master node instead of build agents. This can lead to performance issues, security vulnerabilities, and unreliable builds in distributed Jenkins environments.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Replace direct file reading operations with the <code>readFile()</code> pipeline step. This step works correctly with Jenkins' serialization and distributed execution model.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">// Reading files with direct File operations
new File(env.SERVICE_VERSIONS_FILE).each { line -&gt;
    echo "$line" // Noncompliant
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">// Using Jenkins readFile step
readFile(env.SERVICE_VERSIONS_FILE).split("\n").each { line -&gt;
    echo "$line"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Jenkins Pipeline Steps Reference - <a href="https://www.jenkins.io/doc/pipeline/steps/">Official documentation for Jenkins pipeline steps including readFile and writeFile</a></p>
</li>
<li>
<p>Pipeline: Groovy Plugin Documentation - <a href="https://plugins.jenkins.io/workflow-cps/">Documentation explaining Jenkins pipeline execution model and serialization requirements</a></p>
</li>
<li>
<p>File Operations Plugin - <a href="https://plugins.jenkins.io/file-operations/">Jenkins plugin providing safe file operation steps for pipelines</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>