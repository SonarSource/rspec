include::../description.adoc[]

include::../ask-yourself.adoc[]

include::../recommended.adoc[]

== Sensitive Code Example

[source,ruby,diff-id=1,diff-type=noncompliant]
----
cookies[:example] = { value: "Value of example cookie" } # Sensitive: Secure is false by default
----

== Compliant Solution

[source,ruby,diff-id=1,diff-type=compliant]
----
cookies[:example] = { value: "Value of example cookie", secure: true }
----

The compliant solution is to set the `secure` flag to `true` for the cookie.

Alternatively, setting `config.force_ssl` to `true` in the Rails application configuration enables the `ActionDispatch::SSL` middleware, which enforces several crucial security policies: it redirects all HTTP requests to HTTPS, enables HTTP Strict Transport Security (HSTS), and *automatically adds the secure flag to all cookies*.

include::../see.adoc[]

* Rails Documentation - https://api.rubyonrails.org/classes/ActionDispatch/SSL.html[ActionDispatch::SSL]

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::../message.adoc[]

'''
== Comments And Links
(visible only on this page)

include::../comments-and-links.adoc[]

endif::env-github,rspecator-view[]
