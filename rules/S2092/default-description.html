<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a cookie is protected with the <code>secure</code> attribute set to <em>true</em> it will not be send by the browser over an unencrypted HTTP request and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>the cookie is for instance a <em>session-cookie</em>  not designed to be sent over non-HTTPS communication.</p>
</li>
<li>
<p>it&#8217;s not sure that the website contains <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content">mixed content</a> or not (ie HTTPS everywhere or not)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>It is recommended to use <code>HTTPs</code> everywhere so setting the <code>secure</code> flag to <em>true</em> should be the default behaviour when creating cookies.</p>
</li>
<li>
<p>Set the <code>secure</code> flag to <em>true</em> for session-cookies.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the <code>HttpCookie.Secure</code> property is set to <code>false</code> then the cookie will be send during an unencrypted HTTP request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>HttpCookie myCookie = new HttpCookie("Sensitive cookie");
myCookie.Secure = false; //  Sensitive: a security-sensitive cookie is created with the secure flag set to false</pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.httpcookie.secure?view=netframework-4.8">default value</a> of <code>Secure</code> flag is <code>false</code>, unless overwritten by an application&#8217;s configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>HttpCookie myCookie = new HttpCookie("Sensitive cookie");
//  Sensitive: a security-sensitive cookie is created with the secure flag not defined (by default set to false)</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Set the <code>HttpCookie.Secure</code> property to <code>true</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">HttpCookie myCookie = new HttpCookie("Sensitive cookie");
myCookie.Secure = true; // Compliant</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or change the default flag values for the whole application by editing the <a href="https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/ms228262(v=vs.100)">Web.config configuration file</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">&lt;httpCookies httpOnlyCookies="true" requireSSL="true" /&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>requireSSL</code> attribute corresponds programmatically to the <code>Secure</code> field.</p>
</li>
<li>
<p>the <code>httpOnlyCookies</code> attribute corresponds programmatically to the <code>httpOnly</code> field.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">Top 10 2021 Category A4 - Insecure Design</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">Top 10 2021 Category A5 - Security Misconfiguration</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/311">CWE-311 - Missing Encryption of Sensitive Data</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/315">CWE-315 - Cleartext Storage of Sensitive Information in a Cookie</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/614">CWE-614 - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222576">Application Security and Development: V-222576</a> - The application must set the secure flag on session cookies.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure creating this cookie without setting the 'Secure' property is safe here.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_12_dec_2014_205833_sébastien_gioria_wrote">on 12 Dec 2014, 20:58:33 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>This rule must apply on Session cookie but not on all cookie. SomeTime it&#8217;s not a problem to send cookie on HTTP channel</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_15_dec_2014_102432_freddy_mallet_wrote">on 15 Dec 2014, 10:24:32 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>I see your point [~sebastien.gioria] but for the time being we don&#8217;t see anyway to know exactly what is the type of cookie.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_2_jun_2015_092527_sébastien_gioria_wrote">on 2 Jun 2015, 09:25:27 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>I could be at OWASP-top10-A6 and OWASP-Top10-A2</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_jun_2015_203551_ann_campbell_wrote">on 3 Jun 2015, 20:35:51 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks [~sebastien.gioria]. A6 was already listed, but I&#8217;ve added A2.</p>
</div>
</div>
</div>
</div>