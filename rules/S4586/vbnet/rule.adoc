== Why is this an issue?

Returning `Nothing` from a non-`Async` `Task`/`Task(Of T)` method will cause a `NullReferenceException` at runtime if the method is awaited. This problem can be avoided by returning https://learn.microsoft.com/en-us/dotnet/api/system.threading.tasks.task.completedtask[`Task.CompletedTask`] or https://learn.microsoft.com/en-us/dotnet/api/system.threading.tasks.task.fromresult[`Task.FromResult<T>(TResult)`] respectively.

[source,vbnet,diff-id=1,diff-type=noncompliant]
----
Public Function DoFooAsync() As Task
    Return Nothing            ' Noncompliant: Causes a NullReferenceException if awaited.
End Function

Public Async Function Main() As Task
    Await DoFooAsync()        ' NullReferenceException
End Function
----

[source,vbnet,diff-id=1,diff-type=compliant]
----
Public Function DoFooAsync() As Task
    Return Task.CompletedTask ' Compliant: Method can be awaited.
End Function

Public Async Function Main() As Task
    Await DoFooAsync()
End Function
----

[source,vbnet,diff-id=2,diff-type=noncompliant]
----
Public Function GetFooAsync() As Task(Of Object)
    Return Nothing                             ' Noncompliant: Causes a NullReferenceException if awaited.
End Function
----

[source,vbnet,diff-id=2,diff-type=compliant]
----
Public Function GetFooAsync() As Task(Of Object)
    Return Task.FromResult(Of Object)(Nothing) ' Compliant: Method can be awaited.
End Function
----

include::../resources.adoc[]

include::../rspecator.adoc[]