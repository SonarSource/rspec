<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using <code>File.createTempFile</code> as the first step in creating a temporary directory causes a race condition and is inherently unreliable and insecure. Instead, <code>Files.createTempDirectory</code> (Java 7+) or a library function such as Guava&#8217;s similarly-named <code>Files.createTempDir</code> should be used.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when the following steps are taken in immediate sequence:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>call to <code>File.createTempFile</code></p>
</li>
<li>
<p>delete resulting file</p>
</li>
<li>
<p>call <code>mkdir</code> on the File object</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note</strong> that this rule is automatically disabled when the project&#8217;s <code>sonar.java.source</code> is lower than <code>7</code>.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">File tempDir;
tempDir = File.createTempFile("", ".");
tempDir.delete();
tempDir.mkdir();  // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Path tempPath = Files.createTempDirectory("");
File tempDir = tempPath.toFile();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use "Files.createTempDirectory" or a library function to create this directory instead.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_26_may_2015_120103_ann_campbell_wrote">on 26 May 2015, 12:01:03 Ann Campbell wrote:</h3>
<div class="paragraph">
<p><a href="http://nemo.sonarqube.org/coding_rules#rule_key=grvy%3Aorg.codenarc.rule.security.FileCreateTempFileRule" class="bare">http://nemo.sonarqube.org/coding_rules#rule_key=grvy%3Aorg.codenarc.rule.security.FileCreateTempFileRule</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_may_2015_064407_nicolas_peru_wrote">on 29 May 2015, 06:44:07 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Spec looks good.</p>
</div>
<div class="paragraph">
<p>\[~ann.campbell.2] I am wondering about the targeted language Groovy : rule is covered by codenarc and AFAIK we don&#8217;t have any intention to develop our own groovy analyzer. So should it be covered instead of targeted for groovy ?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_may_2015_144700_ann_campbell_wrote">on 29 May 2015, 14:47:00 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>I wouldn&#8217;t mark it covered based on a 3rd-party tool. I set it to targeted in case we ever do decide to write our own Groovy rules.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_1_jun_2015_150721_nicolas_peru_wrote">on 1 Jun 2015, 15:07:21 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Ok !</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_aug_2019_110423_pierre_loup_tristant_wrote">on 19 Aug 2019, 11:04:23 Pierre-Loup Tristant wrote:</h3>
<div class="paragraph">
<p><a href="https://guava.dev/releases/19.0/api/docs/com/google/common/io/Files.html#createTempDir(" class="bare">https://guava.dev/releases/19.0/api/docs/com/google/common/io/Files.html#createTempDir(</a>)</p>
</div>
</div>
</div>
</div>