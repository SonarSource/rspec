The universal way to prevent path injection is to validate paths constructed from untrusted data. 

The validation should be done as follow:

1. Resolve the canonical path of the file by using methods like `{canonicalization_function}`. This will resolve relative path or path components like `../` and removes any ambiguity regarding the file's location. 
2. Check that the canonical path is within the directory where the file should be located.