=== How to fix it in .NET

:canonicalization_function: System.IO.Path.GetFullPath
include::../../common/fix/code-rationale.adoc[]

[cols="a"]
|===
h| Non-compliant code example
|
[source,csharp]
----
public class ExampleController : Controller
{
    private static string TargetDirectory;

    public void Example(string filename)
    {
        string path = Path.Combine(TargetDirectory, filename);
        System.IO.File.Delete(path); // Noncompliant
    }
}
----
h| Compliant solution
|
[source,csharp]
----
public class ExampleController : Controller
{
    private static string TargetDirectory;

    public void Example(string filename)
    {
        string path = Path.Combine(TargetDirectory, filename);
        string canonicalDestinationPath = Path.GetFullPath(path);

        if (canonicalDestinationPath.StartsWith(TargetDirectory, StringComparison.Ordinal))
        {
            System.IO.File.Delete(canonicalDestinationPath);
        }
    }
}
----
|===

=== How does this work?

include::../../common/fix/how-does-this-work.adoc[]
