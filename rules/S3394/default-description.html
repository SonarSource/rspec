<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This defect can cause corrupted data to be stored and lead to errors and
vulnerabilities in parts of the code that assume the data is valid and use it
without verification.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>ACCEPT</code> statement causes data entered at the console or provided by the
operating system to be made available to the program in a specific data
element, without any validation or sanitization.</p>
</div>
<div class="paragraph">
<p>Thus, if this data is accepted in a particular format and used by other
procedures, the system is vulnerable to attack or malfunction.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>The lack of data validation and error checking when using the ACCEPT keyword in
COBOL can lead to a number of security problems.</p>
</div>
<div class="sect3">
<h4 id="_data_integrity_problems">Data integrity problems</h4>
<div class="paragraph">
<p>Without any form of validation, the ACCEPT keyword can store arbitrary input
data, even if it does not conform to the expected format or type. This can lead
to data corruption, causing the program to behave unpredictably, crash, or
corrupt customer data.</p>
</div>
</div>
<div class="sect3">
<h4 id="_injection_attacks">Injection attacks</h4>
<div class="paragraph">
<p>Malicious users can enter data that contains commands or queries that are then
executed by other procedures. This can lead to unauthorized access, data leaks,
or intrusions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_denial_of_service_dos_attacks">Denial of Service (DoS) attacks</h4>
<div class="paragraph">
<p>An attacker could exploit this vulnerability to overload the system with large
amounts of data or special characters, causing the program to slow down or even
stop working, resulting in a denial of service.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exceptions">Exceptions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule ignores the uses of <code>ACCEPT FROM</code> with date/time-related inputs.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="paragraph">
<p>In this specific example, <code>USER-INPUT</code> is expected to be numeric by the system.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cobol" data-lang="cobol">IDENTIFICATION DIVISION.
PROGRAM-ID. EXAMPLE.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-NUMERIC PIC X VALUE 'N'.
01 USER-INPUT PIC X(4).

PROCEDURE DIVISION.
EXAMPLE-PROCEDURE.
    MOVE 'N' TO WS-NUMERIC.
    PERFORM UNTIL WS-NUMERIC = 'Y'
        DISPLAY 'ENTER YOUR 4 DIGIT RECORD NUMBER: ' NO ADVANCING
        ACCEPT USER-INPUT FROM CONSOLE *&gt; Noncompliant
        MOVE 'Y' TO WS-NUMERIC
    END-PERFORM
    STOP RUN.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>To mitigate the risks associated with the ACCEPT keyword in COBOL, you should
implement data validation and error checking, or directly avoid using <code>ACCEPT</code>
altogether.</p>
</div>
<div class="sect3">
<h4 id="_data_validation_routines">Data Validation Routines</h4>
<div class="paragraph">
<p>Before using the data coming from ACCEPT, validate the data using custom
routines. These routines should check if the data meets the expected format and
type. For example, if you&#8217;re expecting a number, the routine should check if the
input data is indeed a number.</p>
</div>
</div>
<div class="sect3">
<h4 id="_limit_data_size">Limit Data Size</h4>
<div class="paragraph">
<p>To prevent potential DoS attacks, limit the size of the data that can be
accepted and make sure that the exact same size is assumed and expected while
the data transmitted from <code>ACCEPT</code> to other routines.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A03_2021-Injection/">Top 10 2021 Category A3 - Injection</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">Top 10 2017 Category A1 - Injection</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Remove this use of "ACCEPT".</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>the <code>ACCEPT</code> statement - so both <code>ACCEPT</code> and what the input is being accepted into.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_3_nov_2015_202313_ann_campbell_wrote">on 3 Nov 2015, 20:23:13 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~pierre-yves.nicolas], I wrote the exception based on <a href="http://supportline.microfocus.com/Documentation/AcucorpProducts/docs/v6_online_doc/gtman3/gt3678.htm">this</a> but suspect it should be expanded to include more cases.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_5_nov_2015_120530_pierre_yves_nicolas_wrote">on 5 Nov 2015, 12:05:30 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] The documentation you found is specific to AcuCobol which adds many extensions on top of "standard" COBOL. I suggest to keep only the exception about date/time and to not activate that rule by default.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_5_nov_2015_142813_ann_campbell_wrote">on 5 Nov 2015, 14:28:13 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Okay [~pierre-yves.nicolas]. Done</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_21_mar_2017_175400_pierre_yves_nicolas_wrote">on 21 Mar 2017, 17:54:00 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] The scope of this rule changed completely: it used to be "ACCEPT should not be used" and is now "Track uses of forbidden statements". I don&#8217;t see how we can keep the exception for <code>ACCEPT FROM</code> with the new scope.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_22_mar_2017_090425_ann_campbell_wrote">on 22 Mar 2017, 09:04:25 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~pierre-yves.nicolas] I&#8217;ve reverted this rule &amp; created <a data-rspec-id="S3938" class="rspec-auto-link">RSPEC-3938</a></p>
</div>
</div>
</div>
</div>