<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when converting a <code>Date</code> object to a UNIX timestamp using <code>to_time.to_i</code>, which creates timezone-dependent behavior.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Converting <code>Date</code> objects to UNIX timestamps using <code>date.to_time.to_i</code> can produce inconsistent results across different systems and environments.</p>
</div>
<div class="paragraph">
<p>When you call <code>to_time</code> on a <code>Date</code> object, Ruby creates a <code>Time</code> object using the system&#8217;s local timezone. This means the same date will produce different timestamps depending on where your code runs. For example, December 25th, 2023 at midnight will have different UNIX timestamps in New York versus Tokyo.</p>
</div>
<div class="paragraph">
<p>This timezone dependency can cause several problems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Inconsistent behavior</strong>: The same code produces different results on different servers or developer machines</p>
</li>
<li>
<p><strong>Data corruption</strong>: Timestamps may be off by several hours, leading to incorrect time-based calculations</p>
</li>
<li>
<p><strong>Hard-to-debug issues</strong>: Problems may only appear when code runs in production environments with different timezone settings</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>UNIX timestamps are meant to represent absolute points in time, independent of timezone. When timezone conversion happens unexpectedly, it defeats this purpose and can lead to subtle but serious bugs in time-sensitive applications.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Applications may store incorrect timestamps, leading to data inconsistency, failed time-based operations, or incorrect business logic execution. In distributed systems, this can cause synchronization issues between services running in different timezones.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use <code>Time.utc()</code> with explicit date components to create a UTC timestamp. This approach is explicit about timezone handling and produces consistent results.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">date = Date.new(2023, 12, 25)
timestamp = date.to_time.to_i  # Noncompliant: uses local timezone</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">date = Date.new(2023, 12, 25)
timestamp = Time.utc(date.year, date.month, date.day).to_i</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Ruby Date Class Documentation - <a href="https://ruby-doc.org/stdlib-3.0.0/libdoc/date/rdoc/Date.html">Official Ruby documentation for the Date class and its methods</a></p>
</li>
<li>
<p>Ruby Time Class Documentation - <a href="https://ruby-doc.org/core-3.0.0/Time.html">Official Ruby documentation for the Time class and timezone handling</a></p>
</li>
<li>
<p>Working with Time Zones in Ruby - <a href="https://thoughtbot.com/blog/its-about-time-zones">Comprehensive guide to handling timezones correctly in Ruby applications</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>