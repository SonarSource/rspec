<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Secret leaks often occur when a sensitive piece of authentication data is
stored with the source code of an application. Considering the source code is
intended to be deployed across multiple assets, including source code
repositories or application hosting servers, the secrets might get exposed to an
unintended audience.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In most cases, trust boundaries are violated when a secret is exposed in a
source code repository or an uncontrolled deployment environment.
Unintended people who don&#8217;t need to know the secret might get access to it. They
might then be able to use it to gain unwanted access to associated services or
resources.</p>
</div>
<div class="paragraph">
<p>The trust issue can be more or less severe depending on the people&#8217;s role and
entitlement.</p>
</div>
<div class="paragraph">
<p>In that case, the wallet seed phrase, also known as a recovery phrase or
mnemonic seed, is arguably the most critical element in managing cryptocurrency.<br>
Its importance cannot be overstated, as it serves as the master key to entire
crypto portfolios.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>The consequences vary greatly by situation and by audience.<br>
Below is the critical impact of an attacker accessing the wallet phrase.</p>
</div>
<div class="sect3">
<h4 id="_cryptocurrency_theft">Cryptocurrency theft</h4>
<div class="paragraph">
<p>Access to your seed phrase means complete control over your wallet.  An attacker
can import your wallet on their own device and drain all your assets to their
own address.<br>
Due to the irreversible nature of blockchain transactions, there is no way to
undo the theft.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_immediately_generate_a_new_wallet">Immediately generate a new wallet</h3>
<div class="paragraph">
<p>You cannot change the seed phrase for an existing wallet. A seed phrase is the
master key from which all your wallet&#8217;s private keys are mathematically derived.<br>
Therefore, the correct procedure is not to "change" the phrase, but to move your
funds to a new wallet with a new seed phrase.</p>
</div>
<div class="paragraph">
<p>Then, transfer the assets from the old wallet to the new one.</p>
</div>
</div>
<div class="sect2">
<h3 id="_store_the_phrase_in_a_secure_location">Store the phrase in a secure location</h3>
<div class="paragraph">
<p>Store this new backup in an extremely secure, offline location. Do not take
a photo of it or store it on any internet-connected device.</p>
</div>
<div class="paragraph">
<p>If you need to store it digitally, consider using a hardware wallet or a
dedicated secret vault.</p>
</div>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">import { HDNodeWallet } from 'ethers'

const mnemonic = 'donate clutch sport betray purpose monitor lift blame slide spin crunch marriage'
const mnemonicWallet = HDNodeWallet.fromPhrase(mnemonic) // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">import { HDNodeWallet } from 'ethers'

const mnemonic = process.env.SECRET
const mnemonicWallet = HDNodeWallet.fromPhrase(mnemonic)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>While the noncompliant code example contains a hard-coded seed phrase, the
compliant solution retrieves the secret&#8217;s value from its environment.<br>
This allows it to have an environment-dependent secret value and avoids storing
the phrase in the source code itself.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>AWS Documentation - <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html">What is AWS Secrets Manager</a></p>
</li>
<li>
<p>Azure Documentation - <a href="https://learn.microsoft.com/en-us/azure/key-vault/">Azure Key Vault</a></p>
</li>
<li>
<p>Google Cloud - <a href="https://cloud.google.com/secret-manager/docs">Secret Manager documentation</a></p>
</li>
<li>
<p>HashiCorp Developer - <a href="https://developer.hashicorp.com/vault/docs">Vault Documentation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">Top 10 2021 - Category A7 - Identification and Authentication Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">Top 10 2017 - Category A2 - Broken Authentication</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/798">CWE-798 - Use of Hard-coded Credentials</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/259">CWE-259 - Use of Hard-coded Password</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Revoke and change this seed phrase, as it is compromised.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Highlight the use of the seed phrase and its initialization.</p>
</div>
<hr>
</div>
</div>
</div>