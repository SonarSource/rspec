<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Granting public access to GCP resources may reduce an organization&#8217;s ability to
protect itself against attacks or theft of its GCP resources.<br>
Security incidents associated with misuse of public access include disruption
of critical functions, data theft, and additional costs due to resource
overload.</p>
</div>
<div class="paragraph">
<p>To be as prepared as possible in the event of a security incident,
authentication combined with fine-grained permissions helps maintain the
principle of defense in depth and trace incidents back to the perpetrators.</p>
</div>
<div class="paragraph">
<p>GCP also provides the ability to grant access to a large group of people:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If public access is granted to all Google users, the impact of a data theft
is the same as if public access is granted to all Internet users.</p>
</li>
<li>
<p>If access is granted to a large Google group, the impact of a data theft is
limited based on the size of the group.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The only thing that changes in these cases is the ability to track user access
in the event of an incident.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>This GCP resource is essential to the information system infrastructure.</p>
</li>
<li>
<p>This GCP resource is essential to mission-critical functions.</p>
</li>
<li>
<p>This GCP resource stores or processes sensitive data.</p>
</li>
<li>
<p>Compliance policies require that access to this resource be authenticated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of these questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Explicitly set access to this resource or function as private.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For IAM resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "google_cloudfunctions_function_iam_binding" "example" {
  members = [
    "allUsers",              # Sensitive
    "allAuthenticatedUsers", # Sensitive
  ]
}

resource "google_cloudfunctions_function_iam_member" "example" {
  member = "allAuthenticatedUsers" # Sensitive
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For ACL resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "google_storage_bucket_access_control" "example" {
  entity = "allUsers" # Sensitive
}

resource "google_storage_bucket_acl" "example" {
  role_entity = [
    "READER:allUsers",              # Sensitive
    "READER:allAuthenticatedUsers", # Sensitive
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For container clusters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "google_container_cluster" "example" {
  private_cluster_config {
    enable_private_nodes    = false # Sensitive
    enable_private_endpoint = false # Sensitive
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For IAM resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "google_cloudfunctions_function_iam_binding" "example" {
  members = [
    "serviceAccount:${google_service_account.example.email}",
    "group:${var.example_group}"
  ]
}

resource "google_cloudfunctions_function_iam_member" "example" {
  member = "user:${var.example_user}" # Sensitive
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For ACL resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "google_storage_bucket_access_control" "example" {
  entity = "user-${var.example_user]"
}

resource "google_storage_bucket_acl" "example" {
  role_entity = [
    "READER:user-name@example.com",
    "READER:group-admins@example.com"
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For container clusters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "google_container_cluster" "example" {
  private_cluster_config {
    enable_private_nodes    = true
    enable_private_endpoint = true
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/668">CWE-668 - Exposure of Resource to Wrong Sphere</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222620">Application Security and Development: V-222620</a> - Application web servers must be on a separate network segment from the application and database servers.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>For container clusters:</p>
<div class="ulist">
<ul>
<li>
<p>Omitted: Omitting {attribute} grants public access to parts of this cluster. Make sure it is safe here.</p>
</li>
<li>
<p>Explicitly set to false: Ensure that granting public access is safe here.</p>
</li>
</ul>
</div>
</li>
<li>
<p>For the rest: Ensure that granting public access to this resource is safe here.</p>
</li>
<li>
<p>For ACL resources: Ensure that granting public access to this resource is safe here.</p>
</li>
<li>
<p>For DNS-managed zone omissions: Omitting {attribute} will grant public access to this managed zone. Ensure it is safe here.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>Assignments: Highlight the sensitive assignment.</p>
</li>
<li>
<p>Lists: Highlight the sensitive element.</p>
</li>
<li>
<p>Multiple sensitive items: Highlight the resource.</p>
</li>
</ul>
</div>
</div>
</div>
</div>