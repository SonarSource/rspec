<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Lightweight Directory Access Protocol (LDAP) servers provide two main
authentication methods: the <em>SASL</em> and <em>Simple</em> ones. The
<em>Simple Authentication</em> method also breaks down into three different mechanisms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Anonymous</em> Authentication</p>
</li>
<li>
<p><em>Unauthenticated</em> Authentication</p>
</li>
<li>
<p><em>Name/Password</em> Authentication</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A server that accepts either the <em>Anonymous</em> or <em>Unauthenticated</em> mechanisms will
accept connections from clients not providing credentials.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When configured to accept the Anonymous or Unauthenticated authentication
mechanism, an LDAP server will accept connections from clients that do not
provide a password or other authentication credentials. Such users will be
able to read or modify part or all of the data contained in the hosted
directory.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>An attacker exploiting unauthenticated access to an LDAP server can access the
data that is stored in the corresponding directory. The impact varies depending
on the permission obtained on the directory and the type of data it stores.</p>
</div>
<div class="sect3">
<h4 id="_authentication_bypass">Authentication bypass</h4>
<div class="paragraph">
<p>If attackers get write access to the directory, they will be able to alter
most of the data it stores. This might include sensitive technical data such as
user passwords or asset configurations. Such an attack can typically lead to
an authentication bypass on applications and systems that use the affected
directory as an identity provider.</p>
</div>
<div class="paragraph">
<p>In such a case, all users configured in the directory might see their identity
and privileges taken over.</p>
</div>
</div>
<div class="sect3">
<h4 id="_sensitive_information_leak">Sensitive information leak</h4>
<div class="paragraph">
<p>If attackers get read-only access to the directory, they will be able to read
the data it stores. That data might include security-sensitive pieces of
information.</p>
</div>
<div class="paragraph">
<p>Typically, attackers might get access to user account lists that they can use
in further intrusion steps. For example, they could use such lists to perform
password spraying, or related attacks, on all systems that rely on the affected
directory as an identity provider.</p>
</div>
<div class="paragraph">
<p>If the directory contains some Personally Identifiable Information, an attacker
accessing it might represent a violation of regulatory requirements in some
countries. For example, this kind of security event would go against the
European GDPR law.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="paragraph">
<p>The following code indicates an anonymous LDAP authentication vulnerability
because it binds to a remote server using an Anonymous Simple authentication
mechanism.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// Set up the environment for creating the initial context
Hashtable&lt;String, Object&gt; env = new Hashtable&lt;String, Object&gt;();
env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
env.put(Context.PROVIDER_URL, "ldap://localhost:389/o=JNDITutorial");

// Use anonymous authentication
env.put(Context.SECURITY_AUTHENTICATION, "none"); // Noncompliant

// Create the initial context
DirContext ctx = new InitialDirContext(env);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// Set up the environment for creating the initial context
Hashtable&lt;String, Object&gt; env = new Hashtable&lt;String, Object&gt;();
env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
env.put(Context.PROVIDER_URL, "ldap://localhost:389/o=Example");

// Use simple authentication
env.put(Context.SECURITY_AUTHENTICATION, "simple");
env.put(Context.SECURITY_PRINCIPAL, "cn=local, ou=Unit, o=Example");
env.put(Context.SECURITY_CREDENTIALS, getLDAPPassword());

// Create the initial context
DirContext ctx = new InitialDirContext(env);</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://datatracker.ietf.org/doc/html/rfc4513#section-5">RFC 4513 - Lightweight Directory Access Protocol (LDAP): Authentication Methods and Security Mechanisms</a> - Bind operations</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">Top 10 2021 Category A7 - Identification and Authentication Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">Top 10 2017 Category A2 - Broken Authentication</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/521">CWE-521 - Weak Password Requirements</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Change authentication to "simple" or stronger.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Context.SECURITY_AUTHENTICATION, "none"</p>
</div>
</div>
</div>
</div>