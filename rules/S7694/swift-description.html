<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Software projects often rely on external code libraries, known as dependencies. Package managers, such as Swift Package Manager, allow developers to reference dependencies for their projects. These dependencies simplify development, but also introduce risk as they download and include external code based on a project’s configuration. When adding a dependency, developers often specify a range of acceptable versions, such as any version beginning with <code>1.2</code>. When the project is built, the package manager performs dependency resolution. This process involves checking the repository and selecting one specific version that satisfies the version range, which becomes the resolved dependency.</p>
</div>
<div class="paragraph">
<p>Dependency resolution becomes a security concern when the specific resolved version is not recorded or "locked." Without a file containing the locked version, the resolution process runs every time the project is built on a new system. The core issue is that the package manager will always query the repository to find the most recent version available, rendering the application vulnerable when malicious versions of dependencies are released.</p>
</div>
<div class="paragraph">
<p>This is often a key component of what is called a "supply chain attack." The attacker isn’t directly attacking your application. Instead, they are attacking a component you use. This is an important consideration because the attack’s source is less obvious. You might diligently secure your own code, but overlook the risk introduced by external dependencies.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Your team or company has the security policy to enforce predictability of dependency versions at build time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answer yes to this question.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Swift Package Manager automatically creates a lock file named <code>Package.resolved</code>. You should commit this file to your source code repository.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Your project&#8217;s <code>Package.swift</code> file might define a dependency with a version range.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-swift" data-lang="swift">let package = Package(
    name: "Example",
    dependencies: [
        .package(url: "https://example.com/library.git", from: "1.2.3"),
    ],
    targets: [
        .target(
            name: "Example",
            dependencies: ["library"]),
    ]
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a <code>Package.resolved</code> file is absent in the project, there is no guarantee that continuous integration systems and other developers on your team will use the exact same version of the dependency.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you build the project for the first time, Swift Package Manager will resolve the dependencies and create a <code>Package.resolved</code> file. This file contains a reference to the specific commit hash of the version that was downloaded.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-swift" data-lang="swift">let package = Package(
    name: "Example",
    dependencies: [
        .package(url: "https://example.com/library.git", from: "1.2.3"),
    ],
    targets: [
        .target(
            name: "Example",
            dependencies: ["library"]),
    ]
)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "object": {
    "pins": [
      {
        "package": "library",
        "repositoryURL": "https://example.com/library.git",
        "state": {
          "branch": null,
          "revision": "a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4",
          "version": "1.2.5"
        }
      }
    ]
  },
  "version": 1
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run <code>swift package update</code> when you need to update a dependency to a newer version. This command finds the latest versions allowed by the ranges in your <code>Package.swift</code> file and updates the <code>Package.resolved</code> file accordingly. After running the command, review the changes to <code>Package.resolved</code> and then commit the updated file to your repository. This makes the update a deliberate and traceable action.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">Top 10 2021 Category A8 - Software and Data Integrity Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2023-risks/m2-inadequate-supply-chain-security">Mobile Top 10 2024 Category M2 - Inadequate Supply Chain Security</a></p>
</li>
</ul>
</div>
</div>
</div>