<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This vulnerability occurs when an application saves a password in plaintext on device storage.
The password risks being leaked if the device or the application itself is compromised.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When an application stores a password without encryption, it creates a security risk for the user. Often, the password is not directly accessible by a third-parties thanks to OS and application level protections. Yet password leakage can happen if the device is lost or stolen, or if an attacker compromises the application.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="sect3">
<h4 id="_account_compromise">Account Compromise</h4>
<div class="paragraph">
<p>The most direct problem is that an attacker can take over the user&#8217;s account in your application. If they are able to read the stored password from the device, the attacker can log in as the user. Once inside, they could potentially view private information, send messages while impersonating the user, or access other features of the account.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_danger_of_password_reuse">The Danger of Password Reuse</h4>
<div class="paragraph">
<p>Using the same password for multiple websites and applications is a common behavior. If attackers find a password from one application, they will often try that same password on other, more valuable services, such as email, banking, or social media accounts. This is a technique known as credential stuffing. A security weakness in one application can therefore lead to a much broader compromise of a user&#8217;s digital life.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_android">How to fix it in Android</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class ExampleActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_xml_layout);

        SharedPreferences sharedPreferences = getSharedPreferences("example", Context.MODE_PRIVATE);

        EditText passwordEditText = findViewById(R.id.passwordEditText);
        Button savePasswordButton = findViewById(R.id.savePasswordButton);

        savePasswordButton.setOnClickListener(v -&gt; {
            String password = passwordEditText.getText().toString();
            if (!password.isEmpty()) {
                SharedPreferences.Editor editor = sharedPreferences.edit();
                editor.putString("Password", password);
                editor.apply();
            }
        });
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="paragraph">
<p>Applications storing passwords locally often do so because they want users to stay logged in.
To keep users logged in, use or implement session management on the server side.
If not possible or applicable, use the [Android Credential Manager](<a href="https://developer.android.com/jetpack/androidx/releases/credentials" class="bare">https://developer.android.com/jetpack/androidx/releases/credentials</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import androidx.credentials.CredentialManager;

public class ExampleActivity extends AppCompatActivity {

    private CredentialManagerCallback&lt;CreateCredentialResponse, CreateCredentialException&gt; callback;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_xml_layout);

        SharedPreferences sharedPreferences = getSharedPreferences("example", Context.MODE_PRIVATE);

        EditText passwordEditText = findViewById(R.id.passwordEditText);
        Button savePasswordButton = findViewById(R.id.savePasswordButton);

        savePasswordButton.setOnClickListener(v -&gt; {
            String password = passwordEditText.getText().toString();
            if (!password.isEmpty()) {
                CredentialManager credentialManager = CredentialManager.create(this);
                CreatePasswordRequest request = new CreatePasswordRequest(
                        "example",
                        password
                );
                credentialManager.createCredentialAsync (this, request,null, Runnable::run, callback);
            }
        });
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Android Documentation - <a href="https://developer.android.com/identity/sign-in/credential-manager">Sign in your user with Credential Manager</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">Top 10 2021 Category A4 - Insecure Design</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2023-risks/m9-insecure-data-storage.html">Mobile Top 10 2024 Category M9 - Insecure Data Storage</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/256">CWE-256 - Plaintext Storage of a Password</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222602">Application Security and Development: V-222542</a> - The application must only store cryptographic representations of passwords.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Change this code to not store user&#8217;s password on the device.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>"[varname]" is tainted (assignments and parameters)</p>
</div>
<div class="paragraph">
<p>this argument is tainted (method invocations)</p>
</div>
<div class="paragraph">
<p>the returned value is tainted (returns &amp; method invocations results)</p>
</div>
</div>
</div>
</div>