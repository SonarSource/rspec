<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Operands of <code>sizeof</code>, <code>noexcept</code> and <code>decltype</code> are unevaluated. So side effects in these operands (which are all the effects an expression can have in addition to producing a value), will not be applied. And that may be surprising to the reader.</p>
</div>
<div class="paragraph">
<p>Additionally, the operand of <code>typeid</code> may or may not be evaluated, depending on its type: it will be evaluated if it is a function call that returns reference to a polymorphic type, but it will not be evaluated in all the other cases. This difference of behavior is tricky to apprehend and that is why both cases are reported here.</p>
</div>
<div class="paragraph">
<p>This rules reports an issue when operands of such operators have side-effects.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">class A {
public:
  virtual ~A();
  /*...*/
};
class B : public A { /* ....*/ };
A&amp; create(string const &amp;xml);

void test(string const &amp;xml) {
  int i = 0;
  cout &lt;&lt; noexcept(++i); // Noncompliant, "i" is not incremented
  cout &lt;&lt; typeid(++i).name(); // Noncompliant, "i" is not incremented
  auto p1 = malloc(sizeof(i = 5)); // Noncompliant, "i" is not changed

  cout &lt;&lt; typeid(create(xml)).name(); // Noncompliant, even if the side-effects will be evaluated in this case
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">class A {
public:
  virtual ~A();
  /*...*/
};
class B : public A { /* ....*/ };
A&amp; create(string const &amp;xml);

void test(string const &amp;xml) {
  int i = 0;
  ++i;
  cout &lt;&lt; noexcept(i); // Compliant
  ++i;
  cout &lt;&lt; typeid(i).name(); // Compliant
  i = 5;
  auto p1 = malloc(sizeof(i)); // Compliant

  auto a = create(xml);
  cout &lt;&lt; typeid(a).name(); // Compliant
}</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>expression with side effects has no effect in an unevaluated context</p>
</div>
<div class="paragraph">
<p>expression with side effects will be evaluated despite being used as an operand to "typeid"</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_related_to_s922">is related to: <a data-rspec-id="S922" class="rspec-auto-link">S922</a></h3>

</div>
</div>
</div>