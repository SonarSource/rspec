<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when a variable is declared at script level without the <code>def</code> keyword, creating a binding variable that is shared across all loaded scripts.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Jenkins Groovy scripts, variables declared without the <code>def</code> keyword become binding variables. These variables are stored in a shared binding context that is accessible across all loaded scripts in the same Jenkins execution.</p>
</div>
<div class="paragraph">
<p>This creates several problems:</p>
</div>
<div class="paragraph">
<p><strong>Security Risk</strong>: Binding variables can be accessed and modified by any script loaded in the same Jenkins execution. This means sensitive data like credentials, API keys, or configuration values could be accidentally exposed to other scripts.</p>
</div>
<div class="paragraph">
<p><strong>Maintainability Issues</strong>: When multiple scripts can access the same variables, it becomes difficult to track where variables are defined and modified. This makes debugging harder and increases the risk of unexpected behavior.</p>
</div>
<div class="paragraph">
<p><strong>Namespace Pollution</strong>: Binding variables pollute the global namespace, making it more likely that variable names will conflict between different scripts.</p>
</div>
<div class="paragraph">
<p>The <code>@Field</code> annotation provides a better alternative. Variables annotated with <code>@Field</code> are accessible throughout the script but remain encapsulated within that specific script, preventing cross-script access.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Binding variables can lead to security vulnerabilities through unintended data exposure between scripts. They also make code harder to maintain and debug due to unclear variable scoping and potential naming conflicts.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the @Field annotation to declare script-level variables. Import the Field annotation and add it before variable declarations that need to be accessible across methods within the same script.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">// Creates a binding variable accessible across all scripts
some_var = "some value" // Noncompliant

def pr() {
    def another_var = "another " + some_var
    echo "${another_var}"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">// Uses @Field annotation for script-level variable
import groovy.transform.Field

@Field
def some_var = "some value"

def pr() {
    def another_var = "another " + some_var
    echo "${another_var}"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Groovy @Field Annotation Documentation - <a href="https://docs.groovy-lang.org/latest/html/gapi/groovy/transform/Field.html">Official documentation for the @Field annotation in Groovy</a></p>
</li>
<li>
<p>Jenkins Pipeline Groovy Best Practices - <a href="https://www.jenkins.io/doc/book/pipeline/shared-libraries/#defining-global-variables">Jenkins documentation on best practices for variable scoping in pipeline scripts</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE 200 - <a href="https://cwe.mitre.org/data/definitions/200.html">Information Exposure - unintended exposure of sensitive information</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>