== How to fix it in Security Framework

=== Code examples

include::../../common/fix/code-rationale.adoc[]

==== Noncompliant code example

[source,swift,diff-id=11,diff-type=noncompliant]
----
import Security

// The attributes for the key.
let attributes: [String: Any] = [
    kSecAttrKeyType as String: kSecAttrKeyTypeRSA,
    kSecAttrKeySizeInBits as String: 1024, // Noncompliant: keys of 1024 bits are considered weak.
]

// A call to generate a new private key.
var error: Unmanaged<CFError>?
if let privateKey = SecKeyCreateRandomKey(attributes as CFDictionary, &error) {
    // ...
}
----

include::../../common/fix/ec.adoc[]

[source,swift,diff-id=12,diff-type=noncompliant]
----
import Security

// The attributes for the key.
let attributes: [String: Any] = [
    kSecAttrKeyType as String: kSecAttrKeyTypeECSECPrimeRandom,
    kSecAttrKeySizeInBits as String: 192, // Noncompliant: keys of 192 bits are considered weak for EC.
]

// A call to generate a new private key.
var error: Unmanaged<CFError>?
if let privateKey = SecKeyCreateRandomKey(attributes as CFDictionary, &error) {
    // ...
}
----

==== Compliant solution

[source,swift,diff-id=11,diff-type=compliant]
----
import Security

// The attributes for the key.
let attributes: [String: Any] = [
    kSecAttrKeyType as String: kSecAttrKeyTypeRSA,
    kSecAttrKeySizeInBits as String: 2048,
]

// A call to generate a new private key.
var error: Unmanaged<CFError>?
if let privateKey = SecKeyCreateRandomKey(attributes as CFDictionary, &error) {
    // ...
}
----

[source,swift,diff-id=12,diff-type=compliant]
----
import Security

// The attributes for the key.
let attributes: [String: Any] = [
    kSecAttrKeyType as String: kSecAttrKeyTypeECSECPrimeRandom,
    kSecAttrKeySizeInBits as String: 256,
]

// A call to generate a new private key.
var error: Unmanaged<CFError>?
if let privateKey = SecKeyCreateRandomKey(attributes as CFDictionary, &error) {
    // ...
}
----

=== How does this work?

include::../../common/fix/fix.adoc[]

=== Going the extra mile

include::../../common/extra-mile/pre-quantum.adoc[]
