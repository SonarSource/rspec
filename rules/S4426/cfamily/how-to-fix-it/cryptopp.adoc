== How to fix it in CryptoPP

=== Code examples

==== Noncompliant code example

include::../../common/fix/asymmetric-keys-noncompliant.adoc[]

[source,cpp,diff-id=1,diff-type=noncompliant]
----
#include <cryptopp/rsa.h>
#include <cryptopp/rng.h>

CryptoPP::AutoSeededRandomPool  rng;
CryptoPP::InvertibleRSAFunction rsa_trapdoor;

rsa_trapdoor.GenerateRandomWithKeySize(rng,1024); // Noncompliant
----

include::../../common/fix/key-exchange-keys-noncompliant.adoc[]

[source,cpp,diff-id=2,diff-type=noncompliant]
----
#include <cryptopp/rsa.h>
#include <cryptopp/rng.h>

CryptoPP::AutoSeededRandomPool  rng;
CryptoPP::InvertibleRSAFunction rsa_trapdoor;

rsa_trapdoor.GenerateRandomWithKeySize(rng,1024); // Noncompliant
----


When it comes to elliptic curve cryptography, keys are in the algorithm names:
>>>> ASN.1 object identifiers for algorithms and schemes, EC key length should be 224 instead of 112

[source,cpp,diff-id=3,diff-type=noncompliant]
----
#include <cryptopp/osrng.h>

CryptoPP::ASN1::secp112r1(); // Noncompliant
----

==== Compliant solution

>>>> RSA

[source,cpp,diff-id=1,diff-type=compliant]
----
#include <botan/pubkey.h>
#include <botan/rng.h>
#include <botan/rsa.h>

void encrypt() {
    std::unique_ptr<Botan::RandomNumberGenerator> rng(new Botan::System_RNG);
    Botan::RSA_PrivateKey rsaKey(*rng, 2048);
}
----

>>>> DSA / DH

[source,cpp,diff-id=2,diff-type=compliant]
----
#include <botan/dl_group.h>

void encrypt() {
    Botan::DL_Group("modp/ietf/2048");
    Botan::DL_Group("dsa/botan/2048");
}
----

>>>> EC

[source,cpp,diff-id=3,diff-type=compliant]
----
#include <botan/ec_group.h>

Botan::EC_Group("secp224k1");
----

=== How does this work?

include::../../common/fix/fix.adoc[]

=== Going the extra mile

include::../../common/extra-mile/pre-quantum.adoc[]

=== Going the extra mile

include::../../common/extra-mile/pre-quantum.adoc[]
