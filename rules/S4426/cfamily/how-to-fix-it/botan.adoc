== How to fix it in Botan

=== Code examples

==== Noncompliant code example

>>>> RSA

[source,cpp,diff-id=1,diff-type=noncompliant]
----
#include <botan/pubkey.h>
#include <botan/rng.h>
#include <botan/rsa.h>

void encrypt() {
    std::unique_ptr<Botan::RandomNumberGenerator> rng(new Botan::System_RNG);
    Botan::RSA_PrivateKey rsaKey(*rng, 1024); // Noncompliant
}
----

>>>> DSA / DH

[source,cpp,diff-id=2,diff-type=noncompliant]
----
#include <botan/dl_group.h>

void encrypt() {
    Botan::DL_Group("dsa/botan/1024"); // Noncompliant
}
----

>>>> EC

[source,cpp,diff-id=3,diff-type=noncompliant]
----
#include <botan/ec_group.h>

void encrypt() {
    Botan::EC_Group("secp160k1"); // Noncompliant
}
----

==== Compliant solution

>>>> RSA

[source,cpp,diff-id=1,diff-type=compliant]
----
#include <botan/pubkey.h>
#include <botan/rng.h>
#include <botan/rsa.h>

void encrypt() {
    std::unique_ptr<Botan::RandomNumberGenerator> rng(new Botan::System_RNG);
    Botan::RSA_PrivateKey rsaKey(*rng, 2048);
}
----

>>>> DSA / DH

[source,cpp,diff-id=2,diff-type=compliant]
----
#include <botan/dl_group.h>

void encrypt() {
    Botan::DL_Group("modp/ietf/2048");
    Botan::DL_Group("dsa/botan/2048");
}
----

>>>> EC

[source,cpp,diff-id=3,diff-type=compliant]
----
#include <botan/ec_group.h>

void encrypt() {
    Botan::EC_Group("secp224k1");
}
----

=== How does this work?

include::../../common/fix/fix.adoc[]

=== Going the extra mile

include::../../common/extra-mile/pre-quantum.adoc[]

=== Going the extra mile

include::../../common/extra-mile/pre-quantum.adoc[]
