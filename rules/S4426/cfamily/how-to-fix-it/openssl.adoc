== How to fix it in OpenSSL

=== Code examples

==== Noncompliant code example

Example with a symmetric cypher, AES:

[source,cpp,diff-id=1,diff-type=noncompliant]
----
#include <openssl/evp.h>

EVP_aes_128_cbc(); // Noncompliant
----

Example with an asymmetric cypher, RSA:

[source,cpp,diff-id=2,diff-type=noncompliant]
----
#include <openssl/rsa.h>

RSA_public_decrypt(flen, from, to, key, RSA_SSLV23_PADDING); // Noncompliant
----

==== Compliant solution

For the AES symmetric cypher, use the GCM mode:

[source,cpp,diff-id=1,diff-type=noncompliant]
----
#include <openssl/evp.h>

EVP_aes_128_gcm();
----

For the RSA assymmetric cypher, use the Optimal asymmetric encryption padding (OAEP):

[source,cpp,diff-id=2,diff-type=noncompliant]
----
#include <openssl/rsa.h>

RSA_public_decrypt(flen, from, to, key, RSA_PKCS1_OAEP_PADDING);
----

=== How does this work?

include::../../common/fix/fix.adoc[]
