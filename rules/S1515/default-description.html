<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Defining functions inside loops in JavaScript can lead to several issues and is generally considered bad practice. The main problems associated with this approach are related to performance, scope, and potential unintended behavior:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When a function is defined inside a loop, the function is re-created on each iteration of the loop. This can cause unnecessary overhead and lead to performance issues, especially if the loop runs repeatedly. Defining the function outside the loop is more efficient so that it is created only once.</p>
</li>
<li>
<p>Functions defined inside loops have access to the loop&#8217;s variables and parameters. This can sometimes lead to unintended behavior or bugs due to closures. Closures in JavaScript capture the environment in which they are created, including variables and parameters, and this can cause unexpected results when those variables change during the loop.</p>
</li>
<li>
<p>Code that defines functions inside loops can be harder to read and maintain, especially for other developers who might not expect functions to be redefined within the loop. Keeping functions separate and clearly defined is better, improving code organization and understandability.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">for (let i = 0; i &lt; 5; i++) {
  function processItem(item) { // Noncompliant: Function 'processItem' inside a for loop
    // Some processing logic
    console.log(item);
  }

  processItem(i);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Define the function outside the loop and use the function parameters to pass any needed variables instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">function processItem(item) {
  // Some processing logic
  console.log(item);
}

for (let i = 0; i &lt; 5; i++) {
  processItem(i);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>MDN web docs - <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures">Closures</a></p>
</li>
<li>
<p>MDN web docs - <a href="https://developer.mozilla.org/en-US/docs/Glossary/Scope">Scope</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure this function is not called after the loop completes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>primary location: function declaration</p>
</div>
<div class="paragraph">
<p>secondary: loop</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_23_mar_2020_185747_elena_vilchik_wrote">on 23 Mar 2020, 18:57:47 Elena Vilchik wrote:</h3>
<div class="paragraph">
<p>legacy key FunctionDefinitionInsideLoop</p>
</div>
</div>
<div class="sect2">
<h3 id="_is_related_to_s3044">is related to: <a data-rspec-id="S3044" class="rspec-auto-link">S3044</a></h3>

</div>
<div class="sect2">
<h3 id="_on_21_apr_2017_144945_elena_vilchik_wrote">on 21 Apr 2017, 14:49:45 Elena Vilchik wrote:</h3>
<div class="paragraph">
<p>\[~jeanchristophe.collet] Could you please update message for this rule? Something like "Review this function declated inside loop and make sure it is not called after loop ends and it doesn&#8217;t depend on variables updated with each iteration." (https://github.com/SonarSource/sonar-javascript/issues/573)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_16_feb_2018_104258_elena_vilchik_wrote">on 16 Feb 2018, 10:42:58 Elena Vilchik wrote:</h3>
<div class="paragraph">
<p>Function declared inside is a problem when using <code>var</code> declaration for counter. This is very unlikely that in TS somebody will use <code>var</code>. So this rule will have very low ROI. So we will not implement it for TS.</p>
</div>
</div>
</div>
</div>