<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There can&#8217;t be any good reason to do a full table scan on large database tables due to the cost of such operation and the scalability issue that might raise. This rule raises an issue when a <code>SELECT</code> statement doesn&#8217;t use at least one indexed column in its <code>WHERE</code> clause.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong> That this rule raises issues only when a database catalog is provided during the SonarQube analysis.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cobol" data-lang="cobol">SELECT * FROM USERS WHERE NAME = :name  -- non compliant when NAME column is not indexed</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>This rule ignores <code>SELECT</code> statements not having any <code>WHERE</code> clauses; they are covered by other rules: <a data-rspec-id="S1590" class="rspec-auto-link">S1590</a>, SQL.SelectWithNoWhereClauseCheck</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Add at least one criterion to the "WHERE" clause using an indexed column.</p>
</div>
</div>
<div class="sect2">
<h3 id="_parameters">Parameters</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">threshold</div>
<div class="listingblock">
<div class="content">
<pre>1000</pre>
</div>
</div>
<div class="paragraph">
<p>Ignore statements on tables with fewer than this many rows.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>entire where clause</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_deprecates_s1956">deprecates: <a data-rspec-id="S1956" class="rspec-auto-link">S1956</a></h3>

</div>
<div class="sect2">
<h3 id="_on_8_jan_2016_161426_pierre_yves_nicolas_wrote">on 8 Jan 2016, 16:14:26 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>The current message seems to imply that this rule should only be triggered if a SQL statement has a WHERE clause. However, if there is no WHERE clause, no index can be used.</p>
</div>
<div class="paragraph">
<p>Please note that we already have other rules (with a noticeable difference: they have no "threshold" parameter):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S1590" class="rspec-auto-link">RSPEC-1590</a> for DELETE and UPDATE with no WHERE clause (with a default severity set to major)</p>
</li>
<li>
<p><a data-rspec-id="S1492" class="rspec-auto-link">RSPEC-1492</a> for SELECT with no WHERE clause (with a default severity set to critical)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_jan_2016_171924_ann_campbell_wrote">on 8 Jan 2016, 17:19:24 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~pierre-yves.nicolas] if this rule raises an issue on a missing <code>WHERE</code> clause, we&#8217;ll get a double hit if <a data-rspec-id="S1492" class="rspec-auto-link">RSPEC-1492</a> is also on (which is bad, IMO). But if we subsume <a data-rspec-id="S1492" class="rspec-auto-link">RSPEC-1492</a> into this rule, then will <code>WHERE</code>-less <code>SELECT</code>s be found if no database information is available?</p>
</div>
<div class="paragraph">
<p>Regarding the differing severities of <a data-rspec-id="S1590" class="rspec-auto-link">RSPEC-1590</a>, and <a data-rspec-id="S1492" class="rspec-auto-link">RSPEC-1492</a>, <code>WHERE</code>-less <code>SELECT</code>s are widely regarded as security issues, but that&#8217;s not the case for <code>WHERE</code>-less <code>DELETE</code> and <code>UPDATE</code> statements. Unless I&#8217;m behind on my reading&#8230;&#8203;</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_jan_2016_174613_pierre_yves_nicolas_wrote">on 8 Jan 2016, 17:46:13 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I&#8217;m fine to exclude statements without WHERE clause from this rule: I think that the description should then mention <a data-rspec-id="S1492" class="rspec-auto-link">RSPEC-1492</a> and <a data-rspec-id="S1590" class="rspec-auto-link">RSPEC-1590</a>, perhaps in the "See also" section.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_11_jan_2016_183715_ann_campbell_wrote">on 11 Jan 2016, 18:37:15 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Done [~pierre-yves.nicolas] &amp; assigning back to [~freddy.mallet] for his initial review.</p>
</div>
</div>
</div>
</div>