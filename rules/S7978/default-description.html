<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when database operation results (like <code>Database.SaveResult</code>, <code>Database.DeleteResult</code>, or <code>Database.UpsertResult</code>) are stored in a variable but never checked for success or failure.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When performing database operations in Apex using methods like <code>Database.insert()</code>, <code>Database.update()</code>, <code>Database.delete()</code>, or <code>Database.upsert()</code>, these methods return result objects that contain important information about whether the operation succeeded or failed.</p>
</div>
<div class="paragraph">
<p>If you store these results but never check them, your code may continue executing even when the database operation failed. This creates several problems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Silent failures</strong>: Your application appears to work normally, but data changes are not actually saved to the database</p>
</li>
<li>
<p><strong>Inconsistent application state</strong>: Your code may assume the operation succeeded and continue with logic that depends on the data being saved</p>
</li>
<li>
<p><strong>Poor user experience</strong>: Users receive no feedback when their actions fail to complete</p>
</li>
<li>
<p><strong>Difficult debugging</strong>: When issues arise later, it&#8217;s hard to trace back to the original failed operation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Database operations can fail for many reasons: validation rule violations, required field errors, insufficient permissions, or system limits being exceeded. By checking the results, you can handle these failures gracefully and provide meaningful feedback to users.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Unchecked database operation failures can lead to data integrity issues, inconsistent application behavior, and poor user experience. Users may believe their actions completed successfully when they actually failed, leading to confusion and potential business process disruptions.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Check the database operation results and handle failures appropriately. Iterate through the results array and verify each operation succeeded using the <code>isSuccess()</code> method.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">public static boolean shareRecord(Id recordId, Id userOrGroupId) {
    MyCustomObject__Share shareRecord = new MyCustomObject__Share();
    shareRecord.ParentId = recordId;
    shareRecord.UserOrGroupId = userOrGroupId;
    shareRecord.AccessLevel = 'Read';
    shareRecord.RowCause = Schema.MyCustomObject__Share.RowCause.Manual;

    Database.SaveResult[] results = Database.insert(shareRecord, false); // Noncompliant
    // Results are stored but never checked
    return true;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">public static boolean shareRecord(Id recordId, Id userOrGroupId) {
    MyCustomObject__Share shareRecord = new MyCustomObject__Share();
    shareRecord.ParentId = recordId;
    shareRecord.UserOrGroupId = userOrGroupId;
    shareRecord.AccessLevel = 'Read';
    shareRecord.RowCause = Schema.MyCustomObject__Share.RowCause.Manual;

    Database.SaveResult[] results = Database.insert(shareRecord, false);

    for (Database.SaveResult result : results) {
        if (!result.isSuccess()) {
            // Handle the error appropriately
            System.debug('Insert failed: ' + result.getErrors());
            return false;
        }
    }
    return true;
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Database Methods and Error Handling - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexref.meta/apexref/apex_methods_system_database.htm">Official Salesforce documentation on Database class methods and result handling</a></p>
</li>
<li>
<p>Database.SaveResult Class - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexref.meta/apexref/apex_methods_system_database_saveresult.htm">Documentation for the SaveResult class returned by insert and update operations</a></p>
</li>
<li>
<p>Exception Handling and Debugging in Apex - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_exception_definition.htm">Guide to exception handling and debugging techniques in Apex</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-252: Unchecked Return Value - <a href="https://cwe.mitre.org/data/definitions/252.html">Weakness related to ignoring return values that indicate errors or important state changes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>