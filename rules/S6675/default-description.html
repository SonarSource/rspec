<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.trace.writelineif"><code>Trace.WriteLineIf</code> Method</a> from the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.trace"><code>System.Diagnostic.Trace</code></a> facility writes a trace if the condition passed as the first parameter is <code>true</code>.</p>
</div>
<div class="paragraph">
<p><a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.traceswitch"><code>TraceSwitch</code></a> allows trace control via <code>bool</code> properties for each relevant <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.tracelevel"><code>TraceLevel</code></a>, such as <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.traceswitch.traceerror"><code>TraceSwitch.TraceError</code></a>.</p>
</div>
<div class="paragraph">
<p>Using <code>Trace.WriteLineIf</code> with such properties should be avoided since it can lead to misinterpretation and produce confusion.</p>
</div>
<div class="paragraph">
<p>In particular, <code>Trace.WriteLineIf</code> may appear as equivalent to the level-specific tracing methods provided by <code>Trace</code>, such as <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.trace.traceerror"><code>Trace.Error</code></a>, but it is not.</p>
</div>
<div class="paragraph">
<p>The difference is that <code>Trace.WriteLineIf(switch.TraceError, &#8230;&#8203;)</code> conditionally writes the trace, based on the switch, whereas <code>Trace.TraceError</code> always writes the trace, no matter whether <code>switch.TraceError</code> is <code>true</code> or <code>false</code>.</p>
</div>
<div class="paragraph">
<p>Moreover, unlike <code>Trace.TraceError</code>, <code>Trace.WriteLineIf(switch.TraceError, &#8230;&#8203;)</code> would behave like <code>Trace.WriteLine(&#8230;&#8203;)</code> when <code>switch.TraceError</code> is <code>true</code>, writing unfiltered to the underlying trace listeners and not categorizing the log entry by level, as described more in detail in <a data-rspec-id="S6670" class="rspec-auto-link">S6670</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fix depends on the intent behind the use of <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.traceswitch"><code>TraceSwitch</code></a> levels with <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.trace.writelineif"><code>Trace.WriteLineIf</code></a>.</p>
</div>
<div class="paragraph">
<p>If it is <strong>trace categorization</strong>, level-specific tracing methods, such as <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.trace.traceerror"><code>Trace.TraceError</code></a> or <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.trace.tracewarning"><code>Trace.TraceWarning</code>, should be used instead.
</a></p></div>
<div class="paragraph">
<p>If it is <strong>trace filtering</strong>, <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.tracesource"><code>TraceSource</code></a> should be used instead.</p>
</div>
<div class="paragraph">
<p>If it is <strong>log filtering</strong>, <code>Trace</code> should be replaced by logging APIs, such as the <a href="https://learn.microsoft.com/en-us/dotnet/core/diagnostics/logging-tracing#net-logging-apis"><code>ILogger</code> API</a>.</p>
</div>
<div class="paragraph">
<p>Modern logging APIs are also more suitable than <code>Trace</code> when <a href="https://learn.microsoft.com/en-us/dotnet/core/extensions/high-performance-logging">high-performance logging</a> is required.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.trace.writelineif"><code>Trace.WriteLineIf</code> Method</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.traceswitch"><code>TraceSwitch</code></a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.tracesource"><code>TraceSource</code></a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.trace.writeline"><code>Trace.WriteLine</code> Method</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/core/extensions/high-performance-logging">High-performance logging in .NET</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p>StackOverflow - <a href="https://stackoverflow.com/a/5118040">Difference between Trace.WriteLineIf and Trace.Error</a></p>
</li>
<li>
<p>StackOverflow - <a href="https://stackoverflow.com/a/3691841">Difference between TraceSwitch and SourceSwitch</a></p>
</li>
<li>
<p>InfoSupport Blogs - <a href="https://blogs.infosupport.com/please-be-careful-when-using-trace-writelineif/">Please be careful when using Trace.WriteLineIf()</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use <code>Trace.WriteXXX</code> instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p><code>Trace.WriteLineIf(switch.TraceXXX, &#8230;&#8203;)</code></p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
</div>
</div>