== Why is this an issue?

include::../description.adoc[]

include::../recommended.adoc[]

=== Noncompliant code example

[source,php]
----
function createMyAccount() {
  $email = $_GET['email'];
  $name = $_GET['name'];
  $password = $_GET['password'];

  $hash = hash_pbkdf2('sha256', $password, $email, 100000); // Noncompliant; salt (3rd argument) is predictable because initialized with the provided $email

  $hash = hash_pbkdf2('sha256', $password, '', 100000); // Noncompliant; salt is empty

  $hash = hash_pbkdf2('sha256', $password, 'D8VxSmTZt2E2YV454mkqAY5e', 100000); // Noncompliant; salt is hardcoded

  $hash = crypt($password); // Noncompliant; salt is not provided; fails in PHP 8
  $hash = crypt($password, ""); // Noncompliant; salt is hardcoded; fails in PHP 8

  $options = [
    'cost' => 11,
    'salt' => mcrypt_create_iv(22, MCRYPT_DEV_URANDOM), // Noncompliant ; use salt generated by default
  ];
  echo password_hash("rasmuslerdorf", PASSWORD_BCRYPT, $options);
} 
----

=== Compliant solution

[source,php]
----
$salt = openssl_random_pseudo_bytes(16);
$hash = hash_pbkdf2("sha256", $password, $salt, $iterations, 20);
----

include::../see.adoc[]

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::../message.adoc[]

'''
== Comments And Links
(visible only on this page)

=== on 9 Jul 2018, 16:54:36 Alexandre Gigleux wrote:
Reference: \http://php.net/manual/en/function.hash-pbkdf2.php


____
The salt to use for the derivation. This value should be generated randomly.

____

=== on 25 Jul 2018, 11:54:46 Andrei Epure wrote:
\[~tibor.blenessy] , [~alexandre.gigleux] : should we also treat http://php.net/manual/en/function.crypt.php[crypt] and http://php.net/manual/en/function.password-hash.php[password_hash] , which both receive salt arguments and seem to be the http://php.net/manual/en/faq.passwords.php[php-recommended] hash functions?

=== on 25 Jul 2018, 19:37:30 Tibor Blenessy wrote:
I covered these additional functions

=== on 26 Jul 2018, 10:25:28 Andrei Epure wrote:
It would be nice to add a compliant example

include::../comments-and-links.adoc[]

endif::env-github,rspecator-view[]
