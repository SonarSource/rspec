<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Because header files are likely to be included by many source files in a project, they should not contain the definitions of objects or non-inlines, i.e. they should not declare anything that actually takes up memory. Doing so could result in multiple definitions of the same symbol.</p>
</div>
<div class="paragraph">
<p>Because a <code>struct</code> declaration takes up no memory, it can (some would say should) be placed in a header. Similarly, class declarations should also reside in header files, but not class implementations.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">// my_file.h
         void func(int, float);
         void add(int a, int b) { return a+b; } // Noncompliant
inline void subt(int a, int b) {return a-b; }

struct {
  int i;
  char c;
};

class Point {
  int x;
  int y;

public:
  getX() { return x };  // Noncompliant; implementation
  getY();                   // Compliant
}

typedef unsigned int unint;
unint magic = 42; // Noncompliant;

// my_file.c
#include "my_file.h"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">// my_file.h
         void func(int, float);
         void add(int a, int b);
inline void subt(int a, int b) {return a-b; }

struct {
  int i;
  char c;
};

class point {
  int x;
  int y;

public:
  getX();
  getY();
}

typedef unsigned int unint;

// my_file.c
#include "my_file.h"

void add(int a, int b) { return a+b; }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>Because template functions and classes are not instantiable if defined outside a header file, this rule ignores template definitions in headers.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>MISRA C:2004, 8.5 - There shall be no definitions of objects or functions in a header file.</p>
</li>
<li>
<p>MISRA C&#43;&#43;:2008, 3-1-1 - It shall be possible to include any header Ô¨Åle in multiple translation units without violating the One Definition Rule.</p>
</li>
<li>
<p>MISRA C:2012, 8.5 - An external object or function shall be declared once in one and only one file</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Move this definition of "xxx" to a source file.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_9_sep_2014_221744_evgeny_mandrikov_wrote">on 9 Sep 2014, 22:17:44 Evgeny Mandrikov wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] what about templates in C&#43;&#43;?</p>
</div>
<div class="paragraph">
<p>Also while this is a serious issue, I wouldn&#8217;t say that definition in header file is always "bug".</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_10_sep_2014_145459_ann_campbell_wrote">on 10 Sep 2014, 14:54:59 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~evgeny.mandrikov] Do you mean class templates? Like structs, they can be declared in a header. From what I&#8217;m reading, they should be (and it&#8217;s easy to argue that structs should be too). Are you asking for an explicit statement in the rule to that effect?</p>
</div>
<div class="paragraph">
<p>I tagged this bug because it can lead to bugs but I was also ambivalent. What, if anything, would you suggest?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_10_sep_2014_150852_evgeny_mandrikov_wrote">on 10 Sep 2014, 15:08:52 Evgeny Mandrikov wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I was talking about function templates like</p>
</div>
<div class="paragraph">
<p>{noformat}</p>
</div>
<div class="paragraph">
<p>template&lt;typename T&gt; void f(T s) {</p>
</div>
<div class="literalblock">
<div class="content">
<pre>std::cout &lt;&lt; s &lt;&lt; '\n';</pre>
</div>
</div>
<div class="paragraph">
<p>}</p>
</div>
<div class="paragraph">
<p>{noformat}</p>
</div>
<div class="paragraph">
<p>IMO from the description / example not clear whether this compliant or not. And after you mentioned classes and structs - same story, requires re-reading of description several times for understanding. Probably update of examples can heavily improve situation.</p>
</div>
<div class="paragraph">
<p>Regarding tags I would say "pitfall".</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_11_sep_2014_195007_ann_campbell_wrote">on 11 Sep 2014, 19:50:07 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>See what you think now [~evgeny.mandrikov]</p>
</div>
</div>
</div>
</div>