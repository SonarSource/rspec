== How to fix it in pymongo

=== Code examples

The following code is vulnerable to NoSQL injections because untrusted data that
can contain dictionaries is passed to a filter query of MongoDB.

==== Noncompliant code example

[source,python,diff-id=11,diff-type=noncompliant]
----
@app.route('/login')
def login():
    username = request.get_json()['username']
    password = request.get_json()['password']

    user = users.find_one({"username": username, "password": password})  # Noncompliant
----

==== Compliant solution

[source,python,diff-id=11,diff-type=compliant]
----
@app.route('/login')
def login():
    username = str(request.get_json()['username'])
    password = str(request.get_json()['password'])

    user = users.find_one({"username": username, "password": password})
----

=== How does this work?

As a rule of thumb, the approach to protect against injection vulnerabilities
is to ensure that untrusted data cannot break out of the initially intended
logic. You can do this easily by type-casting potential dictionaries to strings.
