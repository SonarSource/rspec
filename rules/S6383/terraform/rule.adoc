Disabling Role-Based Access Control can reduce an organization's ability to
protect itself against access control compromise.      

To be considered safe, access control must follow the least privilege principle
and correctly segregate duties amongst people. Using Role-Based Access Control
helps grant permissions as atomically as possible: It helps bring security and
simplicity.

Furthermore, Role-Based Access Control will allow operations teams to be faster
during a security incident. It helps quickly mitigate account theft or
intrusions by narrowing the impacted scope as soon as possible.

== Ask Yourself Whether

* This Azure resource is essential for the information system infrastructure.
* This Azure resource is essential for mission-critical functions.
* Compliance policies require access to this resource to specifically be authenticated with Role-Based Access Control.

There is a risk if you answered yes to any of those questions.

== Recommended Secure Coding Practices

Enable Role-Based Access Control.

== Sensitive Code Example

For https://azure.microsoft.com/fr-fr/services/kubernetes-service/[Azure Kubernetes Services]:

----
resource "azurerm_kubernetes_cluster" "example" {
  role_based_access_control {
    enabled = false # Sensitive
  }
}

resource "azurerm_kubernetes_cluster" "example2" {
  role_based_access_control {
    enabled = true

    azure_active_directory {
      managed = true
      azure_rbac_enabled = false # Sensitive
    }
  }
}
----

For https://azure.microsoft.com/fr-fr/services/key-vault/[Key Vaults]:

----
resource "azurerm_key_vault" "production" {
  enable_rbac_authorization = false # Sensitive

  access_policy {
    key_permissions = ["Get"]

    secret_permissions = ["Get"]

    storage_permissions = ["Get"]
  }
}
----

== Compliant Solution

For https://azure.microsoft.com/fr-fr/services/kubernetes-service/[Azure Kubernetes Services]:

----
resource "azurerm_kubernetes_cluster" "example" {
  role_based_access_control {
    enabled = true
  }
}

resource "azurerm_kubernetes_cluster" "example" {
  role_based_access_control {
    enabled = true

    azure_active_directory {
      managed = true
      azure_rbac_enabled = true
    }
  }
}
----

For https://azure.microsoft.com/fr-fr/services/key-vault/[Key Vaults]:

----
resource "azurerm_key_vault" "production" {
  enable_rbac_authorization   = true

  access_policy {
    key_permissions = ["Get"]

    secret_permissions = ["Get"]

    storage_permissions = ["Get"]
  }
}
----

== See

* https://owasp.org/Top10/A01_2021-Broken_Access_Control/[OWASP Top 10 2021 Category A1] - Boken Access Control
* https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control[OWASP Top 10 2017 Category A5] - Boken Access Control
* https://cwe.mitre.org/data/definitions/668.html[MITRE, CWE-668] - Exposure of Resource to Wrong Sphere

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

=== Message

* Omitting {parameter} disables role-based access control for this resource. Make sure it is safe here.
* Make sure that disabling role-based access control is safe here.

=== Highlighting

* If role_based_acccess_control is missing, highlight the resource
* If an assignment is non-compliant, highlight the entire assignment
* If an assignment is missing, highlight the block where it should be.


endif::env-github,rspecator-view[]

