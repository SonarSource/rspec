<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Disabling Role-Based Access Control (RBAC) on Azure resources can reduce an
organization&#8217;s ability to protect itself against access controls being compromised.</p>
</div>
<div class="paragraph">
<p>To be considered safe, access controls must follow the principle of
least privilege and correctly segregate duties amongst users.
RBAC helps enforce these practices by adapting the organization&#8217;s access control
needs into explicit role-based policies: It helps keeping access controls maintainable
and sustainable.</p>
</div>
<div class="paragraph">
<p>Furthermore, RBAC allows operations teams to work faster during a security
incident. It helps to mitigate account theft or intrusions by quickly shutting down
accesses.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>This Azure resource is essential for the information system infrastructure.</p>
</li>
<li>
<p>This Azure resource is essential for mission-critical functions.</p>
</li>
<li>
<p>Compliance policies require access to this resource to be enforced through the use of Role-Based Access Control.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Enable Azure RBAC when the Azure resource supports it.</p>
</li>
<li>
<p>For Kubernetes clusters, enable Azure RBAC if Azure AD integration is supported. Otherwise, use the built-in Kubernetes RBAC.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For <a href="https://azure.microsoft.com/fr-fr/services/kubernetes-service/">Azure Kubernetes Services</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "azurerm_kubernetes_cluster" "example" {
  role_based_access_control {
    enabled = false # Sensitive
  }
}

resource "azurerm_kubernetes_cluster" "example2" {
  role_based_access_control {
    enabled = true

    azure_active_directory {
      managed = true
      azure_rbac_enabled = false # Sensitive
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://azure.microsoft.com/fr-fr/services/key-vault/">Key Vaults</a> since 4.42.0:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "azurerm_key_vault" "example" {
  rbac_authorization_enabled = false # Sensitive
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://azure.microsoft.com/fr-fr/services/key-vault/">Key Vaults</a> before 4.42.0:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "azurerm_key_vault" "example" {
  enable_rbac_authorization = false # Sensitive
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For <a href="https://azure.microsoft.com/fr-fr/services/kubernetes-service/">Azure Kubernetes Services</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "azurerm_kubernetes_cluster" "example" {
  role_based_access_control {
    enabled = true
  }
}

resource "azurerm_kubernetes_cluster" "example" {
  role_based_access_control {
    enabled = true

    azure_active_directory {
      managed = true
      azure_rbac_enabled = true
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://azure.microsoft.com/fr-fr/services/key-vault/">Key Vaults</a> since 4.42.0:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "azurerm_key_vault" "example" {
  rbac_authorization_enabled = true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <a href="https://azure.microsoft.com/fr-fr/services/key-vault/">Key Vaults</a> before 4.42.0:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "azurerm_key_vault" "example" {
  enable_rbac_authorization = true
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/668">CWE-668 - Exposure of Resource to Wrong Sphere</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>Omitting {parameter} disables role-based access control for this resource. Make sure it is safe here.</p>
</li>
<li>
<p>Make sure that disabling role-based access control is safe here.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>If {parameter} is missing, highlight the resource</p>
</li>
<li>
<p>If an assignment is non-compliant, highlight the entire assignment</p>
</li>
<li>
<p>If an assignment is missing, highlight the block where it should be.</p>
</li>
</ul>
</div>
</div>
</div>
</div>