include::../description.adoc[]

include::../ask-yourself.adoc[]

include::../recommended.adoc[]

== Sensitive Code Example

Go Standard Library

[source,go]
----
import "net/http"

func handler1(w http.ResponseWriter, req *http.Request) {
	cookie := http.Cookie{}
	cookie.Name = "cookiename"
	cookie.Value = "cookievalue"
	http.SetCookie(w, &cookie) // Sensitive, HttpOnly is false by default
}

func handler2(w http.ResponseWriter, req *http.Request) {
	cookie := http.Cookie{}
	cookie.Name = "cookiename"
	cookie.Value = "cookievalue"
	cookie.HttpOnly = false // Sensitive
	http.SetCookie(w, &cookie)
}
----

Beego

[source,go]
----
import "github.com/beego/beego/v2/server/web"

func (ctrl *MainController) handler() {
	ctrl.Ctx.SetCookie("name1", "value1", 200, "/", "example.com", false, false)                 // Sensitive
	ctrl.Ctx.Output.Cookie("name2", "value2", 200, "/", "example.com", false, false)             // Sensitive
	ctrl.Ctx.SetSecureCookie("secret", "name3", "value3", 200, "/", "example.com", false, false) // Sensitive
}
----

Fiber

[source,go]
----
import "github.com/gofiber/fiber/v2"

func handler1(c *fiber.Ctx) error {
	cookie := new(fiber.Cookie)
	cookie.Name = "name"
	cookie.Value = "value"
	cookie.HTTPOnly = false // Sensitive
	c.Cookie(cookie)
	return c.SendString("")
}

func handler2(c *fiber.Ctx) error {
	cookie := new(fiber.Cookie) // Sensitive, default HTTPOnly is false
	cookie.Name = "name"
	cookie.Value = "value"
	c.Cookie(cookie)
	return c.SendString("")
}
----

Gin

[source,go]
----
import "github.com/gin-gonic/gin"

func handler(c *gin.Context) {
	c.SetCookie("name", "value", 200, "/", "example.com", false, false) // Sensitive
	c.JSON(http.StatusOK, gin.H{"message": ""})
}
----

== Compliant Solution

Go Standard Library

[source,go]
----
import "net/http"

func handler1(w http.ResponseWriter, req *http.Request) {
	cookie := http.Cookie{}
	cookie.Name = "cookiename"
	cookie.Value = "cookievalue"
  cookie.HttpOnly = true // Compliant
	http.SetCookie(w, &cookie)
}

func handler2(w http.ResponseWriter, req *http.Request) {
	cookie := http.Cookie{}
	cookie.Name = "cookiename"
	cookie.Value = "cookievalue"
	cookie.HttpOnly = true // Compliant
	http.SetCookie(w, &cookie)
}
----

Beego

[source,go]
----
import "github.com/beego/beego/v2/server/web"

func (ctrl *MainController) handler() {
	ctrl.Ctx.SetCookie("name1", "value1", 200, "/", "example.com", false, true)                 // Compliant
	ctrl.Ctx.Output.Cookie("name2", "value2", 200, "/", "example.com", false, true)             // Compliant
	ctrl.Ctx.SetSecureCookie("secret", "name3", "value3", 200, "/", "example.com", false, true) // Compliant
}
----

Fiber

[source,go]
----
import "github.com/gofiber/fiber/v2"

func handler1(c *fiber.Ctx) error {
	cookie := new(fiber.Cookie)
	cookie.Name = "name"
	cookie.Value = "value"
	cookie.HTTPOnly = true // Compliant
	c.Cookie(cookie)
	return c.SendString("")
}

func handler2(c *fiber.Ctx) error {
	cookie := new(fiber.Cookie)
	cookie.Name = "name"
	cookie.Value = "value"
	cookie.HTTPOnly = true // Compliant
	c.Cookie(cookie)
	return c.SendString("")
}
----

Gin

[source,go]
----
import "github.com/gin-gonic/gin"

func handler(c *gin.Context) {
	c.SetCookie("name", "value", 200, "/", "example.com", false, true) // Compliant
	c.JSON(http.StatusOK, gin.H{"message": ""})
}
----

include::../see.adoc[]

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::../message.adoc[]

'''
== Comments And Links
(visible only on this page)

include::../comments-and-links.adoc[]

endif::env-github,rspecator-view[]