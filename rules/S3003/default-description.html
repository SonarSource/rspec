<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The use of comparison operators (<code>&lt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>&gt;</code>) with strings is not likely to yield the expected results. Make sure the intention was to compare strings and not numbers.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">var appleNumber = "123";
var orangeNumber = "45";
if (appleNumber &lt; orangeNumber) {  // Noncompliant, this condition is true
  alert("There are more oranges");
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">var appleNumber = "123";
var orangeNumber = "45";
if (Number(appleNumber) &lt; Number(orangeNumber)) {
  alert("There are more oranges");
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>The rule ignores string comparisons occurring in the callback of a sort invocation, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const fruits = ['orange', 'apple', 'banana'];
fruits.sort((a, b) =&gt; a &lt; b);</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Convert operands of this use of "[&lt;|&gt;|&lt;=|&gt;=]" to number type.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>Primary: comparison operator</p>
</li>
<li>
<p>Secondary: both string operands</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_18_nov_2015_174757_elena_vilchik_wrote">on 18 Nov 2015, 17:47:57 Elena Vilchik wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I&#8217;m stuck with this rule. Could you help me with a draft?</p>
</div>
<div class="paragraph">
<p>Initially idea was to check that binary operations are called with operands of same type. But further investigations shown that it&#8217;s common practice to use what ever types you want :)</p>
</div>
<div class="paragraph">
<p>So I found out cases when expected result might differ from actual (see SONARJS-450), and I think that this rule should check only these particular cases. Now I don&#8217;t know what should be the description and especially the title of this rule.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_18_nov_2015_195122_ann_campbell_wrote">on 18 Nov 2015, 19:51:22 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Okay [~elena.vilchik], let&#8217;s narrow this down. We want to raise an issue when:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>String is compared (&lt;, &gt;, &lt;=, &gt;=, ==(?), ===(?)) with &#8230;&#8203; anything? Linked ticket shows <code>str1 &lt; str2</code> but it seems that it would be equally faulty with <code>str1 &lt; obj</code> and <code>str1 &gt;= 4</code> &#8230;&#8203;?</p>
</li>
<li>
<p>Strings are concatenated with non-strings</p>
</li>
<li>
<p>dis-similar types are checked for (in)equality. Is this only <code>===</code> or <code>==</code> as well?</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_nov_2015_113442_elena_vilchik_wrote">on 19 Nov 2015, 11:34:42 Elena Vilchik wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Not exactly. It should be this way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string compared with string only (&lt;, &gt;, &lt;=, &gt;=)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>"123" &lt; "14" // true, lexical comparison     &lt;--- Noncompliant
"123" &lt; 14   // false, both casted to numbers</pre>
</div>
</div>
<div class="paragraph">
<p>Comparison of string with other types is not so dangerous (because actual behaviour is quite expected).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>string concatenated with numbers (because some could expect addition)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>"123" + 45  // "12345"   &lt;--- Noncompliant</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>check only "===" for any non identical types</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>"1" == 1 // true
"1" === 1 // false, whatever values, if types are different &lt;--- Noncompliant</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_nov_2015_195349_ann_campbell_wrote">on 19 Nov 2015, 19:53:49 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>What do you think of splitting this into two rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Faulty string operations should not be made</p>
</li>
<li>
<p>"===" should not be used with dissimilar types
?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Otherwise, the best I&#8217;ve got is: Faulty operations should not be made</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_20_nov_2015_094642_elena_vilchik_wrote">on 20 Nov 2015, 09:46:42 Elena Vilchik wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] We decided to split it to 3 rules :)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>String comparisons should not be made (major with suspicious tag)</p>
</li>
<li>
<p>Numbers should be added to strings (major with suspicious tag)</p>
</li>
<li>
<p>"===" should not be used with dissimilar types (critical with bug tag)
(welcome to change these titles)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Could you create RSPECs?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_20_nov_2015_163840_elena_vilchik_wrote">on 20 Nov 2015, 16:38:40 Elena Vilchik wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Looks like i explained rule badly. I changed description so that now IMO it reflect the rule idea. Could you check it?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_20_nov_2015_164839_ann_campbell_wrote">on 20 Nov 2015, 16:48:39 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Looks good [~elena.vilchik]</p>
</div>
</div>
</div>
</div>