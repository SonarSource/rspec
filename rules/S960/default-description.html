<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Even if function-like macros may look similar to functions, they work differently. For example, functions provide parameter type-checking, whereas macros do not. Furthermore, since macros result in textual replacements, the code within a macro argument may be evaluated multiple times or in unexpected ways.</p>
</div>
<div class="paragraph">
<p>Generally, functions provide a more secure and reliable mechanism than function-like macros. This safety usually outweighs the speed advantages allegedly offered by macros. Therefore, whenever possible, functions should be preferred.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#define CUBE (X) ((X) * (X) * (X)) // Noncompliant

void func(void) {
  int i = 2;
  int a = CUBE(++i); // Noncompliant. Expands to: int a = ((++i) * (++i) * (++i))
  // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">inline int cube(int i) {
  return i * i * i;
}

void func(void) {
  int i = 2;
  int a = cube(++i); // yields 27
  // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>In a few situations, actual functions can&#8217;t replace function-like macros because the macro relies on features that only work with textual replacement. For instance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using manipulation of tokens, such as <code>##</code> (token-pasting) and <code>#</code> (stringification).</p>
</li>
<li>
<p>Getting information about the context into which the macro is expanded by using <code>__FILE__</code>, <code>__LINE__</code>, <code>__func__</code>, or other similar compiler-specific constructs.</p>
<div class="paragraph">
<p>Note that C&#43;&#43;20 <code>std::source_location</code> can be a good replacement for some of these use cases&#8201;&#8212;&#8201;see <a data-rspec-id="S6190" class="rspec-auto-link">S6190</a>.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This rule will ignore macros that make use of those features.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>MISRA C&#43;&#43;:2023, 19.0.2 - Function-like macros shall not be defined</p>
</li>
<li>
<p>MISRA C:2012, Dir. 4.9 - A function should be used in preference to a function-like macro where they are interchangeable</p>
</li>
<li>
<p>MISRA C&#43;&#43;:2008, 16-0-4 - Function-like macros shall not be defined.</p>
</li>
<li>
<p>MISRA C:2004, 19.7 - A function should be used in preference to a function-like macro.</p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/INcxBQ">CERT, PRE00-C.</a> - Prefer inline or static functions to function-like macros</p>
</li>
<li>
<p>C++ Core Guidelines - <a href="https://github.com/isocpp/CppCoreGuidelines/blob/e49158a/CppCoreGuidelines.md#es31-dont-use-macros-for-constants-or-functions">ES.31: Don&#8217;t use macros for constants or "functions"</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Use an inline or static function instead.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_related_to_s962">is related to: <a data-rspec-id="S962" class="rspec-auto-link">S962</a></h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s971">is related to: <a data-rspec-id="S971" class="rspec-auto-link">S971</a></h3>

</div>
<div class="sect2">
<h3 id="_on_19_sep_2014_134613_freddy_mallet_wrote">on 19 Sep 2014, 13:46:13 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>@Ann, I would append the following MISRA explanations to the description :</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>While macros can provide a speed advantage over functions, functions provide a safer and more robust mechanism. This is particularly true with respect to the type checking of parameters, and the problem of function-like macros potentially evaluating parameters multiple times.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>