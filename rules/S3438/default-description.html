<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use of a Spring <code>SingleConnectionFactory</code> without enabling the <code>reconnectOnException</code> setting will prevent automatic connection recovery when the connection goes bad.</p>
</div>
<div class="paragraph">
<p>That&#8217;s because the <code>reconnectOnException</code> property defaults to <code>false</code>. As a result, even if the code that uses this connection factory (Spring&#8217;s <code>DefaultMessageListenerContainer</code> or your own code) has reconnect logic, that code won&#8217;t work because the <code>SingleConnectionFactory</code> will act like a single-connection pool by preventing connection <code>close</code> calls from actually closing anything. As a result, subsequent factory <code>create</code> operations will just hand back the original broken <code>Connection</code>.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;bean id="singleCF" class="org.springframework.jms.connection.SingleConnectionFactory"&gt;  &lt;!-- Noncompliant --&gt;
   &lt;constructor-arg ref="dummyConnectionFactory" /&gt;
 &lt;/bean&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;bean id="singleCF" class="org.springframework.jms.connection.SingleConnectionFactory" p:reconnectOnException="true"&gt;
   &lt;constructor-arg ref="dummyConnectionFactory" /&gt;
 &lt;/bean&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;bean id="singleCF" class="org.springframework.jms.connection.SingleConnectionFactory"&gt;
   &lt;constructor-arg ref="dummyConnectionFactory" /&gt;
   &lt;property name="reconnectOnException"&gt;&lt;value&gt;true&lt;/value&gt;&lt;/property&gt;
 &lt;/bean&gt;</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>Add a "reconnectOnException" property, set to "true"</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>the <code>class</code> value in <code>&lt;bean&gt;</code></p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_5_jan_2016_015217_gordon_daugherty_wrote">on 5 Jan 2016, 01:52:17 Gordon Daugherty wrote:</h3>
<div class="paragraph">
<p>The text of this issue needs to be tweaked. The original version included the "XMF ServiceProxy" terminology that only makes sense within my company. I&#8217;ve reworded it generally. Consider using this:</p>
</div>
<div class="paragraph">
<p>Left unset, the "reconnectOnException" property defaults to "false". As a result, even if the code that uses this Connection Factory (Spring&#8217;s DefaultMessageListenerContainer or your own code) has reconnect logic that code won&#8217;t work because the SingleConnectionFactory is acting like a single-connection pool by preventing connection "close" calls from actually closing anything. As a result subsequent factory "create" operations just hand back the original broken connection.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_5_jan_2016_162811_ann_campbell_wrote">on 5 Jan 2016, 16:28:11 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks [~gjd6640]! I&#8217;ve applied your new version with minor edits.</p>
</div>
</div>
</div>
</div>