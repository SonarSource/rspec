<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when a class defines multiple methods with the same name that accept closures and have parameter types that could cause ambiguous method resolution in Groovy.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Groovy&#8217;s dynamic method resolution system can struggle with overloaded methods that have similar parameter types, especially when closures are involved. This can lead to unexpected method calls and runtime <code>ClassCastException</code> errors.</p>
</div>
<div class="paragraph">
<p>When you define methods like <code>each(List list, Closure closure)</code> and <code>each(Iterator iter, Closure closure)</code>, Groovy&#8217;s method dispatcher might incorrectly choose one over the other. Since <code>List</code> implements <code>Iterable</code> (which extends from similar collection interfaces as <code>Iterator</code>), the type system can become confused about which method to call.</p>
</div>
<div class="paragraph">
<p>This problem is particularly troublesome because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The error only appears at runtime, not during compilation</p>
</li>
<li>
<p>The wrong method might be called silently, leading to unexpected behavior</p>
</li>
<li>
<p>Debugging these issues can be very difficult since the method resolution happens dynamically</p>
</li>
<li>
<p>The error messages often don&#8217;t clearly indicate the root cause</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The issue becomes more complex when dealing with Groovy&#8217;s metaclass system and method caching, where the order of method calls and the state of the runtime can affect which method gets resolved.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>This can cause <code>ClassCastException</code> at runtime when the wrong overloaded method is called. The application may fail unexpectedly, and debugging can be difficult since the method resolution happens dynamically. In some cases, the wrong method might be called silently, leading to incorrect behavior that&#8217;s hard to detect.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use distinct method names instead of overloading methods with similar parameter types. This eliminates ambiguity in method resolution and makes the code more explicit about which operation is being performed.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">class MyClass {
    def each(List list, Closure closure) { // Noncompliant
        list.each(closure)
    }

    def each(Iterator iter, Closure closure) { // Noncompliant
        while (iter.hasNext()) {
            closure(iter.next())
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">class MyClass {
    def eachList(List list, Closure closure) {
        list.each(closure)
    }

    def eachIterator(Iterator iter, Closure closure) {
        while (iter.hasNext()) {
            closure(iter.next())
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Groovy Method Selection - <a href="https://groovy-lang.org/objectorientation.html#_method_selection_algorithm">Official documentation on how Groovy selects methods during runtime dispatch</a></p>
</li>
<li>
<p>Groovy Closures - <a href="https://groovy-lang.org/closures.html">Comprehensive guide to closures in Groovy</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>