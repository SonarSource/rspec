<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when an overriding method changes a contract defined in a superclass.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Because a subclass instance may be used as an instance of the superclass, overriding methods should uphold the aspects of the superclass contract that relate to the <a href="https://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov Substitution Principle</a>. Specifically, an overriding method should be callable with the same parameters as the overriden one.</p>
</div>
<div class="paragraph">
<p>The following modifications are OK:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding an optional parameter, i.e. with a default value, as long as they don&#8217;t change the order of positional parameters.</p>
</li>
<li>
<p>Renaming a positional-only parameter.</p>
</li>
<li>
<p>Reordering keyword-only parameters.</p>
</li>
<li>
<p>Adding a default value to an existing parameter.</p>
</li>
<li>
<p>Changing the default value of an existing parameter.</p>
</li>
<li>
<p>Extend the ways a parameter can be provided, i.e. change a keyword-only or positional-only parameter to a keyword-or-positional parameter. This is only true if the order of positional parameters doesn&#8217;t change. New positional parameters should be placed at the end.</p>
</li>
<li>
<p>Adding a vararg parameter (<code>*args</code>).</p>
</li>
<li>
<p>Adding a keywords parameter (<code>**kwargs</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following modifications are not OK:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Removing parameters, even when they have default values.</p>
</li>
<li>
<p>Adding mandatory parameters, i.e. without a default value.</p>
</li>
<li>
<p>Removing the default value of a parameter.</p>
</li>
<li>
<p>Reordering parameters, except when they are keyword-only parameters.</p>
</li>
<li>
<p>Removing some ways of providing a parameter. If a parameter could be passed as keyword it should still be possible to pass it as keyword, and the same is true for positional parameters.</p>
</li>
<li>
<p>Removing a vararg parameter (<code>*args</code>).</p>
</li>
<li>
<p>Removing a keywords parameter (<code>**kwargs</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This rule raises an issue when the signature of an overriding method does not accept the same parameters as the overriden one. Only instance methods are considered, class methods and static methods are ignored.</p>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>In theory, renaming parameters also breaks Liskov Substitution Principle. Arguments can&#8217;t be passed via keyword arguments anymore. However, <a href="https://www.python.org/dev/peps/pep-0570/#consistency-in-subclasses">PEP-570</a> indicates it is common to rename parameters when it improves code readability and when arguments are always passed by position.</p>
</div>
<div class="paragraph">
<p>"Positional-Only Parameters" were introduced in Python 3.8 to solve this problem. As most programs will need to support older versions of Python, this rule won&#8217;t raise an issue on renamed parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">class ParentClass(object):
    def mymethod(self, param1):
        pass

class ChildClassRenamed(ParentClass):
    def mymethod(self, renamed): # No issue but this is suspicious. Rename this parameter as "param1" or use positional only arguments if possible.
        pass</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">class ParentClass(object):
    def mymethod(self, param1):
        pass

class ChildClassMore(ParentClass):
    def mymethod(self, param1, param2, param3): # Noncompliant * 2.
        # Remove parameter "param2" or provide a default value.
        # Remove parameter "param3" or provide a default value.
        pass

class ChildClassLess(ParentClass):
    def mymethod(self): # Noncompliant. Add missing parameter "param1".
        pass

class ChildClassReordered(ParentClass):
    def mymethod(self, inserted, param1): # Noncompliant
        # Remove parameters "inserted" or provide a default value.
        pass</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">class ParentClass(object):
    def mymethod(self, param1):
        pass

class ChildClassMore(ParentClass):
    def mymethod(self, param1, param2=None, param3=None):
        pass

class ChildClassLess(ParentClass):
    def mymethod(self, param1=None):
        pass

class ChildClassReordered(ParentClass):
    def mymethod(self, param1, inserted=None):
        pass</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>SOLID - <a href="https://en.wikipedia.org/wiki/Liskov_substitution_principle">Wikipedia - Liskov substitution principle</a></p>
</li>
<li>
<p>Python Enhancement Proposal (PEP) 3102 - <a href="https://www.python.org/dev/peps/pep-3102/">Keyword-Only Arguments</a></p>
</li>
<li>
<p>Python Enhancement Proposal (PEP) 570 - <a href="https://www.python.org/dev/peps/pep-0570/">Python Positional-Only Parameters</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>When some parameters are missing</p>
<div class="ulist">
<ul>
<li>
<p>add missing parameters XXX, YYY, &#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
<li>
<p>When there are more mandatory positional parameters:</p>
<div class="ulist">
<ul>
<li>
<p>Remove parameter XXX or provide default value.</p>
</li>
</ul>
</div>
</li>
<li>
<p>When the default value of a parameter is removed</p>
<div class="ulist">
<ul>
<li>
<p>Add a default value to parameter XXX.</p>
</li>
</ul>
</div>
</li>
<li>
<p>When a positional parameter is not at the right place in the list.</p>
<div class="ulist">
<ul>
<li>
<p>Move parameter XXX to position 1.</p>
</li>
</ul>
</div>
</li>
<li>
<p>When a parameter was keyword-or-positional and becomes keyword-only or positional-only</p>
<div class="ulist">
<ul>
<li>
<p>Make parameter XXX keyword-or-positional</p>
</li>
</ul>
</div>
</li>
<li>
<p>When a parameter was keyword-only and becomes positional-only</p>
<div class="ulist">
<ul>
<li>
<p>Make parameter XXX keyword-only or keyword-or-positional</p>
</li>
</ul>
</div>
</li>
<li>
<p>When a parameter was positional-only and becomes keyword-only</p>
<div class="ulist">
<ul>
<li>
<p>Make parameter XXX positional-only or keyword-or-positional</p>
</li>
</ul>
</div>
</li>
<li>
<p>When the overriden method had a vararg (*args) but the overriding method doesn&#8217;t</p>
<div class="ulist">
<ul>
<li>
<p>Add the missing vararg (*args)</p>
</li>
</ul>
</div>
</li>
<li>
<p>When the overriden method had a 'keywords' argument (**kwargs) but the overriding method doesn&#8217;t</p>
<div class="ulist">
<ul>
<li>
<p>Add the missing "keywords" argument (**kwrags)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>Primary:</p>
<div class="ulist">
<ul>
<li>
<p>the function definition or parameter, depending on the issue</p>
</li>
</ul>
</div>
</li>
<li>
<p>Secondary</p>
<div class="ulist">
<ul>
<li>
<p>the overriden method</p>
</li>
<li>
<p><strong>message: "Overriden method&#8217;s definition"</strong></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_related_to_s4454">is related to: <a data-rspec-id="S4454" class="rspec-auto-link">S4454</a></h3>

</div>
<div class="sect2">
<h3 id="_on_4_mar_2016_120912_sytze_van_koningsveld_wrote">on 4 Mar 2016, 12:09:12 sytze van koningsveld wrote:</h3>
<div class="paragraph">
<p>This description is not correct; subclasses are allowed to loosen the contract on parameters, and tightened on return values; see also https://en.wikipedia.org/wiki/Liskov_substitution_principle. Example :</p>
</div>
<div class="paragraph">
<p>public class Raspberry extends Fruit {</p>
</div>
<div class="literalblock">
<div class="content">
<pre>public void setRipe(Season ripe) {  //compliant</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>this.ripe = ripe;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>public @Notnull Integer getProtein() throws MyException {  //compliant</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>return 12;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>}</pre>
</div>
</div>
<div class="paragraph">
<p>}</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_mar_2016_134747_ann_campbell_wrote">on 4 Mar 2016, 13:47:47 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~sytzevk] it&#8217;s allowable - that&#8217;s why it compiles. But it may not be the best idea.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_mar_2016_151249_sytze_van_koningsveld_wrote">on 4 Mar 2016, 15:12:49 sytze van koningsveld wrote:</h3>
<div class="paragraph">
<p>so Liskov&#8217;s principle is a bad idea ? Can you elaborate a bit on why you think a fundamental property of object orientation is not the best idea ?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_7_mar_2016_103604_nicolas_peru_wrote">on 7 Mar 2016, 10:36:04 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Hi [~sytzevk],</p>
</div>
<div class="paragraph">
<p>First a word about the formulation of your question :</p>
</div>
<div class="paragraph">
<p>While we love hearing (negative) feedback, please keep a polite voice and avoid passive agressive tone like in your last question. Being right and pointing out errors of others does not allow to be rude (on the contrary). Thanks.</p>
</div>
<div class="paragraph">
<p>Now for the content of your feedback:</p>
</div>
<div class="paragraph">
<p>If you think about this rule as a rule to detect LSP violations, then indeed, it does not work as it will detect cases that are not LSP violations when you loosen contract on parameters and tighten on return values (false positives).</p>
</div>
<div class="paragraph">
<p>As a first implementation we did not think about it like this, so I&#8217;ll update the description and create a ticket to fix this rule.</p>
</div>
<div class="paragraph">
<p>Thanks!</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_9_jan_2018_163930_amaury_levé_wrote">on 9 Jan 2018, 16:39:30 Amaury Levé wrote:</h3>
<div class="paragraph">
<p>This rule cannot be implemented in C#/VB.Net as these annotations do not exist.</p>
</div>
</div>
</div>
</div>