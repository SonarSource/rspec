<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first element of an array should be accessed using the subscript operator (<code>array[0]</code>),
instead of dereferencing the array (<code>*array</code>) or using the arrow operator on it (<code>array-&gt;mem</code>).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When an expression refers to an object of array type,
it can produce a pointer to the first element of the array.
This behavior is known as array-to-pointer decay or simply array decay.</p>
</div>
<div class="paragraph">
<p>Because of array-to-pointer decay, it is possible to use the dereference operator (<code>*</code>) or
the pointer member access operator (<code>-&gt;</code>) on an array object to access its first element.
However, it remains unclear if accessing the first element was intentional.
In contrast, using array subscript (<code>[0]</code>) removes any such ambiguity.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when the deference operator or the member access operator is used
on an array.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">struct Struct { int x; };
Struct elems[10];
int integers[5];

void init() {
  for (int i = 0; i &lt; 5; ++i) {
    *integers = i; // Noncompliant: "*" used to access "integers[0]"
  }
}

void process() {
  for (int i = 0; i &lt; 10; ++i) {
    elems-&gt;x *= 2; // Noncompliant: "-&gt;" used to access "elems[0]"
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fix depends on the intended effect of the code:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the intent is to access the first element, <code>-&gt;</code> or <code>*</code> should be replaced with an explicit subscripts with <code>[0]</code>;</p>
</li>
<li>
<p>If another element was meant to be accessed, a subscript with the appropriate index should be used;</p>
</li>
<li>
<p>If the intent was to dereference a pointer (for instance to iterate on array elements), the array should be replaced with the appropriate pointer.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">struct Struct { int x; };
Struct elems[10];

void process() {
  for (int i = 0; i &lt; 10; ++i) {
    elems-&gt;x *= 2; // Noncompliant: "-&gt;" used to access "elems[0]"
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="paragraph">
<p>If the access to the first element was intentional, you can use subscript explicitly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">struct Struct { int x; };
Struct elems[10];

void process() {
  for (int i = 0; i &lt; 10; ++i) {
    elems[0].x *= 2; // Compliant: element accessed through subscript
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Otherwise, if <code>i</code>th element was to be updated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">struct Struct { int x; };
Struct elems[10];

void process() {
  for (int i = 0; i &lt; 10; ++i) {
    elems[i].x *= 2; // Compliant: element accessed through subscript
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, the <code>i</code>th element can be accessed using <code>-&gt;</code> and <code>elem</code> pointer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">struct Struct { int x; };
Struct elems[10];

void process() {
  for (Struct* elem = elems, end = elems + 10; elem != end; ++elem) {
    elem-&gt;x *= 2; // Compliant: dereferencing a pointer
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">int integers[5];

void init() {
  for (int i = 0; i &lt; 5; ++i) {
    *integers = i; // Noncompliant: "*" used to access "integers[0]"
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="paragraph">
<p>The intent was probably to access the <code>i</code>th element of <code>integers</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">int integers[5];

void init() {
  for (int i = 0; i &lt; 5; ++i) {
    integers[i] = i; // Compliant: element accessed through subscript
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, to preserve current behavior, use a subscript to explicitly access the first element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">int integers[5];

void init() {
  for (int i = 0; i &lt; 5; ++i) {
    integers[0] = i; // Compliant: element accessed through subscript
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>C&#43;&#43; reference - <a href="https://en.cppreference.com/w/cpp/language/array#Array-to-pointer_decay">Array-to-pointer decay</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S945" class="rspec-auto-link">S945</a> detects array decays that happen when passing an array object to a function that has a pointer parameter.</p>
</li>
</ul>
</div>
</div>
</div>
</div>