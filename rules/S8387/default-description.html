<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Inter-process communication (IPC) mechanisms allow data exchange between
separate processes or execution contexts. When user-controlled data flows into
IPC channels without proper validation or sanitization, it can lead to security
vulnerabilities in the receiving process.</p>
</div>
<div class="paragraph">
<p>The receiving process often operates with a different trust level or security
context.<br>
By passing unvalidated data through IPC, an attacker can potentially exploit
vulnerabilities in the receiving process, bypass security controls, or cause
unintended behavior in components that assume incoming IPC data is trustworthy.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>When tainted data is sent through IPC channels without proper validation,
several security issues can arise, depending on how the receiving process trusts
the data.</p>
</div>
<div class="sect3">
<h4 id="_remote_code_execution">Remote code execution</h4>
<div class="paragraph">
<p>If the receiving process interprets the IPC data as commands or code, an
attacker could execute arbitrary code in the context of that process. This is
particularly dangerous when the receiving process has elevated privileges.</p>
</div>
</div>
<div class="sect3">
<h4 id="_security_control_bypass">Security control bypass</h4>
<div class="paragraph">
<p>IPC often crosses security boundaries between processes. Sending unvalidated
data can allow attackers to bypass access controls, authentication mechanisms,
or sandboxing implemented in the receiving process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_data_corruption_and_integrity_issues">Data corruption and integrity issues</h4>
<div class="paragraph">
<p>Malicious data passed through IPC can corrupt the state of the receiving
process, leading to incorrect behavior, crashes, or data loss in dependent
systems.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="paragraph">
<p>The following code is vulnerable because user-controlled data is sent directly
through IPC without validation.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const { fork } = require('child_process');

function handleRequest(req, res) {
    const userInput = req.query.data;

    const child = fork('./worker.js');
    child.send({ command: userInput });
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const { fork } = require('child_process');

const ALLOWED_COMMANDS = ['process', 'analyze', 'transform'];

function handleRequest(req, res) {
    const userInput = req.query.data;

    if (!ALLOWED_COMMANDS.includes(userInput)) {
        res.status(400).send('Invalid command');
        return;
    }

    const child = fork('./worker.js');
    child.send({ command: userInput });
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="sect3">
<h4 id="_input_validation">Input validation</h4>
<div class="paragraph">
<p>The compliant solution validates user input against an allowlist of permitted
values before sending it through IPC. This ensures that only expected,
legitimate data reaches the receiving process.</p>
</div>
<div class="paragraph">
<p>When validating IPC data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use allowlists to restrict input to known-safe values when possible.</p>
</li>
<li>
<p>Validate the structure and type of complex data objects.</p>
</li>
<li>
<p>Sanitize string inputs to remove or escape potentially dangerous characters.</p>
</li>
<li>
<p>Consider the trust model of the receiving process when determining validation
requirements.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Node.js Documentation - <a href="https://nodejs.org/api/child_process.html">Child Processes</a></p>
</li>
<li>
<p>OWASP - <a href="https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html">Input Validation Cheat Sheet</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP Top 10 2021 - <a href="https://owasp.org/Top10/A03_2021-Injection/">A03:2021 - Injection</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/20">CWE-20 - Improper Input Validation</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Ensure that tainted data is validated before being sent through IPC.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Highlight the IPC send call that receives tainted data.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
</div>
</div>