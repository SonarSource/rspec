<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when Apex REST service methods accept parameters but do not validate them before processing.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Apex REST services act as entry points to your Salesforce org, making them potential targets for malicious input or accidental data corruption. When these services accept parameters without proper validation, several problems can occur.</p>
</div>
<div class="paragraph">
<p>First, invalid or malicious data can be stored directly in your database. This compromises data integrity and can cause issues throughout your application. For example, storing an invalid email address makes it impossible to send communications to that contact.</p>
</div>
<div class="paragraph">
<p>Second, unvalidated input creates security vulnerabilities. Attackers might attempt to inject malicious code or exploit business logic flaws. While Salesforce provides some built-in protections, input validation is your first line of defense.</p>
</div>
<div class="paragraph">
<p>Third, poor input validation leads to confusing error messages and bad user experience. When invalid data causes a database operation to fail, users receive cryptic system errors instead of helpful guidance about what went wrong.</p>
</div>
<div class="paragraph">
<p>Finally, unvalidated input can cause unexpected application behavior or crashes. Missing required fields, incorrect data types, or values that violate business rules can cause your code to fail in unpredictable ways.</p>
</div>
<div class="paragraph">
<p>Proper input validation ensures data quality, improves security, provides better user feedback, and makes your application more robust and reliable.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Without proper input validation, REST services can store corrupted data, expose security vulnerabilities, provide poor user experience with unclear error messages, and cause unexpected application failures.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add validation checks for all input parameters before processing them. Validate required fields, data formats, and business rules. Return appropriate HTTP status codes and error messages when validation fails.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">@RestResource(urlMapping='/api/contact')
global class ContactRestService {
    @HttpPost
    global static String createContact(String firstName, String lastName, String email) {
        Contact newContact = new Contact(
            FirstName = firstName,
            LastName = lastName, // Noncompliant
            Email = email // Noncompliant
        );
        insert newContact;
        return newContact.Id;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">@RestResource(urlMapping='/api/contact')
global class ContactRestService {
    @HttpPost
    global static String createContact(String firstName, String lastName, String email) {
        // Validate required fields
        if (String.isBlank(lastName)) {
            RestContext.response.statusCode = 400;
            return 'Last name is required';
        }

        // Validate email format if provided
        if (String.isNotBlank(email) &amp;&amp; !Pattern.matches('[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}', email)) {
            RestContext.response.statusCode = 400;
            return 'Invalid email format';
        }

        Contact newContact = new Contact(
            FirstName = firstName,
            LastName = lastName,
            Email = email
        );
        insert newContact;
        return newContact.Id;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Apex REST Services - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_rest.htm">Official Salesforce documentation on creating and using Apex REST services</a></p>
</li>
<li>
<p>Input Validation Best Practices - <a href="https://developer.salesforce.com/docs/atlas.en-us.secure_coding_guide.meta/secure_coding_guide/secure_coding_input_validation.htm">Salesforce secure coding guidelines for input validation</a></p>
</li>
<li>
<p>String Class Methods - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexref.meta/apexref/apex_methods_system_string.htm">Documentation for String validation methods like isBlank() and isNotBlank()</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-20: Improper Input Validation - <a href="https://cwe.mitre.org/data/definitions/20.html">Common weakness related to insufficient input validation</a></p>
</li>
<li>
<p>OWASP Top 10:2021-A03-Injection - <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP guidance on preventing injection attacks through proper input validation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S6967" class="rspec-auto-link">RSPEC-6967</a> - <a href="https://rules.sonarsource.com/csharp/RSPEC-6967/">Similar rule for C# ASP.NET Core controllers requiring input validation</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>