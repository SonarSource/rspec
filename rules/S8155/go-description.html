<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when functions that return an error as their last return value have that error ignored using the blank identifier (<code>_</code>) or when the error is not checked immediately after the function call.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Go&#8217;s error handling philosophy is built around explicit error checking rather than exceptions. When errors are ignored or not checked immediately, it can lead to several problems:</p>
</div>
<div class="paragraph">
<p>First, ignoring errors with the blank identifier (<code>_</code>) creates silent failures. The program continues executing even when something has gone wrong, which can lead to unpredictable behavior, data corruption, or security vulnerabilities. For example, if a file operation fails but the error is ignored, the program might try to work with invalid data or leave resources in an inconsistent state.</p>
</div>
<div class="paragraph">
<p>Second, when errors are not checked immediately after a function call, it becomes unclear whether subsequent code should execute. The error might indicate that the returned values are invalid or that the operation didn&#8217;t complete successfully. Using these potentially invalid values can cause crashes, incorrect results, or other unexpected behavior.</p>
</div>
<div class="paragraph">
<p>Third, delayed error checking makes debugging more difficult. When an error is checked far from where it occurred, it becomes harder to understand the context and root cause of the problem. This violates Go&#8217;s principle of handling errors close to where they occur.</p>
</div>
<div class="paragraph">
<p>Proper error handling is essential for building robust, maintainable Go applications. It ensures that failures are detected early, handled appropriately, and don&#8217;t propagate silently through the system.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Ignoring or not properly checking errors can lead to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Silent failures that are difficult to detect and debug</p>
</li>
<li>
<p>Data corruption or inconsistent application state</p>
</li>
<li>
<p>Security vulnerabilities when error conditions are not handled</p>
</li>
<li>
<p>Resource leaks when cleanup operations fail silently</p>
</li>
<li>
<p>Unpredictable application behavior in production environments</p>
</li>
<li>
<p>Difficulty in troubleshooting issues due to lack of error information</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Always capture error return values and check them immediately after the function call. Use proper error handling patterns like returning the error to the caller or logging it appropriately.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">file, _ := os.Open("example.txt") // Noncompliant
defer file.Close()</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">file, err := os.Open("example.txt")
if err != nil {
    return fmt.Errorf("failed to open file: %w", err)
}
defer file.Close()</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Error handling and Go - The Go Blog - <a href="https://go.dev/blog/error-handling-and-go">Official Go blog post explaining error handling patterns and best practices</a></p>
</li>
<li>
<p>Go by Example: Errors - <a href="https://gobyexample.com/errors">Practical examples of error handling in Go</a></p>
</li>
<li>
<p>Effective Go - Errors - <a href="https://go.dev/doc/effective_go#errors">Official Go documentation on error handling conventions</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-754: Improper Check for Unusual or Exceptional Conditions - <a href="https://cwe.mitre.org/data/definitions/754.html">Covers the security implications of not properly checking for error conditions</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S1511" class="rspec-auto-link">RSPEC-1511</a> - <a href="https://rules.sonarsource.com/abap/RSPEC-1511/">Similar rule for ABAP about checking return codes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>