<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Inadequately configured "Log Groups" can lead to indefinite storage of log streams on AWS, resulting in potential cost implications and non-compliance with data retention policies.
It&#8217;s crucial to set the appropriate retention policy for <code>AWS::Logs::LogGroup</code> by defining the <code>RetentionInDays</code> property with a valid value.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Properly managing log data is essential for effective system monitoring, troubleshooting, and security auditing.
The failure to configure a retention policy for "Log Groups" in AWS can have several detrimental consequences.</p>
</div>
<div class="paragraph">
<p>Unnecessary Cost: Log events stored indefinitely result in increased storage costs over time.
AWS charges for data storage, and retaining unnecessary logs can lead to higher expenses that could have been avoided.</p>
</div>
<div class="paragraph">
<p>Non-compliance: Many industries and organizations are bound by strict data retention policies and regulatory requirements.
Failing to enforce a retention period for logs may lead to violations, penalties, or legal issues.</p>
</div>
<div class="paragraph">
<p>Security Risks: Keeping logs indefinitely exposes sensitive information to potential breaches.
Storing unnecessary data for an extended period increases the attack surface and the potential impact of a security incident.</p>
</div>
<div class="paragraph">
<p>Operational Inefficiency: The absence of a proper retention policy makes it harder to manage log data effectively.
Over time, log management tasks become more complex, requiring additional effort and resources.</p>
</div>
<div class="paragraph">
<p>Note: This rule doesn&#8217;t check if the value provided to <code>RetentionInDays</code> is valid because AWS CloudFormation Linter (cfn-lint) does it already</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ensure that each <code>AWS::Logs::LogGroup</code> resource includes the <code>RetentionInDays</code> property.
Set this property to a valid value that aligns with your organization&#8217;s data retention policies and regulatory requirements.</p>
</div>
<div class="paragraph">
<p>Choose an appropriate value for the retention based on your specific use case.
Consider factors such as compliance regulations, data analysis needs, and storage cost considerations.
For example, setting the value to 30 days may strike a balance between retaining sufficient data for analysis and avoiding unnecessary storage costs.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">  MyLambdaFunction:
    Type: AWS::Lambda::Function
    Properties:
      Runtime: nodejs12.x
      Description: Example of Lambda Function

  MyFunctionLogGroup:
    Type: AWS::Logs::LogGroup
    Properties:
      LogGroupName: !Join ['/', ['/aws/lambda', !Ref MyLambdaFunction]]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">  MyLambdaFunction:
    Type: AWS::Lambda::Function
    Properties:
      Runtime: nodejs12.x
      Description: Example of Lambda Function

  MyFunctionLogGroup:
    Type: AWS::Logs::LogGroup
    Properties:
      LogGroupName: !Join ['/', ['/aws/lambda', !Ref MyLambdaFunction]]
      RetentionInDays: 30</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>AWS Documentation <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-logs-loggroup.html">AWS::Logs::LogGroup</a></p>
</li>
</ul>
</div>
</div>
</div>