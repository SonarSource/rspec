<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>PRNGs are algorithms that produce sequences of numbers that only approximate true randomness. While they are suitable for applications like simulations or modeling, they are not appropriate for security-sensitive contexts because their outputs can be predictable if the internal state is known.</p>
</div>
<div class="paragraph">
<p>In contrast, cryptographically secure pseudorandom number generators (CSPRNGs) are designed to be secure against prediction attacks. CSPRNGs use cryptographic algorithms to ensure that the generated sequences are not only random but also unpredictable, even if part of the sequence or the internal state becomes known. This unpredictability is crucial for security-related tasks such as generating encryption keys, tokens, or any other values that must remain confidential and resistant to guessing attacks.</p>
</div>
<div class="paragraph">
<p>For example, the use of non-cryptographic PRNGs has led to vulnerabilities such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2013-6386">CVE-2013-6386</a></p>
</li>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2006-3419">CVE-2006-3419</a></p>
</li>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2008-4102">CVE-2008-4102</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that will be generated, and use this guess to impersonate another user or access sensitive information. Therefore, it is critical to use CSPRNGs in any security-sensitive application to ensure the robustness and security of the system.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such as a password, is hashed.</p>
</li>
<li>
<p>the function you use is a non-cryptographic PRNG.</p>
</li>
<li>
<p>the generated value is used multiple times.</p>
</li>
<li>
<p>an attacker can access the generated value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Only use random number generators which are <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation">recommended by OWASP</a> or any other trusted organization.</p>
</li>
<li>
<p>Use the generated random values only once.</p>
</li>
<li>
<p>You should not expose the generated random value. If you have to store it, make sure that the database or file is secure.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">import "math/rand"

a := make([]byte, 10)
rand.Read(a) // Sensitive</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">import "math/rand"

num := rand.Intn(100) // Sensitive</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">import "crypto/rand"

a := make([]byte, 10)
_, err := rand.Read(a)
if err != nil {
    panic(err)
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">import "crypto/rand"

temp, err := rand.Int(rand.Reader, big.NewInt(100))
if err != nil {
    panic(err)
}
num := temp.Int64()</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation">Secure Random Number Generation Cheat Sheet</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">Top 10 2021 Category A2 - Cryptographic Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/338">CWE-338 - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/330">CWE-330 - Use of Insufficiently Random Values</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/326">CWE-326 - Inadequate Encryption Strength</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/1241">CWE-1241 - Use of Predictable Algorithm in Random Number Generator</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure that using this pseudorandom number generator is safe here.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>Highlight the following functions from the package <code>math/rand</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code>Int</code></p>
</li>
<li>
<p><code>Intn</code></p>
</li>
<li>
<p><code>Int31</code></p>
</li>
<li>
<p><code>Int31n</code></p>
</li>
<li>
<p><code>Int63</code></p>
</li>
<li>
<p><code>Int63n</code></p>
</li>
<li>
<p><code>Uint32</code></p>
</li>
<li>
<p><code>Uint64</code></p>
</li>
<li>
<p><code>ExpFloat64</code></p>
</li>
<li>
<p><code>Float32</code></p>
</li>
<li>
<p><code>Float64</code></p>
</li>
<li>
<p><code>NormFloat64</code></p>
</li>
<li>
<p><code>Perm</code></p>
</li>
<li>
<p><code>Shuffle</code></p>
</li>
<li>
<p><code>Read</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Highlight the following methods of the type <code>Rand</code> from the package <code>math/rand</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code>Int</code></p>
</li>
<li>
<p><code>Intn</code></p>
</li>
<li>
<p><code>Int31</code></p>
</li>
<li>
<p><code>Int31n</code></p>
</li>
<li>
<p><code>Int63</code></p>
</li>
<li>
<p><code>Int63n</code></p>
</li>
<li>
<p><code>Uint32</code></p>
</li>
<li>
<p><code>Uint64</code></p>
</li>
<li>
<p><code>ExpFloat64</code></p>
</li>
<li>
<p><code>Float32</code></p>
</li>
<li>
<p><code>Float64</code></p>
</li>
<li>
<p><code>NormFloat64</code></p>
</li>
<li>
<p><code>Perm</code></p>
</li>
<li>
<p><code>Shuffle</code></p>
</li>
<li>
<p><code>Read</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_relates_to_s3329">relates to: <a data-rspec-id="S3329" class="rspec-auto-link">S3329</a></h3>

</div>
<div class="sect2">
<h3 id="_relates_to_s4347">relates to: <a data-rspec-id="S4347" class="rspec-auto-link">S4347</a></h3>

</div>
<div class="sect2">
<h3 id="_on_16_jan_2015_085449_sébastien_gioria_wrote">on 16 Jan 2015, 08:54:49 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>This rule should be tag OWASP-Top10. It&#8217;s part of OWASP Top10 A6-Sensitive_Data_Exposure.</p>
</div>
<div class="paragraph">
<p>It could bee tag also :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CWE Entry 310 on Cryptographic Issues  (http://cwe.mitre.org/data/definitions/310.html)</p>
</li>
<li>
<p>CWE Entry 326 on Weak Encryption (http://cwe.mitre.org/data/definitions/326.html)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_jan_2015_090443_ann_campbell_wrote">on 19 Jan 2015, 09:04:43 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks [~sebastien.gioria]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_27_jul_2018_205024_ann_campbell_wrote">on 27 Jul 2018, 20:50:24 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.harraudeau] where do you expect the issue to be raised? On the <code>rand()</code> call or where the value is used?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_30_jul_2018_100505_nicolas_harraudeau_wrote">on 30 Jul 2018, 10:05:05 Nicolas Harraudeau wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] On the rand() call. This is a hotspot because we are not yet able to detect if the context is dangerous or not.</p>
</div>
<div class="paragraph">
<p>We could later detect that an encryption function or a hash is using the generated value, but it would then be classified as a Vulnerability instead of a Hotspot.</p>
</div>
</div>
</div>
</div>