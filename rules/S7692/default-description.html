<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when tensors are flipped using manual indexing operations with negative steps (e.g., <code>tensor[::-1]</code>) instead of the built-in <code>torch.flip()</code> function.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Manual tensor flipping using negative indexing like <code>tensor[::-1]</code> or <code>tensor[:, :, :, ::-1]</code> is less readable and maintainable compared to using PyTorch&#8217;s built-in <code>torch.flip()</code> function.</p>
</div>
<div class="paragraph">
<p>The manual approach has several drawbacks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Poor readability</strong>: The intent to flip a tensor is not immediately clear from the indexing syntax</p>
</li>
<li>
<p><strong>Error-prone</strong>: It&#8217;s easy to make mistakes with the number of colons and dimensions</p>
</li>
<li>
<p><strong>Hard to maintain</strong>: Changes to tensor dimensions require updating the indexing pattern</p>
</li>
<li>
<p><strong>Less explicit</strong>: The specific dimensions being flipped are not obvious</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>torch.flip()</code> function was specifically designed for this purpose and provides a clear, explicit way to flip tensors along specified dimensions. It takes the tensor and a list of dimensions to flip, making the code self-documenting and easier to understand.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Using manual indexing for tensor flipping reduces code readability and maintainability. While it doesn&#8217;t cause runtime errors, it makes the code harder to understand and more prone to mistakes during modifications. The built-in function is also potentially more optimized for performance.</p>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_fix_in_pytorch">How to fix in PyTorch?</h3>
<div class="paragraph">
<p>Replace manual tensor flipping with negative indexing by using <code>torch.flip()</code>. Specify the tensor and the dimensions to flip as a list.</p>
</div>
<div class="sect3">
<h4 id="_non_compliant_code_example">Non-compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import torch

# Manual tensor flipping along last dimension
flipped_tensor = tensor[:, :, :, ::-1]  # Noncompliant

# Manual flipping along first dimension
flipped_tensor = tensor[::-1]  # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_code_example">Compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import torch

# Using torch.flip along last dimension (dimension 3)
flipped_tensor = torch.flip(tensor, dims=[3])

# Using torch.flip along first dimension (dimension 0)
flipped_tensor = torch.flip(tensor, dims=[0])</code></pre>
</div>
</div>
<div class="paragraph">
<p>For flipping multiple dimensions, you can specify multiple dimensions in the <code>dims</code> parameter.</p>
</div>
</div>
<div class="sect3">
<h4 id="_non_compliant_code_example_2">Non-compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import torch

# Manual flipping along multiple dimensions
flipped_tensor = tensor[::-1, :, ::-1]  # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_code_example_2">Compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import torch

# Using torch.flip along multiple dimensions
flipped_tensor = torch.flip(tensor, dims=[0, 2])</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>torch.flip documentation - <a href="https://pytorch.org/docs/stable/generated/torch.flip.html">Official PyTorch documentation for the torch.flip function</a></p>
</li>
<li>
<p>PyTorch tensor indexing - <a href="https://pytorch.org/docs/stable/tensor_view.html">Documentation on tensor indexing and slicing operations</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>