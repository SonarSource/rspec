<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When handling a caught exception, the original exception&#8217;s message and stack trace should be logged or passed forward.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">try {
  /* ... */
} catch (Exception e) {   // Noncompliant - exception is lost
  LOGGER.info("context");
}

try {
  /* ... */
} catch (Exception e) {  // Noncompliant - exception is lost (only message is preserved)
  LOGGER.info(e.getMessage());
}

try {
  /* ... */
} catch (Exception e) {  // Noncompliant - original exception is lost
  throw new RuntimeException("context");
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">try {
  /* ... */
} catch (Exception e) {
  LOGGER.info(e);  // exception is logged
}

try {
  /* ... */
} catch (Exception e) {
  throw new RuntimeException(e);   // exception stack trace is propagated
}

try {
  /* ... */
} catch (RuntimeException e) {
  doSomething();
  throw e;  // original exception passed forward
} catch (Exception e) {
  throw new RuntimeException(e);  // Conversion into unchecked exception is also allowed
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p><code>InterruptedException</code>, <code>NumberFormatException</code>, <code>DateTimeParseException</code>, <code>ParseException</code> and <code>MalformedURLException</code> exceptions are arguably used to indicate nonexceptional outcomes. Similarly, handling <code>NoSuchMethodException</code> is often required when dealing with the Java reflection API.</p>
</div>
<div class="paragraph">
<p>Because they are part of Java, developers have no choice but to deal with them. This rule does not verify that those particular exceptions are correctly handled.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>int myInteger;
try {
  myInteger = Integer.parseInt(myString);
} catch (NumberFormatException e) {
  // It is perfectly acceptable to not handle "e" here
  myInteger = 0;
}</pre>
</div>
</div>
<div class="paragraph">
<p>Furthermore, no issue will be raised if the exception message is logged with additional information, as it shows that the developer added some context to the error message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>try {
  /* ... */
} catch (Exception e) {
  String message = "Exception raised while authenticating user: " + e.getMessage();
  LOGGER.warn(message); // Compliant - exception message logged with some contextual information
}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/">Top 10 2021 Category A9 - Security Logging and Monitoring Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring">Top 10 2017 Category A10 - Insufficient Logging &amp; Monitoring</a></p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/xDdGBQ">CERT, ERR00-J.</a> - Do not suppress or ignore checked exceptions</p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/778">CWE-778 - Insufficient Logging</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Either log or rethrow this exception.</p>
</div>
</div>
<div class="sect2">
<h3 id="_parameters">Parameters</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">exceptions</div>
<div class="listingblock">
<div class="content">
<pre>java.lang.InterruptedException, java.lang.NumberFormatException, java.text.ParseException, java.net.MalformedURLException,java.time.format.DateTimeParseException</pre>
</div>
</div>
<div class="paragraph">
<p>List of exceptions which should not be checked. Use a simple dash ('-') character to check all exceptions.</p>
</div>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_related_to_s2486">is related to: <a data-rspec-id="S2486" class="rspec-auto-link">S2486</a></h3>

</div>
<div class="sect2">
<h3 id="_relates_to_s1148">relates to: <a data-rspec-id="S1148" class="rspec-auto-link">S1148</a></h3>

</div>
<div class="sect2">
<h3 id="_on_30_jul_2013_165525_freddy_mallet_wrote">on 30 Jul 2013, 16:55:25 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>Is implemented by http://jira.codehaus.org/browse/SONARJAVA-255</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_aug_2013_082726_dinesh_bolkensteyn_wrote">on 8 Aug 2013, 08:27:26 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>We need to know:</p>
</div>
<div class="paragraph">
<p>1) All possible logger objects: LOGGER, Logger, logger</p>
</div>
<div class="paragraph">
<p>2) All possible logging methods: log(), warn(), warning(), error(), info(), debug()</p>
</div>
<div class="paragraph">
<p>There should be at least one logging method in the block having BOTH the exception as an argument + some other argument.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_aug_2013_135529_freddy_mallet_wrote">on 8 Aug 2013, 13:55:29 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>Conditions to log an issue :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Either : The original exception is not used inside the try-catch block as a method parameter</p>
</li>
<li>
<p>Or : When the original exception is used, the method call have only one parameter &#8594; this original exception</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_aug_2013_163500_dinesh_bolkensteyn_wrote">on 8 Aug 2013, 16:35:00 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>I guess this will end up being too strong.</p>
</div>
<div class="paragraph">
<p>You can&#8217;t do stuff like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>catch (IOException e) {
  throw Throwables.propagate(e);
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_on_26_aug_2013_080432_dinesh_bolkensteyn_wrote">on 26 Aug 2013, 08:04:32 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>In fact we couldn&#8217;t even do stuff like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>catch (RuntimeException e) {
  throw e;
} catch (Exception e) {
  /* ... */
}</pre>
</div>
</div>
<div class="paragraph">
<p>This is now fixed.</p>
</div>
<div class="paragraph">
<p>Guava&#8217;s use case is still not allowed for the time being.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_11_mar_2014_065632_dinesh_bolkensteyn_wrote">on 11 Mar 2014, 06:56:32 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>Update ticket: https://jira.codehaus.org/browse/SONARJAVA-446</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_23_jun_2015_082417_evgeny_mandrikov_wrote">on 23 Jun 2015, 08:24:17 Evgeny Mandrikov wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I&#8217;m wondering how and why this references Cppcheck "exceptRethrowCopy" ?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_23_jun_2015_115027_ann_campbell_wrote">on 23 Jun 2015, 11:50:27 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~evgeny.mandrikov] the message for exceptRethrowCopy is "Throwing a copy of the caught exception instead of rethrowing the original exception. (since Cppcheck 1.52)"</p>
</div>
<div class="paragraph">
<p>If you&#8217;re throwing a copy, you&#8217;re not preserving the original.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_23_jun_2015_134538_evgeny_mandrikov_wrote">on 23 Jun 2015, 13:45:38 Evgeny Mandrikov wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] To be precise - Cppcheck rule "exceptRethrowCopy" detects following case:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>catch (Exception &amp;e) {

  throw e; // use of copy-constructor, use "throw;" to avoid call of copy-constructor

}</pre>
</div>
</div>
<div class="paragraph">
<p>Looking on current examples, I&#8217;m wondering why you consider exact-copy as not preservation of original.</p>
</div>
<div class="paragraph">
<p>Also IMO motivation behind Cppcheck rule is different than description of this RSPEC. Note that C&#43;&#43; has no built-in notion of stack trace, compared to Java.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_25_jun_2015_122632_ann_campbell_wrote">on 25 Jun 2015, 12:26:32 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>CPPCheck mapping removed</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_28_sep_2015_054726_ramsatish_jagajyothi_wrote">on 28 Sep 2015, 05:47:26 Ramsatish Jagajyothi wrote:</h3>
<div class="paragraph">
<p>If java code is something like this, this violation is showing up which is false positive</p>
</div>
<div class="paragraph">
<p>throw (cause instanceof RuntimeException ?(RuntimeException)cause:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>new XXXSystemException( cause, cause.getMessage(), e.getErrorCode()) );</pre>
</div>
</div>
<div class="paragraph">
<p>I think this rule is not able to look into the throw params with ternary operator.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_13_oct_2015_115953_ann_campbell_wrote">on 13 Oct 2015, 11:59:53 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~ramsatish] please raise questions on the implementation of rules in individual languages on the <a href="https://groups.google.com/forum/#!forum/sonarqube">SonarQube Google group</a>.</p>
</div>
</div>
</div>
</div>