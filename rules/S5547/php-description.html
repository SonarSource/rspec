<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This vulnerability makes it possible that the cleartext of the encrypted message
might be recoverable without prior knowledge of the key.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Encryption algorithms are essential for protecting sensitive information and
ensuring secure communication in various domains. They are used for several
important reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Confidentiality, privacy, and intellectual property protection</p>
</li>
<li>
<p>Security during transmission or on storage devices</p>
</li>
<li>
<p>Data integrity, general trust, and authentication</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When selecting encryption algorithms, tools, or combinations, you should also
consider two things:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>No encryption is unbreakable.</p>
</li>
<li>
<p>The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For these reasons, as soon as cryptography is included in a project, it is
important to choose encryption algorithms that are considered strong and secure
by the cryptography community.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>The cleartext of an encrypted message might be recoverable. Additionally, it
might be possible to modify the cleartext of an encrypted message.</p>
</div>
<div class="paragraph">
<p>Below are some real-world scenarios that illustrate some impacts of an attacker
exploiting the vulnerability.</p>
</div>
<div class="sect3">
<h4 id="_theft_of_sensitive_data">Theft of sensitive data</h4>
<div class="paragraph">
<p>The encrypted message might contain data that is considered sensitive and should
not be known to third parties.</p>
</div>
<div class="paragraph">
<p>By using a weak algorithm the likelihood that an attacker might be able to
recover the cleartext drastically increases.</p>
</div>
</div>
<div class="sect3">
<h4 id="_additional_attack_surface">Additional attack surface</h4>
<div class="paragraph">
<p>By modifying the cleartext of the encrypted message it might be possible for an
attacker to trigger other vulnerabilities in the code. Encrypted values are
often considered trusted, since under normal circumstances it would not be
possible for a third party to modify them.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_mcrypt">How to fix it in Mcrypt</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="paragraph">
<p>The following code contains examples of algorithms that are not considered
highly resistant to cryptanalysis and thus should be avoided.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">mcrypt_encrypt(MCRYPT_DES, $key, $plaintext, $mode); // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="paragraph">
<p>Mcrypt is deprecated and should not be used. You can use
<a href="https://www.php.net/manual/en/book.sodium.php">Sodium</a> instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">sodium_crypto_aead_aes256gcm_encrypt($plaintext, '', $nonce, $key);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="sect3">
<h4 id="_use_a_secure_algorithm">Use a secure algorithm</h4>
<div class="paragraph">
<p>It is highly recommended to use an algorithm that is currently considered secure
by the cryptographic community. A common choice for such an algorithm is the
Advanced Encryption Standard (AES).</p>
</div>
<div class="paragraph">
<p>For block ciphers, it is not recommended to use algorithms with a block size
that is smaller than 128 bits.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_openssl">How to fix it in OpenSSL</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples_2">Code examples</h3>
<div class="paragraph">
<p>The following code contains examples of algorithms that are not considered
highly resistant to cryptanalysis and thus should be avoided.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">openssl_encrypt($plaintext, "des-ofb", $key, $options=OPENSSL_RAW_DATA, $iv); // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">openssl_encrypt($plaintext, "aes-256-gcm", $key, $options=OPENSSL_RAW_DATA, $iv);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work_2">How does this work?</h3>
<div class="sect3">
<h4 id="_use_a_secure_algorithm_2">Use a secure algorithm</h4>
<div class="paragraph">
<p>It is highly recommended to use an algorithm that is currently considered secure
by the cryptographic community. A common choice for such an algorithm is the
Advanced Encryption Standard (AES).</p>
</div>
<div class="paragraph">
<p>For block ciphers, it is not recommended to use algorithms with a block size
that is smaller than 128 bits.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">Top 10 2021 Category A2 - Cryptographic Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/327">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222396">Application Security and Development: V-222396</a> - The application must implement DoD-approved encryption to protect the confidentiality of remote access sessions.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>For weak symmetric ciphers:
* Use a strong cipher algorithm.</p>
</div>
<div class="paragraph">
<p>For weak TLS cipher suites (OpenSSL, TLS libraries):
* Use only strong cipher suites.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_deprecates_s2258">deprecates: <a data-rspec-id="S2258" class="rspec-auto-link">S2258</a></h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s4787">deprecates: <a data-rspec-id="S4787" class="rspec-auto-link">S4787</a></h3>

</div>
<div class="sect2">
<h3 id="_supercedes_s2278">supercedes: <a data-rspec-id="S2278" class="rspec-auto-link">S2278</a></h3>

</div>
</div>
</div>