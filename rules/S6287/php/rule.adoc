include::../description.adoc[]

== Noncompliant Code Example

----
<?php
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;

public function index(Request $request)
{
    $key = $request->query->get('k');
    $value = $request->query->get('v');

    $response = new Response('');
    $response->headers->set($key, $value);  // Noncompliant
    $cookie = Cookie::create($key, $value);  // Noncompliant
    $response->headers->setCookie($cookie);

    return $response;
}
----

== Compliant Solution

----
<?php
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;

public function index(Request $request)
{
    $value = $request->query->get('v');

    $response = new Response('');
    $response->headers->set('X-Data', $value);
    $cookie = Cookie::create('data', $value);
    $response->headers->setCookie($cookie);

    return $response;
}
----

include::../see.adoc[]
