=== How to fix it in Java SE

include::../../common/fix/code-rationale.adoc[]

[cols="a"]
|===
h| Non-compliant code example
|
[source,java]
----
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
    Optional<Cookie> cookieOpt = Arrays.stream(request.getCookies())
                                    .filter(c -> c.getName().equals("jsessionid"))
                                    .findFirst();

      if (!cookieOpt.isPresent()) {
          String cookie = request.getParameter("cookie");
          Cookie cookieObj = new Cookie("jsessionid", cookie);  // Noncompliant
          response.addCookie(cookieObj);
      }

      response.sendRedirect("/welcome.jsp");
}
----
h| Compliant solution
|
[source,java]
----
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
    Optional<Cookie> cookieOpt = Arrays.stream(request.getCookies())
                                    .filter(c -> c.getName().equals("jsessionid"))
                                    .findFirst();

      if (!cookieOpt.isPresent()) {
          response.sendRedirect("/getCookie.jsp");
      } else {
          response.sendRedirect("/welcome.jsp");
      }
}
----
|===

include::../../common/fix/how-does-this-work.adoc[]