=== How to fix it in Java SE

include::../../common/fix/code-rationale.adoc[]

[cols="a"]
|===
h| Non-compliant code example
|
[source,java]
----
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
    Optional<Cookie> cookieOpt = Optional.of(
                                    Arrays.stream(
                                        request.getCookies())
                                            .filter(t -> "jsessionid"
                                            .equals(t.getName()))
                                            .findFirst()
                                            .get());
    if (cookieOpt.isPresent() ) {
        response.sendRedirect("/welcome.jsp");
    } else {
        String cookie = request.getParameter("cookie");
        Cookie cookieObj = new Cookie("jsessionid", cookie);  // Noncompliant
        response.addCookie(cookieObj);

        response.sendRedirect("/welcome.jsp");
    }
}
----
h| Compliant solution
|
[source,java]
----
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
    Optional<Cookie> cookieOpt = Optional.of(
                                    Arrays.stream(
                                        request.getCookies())
                                            .filter(t -> "jsessionid"
                                            .equals(t.getName()))
                                            .findFirst()
                                            .get());

    if (cookieOpt.isPresent()) {
        response.sendRedirect("/welcome.jsp");
    } else {
        response.sendRedirect("/cookie.jsp");
    }
}
----
|===

include::../../common/fix/how-does-this-work.adoc[]