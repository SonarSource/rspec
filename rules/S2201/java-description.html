<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the call to a function doesn&#8217;t have any side effects, what is the point of making the call if the results are ignored? In such case, either the function call is useless and should be dropped or the source code doesn&#8217;t behave as expected.</p>
</div>
<div class="paragraph">
<p>To prevent generating any false-positives, this rule triggers an issue only on the following predefined list of immutable classes in the Java API :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.lang.String</code></p>
</li>
<li>
<p><code>java.lang.Boolean</code></p>
</li>
<li>
<p><code>java.lang.Integer</code></p>
</li>
<li>
<p><code>java.lang.Double</code></p>
</li>
<li>
<p><code>java.lang.Float</code></p>
</li>
<li>
<p><code>java.lang.Byte</code></p>
</li>
<li>
<p><code>java.lang.Character</code></p>
</li>
<li>
<p><code>java.lang.Short</code></p>
</li>
<li>
<p><code>java.lang.StackTraceElement</code></p>
</li>
<li>
<p><code>java.time.DayOfWeek</code></p>
</li>
<li>
<p><code>java.time.Duration</code></p>
</li>
<li>
<p><code>java.time.Instant</code></p>
</li>
<li>
<p><code>java.time.LocalDate</code></p>
</li>
<li>
<p><code>java.time.LocalDateTime</code></p>
</li>
<li>
<p><code>java.time.LocalTime</code></p>
</li>
<li>
<p><code>java.time.Month</code></p>
</li>
<li>
<p><code>java.time.MonthDay</code></p>
</li>
<li>
<p><code>java.time.OffsetDateTime</code></p>
</li>
<li>
<p><code>java.time.OffsetTime</code></p>
</li>
<li>
<p><code>java.time.Period</code></p>
</li>
<li>
<p><code>java.time.Year</code></p>
</li>
<li>
<p><code>java.time.YearMonth</code></p>
</li>
<li>
<p><code>java.time.ZonedDateTime</code></p>
</li>
<li>
<p><code>java.math.BigInteger</code></p>
</li>
<li>
<p><code>java.math.BigDecimal</code></p>
</li>
<li>
<p><code>java.util.Optional</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As well as methods of the following classes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.util.Collection</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code>size()</code></p>
</li>
<li>
<p><code>isEmpty()</code></p>
</li>
<li>
<p><code>contains(...)</code></p>
</li>
<li>
<p><code>containsAll(...)</code></p>
</li>
<li>
<p><code>iterator()</code></p>
</li>
<li>
<p><code>toArray()</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>java.util.Map</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code>size()</code></p>
</li>
<li>
<p><code>isEmpty()</code></p>
</li>
<li>
<p><code>containsKey(...)</code></p>
</li>
<li>
<p><code>containsValue(...)</code></p>
</li>
<li>
<p><code>get(...)</code></p>
</li>
<li>
<p><code>getOrDefault(...)</code></p>
</li>
<li>
<p><code>keySet()</code></p>
</li>
<li>
<p><code>entrySet()</code></p>
</li>
<li>
<p><code>values()</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>java.util.stream.Stream</code></p>
<div class="ulist">
<ul>
<li>
<p><code>toArray</code></p>
</li>
<li>
<p><code>reduce</code></p>
</li>
<li>
<p><code>collect</code></p>
</li>
<li>
<p><code>min</code></p>
</li>
<li>
<p><code>max</code></p>
</li>
<li>
<p><code>count</code></p>
</li>
<li>
<p><code>anyMatch</code></p>
</li>
<li>
<p><code>allMatch</code></p>
</li>
<li>
<p><code>noneMatch</code></p>
</li>
<li>
<p><code>findFirst</code></p>
</li>
<li>
<p><code>findAny</code></p>
</li>
<li>
<p><code>toList</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void handle(String command){
  command.toLowerCase(); // Noncompliant; result of method thrown away
  ...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void handle(String command){
  String formattedCommand = command.toLowerCase();
  ...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>This rule will not raise an issue when both these conditions are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The method call is in a <code>try</code> block with an associated <code>catch</code> clause.</p>
</li>
<li>
<p>The method name starts with "parse", "format", "decode" or "valueOf" or the method is <code>String.getBytes(Charset)</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">private boolean textIsInteger(String textToCheck) {

    try {
        Integer.parseInt(textToCheck, 10); // OK
        return true;
    } catch (NumberFormatException ignored) {
        return false;
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/xzdGBQ">CERT, EXP00-J.</a> - Do not ignore values returned by methods</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>The return value of "[method name]" must be used.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_12_aug_2019_235832_andreas_knees_wrote">on 12 Aug 2019, 23:58:32 Andreas Knees wrote:</h3>
<div class="paragraph">
<p>I suggest an Exception for this rule.</p>
</div>
<div class="paragraph">
<p>I use this code to determine whether a number has the desired number of fraction digits:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>BigDecimal bd = new BigDecimal("12.00");
try {

    bd.setScale(allowedFractionDigits);

} catch (final ArithmeticException ex) {
        // thrown if the specified scaling operation would require
        // rounding.
        if (allowedFractionDigits == 0) {
            putError("validation.number.integer");
        } else {
            putError("validation.number.fractionDigits", allowedFractionDigits);
        }
}</pre>
</div>
</div>
<div class="paragraph">
<p>So in my opinion <code>BigDecimal.setScale(int)</code> should be excluded from this rule, because I don&#8217;t use and don&#8217;t need the return value in this case.</p>
</div>
</div>
<div class="sect2">
<h3 id="_relates_to_s899">relates to: <a data-rspec-id="S899" class="rspec-auto-link">S899</a></h3>

</div>
<div class="sect2">
<h3 id="_supercedes_s1154">supercedes: <a data-rspec-id="S1154" class="rspec-auto-link">S1154</a></h3>

</div>
<div class="sect2">
<h3 id="_on_24_nov_2014_125737_nicolas_peru_wrote">on 24 Nov 2014, 12:57:37 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>This rule seems ok to me but the message is not convincing me. I would go for something more explicit about the fact that the return value of the method is ignored.</p>
</div>
<div class="paragraph">
<p>"Return value of method 'xxx' is not used"</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_1_dec_2014_093120_freddy_mallet_wrote">on 1 Dec 2014, 09:31:20 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>And we should be careful to not mix this rule with <a data-rspec-id="S899" class="rspec-auto-link">RSPEC-899</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S899" class="rspec-auto-link">RSPEC-899</a> is about ignoring the result of a function call when this result indicates the status of the operation: KO, OK (so when exceptions are not used to trigger issues)</p>
</li>
<li>
<p>This one <a data-rspec-id="S2201" class="rspec-auto-link">RSPEC-2201</a>, is about ignoring the result of a function call when this result contains the output of the operation</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_27_mar_2015_133647_ann_campbell_wrote">on 27 Mar 2015, 13:36:47 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Per discussion, I floated closing <a data-rspec-id="S899" class="rspec-auto-link">RSPEC-899</a> to C-Family team &amp; met with objections.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_10_jan_2016_124652_freddy_mallet_wrote">on 10 Jan 2016, 12:46:52 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>Hi [~ann.campbell.2], I don&#8217;t understand why this rule is not part of "Sonar way" quality profile because for sure when an issue is raised this is bug.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_11_jan_2016_181509_ann_campbell_wrote">on 11 Jan 2016, 18:15:09 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>As I recall [~freddy.mallet], it&#8217;s a question of confidence in accurately identifying methods without side effects.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_13_jan_2016_092638_freddy_mallet_wrote">on 13 Jan 2016, 09:26:38 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>I know [~ann.campbell.2], but for instance in Java we&#8217;ve tuned the rule to be sure at 100% that we&#8217;re not generating any false-positives (by limiting the scope to calls to immutable objects) and I think we must do the same thing for the other targeted languages. So at least in Java, this rule must be activated by default (cc [~nicolas.peru]).</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_13_jan_2016_133355_ann_campbell_wrote">on 13 Jan 2016, 13:33:55 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Done [~freddy.mallet]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_21_feb_2020_145938_james_bromwell_wrote">on 21 Feb 2020, 14:59:38 James Bromwell wrote:</h3>
<div class="paragraph">
<p>I created <a href="https://github.com/SonarSource/SonarJS/issues/1948">a new issue on the SonarJS GitHub tracker</a> but I&#8217;m not sure if the fault is in the rule itself or in the JS/TS implementation of the rule, so I thought it might be worth bringing up here.</p>
</div>
</div>
</div>
</div>