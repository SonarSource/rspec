<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Insecure functions often involve handling data, such as strings and memory operations. The vulnerability arises when these functions do not properly check or limit the size of the data they are handling.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An attacker typically provides input that exceeds the expected size. This could be through a text field in a user interface, a file that the program reads, or data sent over a network. The insecure function processes this input and places the result into a provided buffer.</p>
</div>
<div class="paragraph">
<p>If the input is larger than the buffer can handle, the insecure function will overwrite the memory following the buffer. This situation is known as a buffer overflow vulnerability.</p>
</div>
<div class="paragraph">
<p>When using typical C or C&#43;&#43; functions, it&#8217;s up to the developer to make sure the size of the buffer to be written to is large enough to avoid buffer overflows.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="sect3">
<h4 id="_code_execution">Code execution</h4>
<div class="paragraph">
<p>In some cases, an attacker can craft input in a way that allows them to gain unauthorized access to your system. For example, they might be able to overwrite a function&#8217;s return address in memory, causing your program to execute code of the attacker&#8217;s choosing. This could potentially give the attacker full control over your system.</p>
</div>
</div>
<div class="sect3">
<h4 id="_denial_of_service">Denial of service</h4>
<div class="paragraph">
<p>If an attacker can trigger a buffer overflow by providing oversized input, it can cause the program to crash. If the attacker repeats this process, it can continually disrupt the service, denying access to other users. This can be particularly damaging for services that require high availability, such as online platforms or databases.</p>
</div>
<div class="paragraph">
<p>In some cases, the input might cause the program to enter an infinite loop or consume excessive memory, slowing down the system or even causing it to become unresponsive. This type of attack is known as a resource exhaustion DoS attack.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Insecure functions should be replaced with safer alternatives that limit how much data can be written to the buffer.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;stdio.h&gt;

char str[20];
gets(str); // Noncompliant; `str` buffer size is not checked and it is vulnerable to overflows</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;string.h&gt;

char buffer[20];
strcpy(buffer, input); // Noncompliant; `input` length is not checked and it may overflow `buffer`</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#define __STDC_WANT_LIB_EXT1__
#include &lt;stdio.h&gt;

char str[20];
gets_s(str, sizeof(str));</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#define __STDC_WANT_LIB_EXT1__
#include &lt;string.h&gt;

char buffer[20];
strcpy_s(buffer, sizeof buffer, input);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>C and C&#43;&#43; have a number of functions that are considered insecure because they do not perform bounds checking. Functions like <code>gets</code> are known to be risky. Replace these with safer alternatives that include bounds checking. For example, instead of <code>gets</code>, use <code>gets_s</code>.</p>
</div>
<div class="paragraph">
<p>The code can also checks if the size of input data is less than or equal to the size of a buffer (including the terminating null byte when dealing with strings).</p>
</div>
<div class="paragraph">
<p>The <code>gets_s</code> function is defined in annex K of C11 and is optional for C11 compilers. It will only be available if the macro <code>__STDC_LIB_EXT1__</code> is defined, and it must be enabled by defining the macro <code>__STDC_WANT_LIB_EXT1__</code> before including <code>&lt;stdio.h&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Other platform-specific functions can perform the same operations. For example, <code>strcpy</code> can be substituted with <a href="https://learn.microsoft.com/en-us/windows/win32/api/strsafe/nf-strsafe-stringcbcopya">StringCbCopyA</a> (Windows) or <a href="https://www.freebsd.org/cgi/man.cgi?query=strlcpy">strlcpy</a> (FreeBSD).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p>Wikipedia - <a href="https://en.wikipedia.org/wiki/Buffer_overflow">Buffer overflow</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/676">CWE-676 - Use of Potentially Dangerous Function</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/119">CWE-119 - Improper Restriction of Operations within the Bounds of a Memory Buffer</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222612">Application Security and Development: V-222612</a> - The application must not be vulnerable to overflow attacks.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Remove the use of this insecure 'xxxxx' function.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_duplicated_by_s1080">is duplicated by: <a data-rspec-id="S1080" class="rspec-auto-link">S1080</a></h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s6069">is related to: <a data-rspec-id="S6069" class="rspec-auto-link">S6069</a></h3>

</div>
<div class="sect2">
<h3 id="_on_6_aug_2013_231226_ann_campbell_wrote">on 6 Aug 2013, 23:12:26 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Changed "unsecured" to "insecure".</p>
</div>
<div class="paragraph">
<p>Hope I interpreted it correctly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_28_aug_2013_072855_dinesh_bolkensteyn_wrote">on 28 Aug 2013, 07:28:55 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>Relates to ObsoletePosixFunction</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_28_aug_2013_073523_dinesh_bolkensteyn_wrote">on 28 Aug 2013, 07:35:23 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>Interesting reference of insecure functions: http://msdn.microsoft.com/en-us/library/bb288454.aspx</p>
</div>
</div>
</div>
</div>