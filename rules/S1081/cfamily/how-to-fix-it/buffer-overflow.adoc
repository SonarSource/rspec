== How to fix it

Fixing vulnerabilities related to insecure functions involves replacing these functions with safer alternatives and implementing proper checks.

=== Code examples

==== Noncompliant code example

[source,cpp,diff-id=1,diff-type=noncompliant]
----
char str[20];
gets(str); // Noncompliant; `str` buffer size is not checked and it is vulnerable to overflows
----

[source,cpp,diff-id=2,diff-type=noncompliant]
----
char buffer[20];
strcpy(buffer, input); // Noncompliant; `input` length is not checked and it may overflow `buffer`
----


==== Compliant solution

[source,cpp,diff-id=1,diff-type=compliant]
----
char str[20];
gets_s(str, sizeof(str));
----

[source,cpp,diff-id=2,diff-type=compliant]
----
char buffer[20];
if(strlen(input) < sizeof(buffer))
  strcpy(buffer, input);
----

=== How does this work?

C and C++ have a number of functions that are considered insecure because they do not perform bounds checking. Functions like ``gets`` are known to be risky. Replace these with safer alternatives that include bounds checking. For example, instead of ``gets``, use ``gets_s``.

The code can also checks if the size of input data is less than or equal to the size of a buffer (including the terminating null byte when dealing with strings).
