<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This vulnerability makes it possible that an encrypted communication is
intercepted.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Transport Layer Security (TLS) provides secure communication between systems
over the internet by encrypting the data sent between them. Certificate validation
adds an extra layer of trust and security to this process to ensure that a system
is indeed the one it claims to be.</p>
</div>
<div class="paragraph">
<p>When certificate validation is disabled, the client skips a critical security check.
This creates an opportunity for attackers to pose as a trusted entity and
intercept, manipulate, or steal the data being transmitted.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Establishing trust in a secure way is a non-trivial task. When you disable
certificate validation, you are removing a key mechanism designed to build this
trust in internet communication, opening your system up to a number of potential
threats.</p>
</div>
<div class="sect3">
<h4 id="_identity_spoofing">Identity spoofing</h4>
<div class="paragraph">
<p>If a system does not validate certificates, it cannot confirm the identity of
the other party involved in the communication. An attacker can exploit this by
creating a fake server and masquerading as a legitimate one. For example,
they might set up a server that looks like your bank&#8217;s server, tricking your
system into thinking it is communicating with the bank. This scenario, called
identity spoofing, allows the attacker to collect any data your system sends
to them, potentially leading to significant data breaches.</p>
</div>
</div>
<div class="sect3">
<h4 id="_loss_of_data_integrity">Loss of data integrity</h4>
<div class="paragraph">
<p>When TLS certificate validation is disabled, the integrity of the data you send
and receive cannot be guaranteed. An attacker could modify the data in transit,
and you would have no way of knowing. This could range from subtle manipulations
of the data you receive to the injection of malicious code or malware into your
system. The consequences of such breaches of data integrity can be severe,
depending on the nature of the data and the system.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_botan">How to fix it in Botan</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="paragraph">
<p>The following code contains examples of disabled certificate validation.</p>
</div>
<div class="paragraph">
<p>The certificate validation gets disabled by overriding <code>tls_verify_cert_chain</code>
with an empty implementation. It is highly recommended to use the original
implementation.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;botan/tls_client.h&gt;
#include &lt;botan/tls_callbacks.h&gt;
#include &lt;botan/tls_session_manager.h&gt;
#include &lt;botan/tls_policy.h&gt;
#include &lt;botan/auto_rng.h&gt;
#include &lt;botan/certstor.h&gt;
#include &lt;botan/certstor_system.h&gt;

class Callbacks : public Botan::TLS::Callbacks
{
    virtual void tls_verify_cert_chain(
              const std::vector&lt;Botan::X509_Certificate&gt; &amp;cert_chain,
              const std::vector&lt;std::shared_ptr&lt;const Botan::OCSP::Response&gt;&gt; &amp;ocsp_responses,
              const std::vector&lt;Botan::Certificate_Store *&gt; &amp;trusted_roots,
              Botan::Usage_Type usage,
              const std::string &amp;hostname,
              const Botan::TLS::Policy &amp;policy)
    override  { }
};

class Client_Credentials : public Botan::Credentials_Manager { };

void connect() {
    Callbacks callbacks;
    Botan::AutoSeeded_RNG rng;
    Botan::TLS::Session_Manager_In_Memory session_mgr(rng);
    Client_Credentials creds;
    Botan::TLS::Strict_Policy policy;

    Botan::TLS::Client client(callbacks, session_mgr, creds, policy, rng,
                              Botan::TLS::Server_Information("example.com", 443),
                              Botan::TLS::Protocol_Version::TLS_V12); // Noncompliant
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;botan/tls_client.h&gt;
#include &lt;botan/tls_callbacks.h&gt;
#include &lt;botan/tls_session_manager.h&gt;
#include &lt;botan/tls_policy.h&gt;
#include &lt;botan/auto_rng.h&gt;
#include &lt;botan/certstor.h&gt;
#include &lt;botan/certstor_system.h&gt;

class Callbacks : public Botan::TLS::Callbacks { };

class Client_Credentials : public Botan::Credentials_Manager { };

void connect() {
    Callbacks callbacks;
    Botan::AutoSeeded_RNG rng;
    Botan::TLS::Session_Manager_In_Memory session_mgr(rng);
    Client_Credentials creds;
    Botan::TLS::Strict_Policy policy;

    Botan::TLS::Client client(callbacks, session_mgr, creds, policy, rng,
                              Botan::TLS::Server_Information("example.com", 443),
                              Botan::TLS::Protocol_Version::TLS_V12);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>Addressing the vulnerability of disabled TLS certificate validation primarily
involves re-enabling the default validation.</p>
</div>
<div class="paragraph">
<p>To avoid running into problems with invalid certificates, consider the following
sections.</p>
</div>
<div class="sect3">
<h4 id="_using_trusted_certificates">Using trusted certificates</h4>
<div class="paragraph">
<p>If possible, always use a certificate issued by a well-known, trusted CA for
your server. Most programming environments come with a predefined list of
trusted root CAs, and certificates issued by these authorities are validated
automatically. This is the best practice, and it requires no additional code or
configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="_working_with_self_signed_certificates_or_non_standard_cas">Working with self-signed certificates or non-standard CAs</h4>
<div class="paragraph">
<p>In some cases, you might need to work with a server using a self-signed
certificate, or a certificate issued by a CA not included in your trusted roots.
Rather than disabling certificate validation in your code, you can add the
necessary certificates to your trust store.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_curl">How to fix it in cURL</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples_2">Code examples</h3>
<div class="paragraph">
<p>The following code contains examples of disabled certificate validation.</p>
</div>
<div class="paragraph">
<p>The certificate validation gets disabled by setting <code>CURLOPT_SSL_VERIFYPEER</code> to
<code>0L</code>. To enable validation set the value to
<code>1L</code> or do not set <code>CURLOPT_SSL_VERIFYPEER</code> at all to
use the secure default value.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;curl/curl.h&gt;

void connect() {
    CURL *curl;
    curl_global_init(CURL_GLOBAL_DEFAULT);

    curl = curl_easy_init();
    curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 0L); // Noncompliant

    curl_easy_perform(curl);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;curl/curl.h&gt;

void connect() {
    CURL *curl;
    curl_global_init(CURL_GLOBAL_DEFAULT);

    curl = curl_easy_init();
    curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 1L);

    curl_easy_perform(curl);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work_2">How does this work?</h3>
<div class="paragraph">
<p>Addressing the vulnerability of disabled TLS certificate validation primarily
involves re-enabling the default validation.</p>
</div>
<div class="paragraph">
<p>To avoid running into problems with invalid certificates, consider the following
sections.</p>
</div>
<div class="sect3">
<h4 id="_using_trusted_certificates_2">Using trusted certificates</h4>
<div class="paragraph">
<p>If possible, always use a certificate issued by a well-known, trusted CA for
your server. Most programming environments come with a predefined list of
trusted root CAs, and certificates issued by these authorities are validated
automatically. This is the best practice, and it requires no additional code or
configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="_working_with_self_signed_certificates_or_non_standard_cas_2">Working with self-signed certificates or non-standard CAs</h4>
<div class="paragraph">
<p>In some cases, you might need to work with a server using a self-signed
certificate, or a certificate issued by a CA not included in your trusted roots.
Rather than disabling certificate validation in your code, you can add the
necessary certificates to your trust store.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_openssl">How to fix it in OpenSSL</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples_3">Code examples</h3>
<div class="paragraph">
<p>The following code contains examples of disabled certificate validation.</p>
</div>
<div class="paragraph">
<p>The certificate validation gets disabled by overriding <code>verify_callback</code>
with an empty implementation. It is highly recommended to use the original
implementation.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_3">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;openssl/ssl.h&gt;

static int verify_callback(int preverify_ok, X509_STORE_CTX *ctx) { return 1; }

void connect() {
    const SSL_METHOD *method = TLS_method();
    SSL_CTX *ctx = SSL_CTX_new(method);
    SSL_CTX_set_verify(ctx, SSL_VERIFY_PEER, verify_callback); // Noncompliant
    SSL_CTX_set_verify(ctx, SSL_VERIFY_NONE, NULL); // Noncompliant
    SSL *ssl = SSL_new(ctx);
    SSL_connect(ssl);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_3">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#include &lt;openssl/ssl.h&gt;

void connect() {
    const SSL_METHOD *method = TLS_method();
    SSL_CTX *ctx = SSL_CTX_new(method);
    SSL *ssl = SSL_new(ctx);
    SSL_connect(ssl);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work_3">How does this work?</h3>
<div class="paragraph">
<p>Addressing the vulnerability of disabled TLS certificate validation primarily
involves re-enabling the default validation.</p>
</div>
<div class="paragraph">
<p>To avoid running into problems with invalid certificates, consider the following
sections.</p>
</div>
<div class="sect3">
<h4 id="_using_trusted_certificates_3">Using trusted certificates</h4>
<div class="paragraph">
<p>If possible, always use a certificate issued by a well-known, trusted CA for
your server. Most programming environments come with a predefined list of
trusted root CAs, and certificates issued by these authorities are validated
automatically. This is the best practice, and it requires no additional code or
configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="_working_with_self_signed_certificates_or_non_standard_cas_3">Working with self-signed certificates or non-standard CAs</h4>
<div class="paragraph">
<p>In some cases, you might need to work with a server using a self-signed
certificate, or a certificate issued by a CA not included in your trusted roots.
Rather than disabling certificate validation in your code, you can add the
necessary certificates to your trust store.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://botan.randombit.net/handbook/">Botan</a> - Handbook</p>
</li>
<li>
<p><a href="https://www.feistyduck.com/books/openssl-cookbook/">OpenSSL</a> - Cookbook</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">Top 10 2021 Category A2 - Cryptographic Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">Top 10 2021 Category A5 - Security Misconfiguration</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">Top 10 2021 Category A7 - Identification and Authentication Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/295">CWE-295 - Improper Certificate Validation</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222550">Application Security and Development: V-222550</a> - The application must validate certificates by constructing a certification path to an accepted trust anchor.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Enable server certificate validation on this SSL/TLS connection.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_deprecates_s4424">deprecates: <a data-rspec-id="S4424" class="rspec-auto-link">S4424</a></h3>

</div>
<div class="sect2">
<h3 id="_deprecates_s5326">deprecates: <a data-rspec-id="S5326" class="rspec-auto-link">S5326</a></h3>

</div>
<div class="sect2">
<h3 id="_relates_to_s5527">relates to: <a data-rspec-id="S5527" class="rspec-auto-link">S5527</a></h3>

</div>
</div>
</div>