When a variable appears in a compound expression (for instance ``a{plus}{plus}`` or `a+=2`), the variable is accessed twice. This detail only matters for `volatile` variables, where any access is important. And it may not be obvious to all developers that two accesses happen while the variable is only named once. The standard was not explicit on this topic up until {cpp}23.

As a consequence, it is usually clearer to rewrite the code so that the variable appears twice, matching the accesses that will happen.


== Noncompliant Code Example

[source,cpp]
----
void f1(int volatile* p) {
  ++(*p); // Noncompliant
}

void f2(volatile int& in) {
  in += 2; // Noncompliant
}

void f3(volatile int& in) {
  int i = in = 2; // Noncompliant
}
----


== Compliant Solution

[source,cpp]
----
void f1(int volatile* p) {
  auto val = *p;  // One access to read the register
  *p = val + 1; // One access to write to it (and potentially overwrite another change)
}

void f2(volatile int& in) {
  auto val = in;
  in = val + 2;
}

void f3(volatile int& in) {
  in = 2;
  int i = in;
}
----

