<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Because <code>printf</code> format strings are interpreted at runtime rather than validated by the compiler, they can contain errors that lead to unexpected behavior or runtime errors. This rule statically validates the good behavior of <code>printf</code> formats.</p>
</div>
<div class="paragraph">
<p>The related rule <a data-rspec-id="S3457" class="rspec-auto-link">S3457</a> is about errors that produce an unexpected string, while this rule is about errors that will create undefined behavior.</p>
</div>
<div class="paragraph">
<p>Starting with C&#43;&#43;23, <code>std::print</code> should be preferred: its arguments are validated at compile-time, making it more secure.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">printf("%d", 1.2); // Noncompliant, an "int" is expected rather than a "double"
printf("%d %d", 1); // Noncompliant, the second argument is missing
printf("%0$d ", 1); // Noncompliant, arguments are numbered starting from 1
printf("%1$d %d", 1, 2); // Noncompliant, positional and non-positional arguments can not be mixed
printf("%*d", 1.1, 2); // Noncompliant, field width should be an integer
printf("ab\0cd"); // Noncompliant, format string contains null char

int x;
printf("%+p", (void*)&amp;x); // Noncompliant, flag "+" has undefined behavior with conversion specifier "p"
printf("%vd", x); //Noncompliant, conversion specifier "v" is not valid</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">printf("%f", 1.2); // Compliant, format is consistent with the corresponding argument
printf("%d", 1); // Compliant, number of specifiers is consistent with number of arguments
printf("%1$d ", 1); // Compliant, number of positional argument is consistent</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>This rule will only work if the format string is provided as a string literal.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CERT - <a href="https://wiki.sei.cmu.edu/confluence/display/c/FIO47-C.+Use+valid+format+strings">FIO47-C. Use valid format strings</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S3457" class="rspec-auto-link">S3457</a> - Format strings should be used correctly</p>
</li>
<li>
<p><a data-rspec-id="S5281" class="rspec-auto-link">S5281</a> - Argument of "printf" should be a format string</p>
</li>
<li>
<p><a data-rspec-id="S6494" class="rspec-auto-link">S6494</a> - C&#43;&#43; formatting functions should be used instead of C printf-like functions</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>XXXX</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_relates_to_s3457">relates to: <a data-rspec-id="S3457" class="rspec-auto-link">S3457</a></h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s3941">is related to: <a data-rspec-id="S3941" class="rspec-auto-link">S3941</a></h3>

</div>
<div class="sect2">
<h3 id="_on_2_feb_2015_204330_sébastien_gioria_wrote">on 2 Feb 2015, 20:43:30 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>could fall in OWASP Top10 2013 A6</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_feb_2015_203229_ann_campbell_wrote">on 3 Feb 2015, 20:32:29 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>I don&#8217;t understand how [~sebastien.gioria]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_14_jul_2016_180743_ann_campbell_wrote">on 14 Jul 2016, 18:07:43 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.peru] I think https://github.com/google/error-prone/blob/master/docs/bugpattern/FormatString.md has cases not covered here&#8230;&#8203;?</p>
</div>
</div>
</div>
</div>