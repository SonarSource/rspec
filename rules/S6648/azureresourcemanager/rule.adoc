Azure Resource Manager templates can receive parameters as input. Parameters defined as "secure" should not be assigned a default value.

== Why is this an issue?

Secure string and object parameters are designed to pass the sensitive data to the resources being deployed. Unlike other data types, they cannot be accessed after the deployment is completed. They can neither be logged nor used as an output.

Secure parameters can be assigned a default value which will be used if the parameter is not supplied. This default value is not protected and it is stored in cleartext in the deployment history.

=== What is the potential impact?

If the default value contains a secret, it will be disclosed to all accounts having read access to the deployment history. 

== How to fix it in ARM templates

=== Code examples

==== Noncompliant code example

[source,json,diff-id=1,diff-type=noncompliant]
----
{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "secretValue": {
      "type": "securestring",
      "defaultValue": "S3CR3T"
    }
  }
}
----

==== Compliant solution

[source,json,diff-id=1,diff-type=compliant]
----
{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "secretValue": {
      "type": "securestring"
    }
  }
}
----


== Resources
=== Documentation

* https://learn.microsoft.com/en-us/azure/azure-resource-manager/templates/data-types[Data types in ARM templates]
* https://learn.microsoft.com/en-us/azure/azure-resource-manager/templates/best-practices#security-recommendations-for-parameters[ARM template best practices - Security recommendations for parameters]

=== Standards

* https://cwe.mitre.org/data/definitions/200[MITRE, CWE-200] - Exposure of Sensitive Information to an Unauthorized Actor
* https://cwe.mitre.org/data/definitions/532[MITRE, CWE-532] - Insertion of Sensitive Information into Log File

ifdef::env-github,rspecator-view[]
== Implementation Specification
(visible only on this page)

=== Message

- Remove the default value on this secure string.
- Remove the default value on this secure object.

=== Highlight

The default value 

endif::env-github,rspecator-view[]