<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is an issue when logical operators are used incorrectly in null checks, potentially causing the code to access properties or methods on null objects.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Faulty null checks can lead to <code>NullPointerException</code> at runtime, which crashes the application unexpectedly.</p>
</div>
<div class="paragraph">
<p>The most common mistake is using the wrong logical operator when combining a null check with property or method access on the same variable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using OR (<code>||</code>) instead of AND (<code>&amp;&amp;</code>) when checking that an object is not null before accessing it</p>
</li>
<li>
<p>Using AND (<code>&amp;&amp;</code>) instead of OR (<code>||</code>) when checking that an object is null</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, <code>if (name != null || name.length &gt; 0)</code> is problematic because:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>name</code> is not null, the first condition <code>name != null</code> is true</p>
</li>
<li>
<p>Due to short-circuit evaluation, <code>name.length &gt; 0</code> won&#8217;t be evaluated, which might not be the intended behavior</p>
</li>
<li>
<p>If <code>name</code> is null, the first condition is false, so the second condition <code>name.length &gt; 0</code> will be evaluated</p>
</li>
<li>
<p>Accessing <code>length</code> on a null object throws a <code>NullPointerException</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Similarly, <code>if (record == null &amp;&amp; record.id &gt; 10)</code> is wrong because if <code>record</code> is null, the first condition is true, but then <code>record.id &gt; 10</code> will still be evaluated, causing a <code>NullPointerException</code>.</p>
</div>
<div class="paragraph">
<p>These logical errors are often typos or misunderstandings of how logical operators work with short-circuit evaluation.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>The application will crash with a <code>NullPointerException</code> when the faulty null check is executed and the object being checked is actually null. This can lead to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Application downtime and poor user experience</p>
</li>
<li>
<p>Data loss if the exception occurs during critical operations</p>
</li>
<li>
<p>Security vulnerabilities if error handling is inadequate</p>
</li>
<li>
<p>Difficult debugging, especially in production environments where the exact conditions causing the null reference may be hard to reproduce</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use AND (&amp;&amp;) when checking that an object is not null before accessing its properties or methods. This ensures that if the object is null, the property access won&#8217;t be evaluated due to short-circuit evaluation.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">if (name != null || name.length &gt; 0) { // Noncompliant
    // This will throw NullPointerException if name is null
    println("Name is valid")
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">if (name != null &amp;&amp; name.length &gt; 0) {
    // Safe: name.length is only evaluated if name is not null
    println("Name is valid")
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Groovy documentation - <a href="https://groovy-lang.org/semantics.html#_boolean_expressions">Boolean expressions</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-476: NULL Pointer Dereference - <a href="https://cwe.mitre.org/data/definitions/476.html">Common weakness enumeration for null pointer dereference vulnerabilities</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>