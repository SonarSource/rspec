<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Certificate_Transparency">Certificate Transparency</a> (CT) is an open-framework to protect against identity theft when  certificates are issued. <a href="https://en.wikipedia.org/wiki/Certificate_authority">Certificate Authorities</a> (CA) electronically sign certificate after verifying the identify of the certificate owner. Attackers use, among other things, social engineering attacks to trick a CA to correctly verifying a spoofed identity/forged certificate.</p>
</div>
<div class="paragraph">
<p>CAs implement Certificate Transparency framework to publicly log the records of newly issued certificates, allowing the public and in particular the identity owner to monitor these logs to verify that his identify was not usurped.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The website identity is valuable and well-known, therefore prone to theft.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to this question.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Implement <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Expect-CT">Expect-CT</a> HTTP header which instructs the web browser to check <a href="https://www.certificate-transparency.org/known-logs">public CT logs</a> in order to verify if the website appears inside and if it is not, the browser will block the request and display a warning to the user.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Express.js application the code is sensitive if the <a href="https://www.npmjs.com/package/expect-ct">expect-ct</a> middleware is disabled:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
    helmet({
      expectCt: false // Sensitive
    })
);</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Express.js application the <a href="https://www.npmjs.com/package/expect-ct">expect-ct</a> middleware is the standard way to implement expect-ct. Usually, the deployment of this policy starts with the report only mode (<code>enforce: false</code>) and with a low <code>maxAge</code> (the number of seconds the policy will apply) value and next if everything works well it is recommended to block future connections that violate Expect-CT policy (<code>enforce: true</code>) and greater value for maxAge directive:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(helmet.expectCt({
  enforce: true,
  maxAge: 86400
})); // Compliant</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">Top 10 2021 Category A5 - Security Misconfiguration</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Certificate_Transparency">developer.mozilla.org</a> - Certificate Transparency</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Certificate_authority">wikipedia.org</a> - Certificate Authority</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure disabling Certificate Transparency monitoring is safe here.</p>
</div>
</div>
</div>
</div>