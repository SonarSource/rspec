<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when a custom validation method in a Rails model returns <code>false</code> or boolean values without adding errors to the model&#8217;s errors collection.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Rails custom validation methods work differently from built-in validation helpers. When you define a custom validation method using <code>validate :method_name</code>, Rails calls that method but ignores its return value.</p>
</div>
<div class="paragraph">
<p>Rails only prevents saving a model when the model&#8217;s <code>errors</code> collection contains validation errors. Simply returning <code>false</code> from a validation method does not add any errors to this collection.</p>
</div>
<div class="paragraph">
<p>This behavior can be confusing because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Built-in validation helpers like <code>validates_presence_of</code> automatically add errors when validation fails</p>
</li>
<li>
<p>Many developers expect custom validation methods to work the same way</p>
</li>
<li>
<p>The model will save successfully even when the validation method returns <code>false</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This leads to invalid data being persisted in the database, which can cause data integrity issues and unexpected application behavior.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Invalid data may be saved to the database, leading to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Data integrity violations</p>
</li>
<li>
<p>Unexpected application behavior when invalid records are processed</p>
</li>
<li>
<p>Difficult-to-debug issues where validation appears to run but doesn&#8217;t prevent saving</p>
</li>
<li>
<p>Potential security vulnerabilities if validation is meant to enforce security constraints</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add errors to the model&#8217;s errors collection instead of returning boolean values. Use <code>errors.add()</code> to specify which attribute has the error and provide a meaningful error message.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">class Company &lt; ActiveRecord::Base
  validate :check_business_rules

  private

  def check_business_rules
    return false if name.blank? # Noncompliant
    return false if invalid_condition? # Noncompliant
    true
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">class Company &lt; ActiveRecord::Base
  validate :check_business_rules

  private

  def check_business_rules
    if name.blank?
      errors.add(:name, 'cannot be blank')
    end

    if invalid_condition?
      errors.add(:base, 'business rule violation')
    end
  end
end</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Rails Guides - Active Record Validations - <a href="https://guides.rubyonrails.org/active_record_validations.html#custom-methods">Official Rails documentation on custom validation methods</a></p>
</li>
<li>
<p>Rails API - ActiveModel::Errors - <a href="https://api.rubyonrails.org/classes/ActiveModel/Errors.html">Documentation for the errors collection and its methods</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>