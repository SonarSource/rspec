<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using "CALL TRANSACTION" statements without an authority check is security sensitive. Its access should be restricted to specific users.</p>
</div>
<div class="paragraph">
<p>This rule raises when a <code>CALL TRANSACTION</code> has no explicit authorization check, i.e. when:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>CALL TRANSACTION</code> statement is not followed by <code>WITH AUTHORITY-CHECK</code>.</p>
</li>
<li>
<p>the <code>CALL TRANSACTION</code> statement is not following an <code>AUTHORITY-CHECK</code> statement.</p>
</li>
<li>
<p>the <code>CALL TRANSACTION</code> statement is not following a call to the <code>AUTHORITY_CHECK_TCODE</code> function.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>the <code>CALL TRANSACTION</code> statement is restricted to the right users.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered no to this question.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Check current user&#8217;s authorization before every <code>CALL TRANSACTION</code> statement. Since ABAP 7.4 this should be done by appending <code>WITH AUTHORITY-CHECK</code> to <code>CALL TRANSACTION</code> statements. In earlier versions the <code>AUTHORITY-CHECK</code> statement or a call to the <code>AUTHORITY_CHECK_TCODE</code> function can be used.</p>
</div>
<div class="paragraph">
<p>Note that since ABAP 7.4 any <code>CALL TRANSACTION</code> statement not followed by <code>WITH AUTHORITY-CHECK</code> or <code>WITHOUT AUTHORITY-CHECK</code> <a href="https://help.sap.com/doc/abapdocu_751_index_htm/7.51/en-US/abapcall_transaction_authority.htm">is obsolete</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>CALL TRANSACTION 'MY_DIALOG'.  " Sensitive as there is no apparent authorization check. It is also obsolete since ABAP 7.4.</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-abap" data-lang="abap">AUTHORITY-CHECK OBJECT 'S_DIAGID'
                  ID 'ACTVT' FIELD '03'.
IF sy-subrc &lt;&gt; 0.
  " show an error message...
ENDIF.

CALL TRANSACTION 'MY_DIALOG'. " Ok but obsolete since ABAP 7.4.</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-abap" data-lang="abap">CALL FUNCTION 'AUTHORITY_CHECK_TCODE'
  exporting
    tcode  = up_fdta
  exceptions
    ok     = 0
    others = 4.
IF sy-subrc &lt;&gt; 0.
  " show an error message...
ENDIF.

CALL TRANSACTION up_fdta USING up_bdc mode 'E'. " Ok but obsolete since ABAP 7.4.</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-abap" data-lang="abap">CALL TRANSACTION 'MY_DIALOG' WITH AUTHORITY-CHECK. " Recommended way since ABAP 7.4.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exceptions">Exceptions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>No issue will be raised when <code>CALL TRANSACTION</code> is followed by <code>WITHOUT AUTHORITY-CHECK</code> as it explicitly says that the TRANSACTION does not require an authorization check.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">Top 10 2021 Category A1 - Broken Access Control</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">Top 10 2017 Category A2 - Broken Authentication</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/285">CWE-285 - Improper Authorization</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/862">CWE-862 - Missing Authorization</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure that using this "CALL TRANSACTION" statement without an authority check is safe here.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_7_apr_2015_194404_ann_campbell_wrote">on 7 Apr 2015, 19:44:04 Ann Campbell wrote:</h3>
<div class="paragraph">
<p><a href="http://scn.sap.com/thread/706673" class="bare">http://scn.sap.com/thread/706673</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_may_2015_130455_ann_campbell_wrote">on 12 May 2015, 13:04:55 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.peru] I&#8217;ve updated the message, description and code samples based on this article: https://www.kiuwan.com/blog/abap-code-quality-security-vulnerabilities-detection/</p>
</div>
<div class="paragraph">
<p>Please double-check me.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_may_2015_142831_nicolas_peru_wrote">on 12 May 2015, 14:28:31 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Looks good.</p>
</div>
</div>
</div>
</div>