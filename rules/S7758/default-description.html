<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is an issue when using <code>String#charCodeAt()</code> or <code>String.fromCharCode()</code> methods, which don&#8217;t properly handle Unicode characters that require surrogate pairs.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JavaScript strings use UTF-16 encoding internally. Some Unicode characters, like emojis and certain international characters, require two 16-bit code units (called surrogate pairs) to represent a single character.</p>
</div>
<div class="paragraph">
<p>The older methods <code>charCodeAt()</code> and <code>fromCharCode()</code> work with individual UTF-16 code units. When dealing with characters that use surrogate pairs, these methods only process the first code unit, leading to incorrect results.</p>
</div>
<div class="paragraph">
<p>For example, the emoji 'ðŸ¦„' (unicorn) has the Unicode code point U+1F984. In UTF-16, this becomes a surrogate pair. Using <code>charCodeAt(0)</code> only returns the first part of this pair, not the complete character code.</p>
</div>
<div class="paragraph">
<p>The newer methods <code>codePointAt()</code> and <code>fromCodePoint()</code> understand Unicode code points properly. They handle surrogate pairs correctly and return the actual Unicode code point value, ensuring your application works correctly with international text and emojis.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Using the wrong methods can cause:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Incorrect character processing for emojis and international characters</p>
</li>
<li>
<p>Data corruption when converting between characters and numeric codes</p>
</li>
<li>
<p>Poor user experience for users with non-ASCII names or content</p>
</li>
<li>
<p>Inconsistent behavior across different Unicode characters</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_fix">How to fix?</h3>
<div class="paragraph">
<p>Replace <code>charCodeAt()</code> with <code>codePointAt()</code> to get the correct Unicode code point value.</p>
</div>
<div class="sect3">
<h4 id="_non_compliant_code_example">Non-compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const code = 'ðŸ¦„'.charCodeAt(0); // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_code_example">Compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const code = 'ðŸ¦„'.codePointAt(0);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/sindresorhus/eslint-plugin-unicorn#readme">eslint-plugin-unicorn</a> - Rule <a href="https://github.com/sindresorhus/eslint-plugin-unicorn/blob/HEAD/docs/rules/prefer-code-point.md">prefer-code-point</a></p>
</li>
<li>
<p>String.prototype.codePointAt() - <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/codePointAt">MDN documentation for the codePointAt() method</a></p>
</li>
<li>
<p>String.fromCodePoint() - <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/fromCodePoint">MDN documentation for the fromCodePoint() method</a></p>
</li>
<li>
<p>Unicode and JavaScript - <a href="https://mathiasbynens.be/notes/javascript-unicode">Comprehensive guide to Unicode handling in JavaScript</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>