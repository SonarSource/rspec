<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when a public method processes input parameters without validating them first.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Public methods act as the entry points to your code and should be defensive against invalid inputs. When these methods don&#8217;t validate their parameters, several problems can occur:</p>
</div>
<div class="paragraph">
<p><strong>Runtime panics</strong>: Accessing nil pointers, reading from empty slices beyond their bounds, or performing operations on invalid data can cause your program to crash unexpectedly.</p>
</div>
<div class="paragraph">
<p><strong>Incorrect behavior</strong>: Processing invalid inputs often leads to wrong results that can be hard to trace back to the source. For example, a function that expects a positive number might produce meaningless output when given a negative value.</p>
</div>
<div class="paragraph">
<p><strong>Resource waste</strong>: Methods that don&#8217;t validate inputs might perform expensive operations on data that should have been rejected immediately.</p>
</div>
<div class="paragraph">
<p><strong>Poor error handling</strong>: Without early validation, errors occur deep in the call stack, making them harder to debug and handle gracefully.</p>
</div>
<div class="paragraph">
<p><strong>Security vulnerabilities</strong>: In some cases, unvalidated inputs can lead to security issues like buffer overflows or injection attacks.</p>
</div>
<div class="paragraph">
<p>Input validation serves as a contract between your method and its callers. It makes your code more predictable, easier to debug, and more robust against unexpected usage patterns.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Missing input validation can lead to runtime panics, incorrect program behavior, security vulnerabilities, and difficult-to-debug issues. The impact is particularly severe in production environments where crashes can affect system availability and user experience.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add validation checks at the beginning of your public methods. Check for nil pointers, empty slices, invalid ranges, and other preconditions before processing the data.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">func (s *Service) ProcessData(data []byte, config *Config) error {
    // Missing validation - could panic or misbehave // Noncompliant
    result := make([]byte, len(data)*2)
    copy(result, data)

    if config.Enabled {
        // Process with config
    }
    return nil
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">func (s *Service) ProcessData(data []byte, config *Config) error {
    if len(data) == 0 {
        return errors.New("data cannot be empty")
    }
    if config == nil {
        return errors.New("config cannot be nil")
    }

    result := make([]byte, len(data)*2)
    copy(result, data)

    if config.Enabled {
        // Process with config
    }
    return nil
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Go Blog: GIF decoder exercise - <a href="https://go.dev/blog/gif-decoder">Example of input validation in the blockReader.Read method</a></p>
</li>
<li>
<p>Effective Go: Error handling - <a href="https://go.dev/doc/effective_go#errors">Best practices for error handling and validation in Go</a></p>
</li>
<li>
<p>Go by Example: Errors - <a href="https://gobyexample.com/errors">Examples of proper error handling and validation patterns</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-20: Improper Input Validation - <a href="https://cwe.mitre.org/data/definitions/20.html">Covers the security implications of insufficient input validation</a></p>
</li>
<li>
<p>CWE-476: NULL Pointer Dereference - <a href="https://cwe.mitre.org/data/definitions/476.html">Describes vulnerabilities from accessing null/nil pointers</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S3900" class="rspec-auto-link">RSPEC-3900</a> - <a href="https://rules.sonarsource.com/csharp/RSPEC-3900/">Similar rule for C# about validating method arguments</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>