<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In asynchronous testing, the test code is written in a way that allows it to wait for the asynchronous operation to complete before
continuing with the test.</p>
</div>
<div class="paragraph">
<p>Using <code>Thread.sleep</code> in this case can cause flaky tests, slow test execution, and inaccurate test results.
It creates brittle tests that can fail unpredictably depending on the environment or load.</p>
</div>
<div class="paragraph">
<p>Use mocks or libraries such as <code>Awaitility</code> instead.
These tools provide features such as timeouts, assertions, and error handling to make it easier to write and manage asynchronous tests.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
public void testDoTheThing(){

  MyClass myClass = new MyClass();
  myClass.doTheThing();

  Thread.sleep(500);  // Noncompliant
  // assertions...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
public void testDoTheThing(){

  MyClass myClass = new MyClass();
  myClass.doTheThing();

  await().atMost(2, Duration.SECONDS).until(didTheThing());  // Compliant
  // assertions...
}

private Callable&lt;Boolean&gt; didTheThing() {
  return new Callable&lt;Boolean&gt;() {
    public Boolean call() throws Exception {
      // check the condition that must be fulfilled...
    }
  };
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/Thread.html">Oracle SE 20 - Thread</a></p>
</li>
<li>
<p><a href="http://www.awaitility.org/">Awaitility</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.baeldung.com/java-thread-sleep-vs-awaitility-await">Baeldung - Thread.sleep() vs Awaitility.await()</a></p>
</li>
<li>
<p><a href="https://www.baeldung.com/awaitility-testing">Baeldung - Awaitility testing</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Remove this use of "Thread.sleep()".</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_12_may_2015_145251_david_gageot_wrote">on 12 May 2015, 14:52:51 David Gageot wrote:</h3>
<div class="paragraph">
<p>lgtm</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_20_may_2015_150839_nicolas_peru_wrote">on 20 May 2015, 15:08:39 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Ok.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_21_aug_2015_092147_michael_gumowski_wrote">on 21 Aug 2015, 09:21:47 Michael Gumowski wrote:</h3>
<div class="paragraph">
<p>WDYT about changes [~duarte.meneses]?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_21_aug_2015_092958_duarte_meneses_wrote">on 21 Aug 2015, 09:29:58 Duarte Meneses wrote:</h3>
<div class="paragraph">
<p>Looks good.</p>
</div>
<div class="paragraph">
<p>Only suggestion I have is to put the timeout in the solution longer (2/3s?), otherwise it wouldn&#8217;t fix the problem of dependency on the environment.</p>
</div>
<div class="paragraph">
<p>With awaitility we can use larger timeouts but still proceed quickly as soon as the polling conditions is satisfied.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_21_aug_2015_093555_michael_gumowski_wrote">on 21 Aug 2015, 09:35:55 Michael Gumowski wrote:</h3>
<div class="paragraph">
<p>Ok, updated. Thanks for your feedback! Feels free to modify it directly next time!</p>
</div>
</div>
</div>
</div>