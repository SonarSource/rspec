<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>PHP session tokens are normally transmitted through HTTP cookies. However, for
clients that do not support cookies and when the PHP <code>session.use_trans_sid</code>
setting is enabled, those tokens can be transmitted as URL parameters.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>GET URL parameter can be disclosed in a variety of ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Directly in a web browser address bar.</p>
</li>
<li>
<p>In navigation history.</p>
</li>
<li>
<p>In web servers or intermediate proxies log files.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Attackers with access to any of those disclosure locations will be able to see
and steal a victim&#8217;s session token. They can then use it to log in as the user,
impersonate their account, and take advantage of their privileges.</p>
</div>
<div class="paragraph">
<p>Such an attack can be more or less severe depending on the victim&#8217;s privileges.
Common security impacts range from data theft to application takeover.</p>
</div>
<div class="sect3">
<h4 id="_data_theft">Data theft</h4>
<div class="paragraph">
<p>Attackers with access to a compromised account will be able to disclose any
information stored on it. This includes the Personally Identifiable Information
(PII) of the user.</p>
</div>
<div class="paragraph">
<p>The confidentiality of PII is a requirement from national security regulatory
authorities in most countries. Insufficiently protecting this data could have
legal consequences and lead to fines or other prosecutions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_application_takeover">Application takeover</h4>
<div class="paragraph">
<p>Attackers compromise the account of a high-privileged user could modify internal
web application logic, disrupt workflows, or change other application&#8217;s settings
in a way that will give them full control over it.</p>
</div>
<div class="paragraph">
<p>Such an attack would lead to reputational damages and financial and legal
consequences.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">; php.ini
session.use_trans_sid=1  ; Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">; php.ini
session.use_trans_sid=0</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>The compliant code example disables the <code>session.use_trans_sid</code> setting.</p>
</div>
<div class="paragraph">
<p>Note that this parameter is off by default.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">Top 10 2021 Category A5 - Security Misconfiguration</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Set "session.use_trans_sid" to 0 or remove this configuration.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_1_sep_2015_064724_linda_martin_wrote">on 1 Sep 2015, 06:47:24 Linda Martin wrote:</h3>
<div class="paragraph">
<p>LGTM!</p>
</div>
</div>
</div>
</div>