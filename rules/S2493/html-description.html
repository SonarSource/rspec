<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Just because you <em>can</em> do something, that doesn&#8217;t mean you <em>should</em>, and the use of full-fledged Java in a JSP or JSF falls into that category.</p>
</div>
<div class="paragraph">
<p>Beside the fact that such code isn&#8217;t resuable, testable, maintainable or OO-inheritable, using Java in such client-side pages can leave you incredibly vulnerable from a number of perspectives including security and resource management.</p>
</div>
<div class="paragraph">
<p>Instead, any heavy-duty logic should happen server-side in a full-fledged Java class. For lighter-weight functions, taglibs should be used.</p>
</div>
<div class="paragraph">
<p>This rule flags all uses of JSP declarations (<code>&lt;%! ... %&gt;</code> and <code>&lt;jsp:declaration&gt;...&lt;/jsp:declaration&gt;</code>) and scriptlets (<code>&lt;% ... %&gt;</code>).</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;%!  // Noncompliant
  private Connection conn = null;

  public void init() {
    try {
      Class.forName("org.hsqldb.jdbcDriver" );
      conn = DriverManager.getConnection("jdbc:hsqldb:mem:SQL", "sa", "");
    } catch (SQLException e) {
      getServletContext().log("Db error: " + e);
    } catch (Exception e) {
    getServletContext().log("System error: " + e);
    }
  }
%&gt;
&lt;%    // Noncompliant
Statement stmt = conn.createStatement();
ResultSet rs = null;
String query = StringEscapeUtils.escapeHtml4(query).replaceAll("'", "&amp;#39");

try {
  String sql = "SELECT PRODUCT, DESC, TYPE, PRICE " +
                     "FROM PRODUCTS" +
                     "WHERE PRODUCT LIKE '%" + query + "%'";
  rs = stmt.executeQuery(sql);

  String output = "";
  int count = 0;
  while (rs.next()) {
    count++;
    output = output.concat("&lt;TR&gt;&lt;TD&gt;" + rs.getString("PRODUCT") +
                                  "&lt;/TD&gt;&lt;TD&gt;" + rs.getString("DESC") +
                                  "&lt;/TD&gt;&lt;TD&gt;" + rs.getString("TYPE") +
                                  "&lt;/TD&gt;&lt;TD&gt;" + rs.getString("PRICE") + "&lt;/TD&gt;&lt;/TR&gt;\n");
  }
  if(count &gt; 0){
%&gt;
&lt;TABLE border="1"&gt;
&lt;TR&gt;&lt;TD&gt;Product&lt;/TD&gt;&lt;TD&gt;Description&lt;/TD&gt;&lt;TD&gt;Type&lt;/TD&gt;&lt;TD&gt;Price&lt;/TD&gt;&lt;/TR&gt;
&lt;%= output %&gt;
&lt;/TABLE&gt;
&lt;%  // Noncompliant
  }
} catch (Exception e) {
  // ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %&gt;

&lt;table&gt;
    &lt;c:forEach items="${products}" var="product"&gt;
        &lt;tr&gt;
            &lt;td&gt;${product.name}&lt;/td&gt;
            &lt;td&gt;${product.description}&lt;/td&gt;
            &lt;td&gt;${product.type}&lt;/td&gt;
            &lt;td&gt;${product.price}&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/c:forEach&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Move the logic in this scriptlet to a server-side Java class.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_11_may_2015_152211_massimo_paladin_wrote">on 11 May 2015, 15:22:11 Massimo PALADIN wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] LGTM.</p>
</div>
</div>
</div>
</div>