<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Domain Name Systems (DNS) are vulnerable by default to various types of attacks.</p>
</div>
<div class="paragraph">
<p>One of the biggest risks is DNS cache poisoning, which occurs when a DNS accepts spoofed DNS data, caches the malicious records, and potentially sends them later in response to legitimate DNS request lookups. This attack typically relies on the attacker&#8217;s <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">MITM</a> ability on the network and can be used to redirect users from an intended website to a malicious website.</p>
</div>
<div class="paragraph">
<p>To prevent these vulnerabilities, Domain Name System Security Extensions (DNSSEC) ensure the integrity and authenticity of DNS data by digitally signing DNS zones.</p>
</div>
<div class="paragraph">
<p>The public key of a DNS zone used to validate signatures can be trusted as DNSSEC is based on the following chain of trust:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The parent DNS zone adds a "fingerprint" of the public key of the child zone in a "DS record".</p>
</li>
<li>
<p>The parent DNS zone signs it with its own private key.</p>
</li>
<li>
<p>And this process continues until the root zone.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The parent DNS zone (likely managed by the DNS registrar of the domain name) supports DNSSEC and</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The DNS zone is public (contains data such as public reachable IP addresses).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to this question.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It&#8217;s recommended to use DNSSEC when creating private and public DNS zones.</p>
</div>
<div class="paragraph">
<p>Private DNS zones cannot be queried on the Internet and provide DNS name resolution for private networks. The risk of MITM attacks might be considered low on these networks and therefore implementing DNSSEC is still recommended but not with a high priority.</p>
</div>
<div class="paragraph">
<p>Note: Choose a robust signing algorithm when setting up DNSSEC, such as <code>rsasha256</code>. The <a href="https://en.wikipedia.org/wiki/SHA-1">insecure</a> <code>rsasha1</code> algorithm should no longer be used.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "google_dns_managed_zone" "example" { # Sensitive: dnssec_config is missing
  name     = "foobar"
  dns_name = "foo.bar."
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-terraform" data-lang="terraform">resource "google_dns_managed_zone" "example" {
  name     = "foobar"
  dns_name = "foo.bar."

  dnssec_config {
    default_key_specs {
      algorithm = "rsasha256"
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://cloud.google.com/dns/docs/dnssec-config">GCP Documentation</a> - Manage DNSSEC configuration</p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/345">CWE-345 - Insufficient Verification of Data Authenticity</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/353">CWE-353 - Missing Support for Integrity Check</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure creating a DNS zone without DNSSEC enabled is safe here.</p>
</div>
</div>
</div>
</div>