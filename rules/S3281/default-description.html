<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>EJB interceptors provide a way to define code that can be executed before and
after a method call. They are typically used for logging, testing, auditing or
security purposes.</p>
</div>
<div class="paragraph">
<p>Interceptor methods can be applied or bound at three levels:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The default interceptor is called for each bean as part of the deployment and
can only be applied through an XML file.</p>
</li>
<li>
<p>The class-level interceptor is invoked for each method of the bean. The
class-level interceptor can be applied both through an annotation and through
an XML file.</p>
</li>
<li>
<p>The method-level interceptor is invoked for a specific method of the bean.
The method-level interceptor can be applied both through an annotation and
through an XML file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want to declare these methods in an XML file, you must declare them in a
file named <code>ejb-jar.xml</code>. Otherwise, they may not be applied or used as
intended.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>If EJB interceptors are not applied or used as intended, inconsistent
application behavior in the app business logic or security might happen.</p>
</div>
<div class="paragraph">
<p>Below are some real-world examples of this issue.</p>
</div>
<div class="sect3">
<h4 id="_inconsistent_behavior">Inconsistent Behavior</h4>
<div class="paragraph">
<p>Interceptors declared outside of <code>ejb-jar.xml</code> may not be applied consistently
across all EJBs. This can lead to unpredictable application behavior, making
debugging and maintaining the code difficult.</p>
</div>
</div>
<div class="sect3">
<h4 id="_security_risks">Security Risks</h4>
<div class="paragraph">
<p>Interceptors often handle sensitive operations such as security checks or
transaction management. If an interceptor is not applied due to incorrect
declaration, these operations may not be performed, leading to potential
security vulnerabilities.<br>
For example, if an interceptor responsible for user authentication is not
applied, unauthorized users may gain access to sensitive information.</p>
</div>
</div>
<div class="sect3">
<h4 id="_performance_impact">Performance Impact</h4>
<div class="paragraph">
<p>Interceptors can also be used to improve application performance, for instance,
by managing database transactions. If these interceptors are not applied, it
could lead to performance issues, such as longer response times or increased
server load.</p>
</div>
<div class="paragraph">
<p>This could open the way for efficient Denial of Service attacks.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;!-- ejb-interceptors.xml --&gt;

&lt;assembly-descriptor&gt;
 &lt;interceptor-binding&gt;
      &lt;ejb-name&gt;*&lt;/ejb-name&gt;
      &lt;interceptor-class&gt;com.myco.ImportantInterceptor&lt;/interceptor-class&gt; &lt;!-- Noncompliant --&gt;
   &lt;/interceptor-binding&gt;
&lt;/assembly-descriptor&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;!-- ejb-jar.xml --&gt;

&lt;assembly-descriptor&gt;
    &lt;interceptor-binding&gt;
        &lt;ejb-name&gt;*&lt;/ejb-name&gt;
        &lt;interceptor-class&gt;com.myco.ImportantInterceptor&lt;/interceptor-class&gt;
    &lt;/interceptor-binding&gt;
&lt;/assembly-descriptor&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">Top 10 2021 Category A5 - Security Misconfiguration</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Move this default interceptor to "ejb-jar.xml"</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_23_jul_2015_130201_ann_campbell_wrote">on 23 Jul 2015, 13:02:01 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Rule origin: https://groups.google.com/forum/#!topic/sonarqube/cYQdBhf00eo</p>
</div>
<div class="paragraph">
<p>Project is EJB if it contains JEE Beans (any one of javax.ejb.Singleton, MessageDriven, Stateless or Stateful) (@Local/@Remote interfaces are not mandatory)</p>
</div>
</div>
</div>
</div>