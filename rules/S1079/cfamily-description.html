<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>%s</code> format specifier is used to read a string into a buffer. If the input string exceeds the size of this buffer, a buffer overflow can occur.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, there is no limit on the length of the string being read. The <code>scanf</code> family of functions will continue to read characters into the buffer until they encounter a whitespace character.</p>
</div>
<div class="paragraph">
<p>If the input contains a string that is long enough and lacks whitespace characters, it can result in memory beyond the end of the buffer being overwritten. This situation is known as a buffer overflow vulnerability.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>An attacker could exploit this vulnerability to overwrite memory used by the application. This could result in the modification of application data, unexpected behavior, or even cause the application to become unstable or crash. In some cases, the attacker might also gain control over the execution flow of the application, leading to arbitrary code execution.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A field width can be used together with the <code>%s</code> format specifier. This places an upper limit on the number of characters that will be read into the buffer.</p>
</div>
<div class="paragraph">
<p>Note that the <code>%s</code> format specifier always null-terminates the string in the buffer. You will need to ensure that the buffer is large enough to hold the required input and the null terminator.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">char buffer[10];
scanf("%s", buffer);  // Noncompliant</code></pre>
</div>
</div>
<div class="paragraph">
<p>If this code is given the word <code>noncompliant</code> as an input, <code>noncomplia</code> will be stored in <code>buffer</code> and <code>nt␀</code> will overwrite the contents of the memory immediately following <code>buffer</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">char buffer[10];
scanf("%9s", buffer);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If this code is given the word <code>noncompliant</code> as an input, <code>noncompli␀</code> will be stored in <code>buffer</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p>Wikipedia - <a href="https://en.wikipedia.org/wiki/Buffer_overflow">Buffer overflow</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/120">CWE-120 - Buffer Copy without Checking Size of Input</a> ('Classic Buffer Overflow')</p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/676">CWE-676 - Use of Potentially Dangerous Function</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222612">Application Security and Development: V-222612</a> - The application must not be vulnerable to overflow attacks.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Add a field width specifier to this "%s" placeholder.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_28_aug_2013_093716_dinesh_bolkensteyn_wrote">on 28 Aug 2013, 09:37:16 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>See http://msdn.microsoft.com/en-us/library/xdb9w69d.aspx</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_aug_2013_063819_dinesh_bolkensteyn_wrote">on 29 Aug 2013, 06:38:19 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>perhaps we should also cover sscanf() and fscanf()</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_aug_2013_081236_dinesh_bolkensteyn_wrote">on 29 Aug 2013, 08:12:36 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p><a href="http://crasseux.com/books/ctutorial/String-overflows-with-scanf.html" class="bare">http://crasseux.com/books/ctutorial/String-overflows-with-scanf.html</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_aug_2013_093741_dinesh_bolkensteyn_wrote">on 29 Aug 2013, 09:37:41 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>Let&#8217;s exclude sscanf() because the length of the string is known by the program, and is an upper bound for the size of the buffer required by %s.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_mar_2015_094930_samuel_mercier_wrote">on 3 Mar 2015, 09:49:30 Samuel Mercier wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] added reference to MITRE, CWE-676 for consistency with <a data-rspec-id="S1081" class="rspec-auto-link">RSPEC-1081</a>. Can you double check?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_mar_2015_144316_samuel_mercier_wrote">on 3 Mar 2015, 14:43:16 Samuel Mercier wrote:</h3>
<div class="paragraph">
<p>Answer from Ann on hipchat on March 3rd, 2014, 14:31 looks good @SamuelMercier . Thx</p>
</div>
</div>
</div>
</div>