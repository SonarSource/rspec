<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>C&#43;&#43;20 introduces the "spaceship" <code>operator&lt;=&gt;</code> that replaces all the other comparison operators in most cases. When this operator is defined, the compiler can rewrite expressions using <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code> and <code>&gt;=</code> to use this operator instead. This presents three advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Less code to write (and therefore fewer bugs, too),</p>
</li>
<li>
<p>Guaranteed consistency between all the comparison operators (for instance, in this situation, <code>a &lt; b</code> and <code>!(a &gt;= b)</code> will always return the same value).</p>
</li>
<li>
<p>Guaranteed symmetry for comparisons: if you can write <code>a &lt; b</code>, and that operation is resolved through <code>operator&lt;=&gt;</code>, you can also write <code>b &lt; a</code>, and get a consistent result. Achieving the same result with classical comparison operators requires twice as many overloads if <code>a</code> and <code>b</code> have different types.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, if the <code>operator&lt;=&gt;</code> has the defaulted implementation, the compiler can implicitly generate a defaulted implementation of <code>operator==</code>, simplifying the class definition one step further.</p>
</div>
<div class="paragraph">
<p>Before C&#43;&#43;20, it was common to provide only <code>operator&lt;</code> for a class and ask the users of this class to write all their code only using this operator (this is what <code>std::map</code> requires of its key type, for instance). In this case, it is still advised to replace the operator with <code>&lt;=&gt;</code>: the quantity of required work is similar, and users of the class will benefit from a much greater expressivity.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule reports user-provided comparison operators (member functions or free functions) <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code> and <code>&gt;=</code> that could be replaced by defining the <code>operator&lt;=&gt;</code>.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">class A { // Noncompliant: defines operator&lt; that can be replaced with operator&lt;=&gt;
  int field;
  public:
    bool operator&lt;(const A&amp; other) const {
      return field &lt; other.field;
    }
};</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">class A {
  int field;
  public:
    auto operator&lt;=&gt;(const A&amp; other) const = default;
    // Note that here, operator == will be implicitly defaulted
};</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">class B;

class C { // Noncompliant: defines 12 comparison operators that can be replaced with 2 operators
  int field;
  public:
    bool operator==(const B&amp;) const;
    bool operator!=(const B&amp;) const;
    bool operator&lt;=(const B&amp;) const;
    bool operator&lt;(const B&amp;) const;
    bool operator&gt;=(const B&amp;) const;
    bool operator&gt;(const B&amp;) const;
    friend bool operator==(const B&amp;, const C&amp;);
    friend bool operator!=(const B&amp;, const C&amp;);
    friend bool operator&lt;=(const B&amp;, const C&amp;);
    friend bool operator&lt;(const B&amp;, const C&amp;);
    friend bool operator&gt;=(const B&amp;, const C&amp;);
    friend bool operator&gt;(const B&amp;, const C&amp;);
};</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">class B;

class C { // Compliant. the same comparisons are possible as with the 12 operators
  int field;
  public:
    auto operator&lt;=&gt;(const B&amp;) const;
    auto operator==(const B&amp;) const;
};</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_3">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">enum class MyEnum {low = 1, high = 2};

bool operator&lt;(MyEnum lhs, MyEnum rhs) { // Noncompliant: can be replaced with operator&lt;=&gt;
    return static_cast&lt;int&gt;(lhs) &lt; static_cast&lt;int&gt;(rhs);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_3">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">enum class MyEnum {low = 1, high = 2};

auto operator&lt;=&gt;(MyEnum lhs, MyEnum rhs) {
    return static_cast&lt;int&gt;(lhs) &lt;=&gt; static_cast&lt;int&gt;(rhs);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>C&#43;&#43; reference - <a href="https://en.cppreference.com/w/cpp/language/operator_comparison#Three-way_comparison">Three-way comparison</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S6186" class="rspec-auto-link">S6186</a> - Redundant comparison operators should not be defined.</p>
</li>
<li>
<p><a data-rspec-id="S6230" class="rspec-auto-link">S6230</a> - Comparision operators (<code>&lt;=&gt;</code>, <code>==</code>) should be defaulted unless non-default behavior is required</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_relates_to_s6186">relates to: <a data-rspec-id="S6186" class="rspec-auto-link">S6186</a></h3>

</div>
<div class="sect2">
<h3 id="_is_related_to_s6230">is related to: <a data-rspec-id="S6230" class="rspec-auto-link">S6230</a></h3>

</div>
</div>
</div>