<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when a published file uses <code>require()</code> to import unpublished files or devDependencies.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you publish a Node.js package to npm, only certain files are included in the published package. Files are considered published if they&#8217;re included in the <code>"files"</code> field of <code>package.json</code> (or if no <code>"files"</code> field exists) and not excluded by <code>.npmignore</code>.</p>
</div>
<div class="paragraph">
<p>If your published code tries to <code>require()</code> unpublished files or modules listed in <code>devDependencies</code>, your package will work locally during development but fail with "Module Not Found" errors after being published to npm. This happens because the required files or dependencies won&#8217;t be available in the published package.</p>
</div>
<div class="paragraph">
<p>This rule helps prevent deployment issues by catching these problems during development, ensuring that your published code only depends on resources that will actually be available in the published package.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Using <code>require()</code> to import unpublished files or devDependencies can cause your package to fail after publication with "Module Not Found" errors, even though it works correctly in your local development environment. This can lead to broken packages for your users and require emergency fixes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_fix">How to fix?</h3>
<div class="paragraph">
<p>Remove the require() call for unpublished files or devDependencies. If you need the functionality, move the dependency to regular dependencies or ensure the file is published.</p>
</div>
<div class="sect3">
<h4 id="_non_compliant_code_example">Non-compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">// In a published file
const testHelper = require('./test/helper'); // Noncompliant: test files are typically unpublished
const devTool = require('some-dev-tool'); // Noncompliant: devDependencies aren't published</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_code_example">Compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">// Remove the require() calls or move dependencies to regular dependencies
// const testHelper = require('./test/helper'); // Removed
// const devTool = require('some-dev-tool'); // Removed or moved to dependencies</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>npm package.json files field - <a href="https://docs.npmjs.com/cli/v11/configuring-npm/package-json#files">Documentation on how npm determines which files to include in published packages</a></p>
</li>
<li>
<p>npm .npmignore - <a href="https://docs.npmjs.com/cli/v11/using-npm/developers#keeping-files-out-of-your-package">How to exclude files from npm packages using .npmignore</a></p>
</li>
<li>
<p>Node.js require() documentation - <a href="https://nodejs.org/api/modules.html#requireid">Official Node.js documentation for the require() function</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related Rules</h3>
<div class="ulist">
<ul>
<li>
<p>n/no-unpublished-import - <a href="https://github.com/eslint-community/eslint-plugin-n/blob/master/docs/rules/no-unpublished-import.md">Similar rule for ES6 import statements</a></p>
</li>
<li>
<p>n/no-missing-require - <a href="https://github.com/eslint-community/eslint-plugin-n/blob/master/docs/rules/no-missing-require.md">Disallow require() of modules that don&#8217;t exist</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>