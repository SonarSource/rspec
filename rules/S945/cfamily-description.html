<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a variable with array type decays to a pointer, its bounds are lost.</p>
</div>
<div class="paragraph">
<p>If a design requires arrays of different lengths, then a class should be used to encapsulate the array objects and so ensure that the size is maintained. Note that in C&#43;&#43;20, the class <code>std::span</code> is designed for this purpose, and you can find implementation of <code>span</code> that works with earlier versions of the standard.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">void f1( int p[ 10 ] ); // Non-compliant, function called with arguments of array type
void f2( int *p ); // Non-compliant, function is called with arguments of array type
void functionWorkingOnSingleInt(int * p); // Non-compliant, function is called with arguments of array type

void b ()
{
  int a[ 10 ];
  f1( a ); // The size is lost
  f2( a ); // The size is lost
  functionWorkingOnSingleInt( a ); // Not clear that the function acts on only one element
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">void f3( int ( &amp;p )[ 10 ] ); // Compliant
void f4(span&lt;int&gt; s); // Compliant
void functionWorkingOnSingleInt(int * p); // Compliant

void b ()
{
 int a[ 10 ];
  f3( a ); // size preserved.
  f4( a ); // size captured by the span class
  functionWorkingOnSingleInt( &amp;a[0] ); // explicit about what happens
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>MISRA C&#43;&#43;:2008, 5-2-12 - An identifier with array type passed as a function argument shall not decay to a pointer.</p>
</li>
<li>
<p>C&#43;&#43; Core Guidelines - <a href="https://github.com/isocpp/CppCoreGuidelines/blob/e49158a/CppCoreGuidelines.md#i13-do-not-pass-an-array-as-a-single-pointer">I.13: Do not pass an array as a single pointer</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Conversion from array to pointer discards the size information.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Primary : Function declaration</p>
</div>
<div class="paragraph">
<p>Secondary : Call site where an array argument is passed</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_is_related_to_s5945">is related to: <a data-rspec-id="S5945" class="rspec-auto-link">S5945</a></h3>

</div>
<div class="sect2">
<h3 id="_on_15_oct_2014_204316_ann_campbell_wrote">on 15 Oct 2014, 20:43:16 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~samuel.mercier] please:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>fill in the appropriate reference field(s).</p>
</li>
<li>
<p>provide a See section.</p>
</li>
<li>
<p>take another stab at the message; I&#8217;m not able to follow it.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_30_oct_2019_160626_nicolas_harraudeau_wrote">on 30 Oct 2019, 16:06:26 Nicolas Harraudeau wrote:</h3>
<div class="paragraph">
<p>\[~amelie.renard] There is a mismatch between the Noncompliant code, i.e. the function call, and what is fixed in the compliant code, i.e. the called function&#8217;s signature. It looks like developers won&#8217;t be able to fix these issues when functions are defined in a third-party library.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_nov_2019_182339_lo誰c_joly_wrote">on 4 Nov 2019, 18:23:39 Lo誰c Joly wrote:</h3>
<div class="paragraph">
<p>Hello [~nicolas.harraudeau],</p>
</div>
<div class="paragraph">
<p>I hear your argument, and I think that this issue is not a coding issue, but more a design issue. We are currently thinking about the possibility to report the error on the called function declaration, not at the call site (even if, in some situations, the error can go away by changing the call site&#8230;&#8203;). I&#8217;m updating the example accordingly, just to see what it looks like. We might however have some technical issues with this solution, to be checked&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>From a strict MISRA point of view (I think we should fork this rule), the error would still be reported at the call site, there is no other way to make sure we report all usages, and MISRA does not really have the notion of "unchangeable third party library": If a library is not safe to use, it should not be used, unless there is a deviation&#8230;&#8203;</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_nov_2019_183146_lo誰c_joly_wrote">on 4 Nov 2019, 18:31:46 Lo誰c Joly wrote:</h3>
<div class="paragraph">
<p>\[~amelie.renard]: Can you please review my proposed changes?</p>
</div>
</div>
</div>
</div>