<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when methods are called on objects that might be nil without using the safe navigation operator (&amp;.).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Ruby, calling a method on a nil object raises a <code>NoMethodError</code> exception, which can crash your application at runtime. This commonly happens in several scenarios:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When accessing nested associations in ActiveRecord models where intermediate objects might not exist</p>
</li>
<li>
<p>When working with array elements that could be nil after operations like <code>pluck</code> or <code>compact</code></p>
</li>
<li>
<p>In conditional blocks where objects might not be initialized</p>
</li>
<li>
<p>When dealing with optional parameters or return values from methods</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The safe navigation operator (<code>&amp;.</code>) was introduced in Ruby 2.3 specifically to handle these situations gracefully. When you use <code>object&amp;.method</code>, Ruby checks if <code>object</code> is nil before calling the method. If it is nil, the entire expression returns nil instead of raising an exception.</p>
</div>
<div class="paragraph">
<p>This defensive programming approach makes your code more robust and prevents unexpected crashes, especially in production environments where nil values might occur due to data inconsistencies or edge cases you didn&#8217;t anticipate during development.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Without using the safe navigation operator, your application can crash with <code>NoMethodError</code> exceptions when encountering nil objects. This leads to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Application downtime and poor user experience</p>
</li>
<li>
<p>Difficult-to-debug runtime errors that may only surface in production</p>
</li>
<li>
<p>Increased error monitoring alerts and support tickets</p>
</li>
<li>
<p>Potential data loss if transactions are interrupted by exceptions</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Replace direct method calls with the safe navigation operator (&amp;.) when the receiver might be nil. This prevents NoMethodError exceptions by returning nil instead of crashing.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">field :name, as: :text, visible -&gt; { resource.record.enabled? } # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">field :name, as: :text, visible -&gt; { resource.record&amp;.enabled? }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_activerecord">How to fix it in ActiveRecord</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use safe navigation when accessing nested associations where intermediate models might not exist.</p>
</div>
<div class="sect2">
<h3 id="_code_examples_2">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">user.profile.company.name # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">user.profile&amp;.company&amp;.name</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Ruby Safe Navigation Operator - <a href="https://ruby-doc.org/core-3.0.0/doc/syntax/calling_methods_rdoc.html#label-Safe+navigation+operator">Official Ruby documentation on the safe navigation operator</a></p>
</li>
<li>
<p>Ruby 2.3.0 Release Notes - <a href="https://www.ruby-lang.org/en/news/2015/12/25/ruby-2-3-0-released/">Release notes introducing the safe navigation operator</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-476: NULL Pointer Dereference - <a href="https://cwe.mitre.org/data/definitions/476.html">Covers the security implications of dereferencing null pointers</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S6582" class="rspec-auto-link">RSPEC-6582</a> - <a href="https://rules.sonarsource.com/dart/RSPEC-6582/">Similar rule for Dart language regarding null-aware operators</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>