<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is an issue when using closure syntax <code>${&#8594; variable}</code> in Jenkins pipelines or expression syntax <code>${variable}</code> when lazy evaluation is needed in standard Groovy.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>GString interpolation in Groovy supports two syntaxes with different evaluation behaviors. The expression syntax <code>${variable}</code> evaluates the variable immediately when the GString is created, capturing its current value. The closure syntax <code>${&#8594; variable}</code> creates a closure that evaluates the variable each time the GString is used, providing lazy evaluation.</p>
</div>
<div class="paragraph">
<p>In Jenkins pipelines, the Continuous Passing Style (CPS) transformation process cannot handle closures within GString interpolation. When Jenkins encounters <code>${&#8594; variable}</code> syntax, it attempts to transform the closure for CPS compatibility, which results in runtime errors and pipeline failures.</p>
</div>
<div class="paragraph">
<p>Conversely, in standard Groovy applications where you need the variable to be re-evaluated each time the GString is accessed (such as when the variable&#8217;s value changes after GString creation), using expression syntax will capture only the initial value, leading to stale data and incorrect behavior.</p>
</div>
<div class="paragraph">
<p>This context-dependent behavior makes it easy to choose the wrong syntax, especially when code is moved between different execution environments or when developers are not aware of the underlying evaluation differences.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Using inappropriate GString interpolation syntax can cause runtime failures in Jenkins pipelines or produce incorrect results in standard Groovy applications. In Jenkins, closure syntax leads to CPS transformation errors that break pipeline execution. In standard Groovy, expression syntax can result in stale data when lazy evaluation is expected, causing logic errors and unexpected application behavior.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_jenkins">How to fix it in Jenkins</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Jenkins pipeline contexts, use expression syntax instead of closure syntax to avoid CPS transformation errors.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">// In Jenkins pipeline context
def status = "pending"
def message = "Build status: ${-&gt; status}" // Noncompliant
status = "completed"
println message</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">// In Jenkins pipeline context
def status = "pending"
def message = "Build status: ${status}"
status = "completed"
println message</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Groovy Closures in GStrings - <a href="http://groovy-lang.org/closures.html#_closures_in_gstrings">Official Groovy documentation explaining closure syntax in GString interpolation and lazy evaluation</a></p>
</li>
<li>
<p>Jenkins Pipeline CPS Transformation - <a href="https://www.jenkins.io/doc/book/pipeline/cps-method-mismatches/">Jenkins documentation about CPS transformation and method compatibility issues</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p>CodeNarc-ClosureInGString - <a href="https://codenarc.org/codenarc-rules-jenkins.html#closureingstring-rule">CodeNarc rule that flags closures in GString interpolation for Jenkins compatibility</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>