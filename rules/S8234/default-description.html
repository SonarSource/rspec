<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using <code>permissions: read-all</code> or <code>permissions: write-all</code> grants all read or write permissions to a job, violating the principle of least privilege. Jobs should only have the specific permissions they need.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>read-all</code> grants: pull-requests: read, packages: read, deployments: read, actions: read, etc.</p>
</li>
<li>
<p><code>write-all</code> grants: pull-requests: write, packages: write, deployments: write, actions: write, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, a job that only needs to read issues should not have access to read code, pull requests, or packages. A job that only needs to write files should not be able to create releases, modify deployments, or write to other repositories.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>If a workflow or job is compromised (e.g., via malicious code injection, supply chain attack, or accidental exposure), excessive permissions can lead to:</p>
</div>
<div class="sect3">
<h4 id="_data_exposure">Data Exposure</h4>
<div class="paragraph">
<p>If a workflow or job with <code>read-all</code> permission is compromised, an attacker can access sensitive data in issues, pull requests, or packages etc.</p>
</div>
</div>
<div class="sect3">
<h4 id="_unauthorized_modification">Unauthorized Modification</h4>
<div class="paragraph">
<p>If a workflow or job with <code>write-all</code> permission is compromised, an attacker can create or modify issues, pull requests, releases, or deployments etc.</p>
</div>
</div>
<div class="sect3">
<h4 id="_supply_chain_compromise">Supply chain compromise</h4>
<div class="paragraph">
<p>If a workflow or job with <code>write-all</code> permission is compromised, an attacker can publish malicious packages or modify artifacts</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Replace <code>read-all</code> and <code>write-all</code> with specific permissions that match the job&#8217;s actual needs. If a job needs multiple permissions, list them explicitly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>permissions:
  contents: read
  pull-requests: read
  issues: write</pre>
</div>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">name: Example
jobs:
  test-job:
    permissions: read-all # Noncompliant
    runs-on: ubuntu-latest
    steps:
      # Do something that requires 'contents: read' permissions.</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">name: Example
permissions: write-all # Noncompliant
jobs:
  example:
    runs-on: ubuntu-latest
    steps:
      - name: hello
         # Do something that requires 'contents: write' permissions.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">name: Example
jobs:
  test-job:
    permissions:
      contents: read
    runs-on: ubuntu-latest
    steps:
      # Do something that requires 'contents: read' permissions.</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">name: Example
jobs:
  example:
    permissions:
      contents: write
    runs-on: ubuntu-latest
    steps:
      - name: hello
         # Do something that requires 'contents: write' permissions.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>GitHub Actions enforces permissions through the GITHUB_TOKEN automatically provided to each workflow run. When you specify permissions in a workflow, GitHub restricts the token&#8217;s scopes for that job.</p>
</div>
<div class="paragraph">
<p>When a job uses <code>permissions: read-all</code>, GitHub grants all read permissions to the GITHUB_TOKEN for that job. Similarly, <code>permissions: write-all</code> grants all write permissions. This means any step in the job can perform any read or write operation, even if it&#8217;s not needed.</p>
</div>
<div class="paragraph">
<p>By specifying individual permissions like permissions: <code>contents: read</code>, GitHub restricts the token to only that scope. If a step tries to access other resources (e.g., reading issues with only contents: read), GitHub returns 403 Forbidden, preventing unauthorized access.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Github Docs - <a href="https://docs.github.com/en/actions/reference/workflows-and-actions/workflow-syntax#defining-access-for-the-github_token-scopes">Access Scope</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">Top 10 2021 Category A1 - Broken Access Control</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">Top 10 2017 Category A5 - Broken Access Control</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/266">CWE-266 - Incorrect Privilege Assignment</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222430">Application Security and Development: V-222430</a> - The application must execute without excessive account permissions</p>
</li>
</ul>
</div>
</div>
</div>
</div>