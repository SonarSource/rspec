<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when the error return value of a system call function is ignored or not checked.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>System calls interact directly with the operating system and can fail for many reasons: insufficient permissions, missing files, network issues, or resource constraints.</p>
</div>
<div class="paragraph">
<p>When you ignore error return values from system calls, your program continues executing as if the operation succeeded. This creates several problems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Silent failures</strong>: Your program thinks it completed a task when it actually failed</p>
</li>
<li>
<p><strong>Unpredictable behavior</strong>: Later code may depend on the system call having succeeded</p>
</li>
<li>
<p><strong>Security vulnerabilities</strong>: Failed permission changes or file operations can leave systems in unsafe states</p>
</li>
<li>
<p><strong>Data loss</strong>: Failed write or delete operations may not be noticed until it&#8217;s too late</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Go&#8217;s error handling philosophy emphasizes explicit error checking. The language designers made errors visible return values specifically so developers would handle them appropriately.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Ignoring system call errors can lead to silent failures where your program continues running but critical operations have failed. This can result in:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Security vulnerabilities when permission changes fail silently</p>
</li>
<li>
<p>Data corruption or loss when file operations fail unnoticed</p>
</li>
<li>
<p>System instability when resource management operations fail</p>
</li>
<li>
<p>Difficult debugging when problems only surface much later in execution</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Always check the error return value from system calls. Handle the error appropriately by logging it, returning it to the caller, or taking corrective action.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">unix.Reboot(unix.LINUX_REBOOT_CMD_POWER_OFF) // Noncompliant

os.Remove("/tmp/tempfile") // Noncompliant

os.Chmod("config.txt", 0600) // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-go" data-lang="go">if err := unix.Reboot(unix.LINUX_REBOOT_CMD_POWER_OFF); err != nil {
    log.Printf("Failed to reboot: %v", err)
    return err
}

if err := os.Remove("/tmp/tempfile"); err != nil {
    log.Printf("Failed to remove file: %v", err)
}

if err := os.Chmod("config.txt", 0600); err != nil {
    return fmt.Errorf("failed to set file permissions: %w", err)
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Go Error Handling - <a href="https://go.dev/blog/error-handling-and-go">Official Go blog post explaining error handling philosophy and best practices</a></p>
</li>
<li>
<p>Effective Go - Errors - <a href="https://go.dev/doc/effective_go#errors">Official Go documentation on error handling patterns</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-252: Unchecked Return Value - <a href="https://cwe.mitre.org/data/definitions/252.html">Describes the security implications of ignoring return values</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S899" class="rspec-auto-link">RSPEC-899</a> - <a href="https://rules.sonarsource.com/java/RSPEC-899/">Return values from functions without side effects should not be ignored (Java)</a></p>
</li>
<li>
<p><a data-rspec-id="S937" class="rspec-auto-link">RSPEC-937</a> - <a href="https://rules.sonarsource.com/c/RSPEC-937/">Return values should not be ignored when function calls don&#8217;t have any side effects (C/C++)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>