<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A macro definition should not be redefined without marking that intent specifically by un-defining it first.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#define A 1
#define A 2</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#define A 1
#undef A
#define A 2</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>If the redefinition has the same value as the original one. This is consistent with most C compilers warnings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">#define A 1
#define A 1</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Remove this redefinition or precede it with "#undef" first.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>primary macro name</p>
</div>
<div class="paragraph">
<p>secondary previous definition</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_12_oct_2016_174206_jean_christophe_collet_wrote">on 12 Oct 2016, 17:42:06 Jean-Christophe Collet wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] insisted on removing the exception. Talk to her if you disagree.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_13_oct_2016_151648_alban_auzeill_wrote">on 13 Oct 2016, 15:16:48 Alban Auzeill wrote:</h3>
<div class="paragraph">
<p>By removing the exception we find issue like the following:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/GNOME/glib/blob/f924d0b1f7d2b019f1abb56685dcfda74266c608/glib/gdatetime.c#L177" class="bare">https://github.com/GNOME/glib/blob/f924d0b1f7d2b019f1abb56685dcfda74266c608/glib/gdatetime.c#L177</a></p>
</div>
<div class="paragraph">
<p>But it&#8217;s a rare example.</p>
</div>
<div class="paragraph">
<p>\[~jeanchristophe.collet] I will show you issues in our ruling so we can decide what to do.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_13_oct_2016_152509_jean_christophe_collet_wrote">on 13 Oct 2016, 15:25:09 Jean-Christophe Collet wrote:</h3>
<div class="paragraph">
<p>That still looks like something that should be pointed out.</p>
</div>
<div class="paragraph">
<p>Either the 2nd definition is useless or the developer meant to write something else. Either way, that&#8217;s a code smell to me.</p>
</div>
<div class="paragraph">
<p>Or did I miss something?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_13_oct_2016_160638_alban_auzeill_wrote">on 13 Oct 2016, 16:06:38 Alban Auzeill wrote:</h3>
<div class="paragraph">
<p>Yes the issue on GNOME looks like an unfortunate copy and past. I hope that the developer intention was not to declare something else.</p>
</div>
<div class="paragraph">
<p>This finding tipped the balance in favour of exception removal proposed by [~ann.campbell.2].</p>
</div>
<div class="paragraph">
<p>But [~massimo.paladin] argues than clang, gcc and visual studio only report issues on redefinition of macro with a different values, and ignore when the values are identical.</p>
</div>
<div class="paragraph">
<p>So [~massimo.paladin] suggest to do like compilers to not generate noise.</p>
</div>
<div class="paragraph">
<p>Note:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The C standard says (ISO/IEC 9899:1999, ยง6.10.3, 2):</p>
</div>
<div class="paragraph">
<p>An identifier currently defined as an object-like macro shall not be redefined by another</p>
</div>
<div class="paragraph">
<p>#define preprocessing directive unless the second definition is an object-like macro</p>
</div>
<div class="paragraph">
<p>definition and the two replacement lists are identical. Likewise, an identifier currently</p>
</div>
<div class="paragraph">
<p>defined as a function-like macro shall not be redefined by another #define</p>
</div>
<div class="paragraph">
<p>preprocessing directive unless the second definition is a function-like macro definition</p>
</div>
<div class="paragraph">
<p>that has the same number and spelling of parameters, and the two replacement lists are</p>
</div>
<div class="paragraph">
<p>identical.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>