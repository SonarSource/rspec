<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To customize the default behavior for an export in the <a href="https://learn.microsoft.com/en-us/dotnet/framework/mef/">Managed Extensibility Framework</a> (MEF), applying the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.componentmodel.composition.partcreationpolicyattribute"><code>PartCreationPolicyAttribute</code></a> is necessary.
For the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.componentmodel.composition.partcreationpolicyattribute"><code>PartCreationPolicyAttribute</code></a> to be meaningful in the context of an export, the class must also be annotated with the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.componentmodel.composition.exportattribute"><code>ExportAttribute</code></a>.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when a class is annotated with the <code>PartCreationPolicyAttribute</code> but not with the <code>ExportAttribute</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">using System.ComponentModel.Composition;

[PartCreationPolicy(CreationPolicy.Any)] // Noncompliant
public class FooBar : IFooBar { }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">using System.ComponentModel.Composition;

[Export(typeof(IFooBar))]
[PartCreationPolicy(CreationPolicy.Any)]
public class FooBar : IFooBar { }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/framework/mef/">Managed Extensibility Framework (MEF)</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/framework/mef/attributed-programming-model-overview-mef">Attributed programming model overview (MEF)</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.componentmodel.composition.partcreationpolicyattribute">PartCreationPolicyAttribute Class</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.componentmodel.composition.exportattribute">ExportAttribute Class</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/system.componentmodel.composition.creationpolicy">CreationPolicy Enum</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p>Stefan Henneken - <a href="https://stefanhenneken.net/2015/11/08/mef-part-1-fundamentals-imports-and-exports/">MEF Part 1 – Fundamentals, Imports and Exports</a></p>
</li>
<li>
<p>Stefan Henneken - <a href="https://stefanhenneken.net/2019/01/26/mef-part-2-metadata-and-creation-policies/">MEF Part 2 – Metadata and creation policies</a></p>
</li>
<li>
<p>Stefan Henneken - <a href="https://stefanhenneken.net/2019/03/06/mef-part-3-life-cycle-management-and-monitoring/">MEF Part 3 – Life cycle management and monitoring</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Add the "ExportAttribute" or remove "PartCreationPolicyAttribute" to/from this type definition.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>PartCreationPolicyAttribute attribute</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_23_jan_2018_163856_amaury_levé_wrote">on 23 Jan 2018, 16:38:56 Amaury Levé wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Could you review this draft? I put it as a <code>Bug Detection</code> as the class is never going to work as expected but I am not sure about the severity.</p>
</div>
<div class="paragraph">
<p>If everything is find could you change the completeness?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_23_jan_2018_171215_duncan_pocklington_wrote">on 23 Jan 2018, 17:12:15 Duncan Pocklington wrote:</h3>
<div class="paragraph">
<p>\[~amaury.leve] looks ok to me.</p>
</div>
<div class="paragraph">
<p>A couple of comments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a class can be exported using <em>Export</em> or <em>InheritedExport</em>, or a custom attribute that inherits from one of those two attributes.</p>
</li>
<li>
<p>there are other MEF attributes like <em>Import</em> and <em>ImportingConstructor</em> that don&#8217;t make sense unless they are on an exported class. Should we have those as separate rules, or make this rule more generic e.g. "MEF attribute should only be used on exported types"</p>
</li>
</ul>
</div>
</div>
</div>
</div>