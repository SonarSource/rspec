<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule addresses the issue of incomplete assertions that can occur when using certain test frameworks. Incomplete assertions can lead to tests that do not effectively verify anything. The rule enforces the use of complete assertions in specific cases, namely:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fluent Assertions: <a href="https://fluentassertions.com/introduction">Should()</a> is not followed by an assertion invocation.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>string actual = "Using Fluent Assertions";
actual.Should(); // Noncompliant</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>NFluent: <a href="https://www.n-fluent.net">Check.That()</a> is not followed by an assertion invocation.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>string actual = "Using NFluent";
Check.That(actual); // Noncompliant</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>NSubstitute: <a href="https://nsubstitute.github.io/help/received-calls">Received()</a> is not followed by an invocation.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>command.Received(); // Noncompliant</pre>
</div>
</div>
<div class="paragraph">
<p>In such cases, what is intended to be a test doesn&#8217;t actually verify anything.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_fluent_assertions">How to fix it in Fluent Assertions</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>Fluent Assertions</code> provides an interface for writing assertions, and it is important to ensure that <code>Should()</code> is properly used in conjunction with an assertion method.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">string actual = "Hello World!";
actual.Should(); // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">string actual = "Hello World!";
actual.Should().Contain("Hello");</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_nfluent">How to fix it in NFluent</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>NFluent</code> offers a syntax for assertions, and it&#8217;s important to follow <code>Check.That()</code> with an assertion method to complete the assertion.</p>
</div>
<div class="sect2">
<h3 id="_code_examples_2">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">string actual = "Hello World!";
Check.That(actual); // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">string actual = "Hello World!";
Check.That(actual).Contains("Hello");</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_nsubstitute">How to fix it in NSubstitute</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>NSubstitute</code> is a mocking framework, and <code>Received()</code> is used to verify that a specific method has been called.
However, invoking a method on the mock after calling <code>Received()</code> is necessary to ensure the complete assertion.</p>
</div>
<div class="sect2">
<h3 id="_code_examples_3">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example_3">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">command.Received(); // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_3">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">command.Received().Execute();</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://fluentassertions.com/introduction">Fluent assertions: Should()</a></p>
</li>
<li>
<p><a href="https://www.n-fluent.net">NFluent: Check.That()</a></p>
</li>
<li>
<p><a href="https://nsubstitute.github.io/help/received-calls">NSubstitute: Received()</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Complete the assertion.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_24_nov_2015_140146_ann_campbell_wrote">on 24 Nov 2015, 14:01:46 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk] see truncated description in main task.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_24_nov_2015_142715_tamas_vajk_wrote">on 24 Nov 2015, 14:27:15 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] It seems okay.</p>
</div>
<div class="paragraph">
<p>Do we mark somehow rules that are library dependent? For example, out of the box we only have <code>Assert.IsTrue</code> and <code>Assert.AreEqual</code>-like assertions. With those, this rule doesn&#8217;t make sense. But when you add a library like "FluentAssertions", you could write "something.Should();" instead of "something.Should().NotBeNull()".</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_24_nov_2015_143637_ann_campbell_wrote">on 24 Nov 2015, 14:36:37 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk] should we expand the examples to include:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Assert;  // Noncompliant</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>Assert.AreNotSame(actual,"");</pre>
</div>
</div>
<div class="paragraph">
<p>? Does the noncompliant version compile?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_24_nov_2015_144924_tamas_vajk_wrote">on 24 Nov 2015, 14:49:24 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] No, <code>Assert;</code> on its own doesn&#8217;t compile.</p>
</div>
</div>
<div class="sect2">
<h3 id="_is_duplicated_by_s2858">is duplicated by: <a data-rspec-id="S2858" class="rspec-auto-link">S2858</a></h3>

</div>
<div class="sect2">
<h3 id="_on_22_may_2015_154959_ann_campbell_wrote">on 22 May 2015, 15:49:59 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks for this nearly-complete "stub", [~massimo.paladin].</p>
</div>
<div class="paragraph">
<p>Now I&#8217;m going to ask you to work some more :-)</p>
</div>
<div class="paragraph">
<p>Could you add a code snipped to illustrated the exception? I don&#8217;t quite understand it as-is, and I&#8217;m afraid others won&#8217;t either.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_26_may_2015_122221_massimo_paladin_wrote">on 26 May 2015, 12:22:21 Massimo PALADIN wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I added a code snippet to the exceptions section, back to you for verification.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_26_may_2015_140008_ann_campbell_wrote">on 26 May 2015, 14:00:08 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>This looks great [~massimo.paladin], thanks!</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_may_2015_121220_dinesh_bolkensteyn_wrote">on 29 May 2015, 12:12:20 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I&#8217;m increasing the severity to CRITICAL with the agreement of [~mpaladin]: These issues must be fixed immediately - else you might ship broken code</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_may_2015_121521_ann_campbell_wrote">on 29 May 2015, 12:15:21 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Okay [~dinesh.bolkensteyn].</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_mar_2019_162904_jeffrey_naisbitt_wrote">on 19 Mar 2019, 16:29:04 Jeffrey Naisbitt wrote:</h3>
<div class="paragraph">
<p>This rule appears to have a bug/false-positive when using AssertJ&#8217;s SoftAssertion feature.  AssertJ has a static method (SoftAssertions.assertSoftly) that calls assertAll() after its soft assertions.  Therefore, this case should not trigger the rule violation indicating 'assertAll' is needed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import org.assertj.core.api.SoftAssertions;
import org.junit.Test;

public class Rule2970 {

  @Test
  public void test() {
    SoftAssertions.assertSoftly(softly -&gt; {
      softly.assertThat(true).isTrue();
      softly.assertThat(false).isFalse();
    });
  } // False-positive here: squid:S2970: "Add a call to 'assertAll' after all 'assertThat'."
}</pre>
</div>
</div>
</div>
</div>
</div>