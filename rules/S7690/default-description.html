<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when shell scripts use <code>let</code>, <code>expr</code>, or comparison operators within <code>[ ]</code> or <code>[[ ]]</code> for integer arithmetic operations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Shell scripts have multiple ways to perform integer arithmetic, but some approaches are better than others in terms of performance, readability, and maintainability.</p>
</div>
<div class="paragraph">
<p>The <code>expr</code> command is an external program that must be launched as a separate process for each arithmetic operation. This makes it significantly slower than shell built-ins, especially when used repeatedly in loops or complex calculations.</p>
</div>
<div class="paragraph">
<p>The <code>let</code> built-in, while faster than <code>expr</code>, requires careful attention to quoting. Variables and expressions often need to be quoted to prevent word splitting and pathname expansion, which can lead to subtle bugs if not handled correctly.</p>
</div>
<div class="paragraph">
<p>Using <code>[ ]</code> or <code>[[ ]]</code> for integer comparisons works but is less clear in intent compared to arithmetic-specific syntax.</p>
</div>
<div class="paragraph">
<p>The <code></code> arithmetic evaluation construct is specifically designed for integer arithmetic in bash. It provides several advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Performance</strong>: It&#8217;s a shell built-in that doesn&#8217;t spawn external processes</p>
</li>
<li>
<p><strong>Simplicity</strong>: Variables don&#8217;t require <code>$</code> prefix and no special quoting is needed</p>
</li>
<li>
<p><strong>Clarity</strong>: The syntax clearly indicates arithmetic operations</p>
</li>
<li>
<p><strong>Functionality</strong>: It supports all standard arithmetic operators and comparisons</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using <code></code> makes the code more readable and maintainable while following modern shell scripting best practices.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Using slower arithmetic methods like <code>expr</code> can impact script performance, especially in loops or when processing large amounts of data. The <code>let</code> command&#8217;s quoting requirements can introduce bugs if variables contain unexpected characters or spaces. Using suboptimal arithmetic syntax makes the code harder to read and maintain.</p>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_fix">How to fix?</h3>
<div class="paragraph">
<p>Replace <code>let</code> assignments with <code></code> arithmetic evaluation. The <code></code> syntax doesn&#8217;t require quoting and provides cleaner arithmetic operations.</p>
</div>
<div class="sect3">
<h4 id="_non_compliant_code_example">Non-compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">let "result = x * 2"  # Noncompliant
let "counter++"       # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_code_example">Compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">(( result = x * 2 ))
(( counter++ ))</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Bash Manual - Arithmetic Evaluation - <a href="https://www.gnu.org/software/bash/manual/html_node/Arithmetic-Evaluation.html">Official documentation for bash arithmetic evaluation using </a></p>
</li>
<li>
<p>LinuxCommand.org - Coding Standards - <a href="https://linuxcommand.org/lc3_adv_standards.php">Comprehensive shell scripting coding standards including arithmetic best practices</a></p>
</li>
<li>
<p>Advanced Bash-Scripting Guide - Arithmetic Expansion - <a href="https://tldp.org/LDP/abs/html/arithexp.html">Detailed guide on arithmetic operations in bash scripts</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-1126: Declaration of Variable with Unnecessarily Wide Scope - <a href="https://cwe.mitre.org/data/definitions/1126.html">Using inefficient arithmetic methods can indicate poor coding practices</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>