<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When accessing files on the local filesystem, PHP can enforce security checks to
defend against some attacks. The <code>open_basedir</code> setting in the main PHP
configuration defines a set of directories that the application is allowed to
access. Access to locations outside of these directories will be blocked.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The PHP runtime will allow the application to access all files underneath the
configured set of directories. If no value is set, the application may access
any file on the filesystem.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p><code>open_basedir</code> is commonly used to ensure that a PHP application can only access
files needed for the application function. While deactivating this setting does
not pose a direct threat to the application&#8217;s security, it can make exploitation
of other vulnerabilities easier and more severe.</p>
</div>
<div class="paragraph">
<p>If an attacker can exploit a path traversal vulnerability, they will be able to
access any file made available to the application&#8217;s user account. This may
include system-critical or otherwise sensitive files.</p>
</div>
<div class="paragraph">
<p>In shared hosting environments, a vulnerability can affect all co-hosted
applications and not only the vulnerable one. <code>open_basedir</code> can help limit the
scope of the compromise in that case.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The main PHP configuration should define the <code>open_basedir</code> setting.
This setting should not include overly large directories, such as the root
directory of the filesystem.</p>
</div>
<div class="paragraph">
<p>Adding the current directory, denoted by &#8220;.&#8221;, to the <code>open_basedir</code>
configuration is also dangerous. It is possible to change the current directory
within PHP scripts by calling <code>chdir()</code>, effectively removing any protection.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">; php.ini
open_basedir="/:${USER}/scripts/data"  ; Noncompliant; root directory in the list</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">; php.ini
; open_basedir= ; Noncompliant; setting commented out</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">; php.ini
open_basedir="${USER}/scripts/data"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">; php.ini try 1
open_basedir="/var/www/myapp/data"</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">Top 10 2021 Category A5 - Security Misconfiguration</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/23">CWE-23 - Relative Path Traversal</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/36">CWE-36 - Absolute Path Traversal</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>Set "open_basedir".</p>
</li>
<li>
<p>Limit "open_basedir" to a narrower path than "xxx".</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_1_sep_2015_075530_linda_martin_wrote">on 1 Sep 2015, 07:55:30 Linda Martin wrote:</h3>
<div class="paragraph">
<p>@Ann actually I just realised that comment in the php.ini file are defined as the following: "any text on a line after an unquoted semicolon (; ) is ignored" from documentation: see http://php.net/manual/en/configuration.file.php.</p>
</div>
<div class="paragraph">
<p>So shall we update the code snippet or not (for readability)?</p>
</div>
<div class="paragraph">
<p>Otherwise LGTM!</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_1_sep_2015_130823_ann_campbell_wrote">on 1 Sep 2015, 13:08:23 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Absolutely [~linda.martin]! Please always correct my syntax. :-]</p>
</div>
<div class="paragraph">
<p>I&#8217;ve made an update just now. Double-check it?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_nov_2015_174503_linda_martin_wrote">on 12 Nov 2015, 17:45:03 Linda Martin wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Thanks, I update the remaining comments.</p>
</div>
</div>
</div>
</div>