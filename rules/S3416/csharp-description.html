<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is a well-established convention to name each logger after its enclosing type. This rule raises an issue when the convention is not respected.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">class EnclosingType
{
    private readonly ILogger logger;

    public EnclosingType(ILoggerFactory loggerFactory)
    {
        logger = loggerFactory.CreateLogger&lt;AnotherType&gt;();   // Noncompliant
        logger = loggerFactory.CreateLogger&lt;EnclosingType&gt;(); // Compliant
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Not following such a convention can result in confusion and logging misconfiguration.</p>
</div>
<div class="paragraph">
<p>For example, the person configuring the log may attempt to change the logging behavior for the <code>MyNamespace.EnclosingType</code> type, by overriding defaults for the logger named after that type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "Logging": {
        "LogLevel": {
            "Default": "Error",
            "MyNamespace.EnclosingType": "Debug"
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, if the convention is not in place, the override would not affect logs from <code>MyNamespace.EnclosingType</code>, since they are made via a logger with a different name.</p>
</div>
<div class="paragraph">
<p>Moreover, using the same logger name for multiple types prevents the granular configuration of each type&#8217;s logger, since there is no way to distinguish them in configuration.</p>
</div>
<div class="paragraph">
<p>The rule targets the following logging frameworks:
* <a href="https://learn.microsoft.com/en-us/dotnet/core/extensions/logging">Microsoft Extensions Logging</a>
* <a href="https://logging.apache.org/log4net/">Apache log4net</a>
* <a href="https://nlog-project.org/">NLog</a></p>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>The rule doesn&#8217;t raise issues when custom handling of logging names is in place, and the logger name is not derived from a <code>Type</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">class EnclosingType
{
    private readonly ILogger logger;

    EnclosingType(ILoggerFactory loggerFactory)
    {
        logger = loggerFactory.CreateLogger("My cross-type logging category");   // Compliant
        logger = loggerFactory.CreateLogger(AComplexLogicToFindTheRightType());  // Compliant
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the logger name is defined by a generic type parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">class EnclosingType
{
    private readonly ILogger logger;

    public EnclosingType(ILoggerFactory loggerFactory)
    {
        logger = loggerFactory.CreateLogger&lt;AnotherType&gt;();   // Noncompliant
        logger = loggerFactory.CreateLogger&lt;EnclosingType&gt;(); // Compliant
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the logger name is defined by an input parameter of type <code>Type</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">class EnclosingType
{
    private readonly ILogger logger;

    public EnclosingType(ILoggerFactory loggerFactory)
    {
        logger = loggerFactory.CreateLogger(typeof(AnotherType));   // Noncompliant
        logger = loggerFactory.CreateLogger(typeof(EnclosingType)); // Compliant
        logger = loggerFactory.CreateLogger(GetType());             // Compliant
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the logger name is a string, derived from a <code>Type</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">class EnclosingType
{
    private readonly ILogger logger;

    public EnclosingType(ILoggerFactory loggerFactory)
    {
        logger = loggerFactory.CreateLogger(typeof(AnotherType).Name);       // Noncompliant
        logger = loggerFactory.CreateLogger(typeof(AnotherType).FullName);   // Noncompliant
        logger = loggerFactory.CreateLogger(nameof(AnotherType));            // Noncompliant
        // Fix by referring to the right type
        logger = loggerFactory.CreateLogger(typeof(EnclosingType).Name);     // Compliant
        logger = loggerFactory.CreateLogger(typeof(EnclosingType).FullName); // Compliant
        logger = loggerFactory.CreateLogger(nameof(EnclosingType));          // Compliant
        // or by retrieving the right type dynamically
        logger = loggerFactory.CreateLogger(GetType().FullName);             // Compliant
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/core/diagnostics/logging-tracing">.NET logging and tracing</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/core/extensions/logging?tabs=command-line#log-category">Logging in C# and .NET - Log category</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/core/extensions/logging?tabs=command-line#configure-logging">Logging in C# and .NET - Configure logging</a></p>
</li>
<li>
<p>Microsoft Learn - <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.extensions.logging.ilogger-1">ILogger&lt;TCategoryName&gt; Interface</a></p>
</li>
<li>
<p>Apache Logging - <a href="https://logging.apache.org/log4net/">Apache log4net</a></p>
</li>
<li>
<p>NLog - <a href="https://nlog-project.org/">Flexible &amp; free open-source logging for .NET</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p>Raygun Blog - <a href="https://raygun.com/blog/c-sharp-logging-best-practices/">C# logging: Best practices in 2023 with examples and tools</a></p>
</li>
<li>
<p>Apache Logging - <a href="https://logging.apache.org/log4net/release/manual/configuration.html">Apache log4net Manual - Configuration</a></p>
</li>
<li>
<p>GitHub NLog repository - <a href="https://github.com/nlog/nlog/wiki/Tutorial#best-practices-for-using-nlog">Best practices for using NLog</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Update this logger to use its enclosing type.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>XXX | typeof(XXX) | typeof(XXX).FullName</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links_2">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_25_nov_2015_092238_freddy_mallet_wrote">on 25 Nov 2015, 09:22:38 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>See my comment on relating Google Group thread [~ann.campbell.2]: https://groups.google.com/forum/?utm_medium=email&amp;utm_source=footer#!msg/sonarqube/7DGhtbqRsHk/j2rDIp6dAwAJ</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_7_jun_2018_141752_andrei_epure_wrote">on 7 Jun 2018, 14:17:52 Andrei Epure wrote:</h3>
<div class="paragraph">
<p>Also requested in https://groups.google.com/forum/?utm_source=digest&amp;utm_medium=email#!topic/sonarqube/qCK_pZJ7G_Q</p>
</div>
</div>
</div>
</div>