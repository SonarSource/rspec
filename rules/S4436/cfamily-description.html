<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Network addresses have to be encoded in the network byte order, as specified by RFC-1700, which may be different from that of the host running the code, depending on the endianness of its architecture. This is usually done by using <code>ntohs</code>, <code>ntohl</code>, <code>htons</code> or <code>htonl</code>.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when the following fields are assigned to or from without proper conversion:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>struct sockaddr_in.sin_port</code></p>
</li>
<li>
<p><code>struct sockaddr_in.sin_addr.s_addr</code></p>
</li>
<li>
<p><code>struct sockaddr_in6.sin6_port</code></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">int16_t port = 80;

sa-&gt;sin_port = port; // Noncompliant
sa-&gt;sin_addr.s_addr = address; // Noncompliant
sa-&gt;sin_family = AF_INET;

// ...

port = sa-&gt;sin_port; // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">int16_t port = 80;

sa-&gt;sin_port = htons(port);
sa-&gt;sin_addr.s_addr = htonl(address);
sa-&gt;sin_family = AF_INET;

// ...

port = ntohs(sa-&gt;sin_port);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc1700">RFC-1700</a></p>
</li>
<li>
<p>Wikipedia - <a href="https://en.wikipedia.org/wiki/Endianness">Endianness</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Convert this value with {htons|htonl|ntohs|ntohl}</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>sockaddr_in, or sockaddr_in6 field assignment</p>
</div>
</div>
</div>
</div>