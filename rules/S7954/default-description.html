<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when DML operations (insert, update, delete, upsert, undelete, merge) are performed inside loops.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Salesforce enforces strict governor limits on DML operations to ensure fair resource usage in its multi-tenant environment. The platform allows a maximum of 150 DML operations per transaction in standard orgs (450 with Hyperforce).</p>
</div>
<div class="paragraph">
<p>When DML operations are performed inside loops, each iteration consumes one DML operation from the transaction limit. This approach is highly inefficient and can quickly lead to governor limit exceptions. For example, a loop processing 200 records with individual DML operations would exceed the 150-operation limit, causing a <code>System.LimitException: Too many DML statements: 151</code> runtime exception that cannot be caught or handled.</p>
</div>
<div class="paragraph">
<p>Beyond governor limits, performing DML operations inside loops also impacts performance. Each DML operation involves database communication, and multiple individual operations create unnecessary overhead compared to a single bulk operation.</p>
</div>
<div class="paragraph">
<p>Salesforce&#8217;s architecture is designed to handle bulk operations efficiently. The platform can process multiple records in a single DML statement, which not only stays within governor limits but also provides better performance and scalability.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Violating this rule can lead to several serious consequences:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Governor Limit Exceptions</strong>: The application will throw uncatchable <code>System.LimitException</code> errors when processing moderate to large datasets, causing transaction failures and data inconsistency.</p>
</li>
<li>
<p><strong>Poor Scalability</strong>: Code that works with small datasets during development may fail in production when processing larger volumes of data.</p>
</li>
<li>
<p><strong>Performance Degradation</strong>: Individual DML operations create unnecessary database round trips, significantly slowing down execution compared to bulk operations.</p>
</li>
<li>
<p><strong>User Experience Issues</strong>: Applications may become unreliable and slow, leading to frustrated users and potential business disruption.</p>
</li>
<li>
<p><strong>Maintenance Overhead</strong>: Non-bulkified code requires more complex workarounds and monitoring to handle governor limits, increasing long-term maintenance costs.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Collect records in a collection during loop iteration, then perform a single bulk DML operation outside the loop. This approach uses only one DML operation regardless of the number of records processed.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">for (Account acc : accounts) {
    acc.Name = 'Updated Name';
    update acc; // Noncompliant
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">List&lt;Account&gt; accountsToUpdate = new List&lt;Account&gt;();
for (Account acc : accounts) {
    acc.Name = 'Updated Name';
    accountsToUpdate.add(acc);
}
update accountsToUpdate; // Bulk DML outside loop</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Salesforce Apex Best Practices - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_bestpractices.htm">Official Salesforce documentation on Apex coding best practices including bulkification</a></p>
</li>
<li>
<p>Understanding Execution Governors and Limits - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_gov_limits.htm">Comprehensive guide to Salesforce governor limits and how to work within them</a></p>
</li>
<li>
<p>Bulk Apex Triggers - <a href="https://trailhead.salesforce.com/content/learn/modules/apex_triggers/apex_triggers_bulk">Trailhead module explaining how to write bulk-safe Apex triggers</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>Salesforce Governor Limits - <a href="https://developer.salesforce.com/docs/atlas.en-us.salesforce_app_limits_cheatsheet.meta/salesforce_app_limits_cheatsheet/salesforce_app_limits_platform_apexgov.htm">Official limits enforced by the Salesforce platform for DML operations</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_rules">Related rules</h3>
<div class="ulist">
<ul>
<li>
<p><a data-rspec-id="S5382" class="rspec-auto-link">RSPEC-5382</a> - <a href="https://rules.sonarsource.com/apex/RSPEC-5382">Related rule about SOQL queries in loops which has similar performance implications</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>