include::../description.adoc[]

include::../ask.adoc[]

include::../recommended.adoc[]

== Sensitive Code Example

include::../sensitive.adoc[]

[source,bash,diff-id=1,diff-type=noncompliant]
----
# Sensitive
curl --tlsv1.2 -sSf -L https://might-redirect.example.com/install.sh | sh
----

`wget` will follow redirects by default.

[source,bash,diff-id=2,diff-type=noncompliant]
----
# Sensitive
wget --secure-protocol=TLSv1_2 -q -O - https://might-redirect.example.com/install.sh | sh
----

== Compliant Solution

If you expect the server to redirect the download to a new location, `curl` can use the option `--proto "=https"`
to ensure requests are only made using HTTPS. Any attempt to redirect to a location using HTTP will result in an error.

[source,bash,diff-id=1,diff-type=compliant]
----
curl --proto "=https" --tlsv1.2 -sSf -L https://might-redirect.example.com/install.sh | sh
----

`wget` does not support this functionality so `curl` should be used instead.

If you expect the server to return the file without redirects, `curl` should not be instructed to follow redirects.
Remove any `-L` or `--location` options from the command.

[source,bash]
----
curl --tlsv1.2 -sSf https://might-redirect.example.com/install.sh | sh
----

`wget` uses the option `--max-redirect=0` to disable redirects.

[source,bash,diff-id=2,diff-type=compliant]
----
wget --secure-protocol=TLSv1_2 --max-redirect=0 -q -O - https://might-redirect.example.com/install.sh | sh
----

include::../see.adoc[]

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

include::../message.adoc[]

include::../highlighting.adoc[]

endif::env-github,rspecator-view[]
