Refactor this "SELECT" to use a view or use fewer tables.