<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>Thread</code> class has some methods that are used to monitor and manage its execution.
With the introduction of virtual threads in Java 21, there are three of these methods that behave differently
between the standard platform threads and the virtual ones.</p>
</div>
<div class="paragraph">
<p>For virtual threads:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Thread.setDaemon(boolean)</code> will throw an <code>IllegalArgumentException</code> if <code>false</code> is passed as an argument as a virtual thread daemon status is always true.</p>
</li>
<li>
<p><code>Thread.setPriority(int priority)</code> will never change the actual priority of a virtual thread, which is always equal to <code>Thread.NORM_PRIORITY</code></p>
</li>
<li>
<p><code>Thread.getThreadGroup()</code> will return a dummy "VirtualThreads" group that is empty and should not be used</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This rule reports an issue when one of these methods is invoked on a virtual thread.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Thread t = Thread.ofVirtual().unstarted(()-&gt;{/* some task */});
t.setPriority(1); // Noncompliant; virtual threads' priority cannot be changed
t.setDaemon(false); // Noncompliant; will throw IllegalArgumentException
t.setDaemon(true); // Noncompliant; redundant
t.start();
var threadGroup = t.getThreadGroup(); // Noncompliant; virtual thread groups should not be used</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Java Documentation - <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Thread.html#setDaemon(boolean)">Thread.setDaemon</a></p>
</li>
<li>
<p>Java Documentation - <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Thread.html#setPriority(int)">Thread.setPriority</a></p>
</li>
<li>
<p>Java Documentation - <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Thread.html#getThreadGroup()">Thread.getThreadGroup</a></p>
</li>
<li>
<p>Java Documentation - <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ThreadGroup.html#virtualthreadgroup">Virtual threads group</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>