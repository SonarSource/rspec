<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the same condition is checked twice in a row, it is either confusing - why have separate checks? - or an error - some other condition should have been checked in the second test.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">if (a == b)
{
  doTheThing(b);
}
if (a == b) // Noncompliant; is this really what was intended?
{
  doTheThing(c);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">if (a == b)
{
  doTheThing(b);
  doTheThing(c);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">if (a == b)
{
  doTheThing(b);
}
if (b == c)
{
  doTheThing(c);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>Since it is a common pattern to test a variable, reassign it if it fails the test, then re-test it, that pattern is ignored.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>This condition was just checked on line n.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_25_jun_2015_130010_tamas_vajk_wrote">on 25 Jun 2015, 13:00:10 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] could you check the wording of this language specific exception?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_25_jun_2015_173706_ann_campbell_wrote">on 25 Jun 2015, 17:37:06 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>I&#8217;ve edited [~tamas.vajk], but I believe it semantically the same. :-)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_26_jun_2015_063115_tamas_vajk_wrote">on 26 Jun 2015, 06:31:15 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Thanks.</p>
</div>
</div>
<div class="sect2">
<h3 id="_is_duplicated_by_s2751">is duplicated by: <a data-rspec-id="S2751" class="rspec-auto-link">S2751</a></h3>

</div>
<div class="sect2">
<h3 id="_relates_to_s1862">relates to: <a data-rspec-id="S1862" class="rspec-auto-link">S1862</a></h3>

</div>
<div class="sect2">
<h3 id="_on_24_apr_2015_081530_tamas_vajk_wrote">on 24 Apr 2015, 08:15:30 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] This rule gives false positives on the following pattern:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>if (a == null) {
    a = tryToGetA();
}
if (a == null) {
    throw new Exception();
}
...</pre>
</div>
</div>
<div class="paragraph">
<p>Should we add an exception to this rule to check if the condition of the <code>if</code> is comparing an expression, and inside the <code>if</code> some value is assigned to the same expression? Or should this pattern be avoided?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_27_apr_2015_075737_ann_campbell_wrote">on 27 Apr 2015, 07:57:37 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk] see what you think</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_27_apr_2015_082829_evgeny_mandrikov_wrote">on 27 Apr 2015, 08:28:29 Evgeny Mandrikov wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] as I already told to [~tamas.vajk] : I don&#8217;t agree with such exception, IMO provided example doesn&#8217;t show really readable code - why one wouldn&#8217;t combine first two if-statements ?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_27_apr_2015_154032_ann_campbell_wrote">on 27 Apr 2015, 15:40:32 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Exception reverted</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_jun_2015_073405_evgeny_mandrikov_wrote">on 3 Jun 2015, 07:34:05 Evgeny Mandrikov wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] maybe we should add a little explanation why this is irrelevant for JavaScript? to prevent confusion during further reviews?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_jun_2015_142946_ann_campbell_wrote">on 3 Jun 2015, 14:29:46 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Irrelevant for JavaScript because this is a very common pattern, which raised hundreds of FP&#8217;s</p>
</div>
<div class="listingblock">
<div class="content">
<pre>if ( ! isItOkay(a)) {
  doSomethingTo(a);
}
if ( ! isItOkay(a)) {
  // try again? raise error? ...
}</pre>
</div>
</div>
<div class="paragraph">
<p>cc [~elena.vilchik]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_jun_2015_143548_evgeny_mandrikov_wrote">on 3 Jun 2015, 14:35:48 Evgeny Mandrikov wrote:</h3>
<div class="paragraph">
<p>\[~elena.vilchik], [~ann.campbell.2], same question as for example from C# - why one wouldn&#8217;t combine those two if-statements into single one?</p>
</div>
<div class="listingblock">
<div class="content">
<pre>if ( ! isItOkay(a)) {
  doSomethingTo(a);
  if ( ! isItOkay(a)) {
    // try again? raise error? ...
  }
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_jun_2015_130944_tamas_vajk_wrote">on 4 Jun 2015, 13:09:44 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~evgeny.mandrikov] we had the same in C# as we discussed it earlier. Since then, I added an exception for the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>if (condition)
{
  statement
}
if (condition)
{
 //...
}</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>statement</code> is in any of the following three formats:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>x = anything; //any kind of assignment (-=, +=, ...)
x++; //any postfix unary
++x; //any prefix unary</pre>
</div>
</div>
<div class="paragraph">
<p>and <code>x</code> can be any symbol in <code>condition</code>.</p>
</div>
<div class="paragraph">
<p>With this simple exception, I could get rid of all the false positives that we had in the C# ruling.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_jun_2015_140755_evgeny_mandrikov_wrote">on 4 Jun 2015, 14:07:55 Evgeny Mandrikov wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk] I see the issue here - implementation not aligned with RSPEC. /CC [~dinesh.bolkensteyn] [~ann.campbell.2] [~freddy.mallet]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_jun_2015_153113_dinesh_bolkensteyn_wrote">on 4 Jun 2015, 15:31:13 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>As the RSPEC is assigned to you [~evgeny.mandrikov] , I understand that you take care to come up with a solution to this issue.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_5_jun_2015_120948_evgeny_mandrikov_wrote">on 5 Jun 2015, 12:09:48 Evgeny Mandrikov wrote:</h3>
<div class="paragraph">
<p>\[~dinesh.bolkensteyn] no, I don&#8217;t, I don&#8217;t know why Ann assigned it back to me.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_5_jun_2015_125022_ann_campbell_wrote">on 5 Jun 2015, 12:50:22 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Absentmindedness [~evgeny.mandrikov]. I thought it was <em>still</em> assigned to me, not <em>reassigned</em> to me.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_5_jun_2015_232419_evgeny_mandrikov_wrote">on 5 Jun 2015, 23:24:19 Evgeny Mandrikov wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk] if I correctly understand your exclusion, then this case will be excluded:</p>
</div>
<div class="paragraph">
<p>{noformat}</p>
</div>
<div class="paragraph">
<p>if (c &gt; 5)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{cpp};</pre>
</div>
</div>
<div class="paragraph">
<p>if (c &gt; 5) // copy-paste error</p>
</div>
<div class="literalblock">
<div class="content">
<pre>c--;</pre>
</div>
</div>
<div class="paragraph">
<p>{noformat}</p>
</div>
<div class="paragraph">
<p>I don&#8217;t see an excuse for successive if-statements with identical conditions - they are error-prone and IMO make code less unreadable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_jun_2015_075928_tamas_vajk_wrote">on 8 Jun 2015, 07:59:28 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~evgeny.mandrikov] Yes, you see it correctly, this won&#8217;t report an issue in the current implementation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_jun_2015_080406_dinesh_bolkensteyn_wrote">on 8 Jun 2015, 08:04:06 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>my 2 cents: This is a maintainability rule, not a bug detection one - there should be another rule that targets the discovery of copy&amp;paste errors</p>
</div>
<div class="listingblock">
<div class="content">
<pre>if (foo == null)
{
  foo = GetFoo1();
}

if (foo == null)
{
  foo = GetFoo2();
}</pre>
</div>
</div>
<div class="paragraph">
<p>this could be refactored into:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>if (foo == null)
{
  foo = GetFoo1();
  if (foo == null)
  {
    foo = GetFoo2();
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>but there clearly is no bug here&#8230;&#8203;</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_jun_2015_084328_dinesh_bolkensteyn_wrote">on 8 Jun 2015, 08:43:28 Dinesh Bolkensteyn wrote:</h3>
<div class="paragraph">
<p>Let&#8217;s discuss IRL</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_24_jun_2015_190724_ann_campbell_wrote">on 24 Jun 2015, 19:07:24 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~tamas.vajk], [~evgeny.mandrikov], [~dinesh.bolkensteyn] where do we stand on this rule? FYI, I&#8217;ve just upgraded severity to Critical since I&#8217;m pretty sure we want to keep the 'bug' tag.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_25_jun_2015_130135_tamas_vajk_wrote">on 25 Jun 2015, 13:01:35 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2], I&#8217;ve added an exception to this rule in the C# substask.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_sep_2015_135139_ann_campbell_wrote">on 3 Sep 2015, 13:51:39 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Downgraded from Critical/bug/Reliability to Major/suspicious/Maintainability and exception added after discussion with [~freddy.mallet], [~tamas.vajk], [~ann.campbell.2]</p>
</div>
</div>
</div>
</div>