This rule raises an issue when control structures like `if`, `else`, `while`, or `for` statements have a body without braces, even for single statements.

== Why is this an issue?

Control structures without braces can lead to maintenance problems and bugs. When a developer later adds a second statement to what appears to be a block, they might forget to add braces, causing the second statement to execute outside the intended control flow.

Consider this example:

[source,groovy]
----
if (condition)
    doSomething()
    doSomethingElse()  // This always executes!
----

The second statement `doSomethingElse()` will always execute, regardless of the condition, because it's not part of the if statement. This is a common source of bugs that can be difficult to spot during code review.

Using braces makes the code structure explicit and prevents these types of errors. It also improves readability by clearly showing where each control block begins and ends, especially in nested structures.

=== What is the potential impact?

Without braces, code modifications can introduce logic errors where statements execute outside their intended control flow. This can lead to incorrect program behavior, security vulnerabilities, or data corruption. The impact is particularly severe when the unintended execution involves security checks, resource management, or critical business logic.

== How to fix it

Add braces around the statement body of control structures.

=== Code examples

==== Noncompliant code example

[source,groovy,diff-id=1,diff-type=noncompliant]
----
if (condition)
    doSomething() // Noncompliant
----

==== Compliant solution

[source,groovy,diff-id=1,diff-type=compliant]
----
if (condition) {
    doSomething()
}
----

== Resources

=== Documentation

 * Groovy Style Guide - https://groovy-lang.org/style-guide.html[Official Groovy style guide]

=== Standards

 * CWE-483: Incorrect Block Delimitation - https://cwe.mitre.org/data/definitions/483.html[Describes security implications of incorrect block delimitation in code]

