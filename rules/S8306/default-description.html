<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when control structures like <code>if</code>, <code>else</code>, <code>while</code>, or <code>for</code> statements have a body without braces, even for single statements.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Control structures without braces can lead to maintenance problems and bugs. When a developer later adds a second statement to what appears to be a block, they might forget to add braces, causing the second statement to execute outside the intended control flow.</p>
</div>
<div class="paragraph">
<p>Consider this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">if (condition)
    doSomething()
    doSomethingElse()  // This always executes!</code></pre>
</div>
</div>
<div class="paragraph">
<p>The second statement <code>doSomethingElse()</code> will always execute, regardless of the condition, because it&#8217;s not part of the if statement. This is a common source of bugs that can be difficult to spot during code review.</p>
</div>
<div class="paragraph">
<p>Using braces makes the code structure explicit and prevents these types of errors. It also improves readability by clearly showing where each control block begins and ends, especially in nested structures.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Without braces, code modifications can introduce logic errors where statements execute outside their intended control flow. This can lead to incorrect program behavior, security vulnerabilities, or data corruption. The impact is particularly severe when the unintended execution involves security checks, resource management, or critical business logic.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add braces around the statement body of control structures.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">if (condition)
    doSomething() // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">if (condition) {
    doSomething()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Groovy Style Guide - <a href="https://groovy-lang.org/style-guide.html">Official Groovy style guide</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>CWE-483: Incorrect Block Delimitation - <a href="https://cwe.mitre.org/data/definitions/483.html">Describes security implications of incorrect block delimitation in code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>