<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mounting sensitive file system paths can lead to information disclosure and compromise of the host systems.</p>
</div>
<div class="paragraph">
<p>System paths can contain sensitive information like configuration files or cache files.
Those might be used by attackers to expand permissions or to collect information for further attacks.
System paths can also contain binaries and scripts that might be executed by the host system periodically.
A compromised or rogue container with access to sensitive files could endanger the integrity of the whole Kubernetes cluster.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The mounted file path contains sensitive information.</p>
</li>
<li>
<p>The mounted file path contains configuration files or executables that are writable.</p>
</li>
<li>
<p>The Pod is untrusted or might contain vulnerabilities.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is recommended to avoid mounting sensitive system file paths into containers.
If it is necessary to mount such a path due to the architecture, the least privileges should be given, for instance by making the mount read-only to prevent unwanted modifications.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">---
- name: Deploy a Container
  hosts: all
  tasks:
    - name: Create and Start Container
      community.docker.docker_container:
        name: container
        image: ubuntu:22.04
        volumes:
          - "/etc:/host_etc" # Sensitive</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">---
- name: Deploy a Container
  hosts: all
  tasks:
    - name: Create and Start Container
      community.docker.docker_container:
        name: container
        image: ubuntu:22.04
        volumes:
          - "/data:/data"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Ansible Community Documentation - <a href="https://docs.ansible.com/ansible/latest/collections/community/docker/docker_container_module.html">community.docker.docker_container module</a></p>
</li>
<li>
<p>Ansible Community Documentation - <a href="https://docs.ansible.com/ansible/latest/collections/containers/podman/podman_container_module.html#containers-podman-podman-container-module-manage-podman-containers">containers.podman.podman_container module</a></p>
</li>
<li>
<p>Ansible Community Documentation - <a href="https://docs.ansible.com/ansible/latest/collections/kubernetes/core/k8s_module.html#kubernetes-core-k8s-module-manage-kubernetes-k8s-objects">kubernetes.core.k8s module</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/284">CWE-668 - Exposure of Resource to Wrong Sphere</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure mounting the file system path is safe here.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="ulist">
<ul>
<li>
<p>Highlight the whole path if not empty.</p>
</li>
</ul>
</div>
</div>
</div>
</div>