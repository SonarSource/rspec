<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when the <code>fetch()</code> method on an Apex cursor is called with a chunk size larger than 200 records.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Salesforce enforces strict governor limits on resources like heap size and CPU time within each transaction. These limits prevent any single operation from consuming too many platform resources.</p>
</div>
<div class="paragraph">
<p>When using Apex cursors to process large datasets, the <code>fetch()</code> method retrieves a specified number of records in a single call. If you fetch too many records at once (typically more than 200), you risk exceeding these governor limits, especially:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Heap size limit</strong>: Large record sets consume significant memory</p>
</li>
<li>
<p><strong>CPU time limit</strong>: Processing many records can exceed the allowed computation time</p>
</li>
<li>
<p><strong>SOQL query limits</strong>: Though less common with cursors, large fetches can still impact query performance</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When governor limits are exceeded, Salesforce throws runtime exceptions that cannot be caught or handled gracefully. This causes the entire transaction to fail, potentially leaving your data in an inconsistent state.</p>
</div>
<div class="paragraph">
<p>Apex cursors are specifically designed for incremental processing of large datasets. The whole point is to break down big operations into manageable chunks that stay well within platform limits.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Exceeding governor limits causes immediate transaction failure with uncatchable runtime exceptions. This can lead to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Data processing operations that fail unpredictably</p>
</li>
<li>
<p>Incomplete data migrations or bulk operations</p>
</li>
<li>
<p>Poor user experience when operations fail without clear error handling</p>
</li>
<li>
<p>Difficulty in debugging and maintaining code that works in some environments but fails in others with larger datasets</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Reduce the chunk size to 200 records or fewer. This keeps your operations well within Salesforce governor limits while still processing data efficiently.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">List&lt;Contact&gt; scope = locator.fetch(position, 2000); // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-apex" data-lang="apex">List&lt;Contact&gt; scope = locator.fetch(position, 200);</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Apex Cursors for Scalable Data Processing - <a href="https://www.apexhours.com/apex-cursors-for-scalable-data-processing-in-salesforce">Comprehensive guide on using Apex cursors with best practices for chunk sizes</a></p>
</li>
<li>
<p>Salesforce Governor Limits - <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_gov_limits.htm">Official documentation on Salesforce platform limits and resource management</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>