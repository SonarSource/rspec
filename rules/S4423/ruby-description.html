<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This vulnerability exposes encrypted data to a number of
attacks whose goal is to recover the plaintext.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Encryption algorithms are essential for protecting sensitive information and
ensuring secure communications in a variety of domains. They are used for
several important reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Confidentiality, privacy, and intellectual property protection</p>
</li>
<li>
<p>Security during transmission or on storage devices</p>
</li>
<li>
<p>Data integrity, general trust, and authentication</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When selecting encryption algorithms, tools, or combinations, you should also
consider two things:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>No encryption is unbreakable.</p>
</li>
<li>
<p>The strength of an encryption algorithm is usually measured by the effort required to crack it within a reasonable time frame.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For these reasons, as soon as cryptography is included in a project, it is
important to choose encryption algorithms that are considered strong and secure
by the cryptography community.</p>
</div>
<div class="paragraph">
<p>To provide communication security over a network, SSL and TLS are generally
used. However, it is important to note that the following protocols are all
considered weak by the cryptographic community, and are officially deprecated:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SSL versions 1.0, 2.0 and 3.0</p>
</li>
<li>
<p>TLS versions 1.0 and 1.1</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When these unsecured protocols are used, it is best practice to expect a breach:
that a user or organization with malicious intent will perform mathematical
attacks on this data after obtaining it by other means.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>After retrieving encrypted data and performing cryptographic attacks on it on a
given timeframe, attackers can recover the plaintext that encryption was
supposed to protect.</p>
</div>
<div class="paragraph">
<p>Depending on the recovered data, the impact may vary.</p>
</div>
<div class="paragraph">
<p>Below are some real-world scenarios that illustrate the potential impact of an
attacker exploiting the vulnerability.</p>
</div>
<div class="sect3">
<h4 id="_additional_attack_surface">Additional attack surface</h4>
<div class="paragraph">
<p>By modifying the plaintext of the encrypted message, an attacker may be able to
trigger additional vulnerabilities in the code. An attacker can further exploit
a system to obtain more information.<br>
Encrypted values are often considered trustworthy because it would not be
possible for a third party to modify them under normal circumstances.</p>
</div>
</div>
<div class="sect3">
<h4 id="_breach_of_confidentiality_and_privacy">Breach of confidentiality and privacy</h4>
<div class="paragraph">
<p>When encrypted data contains personal or sensitive information, its retrieval
by an attacker can lead to privacy violations, identity theft, financial loss,
reputational damage, or unauthorized access to confidential systems.</p>
</div>
<div class="paragraph">
<p>In this scenario, the company, its employees, users, and partners could be
seriously affected.</p>
</div>
<div class="paragraph">
<p>The impact is twofold, as data breaches and exposure of encrypted data can
undermine trust in the organization, as customers, clients and stakeholders may
lose confidence in the organization&#8217;s ability to protect their sensitive data.</p>
</div>
</div>
<div class="sect3">
<h4 id="_legal_and_compliance_issues">Legal and compliance issues</h4>
<div class="paragraph">
<p>In many industries and locations, there are legal and compliance requirements
to protect sensitive data. If encrypted data is compromised and the plaintext
can be recovered, companies face legal consequences, penalties, or violations
of privacy laws.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_ruby_standard_library">How to fix it in Ruby Standard Library</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">http = Net::HTTP.new("https://www.example.com")
http.use_ssl = true
http.ciphers = "DEFAULT@SECLEVEL=0" # Noncompliant
response = http.get("/")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">http = Net::HTTP.new("https://www.example.com")
http.use_ssl = true
response = http.get("/")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work">How does this work?</h3>
<div class="paragraph">
<p>As a rule of thumb, by default you should use the cryptographic algorithms and
mechanisms that are considered strong by the cryptographic community.</p>
</div>
<div class="paragraph">
<p>The best choices at the moment are the following.</p>
</div>
<div class="sect3">
<h4 id="_use_tls_v1_2_or_tls_v1_3">Use TLS v1.2 or TLS v1.3</h4>
<div class="paragraph">
<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and
secure practice by the cryptography community.<br></p>
</div>
<div class="paragraph">
<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and
enables seamless communication between different systems that do not yet have
TLS v1.3 support.</p>
</div>
<div class="paragraph">
<p>The only drawback depends on whether the framework used is outdated: its TLS
v1.2 settings may enable older and insecure cipher suites that are deprecated
as insecure.</p>
</div>
<div class="paragraph">
<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic
algorithms, eliminates known vulnerabilities from previous TLS versions, and
improves performance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_openssl_security_levels">OpenSSL Security Levels</h4>
<div class="paragraph">
<p>OpenSSL introduced security levels in version 1.1.0 to provide a simplified way to configure cryptographic security requirements. The security level system uses numeric values from 0 to 5, where higher numbers represent stricter security requirements.</p>
</div>
<div class="sect4">
<h5 id="_security_level_0_seclevel0">Security Level 0 (SECLEVEL=0)</h5>
<div class="paragraph">
<p>Setting <code>SECLEVEL=0</code> explicitly disables OpenSSL&#8217;s security level restrictions, allowing the use of Weak cipher suites and older TLS protocols.</p>
</div>
</div>
<div class="sect4">
<h5 id="_default_security_levels">Default Security Levels</h5>
<div class="paragraph">
<p>When no security level is specified, OpenSSL uses the default security level (typically 1 or 2 depending on the version), which blocks weak cipher suites and older TLS protocols.</p>
</div>
<div class="paragraph">
<p>The compliant solution removes the <code>SECLEVEL=0</code> configuration, allowing OpenSSL to use its secure default security level, which provides strong cryptographic protection.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_faraday">How to fix it in Faraday</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples_2">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">ssl_options = {
    ciphers: "DEFAULT@SECLEVEL=0" # Noncompliant
    # Optional parameters
}
conn = Faraday.new(url: "https://www.example.com", ssl: ssl_options)
response = conn.get("/")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">ssl_options = {
    # Optional parameters
}
conn = Faraday.new(url: "https://www.example.com", ssl: ssl_options)
response = conn.get("/")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work_2">How does this work?</h3>
<div class="paragraph">
<p>As a rule of thumb, by default you should use the cryptographic algorithms and
mechanisms that are considered strong by the cryptographic community.</p>
</div>
<div class="paragraph">
<p>The best choices at the moment are the following.</p>
</div>
<div class="sect3">
<h4 id="_use_tls_v1_2_or_tls_v1_3_2">Use TLS v1.2 or TLS v1.3</h4>
<div class="paragraph">
<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and
secure practice by the cryptography community.<br></p>
</div>
<div class="paragraph">
<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and
enables seamless communication between different systems that do not yet have
TLS v1.3 support.</p>
</div>
<div class="paragraph">
<p>The only drawback depends on whether the framework used is outdated: its TLS
v1.2 settings may enable older and insecure cipher suites that are deprecated
as insecure.</p>
</div>
<div class="paragraph">
<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic
algorithms, eliminates known vulnerabilities from previous TLS versions, and
improves performance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_openssl_security_levels_2">OpenSSL Security Levels</h4>
<div class="paragraph">
<p>OpenSSL introduced security levels in version 1.1.0 to provide a simplified way to configure cryptographic security requirements. The security level system uses numeric values from 0 to 5, where higher numbers represent stricter security requirements.</p>
</div>
<div class="sect4">
<h5 id="_security_level_0_seclevel0_2">Security Level 0 (SECLEVEL=0)</h5>
<div class="paragraph">
<p>Setting <code>SECLEVEL=0</code> explicitly disables OpenSSL&#8217;s security level restrictions, allowing the use of Weak cipher suites and older TLS protocols.</p>
</div>
</div>
<div class="sect4">
<h5 id="_default_security_levels_2">Default Security Levels</h5>
<div class="paragraph">
<p>When no security level is specified, OpenSSL uses the default security level (typically 1 or 2 depending on the version), which blocks weak cipher suites and older TLS protocols.</p>
</div>
<div class="paragraph">
<p>The compliant solution removes the <code>SECLEVEL=0</code> configuration, allowing OpenSSL to use its secure default security level, which provides strong cryptographic protection.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_rest_client">How to fix it in rest-client</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples_3">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example_3">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">client = RestClient::Resource.new("https://www.example.com", ssl_ciphers: "DEFAULT@SECLEVEL=0") # Noncompliant
response = client.get</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_3">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">client = RestClient::Resource.new("https://www.example.com")
response = client.get</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work_3">How does this work?</h3>
<div class="paragraph">
<p>As a rule of thumb, by default you should use the cryptographic algorithms and
mechanisms that are considered strong by the cryptographic community.</p>
</div>
<div class="paragraph">
<p>The best choices at the moment are the following.</p>
</div>
<div class="sect3">
<h4 id="_use_tls_v1_2_or_tls_v1_3_3">Use TLS v1.2 or TLS v1.3</h4>
<div class="paragraph">
<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and
secure practice by the cryptography community.<br></p>
</div>
<div class="paragraph">
<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and
enables seamless communication between different systems that do not yet have
TLS v1.3 support.</p>
</div>
<div class="paragraph">
<p>The only drawback depends on whether the framework used is outdated: its TLS
v1.2 settings may enable older and insecure cipher suites that are deprecated
as insecure.</p>
</div>
<div class="paragraph">
<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic
algorithms, eliminates known vulnerabilities from previous TLS versions, and
improves performance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_openssl_security_levels_3">OpenSSL Security Levels</h4>
<div class="paragraph">
<p>OpenSSL introduced security levels in version 1.1.0 to provide a simplified way to configure cryptographic security requirements. The security level system uses numeric values from 0 to 5, where higher numbers represent stricter security requirements.</p>
</div>
<div class="sect4">
<h5 id="_security_level_0_seclevel0_3">Security Level 0 (SECLEVEL=0)</h5>
<div class="paragraph">
<p>Setting <code>SECLEVEL=0</code> explicitly disables OpenSSL&#8217;s security level restrictions, allowing the use of Weak cipher suites and older TLS protocols.</p>
</div>
</div>
<div class="sect4">
<h5 id="_default_security_levels_3">Default Security Levels</h5>
<div class="paragraph">
<p>When no security level is specified, OpenSSL uses the default security level (typically 1 or 2 depending on the version), which blocks weak cipher suites and older TLS protocols.</p>
</div>
<div class="paragraph">
<p>The compliant solution removes the <code>SECLEVEL=0</code> configuration, allowing OpenSSL to use its secure default security level, which provides strong cryptographic protection.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it_in_excon">How to fix it in excon</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples_4">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example_4">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">excon = Excon.new("https://www.example.com", ciphers: "DEFAULT@SECLEVEL=0") # Noncompliant
response = excon.get</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_4">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">excon = Excon.new("https://www.example.com")
response = excon.get</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_does_this_work_4">How does this work?</h3>
<div class="paragraph">
<p>As a rule of thumb, by default you should use the cryptographic algorithms and
mechanisms that are considered strong by the cryptographic community.</p>
</div>
<div class="paragraph">
<p>The best choices at the moment are the following.</p>
</div>
<div class="sect3">
<h4 id="_use_tls_v1_2_or_tls_v1_3_4">Use TLS v1.2 or TLS v1.3</h4>
<div class="paragraph">
<p>Even though TLS V1.3 is available, using TLS v1.2 is still considered good and
secure practice by the cryptography community.<br></p>
</div>
<div class="paragraph">
<p>The use of TLS v1.2 ensures compatibility with a wide range of platforms and
enables seamless communication between different systems that do not yet have
TLS v1.3 support.</p>
</div>
<div class="paragraph">
<p>The only drawback depends on whether the framework used is outdated: its TLS
v1.2 settings may enable older and insecure cipher suites that are deprecated
as insecure.</p>
</div>
<div class="paragraph">
<p>On the other hand, TLS v1.3 removes support for older and weaker cryptographic
algorithms, eliminates known vulnerabilities from previous TLS versions, and
improves performance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_openssl_security_levels_4">OpenSSL Security Levels</h4>
<div class="paragraph">
<p>OpenSSL introduced security levels in version 1.1.0 to provide a simplified way to configure cryptographic security requirements. The security level system uses numeric values from 0 to 5, where higher numbers represent stricter security requirements.</p>
</div>
<div class="sect4">
<h5 id="_security_level_0_seclevel0_4">Security Level 0 (SECLEVEL=0)</h5>
<div class="paragraph">
<p>Setting <code>SECLEVEL=0</code> explicitly disables OpenSSL&#8217;s security level restrictions, allowing the use of Weak cipher suites and older TLS protocols.</p>
</div>
</div>
<div class="sect4">
<h5 id="_default_security_levels_4">Default Security Levels</h5>
<div class="paragraph">
<p>When no security level is specified, OpenSSL uses the default security level (typically 1 or 2 depending on the version), which blocks weak cipher suites and older TLS protocols.</p>
</div>
<div class="paragraph">
<p>The compliant solution removes the <code>SECLEVEL=0</code> configuration, allowing OpenSSL to use its secure default security level, which provides strong cryptographic protection.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/Padding_oracle_attack">Wikipedia, Padding Oracle Attack</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Chosen-ciphertext_attack">Wikipedia, Chosen-Ciphertext Attack</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Chosen-plaintext_attack">Wikipedia, Chosen-Plaintext Attack</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Semantic_security">Wikipedia, Semantically Secure Cryptosystems</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding">Wikipedia, OAEP</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Galois/Counter_Mode">Wikipedia, Galois/Counter Mode</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">Top 10 2021 Category A2 - Cryptographic Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">Top 10 2021 Category A7 - Identification and Authentication Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/327">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Change this code to enforce TLS 1.2 or above.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_deprecates_s5326">deprecates: <a data-rspec-id="S5326" class="rspec-auto-link">S5326</a></h3>

</div>
<div class="sect2">
<h3 id="_on_5_mar_2018_120437_alexandre_gigleux_wrote">on 5 Mar 2018, 12:04:37 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>There is no SEI CERT ID for this one in https://wiki.sei.cmu.edu/confluence/display/java/SEI+CERT+Oracle+Coding+Standard+for+Java</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_5_mar_2018_130612_alexandre_gigleux_wrote">on 5 Mar 2018, 13:06:12 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>See https://docs.oracle.com/javase/8/docs/technotes/guides/security/StandardNames.html#SSLContext for the list of protocols supported by <code>SSLContext.getInstance()</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_27_mar_2018_154654_pierre_yves_nicolas_wrote">on 27 Mar 2018, 15:46:54 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>\[~alexandre.gigleux] There&#8217;s a different <a href="https://docs.oracle.com/javase/9/docs/specs/security/standard-names.html#sslcontext-algorithms">list for java 9</a> which contains 3 "new" protocols: DTLS, DTLSv1.0 and DTLSv1.2. Should they also be considered as weak?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_27_mar_2018_164202_alexandre_gigleux_wrote">on 27 Mar 2018, 16:42:02 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>\[~pierre-yves.nicolas]</p>
</div>
<div class="paragraph">
<p>According to https://tools.ietf.org/html/rfc7525#page-6 (3.1.2. DTLS Protocol Versions), here is the mapping between DTLS and TLS:</p>
</div>
<div class="paragraph">
<p>Version 1.0 of DTLS correlates to version 1.1 of TLS</p>
</div>
<div class="paragraph">
<p>Version 1.2 of DTLS correlates to version 1.2 of TLS</p>
</div>
<div class="paragraph">
<p>As a consequence, we should consider DTLS and DTLSv1.0 in the "weak" list.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_30_may_2018_170033_alexandre_gigleux_wrote">on 30 May 2018, 17:00:33 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>We should generalize this rule to: "Weak SSL protocols should not be used"</p>
</div>
</div>
</div>
</div>