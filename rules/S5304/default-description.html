<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using environment variables is security-sensitive. For example, their use has led in the past to the following vulnerabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2014-6278">CVE-2014-6278</a></p>
</li>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2019-3464">CVE-2019-3464</a></p>
</li>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2018-1000402">CVE-2018-1000402</a></p>
</li>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2016-10530">CVE-2016-10530</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Environment variables  are sensitive to injection attacks, just like any other input.</p>
</div>
<div class="paragraph">
<p>Note also that environment variables can be exposed in multiple ways, storing sensitive information in them should be done carefully:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>on Unix systems environment variables of one process can be read by another process running with the same UID.</p>
</li>
<li>
<p>environment variables <a href="https://docs.oracle.com/javase/tutorial/essential/environment/env.html">might be forwarded to child processes</a>.</p>
</li>
<li>
<p>application running in debug mode often exposes their environment variable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This rule raises an issue when environment variables are read.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Environment variables are used without being sanitized.</p>
</li>
<li>
<p>You store sensitive information in environment variables and other processes might be able to access them.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You are at risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sanitize every environment variable before using its value.</p>
</div>
<div class="paragraph">
<p>If you store sensitive information in an environment variable, make sure that no other process can access them, i.e. the process runs with a separate user account and child processes don&#8217;t have access to their parent&#8217;s environment.</p>
</div>
<div class="paragraph">
<p>Don&#8217;t run your application in debug mode if it has access to sensitive information, including environment variables.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>public class Main {
    public static void main (String[] args) {
        System.getenv();  // Sensitive
        System.getenv("myvar");  // Sensitive

        ProcessBuilder processBuilder = new ProcessBuilder();
        Map&lt;String, String&gt; environment = processBuilder.environment();  // Sensitive
        environment.put("VAR", "value");

        Runtime.getRuntime().exec("ping", new String[]{"env=val"});   // Sensitive
    }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/526">CWE-526 - Information Exposure Through Environmental Variables</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/74">CWE-74 - Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure that environment variables are used safely here</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_27_may_2020_164125_eric_therond_wrote">on 27 May 2020, 16:41:25 Eric Therond wrote:</h3>
<div class="paragraph">
<p>Deprecated because it overlaps with SonarSecurity</p>
</div>
</div>
</div>
</div>