<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Android has a built-in backup mechanism that can save and restore application
data. When application backup is enabled, local data from your application can
be exported to Google Cloud or to an external device via <code>adb backup</code>.
Enabling Android backup exposes your application to disclosure of sensitive
data. It can also lead to corruption of local data when restoration is performed
from an untrusted source.</p>
</div>
<div class="paragraph">
<p>By default application backup is enabled and it includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Shared preferences files</p>
</li>
<li>
<p>Files saved in one of the paths returned by</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://developer.android.com/reference/android/content/Context#getDatabasePath(java.lang.String)">getDatabasePath(String)</a></p>
</li>
<li>
<p><a href="https://developer.android.com/reference/android/content/Context#getFilesDir()">getFilesDir()</a></p>
</li>
<li>
<p><a href="https://developer.android.com/reference/android/content/Context#getDir(java.lang.String,%20int)">getDir(String, int)</a></p>
</li>
<li>
<p><a href="https://developer.android.com/reference/android/content/Context#getExternalFilesDir(java.lang.String)">getExternalFilesDir(String)</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Application backup is enabled and sensitive data is stored in local files, local databases, or shared preferences.</p>
</li>
<li>
<p>Your application never validates data from files that are included in backups.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Disable application backup unless it is required for your application to work properly.</p>
</li>
<li>
<p>Narrow the scope of backed-up files by using either</p>
<div class="ulist">
<ul>
<li>
<p>backup rules (see <code>android:fullBackupContent</code> attribute).</p>
</li>
<li>
<p>a custom <code>BackupAgent</code>.</p>
</li>
<li>
<p>the dedicated <code>no_backup</code> folder (see <code>android.content.Context#getNoBackupFilesDir()</code>).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Do not back up local data containing sensitive information unless they are properly encrypted.</p>
</li>
<li>
<p>Make sure that the keys used to encrypt backup data are not included in the backup.</p>
</li>
<li>
<p>Validate data from backed-up files. They should be considered untrusted as they could have been restored from an untrusted source.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;application
    android:allowBackup="true"&gt; &lt;!-- Sensitive --&gt;
&lt;/application&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Disable application backup.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;application
    android:allowBackup="false"&gt;
&lt;/application&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If targeting Android 6.0 or above (API level 23), define files to include/exclude from the application backup.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;application
    android:allowBackup="true"
    android:fullBackupContent="@xml/backup.xml"&gt;
&lt;/application&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">Top 10 2021 Category A1 - Broken Access Control</a></p>
</li>
<li>
<p>OWASP - <a href="https://mas.owasp.org/checklists/MASVS-STORAGE/">Mobile AppSec Verification Standard - Data Storage and Privacy Requirements</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage">Mobile Top 10 2016 Category M1 - Improper platform usage</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage">Mobile Top 10 2016 Category M2 - Insecure Data Storage</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-mobile-top-10/2023-risks/m9-insecure-data-storage">Mobile Top 10 2024 Category M9 - Insecure Data Storage</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/312">CWE-922 - Insecure Storage of Sensitive Information</a></p>
</li>
<li>
<p><a href="https://developer.android.com/guide/topics/data/autobackup">Back up user data with Auto Backup</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure backup of application data is safe here.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>The opening &lt;application&gt; tag</p>
</div>
</div>
</div>
</div>