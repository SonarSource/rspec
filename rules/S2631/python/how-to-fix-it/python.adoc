=== How to fix it in Python Standard Library

The following noncompliant code is vulnerable to Regex Denial of Service (ReDoS)
because untrusted data is used as a regex to scan a string without prior
sanitization or validation.

==== Noncompliant code example

[source,python,diff-id=1,diff-type=noncompliant]
----
from flask import request
import re

@app.route('/lookup')
def lookup():
  needle = request.args.get('needle')
  haystack = request.args.get('haystack')

  re.search(needle, haystack) # Noncompliant
----

==== Compliant solution

[source,python,diff-id=1,diff-type=compliant]
----
from flask import request
import re

@app.route('/lookup')
def lookup():
  needle = re.escape(request.args.get('needle'))
  haystack = request.get('haystack')

  re.search(needle, haystack)
----

=== How does this work?

include::../../common/fix/validation.adoc[]

In the example, `re.escape` escapes metacharacters and escape sequences that
could have broken the initially intended logic.
