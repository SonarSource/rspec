=== How to fix it in Java SE

The following non-compliant code is vulnerable to Regex Denial of Service
because untrusted data is used as a pattern to scan a string without prior
sanitization or validation.

[cols="a"]
|===
h| Non-compliant code example
|
[source,java]
----
public boolean validate(HttpServletRequest request) {
  String regex = request.getParameter("regex");
  String input = request.getParameter("input");

  input.matches(regex);  // Noncompliant
}
----
h| Compliant solution
|
[source,java]
----
public boolean validate(javax.servlet.http.HttpServletRequest request) {
  String regex = request.getParameter("regex");
  String input = request.getParameter("input");

  input.matches(Pattern.quote(regex));
}
----
|===

=== How does this work?

include::../../common/fix/validation.adoc[]

In the example, `Patter.quote` escapes metacharacters and escape sequences that
could have broken the initially intended logic.
