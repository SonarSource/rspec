<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>cgi.force_redirect</code> <em>php.ini</em> configuration controls the behavior of
the PHP engine when used in CGI mode. In particular, it prevents CGI scripts
from being directly requested without prior web server or application
processing.</p>
</div>
<div class="paragraph">
<p>When disabled, CGI scripts can be requested directly.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Pre-processing on the server side is often required to check users
authentication when working in CGI mode. Those preliminary actions can also
position diverse configuration parameters necessary for the CGI script to work
correctly.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>CGI scripts might behave unexpectedly if the proper configuration is not set up
before they are accessed.</p>
</div>
<div class="paragraph">
<p>Most serious security-related consequences will affect the authorization and
authentication mechanisms of the application. When the web server is responsible
for authenticating clients and forwarding the proper identity to the script,
direct access will bypass this authentication step.</p>
</div>
<div class="paragraph">
<p>Attackers could also provide arbitrary identities to the CGI script by forging
specific HTTP headers or parameters. They could then impersonate any legitimate
user of the application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>cgi.force_redirect</code> should be enforced in the main PHP configuration file.</p>
</div>
<div class="paragraph">
<p>Note that this parameter is enabled by default.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">; php.ini
cgi.force_redirect=0  ; Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">; php.ini
cgi.force_redirect=1  ; Noncompliant</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pitfalls">Pitfalls</h3>
<div class="paragraph">
<p>The <code>cgi.force_redirect</code> is not supported by all web servers. For example,
Microsoft IIS web server is unable to differentiate an internally redirected
request from a normal one.</p>
</div>
<div class="paragraph">
<p>While using such a server, the <code>cgi.force_redirect</code> parameter will have to be
disabled for the CGI scripts to work properly. In that case, it is important to
ensure the CGI behavior is aware of the security threat.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">Top 10 2021 Category A5 - Security Misconfiguration</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/305">CWE-305 - Authentication Bypass by Primary Weakness</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Remove this configuration disabling "cgi.force_redirect".</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_1_sep_2015_074606_linda_martin_wrote">on 1 Sep 2015, 07:46:06 Linda Martin wrote:</h3>
<div class="paragraph">
<p>LGTM!</p>
</div>
</div>
</div>
</div>