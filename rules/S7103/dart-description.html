<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <code>final</code> or <code>const</code> variable that is declared as a nullable type, but then initialized with a non-null value, should rather be declared as a non-nullable type.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Unlike <code>var</code> variables, <code>final</code> and <code>const</code> variables need to be initialized inline.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">final int i = 42;
const int i = 42;</code></pre>
</div>
</div>
<div class="paragraph">
<p>An exception to the inline initialization is when the <a href="https://dart.dev/null-safety/understanding-null-safety#late-variables"><code>late</code> keyword</a> is used, which allows the variable to be initialized later, and that can only apply to non-<code>const</code> variables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">late final int i1;
late int? i2;

void main() {
  // ...
  i1 = int.parse(String.fromEnvironment('I1'));
  i2 = int.parse(String.fromEnvironment('I2'));
  // Use i
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Aforementioned exceptions apart, if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the declared type is explicit (e.g. <code>final int?</code> or <code>const int?</code>)</p>
</li>
<li>
<p>the declared type is a nullable type (e.g. <code>int?</code>)</p>
</li>
<li>
<p>the inline initialization value is not null (e.g. <code>42</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>then the declared type could be non-nullable instead, because the value of the variable will never be <code>null</code> under any circumstances, due to the <code>final</code> or <code>const</code> constaints imposed.</p>
</div>
<div class="paragraph">
<p>The rule applies to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>local variables of functions and methods</p>
</li>
<li>
<p>top-level variables</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Because Dart 3 enforces <a href="https://dart.dev/null-safety#dart-3-and-null-safety">sound null safety</a>, not following this rule may have multiple consequences.</p>
</div>
<div class="sect3">
<h4 id="_code_complexity">Code complexity</h4>
<div class="paragraph">
<p>It may make the code <strong>unnecessarily complicated</strong>, as the developer will have to handle the <code>null</code> case even though it will never happen: for example, if the variable <code>t</code> is of type <code>T?</code>, any operation <code>f</code> on <code>t</code> will have to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>either use the null-aware operator <code>?.</code>: e.g. <code>t?.f()</code></p>
</li>
<li>
<p>or the null assertion operator <code>!</code> on <code>t</code>: e.g. <code>t!.f()</code></p>
</li>
<li>
<p>or narrow the type from <code>T?</code> to <code>T</code> with an <code>if</code> statement, a conditional expression, or via pattern matching: e.g. <code>t != null ? t.f() : ...</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Neither of these options is necessary if the variable is declared as <code>final T</code> or <code>const T</code> instead.</p>
</div>
</div>
<div class="sect3">
<h4 id="_unclear_intent">Unclear intent</h4>
<div class="paragraph">
<p>If the variable is declared as <code>final T?</code> or <code>const T?</code>, and used far from its declaration, the <code>?</code> can be misleading, since the developer may assume that the variable can be <code>null</code> at some point in its lifetime, even though it can&#8217;t.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>The rule does not apply to class instance fields, whether they are <code>late</code> or not.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">class A {
  final int? i = 42; // Non applicable
  A(this.a);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, it does apply to class static fields:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">class A {
  static final int? i1 = 42; // Non compliant
  static const int? i2 = 42; // Non compliant
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Change the type of the variable to be non-nullable and remove all the null-safety measures potentially used at every call site, such as</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the null-aware operator <code>?.</code></p>
</li>
<li>
<p>the null assertion operator <code>!</code></p>
</li>
<li>
<p>or any construct introduced to narrow the type</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">final int? i = 42; // Noncompliant
final String? s = 'Hello'; // Noncompliant

void main() {
  print(i!);
  print(s?.length);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">final int i = 42;
final String s = 'Hello';

void main() {
  print(i);
  print(s.length);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example_2">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">class AClass {
  static final int? i1 = 42; // Noncompliant
  static final String? s1 = 'Hello'; // Noncompliant

  static void aFunction() {
    final int? i2 = 42; // Noncompliant
    const int? i3 = 42; // Noncompliant

    print(i1!);
    print(s1?.length);
    print(i2 ?? 0);
    print(i3 != null ? i3 : '&lt;no value&gt;');
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution_2">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dart" data-lang="dart">class AClass {
  static final int i1 = 42;
  static final String s1 = 'Hello';

  static void aFunction() {
    final int i2 = 42;
    const int i3 = 42;

    print(i1);
    print(s1.length);
    print(i2);
    print(i3);
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Dart Docs - <a href="https://dart.dev/tools/linter-rules/unnecessary_nullable_for_final_variable_declarations">Dart Linter rule - unnecessary_nullable_for_final_variable_declarations</a></p>
</li>
<li>
<p>Dart Docs - <a href="https://dart.dev/null-safety#dart-3-and-null-safety">Language - Dart 3 and null safety</a></p>
</li>
<li>
<p>Dart Docs - <a href="https://dart.dev/null-safety/understanding-null-safety#late-variables">Language - Late variables</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Type could be non-nullable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>The identifier of the variable defined as nullable, at the declaration site.</p>
</div>
</div>
</div>
</div>