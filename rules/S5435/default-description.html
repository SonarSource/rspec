<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On Python versions earlier than 2.7.9 and 3.4.3, standard libraries that perform HTTPS request have a vulnerable SSL/TLS configuration by default. In the past, it has led to the following vulnerabilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2013-2191">CVE-2013-2191</a></p>
</li>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2013-6396">CVE-2013-6396</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, those library would simply ignore verification of X509 certificate signatures, as well as hostname verification. This mean that nothing is preventing an attacker to intercept network traffic. He would then be able to read and modify sensitive information that should normally be safe from this threat.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when one of the following standard library is used for networking with its default SSL/TLS configuration: <code>urllib</code>, <code>urllib</code>, <code>http</code> or <code>httplib</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Your application is using <em>urllib</em>, <em>urllib2</em>, <em>http</em>, and <em>httplib</em> modules to perform HTTPS requests</p>
</li>
<li>
<p>You rely on the library default SSL/TLS configuration.</p>
</li>
<li>
<p>You are using a version of Python prior to 2.7.9 or 3.4.3.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You are at risk if you answered yes to all those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Avoid versions of Python where standard library have vulnerable SSL/TLS configuration by default. Your Python version should be at least 2.7.9 or 3.4.3.</p>
</li>
<li>
<p>Prefer using <a href="http://requests.readthedocs.org/">Requests package</a> which has secure SSL/TLS configuration by default.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">Top 10 2021 Category A7 - Identification and Authentication Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/295">CWE-295 - Improper Certificate Validation</a></p>
</li>
<li>
<p><a href="https://www.python.org/dev/peps/pep-0476/">PEP-476</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=4o-xqqidvKA">Benjamin Peterson - A Dive into TLS - PyCon 2015</a></p>
</li>
<li>
<p><a href="https://wiki.openstack.org/wiki/OSSN/OSSN-0033">OSSN/OSSN-0033</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_6_aug_2019_160601_pierre_loup_tristant_wrote">on 6 Aug 2019, 16:06:01 Pierre-Loup Tristant wrote:</h3>
<div class="paragraph">
<p>This rule will not be implemented after all.</p>
</div>
<div class="paragraph">
<p>The main reason is: to few Python 3 applications are concerned by this vulnerability.</p>
</div>
<div class="paragraph">
<p>Source: https://www.jetbrains.com/research/python-developers-survey-2018/</p>
</div>
<div class="paragraph">
<p>Only 5% to 10% of developer that responded to this survey are affected by the vulnerable versions of Python 3.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_aug_2019_114904_pierre_loup_tristant_wrote">on 8 Aug 2019, 11:49:04 Pierre-Loup Tristant wrote:</h3>
<div class="paragraph">
<p>To complete last comment: this rule was feared to be just noise for a large majority of Python 3 developers</p>
</div>
</div>
</div>
</div>