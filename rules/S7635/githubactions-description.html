<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>GitHub Actions workflows should follow the principle of least privilege by providing reusable workflows with access only to the specific secrets they require. When <code>secrets: inherit</code> is used to call a reusable workflow, all repository secrets become available to the reusable workflow, creating unnecessary security risks.</p>
</div>
<div class="paragraph">
<p>This practice increases the attack surface and potential for secret exposure, as any vulnerability in the reusable workflow could compromise all secrets rather than just the ones actually needed. Additionally, it violates the principle of least privilege by granting broader access than necessary.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>There are secrets in the repository that are unrelated to the reusable workflow&#8217;s purpose.</p>
</li>
<li>
<p>The reusable workflow could function with access to only specific, named secrets.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answer yes to any of the above questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Provide reusable workflows with access only to the specific secrets they require.</p>
</li>
<li>
<p>Use individual secret references instead of inheriting all secrets.</p>
</li>
<li>
<p>Regularly audit and remove unused secrets from the repository.</p>
</li>
<li>
<p>Consider the trust level of external reusable workflows before granting secret access.</p>
</li>
<li>
<p>Implement proper secret rotation policies to limit exposure duration.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">name: Example

on:
  pull_request:

jobs:
  call-reusable-workflow:
    uses: github/ExampleRepo/.github/workflows/reusable.yml@v1
    secrets: inherit # Sensitive</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">name: Example

on:
  pull_request:

jobs:
  call-reusable-workflow:
    uses: github/ExampleRepo/.github/workflows/reusable.yml@v1
    secrets:
      SECRET: ${{ secrets.EXAMPLE_SECRET }}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>GitHub Docs - <a href="https://docs.github.com/en/actions/using-workflows/reusing-workflows">Reusing workflows</a></p>
</li>
<li>
<p>GitHub Docs - <a href="https://docs.github.com/en/actions/using-workflows/reusing-workflows#passing-secrets-to-nested-workflows">Passing secrets to nested workflows</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">Top 10 2021 Category A1 - Broken Access Control</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">Top 10 2017 Category A5 - Broken Access Control</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/266">CWE-266 - Incorrect Privilege Assignment</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222430">Application Security and Development: V-222430</a> - The application must execute without excessive account permissions</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Only pass required secrets to this workflow</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>On <code>secrets: inherit</code></p>
</div>
<hr>
</div>
</div>
</div>