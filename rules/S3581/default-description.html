<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The comparison of numeric values of different formats is inefficient. For instance, comparing a <code>COMP-3</code> with a <code>COMP-4</code> causes a performance drag because conversions are required under the covers before the comparison.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when variables with different <code>USAGE</code> clauses, or different numbers of decimal places are compared.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cobol" data-lang="cobol">01 SUB1 PIC 9999 BINARY
01 WS-DISPLAY-1	PIC 9(12)
01 WS-PACKED-DEC PIC 9(12)V9(2) COMP-3
01 WS-BIN PIC S9999 COMP-4
01 WS-DISPLAY-2	PIC 9(4)

PERFORM VARYING SUB1 FROM WS-DISPLAY-1
BY WS-PACKED-DEC
UNTIL WS-BIN &gt; WS-DISPLAY-2  *&gt; Noncompliant
* ...
END-PERFORM</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cobol" data-lang="cobol">01 SUB1 PIC 9999 BINARY
01 WS-DISPLAY-1	PIC 9(12)
01 WS-PACKED-DEC PIC 9(12)V9(2) COMP-4
01 WS-BIN PIC S9999 COMP-4
01 WS-DISPLAY-2	PIC 9(4)

PERFORM VARYING SUB1 FROM WS-DISPLAY-1
BY WS-PACKED-DEC
UNTIL WS-BIN &gt; WS-DISPLAY-2
* ...
END-PERFORM</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Update the declarations of "XXX" and "YYY" to have the same format.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>operands and operator</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_24_mar_2016_145425_ann_campbell_wrote">on 24 Mar 2016, 14:54:25 Ann Campbell wrote:</h3>
<div class="paragraph">
<p><em>Why</em> is this inefficient and why does efficiency decrease as the number of formats in an operation increases?</p>
</div>
<div class="paragraph">
<p>What&#8217;s the best corrective action? Change all the relevant var declarations? Perform intermediate calculations? Apply casts or conversions?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_may_2016_141033_pierre_yves_nicolas_wrote">on 3 May 2016, 14:10:33 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] We should clarify what "different numeric formats" means:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We should probably compare the USAGE clauses of the definitions of the operands, taking into account the default value and possible synonyms (e.g. COMP is the same as BINARY)</p>
</li>
<li>
<p>According to an <a href="http://www.ibm.com/support/knowledgecenter/SS6SG3_6.1.0/com.ibm.cobol61.ent.doc/PGandLR/tasks/tpeff05b.html">IBM documentation</a>, we should probably also compare the number of decimal places.</p>
</li>
<li>
<p>Should we check that the PICTURE clauses are identical?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The current issue message is "Update the declaration of XXX to make it a YYY". If the 2 operands of a binary expression have different numeric formats, which definition should be updated? It&#8217;s not always obvious, e.g. when operand 1 is COMP and operand 2 is COMP-3. The message could be changed to avoid this kind of problem.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_3_may_2016_141848_pierre_yves_nicolas_wrote">on 3 May 2016, 14:18:48 Pierre-Yves Nicolas wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Should we keep this rule restricted to "comparisons" or should we extend it to cover arithmetic expressions/statements? In the current code sample, a variable is incremented through a specific syntax (PERFORM VARYING&#8230;&#8203;) using different numeric formats.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_24_may_2016_154300_ann_campbell_wrote">on 24 May 2016, 15:43:00 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Per our discussion, I&#8217;ve forwarded these questions to the original requester.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_29_nov_2016_093452_elena_vilchik_wrote">on 29 Nov 2016, 09:34:52 Elena Vilchik wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] There is wording "the more formats there are in a comparison the less &#8230;&#8203;", while IMO it&#8217;s weird to say "the more" if there are just max 2 possible. Do you think you could rephrase it? Thanks!</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_5_dec_2016_094312_ann_campbell_wrote">on 5 Dec 2016, 09:43:12 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>done [~elena.vilchik]</p>
</div>
</div>
</div>
</div>