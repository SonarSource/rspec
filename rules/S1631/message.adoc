Rework this SQL statement to reduce the number of joined tables/views from X to at most Y