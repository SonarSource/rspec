<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when async operations are wrapped in immediately invoked function expressions, promise chains, or async functions that are called immediately at the top level.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JavaScript&#8217;s top-level await feature allows you to use <code>await</code> directly at the module level without wrapping async operations in functions. This makes code cleaner and more readable.</p>
</div>
<div class="paragraph">
<p>When you wrap async operations in immediately invoked function expressions (IIFEs) or create async functions just to call them immediately, you add unnecessary boilerplate code. This pattern was common before top-level await was available, but is no longer needed in modern JavaScript environments.</p>
</div>
<div class="paragraph">
<p>Using wrapper patterns can also make error handling more complex and may lead to unhandled promise rejections if not properly managed. Top-level await provides a more straightforward approach to handling async operations at the module level.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Using wrapper patterns instead of top-level await reduces code readability and maintainability. It adds unnecessary complexity and boilerplate code that makes the intent less clear. In some cases, improper error handling in wrapper patterns can lead to unhandled promise rejections.</p>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_fix">How to fix?</h3>
<div class="paragraph">
<p>Replace immediately invoked async function expressions with top-level await.</p>
</div>
<div class="sect3">
<h4 id="_non_compliant_code_example">Non-compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">(async () =&gt; {
  try {
    await run();
  } catch (error) {
    console.error(error);
    process.exit(1);
  }
})(); // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_code_example">Compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">try {
  await run();
} catch (error) {
  console.error(error);
  process.exit(1);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/sindresorhus/eslint-plugin-unicorn#readme">eslint-plugin-unicorn</a> - Rule <a href="https://github.com/sindresorhus/eslint-plugin-unicorn/blob/HEAD/docs/rules/prefer-top-level-await.md">prefer-top-level-await</a></p>
</li>
<li>
<p>MDN - Top-level await - <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await#top_level_await">Official documentation for JavaScript&#8217;s top-level await feature</a></p>
</li>
<li>
<p>TC39 - Top-level await proposal - <a href="https://github.com/tc39/proposal-top-level-await">The official ECMAScript proposal for top-level await</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>