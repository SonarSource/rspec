<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when calls to <code>tuple()</code>, <code>list()</code>, <code>set()</code>, or <code>dict()</code>
are done with an argument that is either already a collection literal or a comprehension.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Python provides direct ways to create common data structures like tuples, lists, and dictionaries using literals, e.g., <code>()</code>, <code>(1,2)</code>, <code>[]</code>, <code>[1,2]</code>, <code>{}</code>, <code>{'a':1}</code>
and comprehensions e.g., <code>[x for x in y]</code>, <code>{k:v for k,v in y}</code>.
Wrapping these direct forms in a type constructors is unnecessary, as shown in the following examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">tuple((1,2))

list([1,2])
list([x for x in [1,2]])

set({})
set({for k in [1,2]})

dict({'a':1})
dict({k:v for k,v in [1,2]})
dict([(1,"a"), (2, "b")])</code></pre>
</div>
</div>
<div class="paragraph">
<p>Such constructs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>add overhead by creating an intermediate collections</p>
</li>
<li>
<p>add verbosity without providing any additional functionality</p>
</li>
<li>
<p>add ambiguity and may mislead readers or imply a more complex operation than what is actually occurring</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>If there are no modification in the comprehension such as <code>list([x for x in [1,2]])</code> which is the same as <code>[1,2]</code>, this rule will not raise an issue;
instead rule <a data-rspec-id="S7500" class="rspec-auto-link">S7500</a> - Comprehensions only used to copy should be replaced with the respective constructor calls, will raise an issue.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To fix this, remove the constructor call and use the literal or comprehension syntax of the target type.
As an exception, for a list or comprehension inside of a <code>tuple</code> constructor replace the comprehension by a generator.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">t1 = tuple([1, 2]) # Noncompliant: the tuple creation can be done directly without the intermediate list</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">t1 = (1, 2) # Compliant</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">l1 = list([x * 2 for x in [1,2,3]]) # Noncompliant: list is redundant.</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">l1 = [x * 2 for x in [1,2,3]] # Compliant</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">s1 = set([x * 2 for x in [1,2,3]]) # Noncompliant: the set creation can be done with a set comprehension.</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">s1 = {x * 2 for x in [1,2,3]} # Compliant</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Python Documentation - <a href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions">List Comprehensions</a></p>
</li>
<li>
<p>Python Documentation - <a href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries">Dictionaries</a></p>
</li>
<li>
<p>Python Documentation - <a href="https://docs.python.org/3/tutorial/datastructures.html#sets">Sets</a></p>
</li>
<li>
<p>Python Documentation - <a href="https://docs.python.org/3/tutorial/datastructures.html#tuples-and-sequences">Tuples and Sequences</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We should be careful to not raise issue if there are no modification. This means no function call,
no filtering (if), no multiple <code>for</code>s and no switch of keys and values in dict comprehensions.</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>When the inner type is the same as the constructor:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Remove the redundant {tuple|list|set|dict} constructor call.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the inner type is different than the constructor:
For literals:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Replace this {tuple|list|set|dict} constructor call by a {tuple|list|set|dict} literal.
For comprehensions:</p>
</li>
<li>
<p>Replace this {list|set|dict} constructor call by a {list|set|dict} literal.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Exception for tuple with a list/set-comprehension <code>tuple([foo(x) in [1,2]])</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Replace this list/set comprehension by a generator.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>The list/set/dict/tuple constructor call.</p>
</div>
<div class="paragraph">
<p>Exception for tuple with a list/set-comprehension <code>tuple([foo(x) in [1,2]])</code>:
We should highlight the list/set-comprehension</p>
</div>
</div>
</div>
</div>