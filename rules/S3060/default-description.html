<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One of the possible ways of performing <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/type-testing-and-cast">type-testing</a> is via the <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/is">is operator</a>: <code>food is Pizza</code>.</p>
</div>
<div class="paragraph">
<p>The <code>is</code> operator is often used before a direct <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/type-testing-and-cast#cast-expression">cast</a> to the target type, as a more flexible and powerful alternative to the <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/type-testing-and-cast#as-operator">as operator</a>, especially when used to perform <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/type-testing-and-cast#type-testing-with-pattern-matching">pattern matching</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">if (food is Pizza pizza)</code></pre>
</div>
</div>
<div class="paragraph">
<p>There&#8217;s no valid reason to test <code>this</code> with <code>is</code>. The only plausible explanation for such a test is that you&#8217;re executing code in a parent class conditionally based on the kind of child class <code>this</code> is.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public class Food
{
  public void DoSomething()
  {
    if (this is Pizza) // Noncompliant
    {
      // Code specific to Pizza...
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, code that&#8217;s specific to a child class should be <em>in</em> that child class, not in the parent.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One way is to take advantage of the <a href="https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/tutorials/oop">object-orientation</a> of C# and use <a href="https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/object-oriented/polymorphism">polymorphism</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make the method <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/virtual">virtual</a>, if it is not already. That will allow derived classes to perform <a href="https://en.wikipedia.org/wiki/Method_overriding">method overriding</a>.</p>
</li>
<li>
<p>Move the code to the right level of the type hierarchy.</p>
</li>
<li>
<p>Use <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/base">base</a> to call the method on the base class that has been overridden.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, when simple method polymorphism is not enough because it is necessary to reuse multiple sections of the parent method, the <a href="https://en.wikipedia.org/wiki/Template_method_pattern">Template method pattern</a> might help.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public class Food
{
  public void DoSomething()
  {
    // Code shared by all Food...
    if (this is Pizza) // Noncompliant
    {
      // Code specific to Pizza...
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public class Food
{
  public virtual void DoSomething()
  {
    // Code shared by all Food...
  }
}

public class Pizza : Food
{
  public override void DoSomething()
  {
    base.DoSomething();
    // Code specific to Pizza...
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/operators/type-testing-and-cast">Type-testing operators and cast expressions - is, as, typeof and casts</a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/functional/pattern-matching">Pattern matching overview</a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/tutorials/oop">Object-Oriented programming (C#)</a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/object-oriented/polymorphism">Polymorphism</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Template_method_pattern">Template method pattern</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Method_overriding">Method overriding</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Offload the code that&#8217;s conditional on this "is" test to the appropriate subclass and remove the test.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_12_jun_2015_175304_ann_campbell_wrote">on 12 Jun 2015, 17:53:04 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>CodePro: Use of "instanceof" with "this"</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_jun_2015_175551_ann_campbell_wrote">on 12 Jun 2015, 17:55:51 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>FYI [~tamas.vajk]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_15_jun_2015_201833_nicolas_peru_wrote">on 15 Jun 2015, 20:18:33 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Looks good</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_16_jun_2015_095906_tamas_vajk_wrote">on 16 Jun 2015, 09:59:06 Tamas Vajk wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I&#8217;ve added the C# specific parts. (The operator is called <code>is</code> in C#.)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_16_jun_2015_112455_ann_campbell_wrote">on 16 Jun 2015, 11:24:55 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks [~tamas.vajk]. FYI, I&#8217;ve moved the C#-specific stuff to a subtask. I know that it seems a shame with so few tiny differences, but brackes &amp; pipes is what we used before we came up with creating subtasks &amp; eventually everything will be converted from brackets to subtasks.</p>
</div>
</div>
</div>
</div>