== Why is this an issue?

The JDK provides a set of built-in methods to copy the contents of an array into another array.
Using a loop to perform the same operation is less clear, more verbose and should be avoided.

=== Exceptions

The rule detects only the most idiomatic patterns, it will not consider loops with non-trivial control flow.
For example, loops that copy array elements conditionally are ignored.

== How to fix it

You can use:

* `Arrays.copyOf` to copy an entire array into another array
* `System.arraycopy` to copy only a subset of an array into another array
* `Arrays.asList` to create a new list with the contents of the array
* `Collections.addAll` to add the elements of a collection into another collection

Note that `Arrays.asList` returns a fixed-size `List`, so further steps are required if a non-fixed-size `List` is needed.

=== Code examples

==== Noncompliant code example

[source,java,diff-id=1,diff-type=noncompliant]
----
public void makeCopies(String[] source) {

  String[] array = new String[source.length];
  List<String> list = new ArrayList(source.length);

  for (int i = 0; i < source.length; i++) {
    array[i] = source[i]; // Noncompliant
  }

  for (String s : source) {
    list.add(s); // Noncompliant
  }
}

----

==== Compliant solution

[source,java,diff-id=1,diff-type=compliant]
----
public void makeCopies(String[] source) {
  String[] array = Arrays.copyOf(source, source.length);

  String[] fiveElementsFromIndexTwo = new String[5];
  System.arraycopy(source, 2, fiveElementsFromIndexTwo, 0, 5); // System.arraycopy allows to copy a subset of the source elements

  List<String> asList = Arrays.asList(source);

  List<String> list = new ArrayList<>();
  Collections.addAll(list, source);
}

public void makeCopiesConditional(int[] source) {
  int[] dest = new int[source.length];
  for (int i = 0; i < source.length; i++) {
    if (source[i] > 10) {
      dest[i] = source[i];  // Compliant
    }
  }
}

----

== Resources
=== Documentation

* https://docs.oracle.com/javase/8/docs/api/java/util/Arrays.html#copyOf-T:A-int-:~:text=1.6-,copyOf,-public%20static%C2%A0byte[Arrays.copyOf]
* https://docs.oracle.com/javase/8/docs/api/java/util/Arrays.html#asList-T...-:~:text=1.6-,asList,-%40SafeVarargs%0Apublic%20static[Arrays.asList]
* https://docs.oracle.com/javase/8/docs/api/java/lang/System.html#arraycopy-java.lang.Object-int-java.lang.Object-int-int-:~:text=1.5-,arraycopy,-public%20static%C2%A0void[System.arraycopy]

ifdef::env-github,rspecator-view[]

'''
== Implementation Specification
(visible only on this page)

=== Message

Use "Arrays.copyOf", "Arrays.asList", "Collections.addAll" or "System.arraycopy" instead.


'''
== Comments And Links
(visible only on this page)

=== on 23 Jul 2015, 07:14:19 Nicolas Peru wrote:
I slightly changed the title to make it clearer. Please double check. 

=== on 23 Jul 2015, 09:06:29 Ann Campbell wrote:
Thanks [~nicolas.peru].

endif::env-github,rspecator-view[]
