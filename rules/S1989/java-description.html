<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Servlets are components in Java web development, responsible for processing HTTP requests and generating responses.
In this context, exceptions are used to handle and manage unexpected errors or exceptional conditions that may
occur during the execution of a servlet.</p>
</div>
<div class="paragraph">
<p>Catching exceptions within the servlet allows us to convert them into meaningful, user-friendly messages.
Otherwise, failing to catch exceptions will propagate them to the servlet container, where the default
error-handling mechanism may impact the overall security and stability of the server.</p>
</div>
<div class="paragraph">
<p>Possible security problems are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Vulnerability to denial-of-service attacks:</strong>
Not caught exceptions can leave the servlet container in an unstable state, which can exhaust the available resources
and make the system unavailable in the worst cases.</p>
</li>
<li>
<p><strong>Exposure of sensitive information:</strong>
Exceptions handled by the servlet container, by default, expose detailed error messages or debugging information to
the user, which may contain sensitive data such as stack traces, database connection, or system configuration.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Unfortunately, servlet method signatures do not force developers to handle <code>IOException</code> and <code>ServletException</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To prevent this risk, this rule enforces all exceptions to be caught within the "do*" methods of servlet classes.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Surround all method calls that may throw an exception with a <code>try/catch</code> block.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="paragraph">
<p>In the following example, the <code>getByName</code> method may throw an <code>UnknownHostException</code>.</p>
</div>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {
  InetAddress addr = InetAddress.getByName(request.getRemoteAddr()); // Noncompliant
  //...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {
  try {
    InetAddress addr = InetAddress.getByName(request.getRemoteAddr());
    //...
  }
  catch (UnknownHostException ex) {  // Compliant
    //...
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_articles_blog_posts">Articles &amp; blog posts</h3>
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">Top 10 2017 Category A3 - Sensitive Data Exposure</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/600">CWE-600 - Uncaught Exception in Servlet</a></p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/x/-zZGBQ">CERT, ERR01-J.</a> - Do not allow exceptions to expose sensitive information</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Handle the following exception(s) that could be thrown by "xxx": ExceptionType.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_19_sep_2014_133526_freddy_mallet_wrote">on 19 Sep 2014, 13:35:26 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>@Ann:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>I would activate this rule by default because I don&#8217;t see when this rule might generate some false-positives</p>
</li>
<li>
<p>I would associate the rule to the SQALE sub-characteristic "Error"</p>
</li>
<li>
<p>I guess this rule belongs to OWASP Top 10 ?</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_on_22_sep_2014_114456_ann_campbell_wrote">on 22 Sep 2014, 11:44:56 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>For the record: not in the OWASP Top 10</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_dec_2014_212602_sébastien_gioria_wrote">on 12 Dec 2014, 21:26:02 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>as the result could be to stackTrace or information reply on the browser, we could consider this issue in OWASP-TOP10-A6</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_15_dec_2014_102203_freddy_mallet_wrote">on 15 Dec 2014, 10:22:03 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>This is a good point [~sebastien.gioria] which raises another question: for the time being we tag a rule relating to a CWE item with tag "owasp-top10" if and only if in the MITRE CWE referential, this CWE item is part of <a href="http://cwe.mitre.org/data/definitions/928.html">CWE-928: Weaknesses in OWASP Top Ten (2013)</a>. Do you think this is a too strong requirement [~sebastien.gioria] ?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_20_jul_2015_074937_ann_campbell_wrote">on 20 Jul 2015, 07:49:37 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Tagged java-top by Ann</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_13_nov_2019_150656_guillaume_dequenne_wrote">on 13 Nov 2019, 15:06:56 Guillaume Dequenne wrote:</h3>
<div class="paragraph">
<p>Updating the message to explicitly mention which unhandled exception type triggered the issue (as the method invocation could already be in a try/catch block without a correct catch clause).</p>
</div>
</div>
</div>
</div>