<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is an issue when environment variables containing boolean values (stored as strings) are compared directly to boolean literals or used in boolean contexts without proper conversion.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Jenkins declarative pipelines, environment variables are always stored as strings, even when they originate from boolean-returning functions like <code>fileExists()</code>. When a function like <code>fileExists 'Dockerfile'</code> returns <code>true</code>, it gets stored in the environment variable as the string <code>'true'</code>, not the boolean <code>true</code>.</p>
</div>
<div class="paragraph">
<p>When developers try to compare these string values directly to boolean literals (<code>env.IS_DOCKERFILE == true</code>), the comparison will always fail because you&#8217;re comparing a string to a boolean. This leads to conditional expressions that don&#8217;t behave as expected.</p>
</div>
<div class="paragraph">
<p>For example, if <code>fileExists 'Dockerfile'</code> returns <code>true</code>, the environment variable <code>IS_DOCKERFILE</code> will contain the string <code>'true'</code>. Comparing <code>'true' == true</code> evaluates to <code>false</code> in Groovy, causing stages that should run to be skipped.</p>
</div>
<div class="paragraph">
<p>This type of bug can be particularly frustrating because the logic appears correct at first glance, but the pipeline behaves unexpectedly due to the implicit type conversion between boolean functions and string environment variables.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Pipeline stages may not execute when they should, or may execute when they shouldn&#8217;t. This can lead to incomplete builds, missing deployment steps, or incorrect conditional logic in CI/CD workflows. In critical deployment scenarios, this could result in failed releases or inconsistent application states.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Convert the environment variable to a boolean using <code>.toBoolean()</code> before using it in boolean expressions.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">environment {
    IS_DOCKERFILE = fileExists 'Dockerfile'
}
when {
    expression {
        env.IS_DOCKERFILE == true // Noncompliant
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">environment {
    IS_DOCKERFILE = fileExists 'Dockerfile'
}
when {
    expression {
        env.IS_DOCKERFILE.toBoolean()
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Jenkins Pipeline Syntax - Environment Variables - <a href="https://www.jenkins.io/doc/book/pipeline/syntax/#environment">Official Jenkins documentation on environment variables in declarative pipelines</a></p>
</li>
<li>
<p>Jenkins Pipeline Syntax - When Conditions - <a href="https://www.jenkins.io/doc/book/pipeline/syntax/#when">Official Jenkins documentation on when conditions in declarative pipelines</a></p>
</li>
<li>
<p>Groovy String to Boolean Conversion - <a href="https://docs.groovy-lang.org/latest/html/groovy-jdk/java/lang/String.html#toBoolean()">Groovy documentation for the toBoolean() method</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>