<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when Node.js built-in modules are imported without using the <code>node:</code> protocol prefix.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When importing Node.js built-in modules, using the <code>node:</code> protocol makes it explicitly clear that you&#8217;re importing a core Node.js module rather than a third-party package from npm.</p>
</div>
<div class="paragraph">
<p>Without the <code>node:</code> prefix, it can be ambiguous whether <code>import fs from 'fs'</code> refers to the built-in file system module or a potential npm package named 'fs'. This ambiguity can lead to confusion, especially for developers who are new to a codebase or when reviewing code.</p>
</div>
<div class="paragraph">
<p>The <code>node:</code> protocol was introduced in Node.js 12.20.0 and became the recommended approach for importing built-in modules. It provides several benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Clarity</strong>: Makes it immediately obvious that the import refers to a Node.js built-in module</p>
</li>
<li>
<p><strong>Security</strong>: Prevents potential confusion attacks where malicious packages could have names similar to built-in modules</p>
</li>
<li>
<p><strong>Future-proofing</strong>: Aligns with Node.js best practices and ESM standards</p>
</li>
<li>
<p><strong>Consistency</strong>: Creates a uniform way to reference all built-in modules</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This practice is particularly important in larger codebases where the distinction between built-in modules and external dependencies needs to be clear at a glance.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>Using imports without the <code>node:</code> protocol can lead to confusion about whether a module is built-in or external. In rare cases, this could create security vulnerabilities if malicious packages with names similar to built-in modules are installed. The lack of explicit protocol also makes code less self-documenting and harder to understand for new team members.</p>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_fix">How to fix?</h3>
<div class="paragraph">
<p>Add the <code>node:</code> prefix to ES6 import statements when importing Node.js built-in modules.</p>
</div>
<div class="sect3">
<h4 id="_non_compliant_code_example">Non-compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">import fs from 'fs';
import path from 'path';
import { createServer } from 'http'; // Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_code_example">Compliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">import fs from 'node:fs';
import path from 'node:path';
import { createServer } from 'node:http';</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/sindresorhus/eslint-plugin-unicorn#readme">eslint-plugin-unicorn</a> - Rule <a href="https://github.com/sindresorhus/eslint-plugin-unicorn/blob/HEAD/docs/rules/prefer-node-protocol.md">prefer-node-protocol</a></p>
</li>
<li>
<p>Node.js ESM Documentation - Node Imports - <a href="https://nodejs.org/api/esm.html#node-imports">Official Node.js documentation explaining the node: protocol for importing built-in modules</a></p>
</li>
<li>
<p>Node.js Modules Documentation - <a href="https://nodejs.org/api/modules.html">Complete reference for Node.js built-in modules and module system</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_standards">Standards</h3>
<div class="ulist">
<ul>
<li>
<p>ECMAScript Modules (ESM) - <a href="https://tc39.es/ecma262/#sec-modules">ECMAScript specification for module syntax and semantics</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>