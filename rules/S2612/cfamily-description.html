<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Unix file system permissions, the "<code>others</code>" category refers to all
users except the owner of the file system resource and the members of the group
assigned to this resource.</p>
</div>
<div class="paragraph">
<p>Granting permissions to this category can lead to unintended access to files or
directories that could allow attackers to obtain sensitive information, disrupt
services or elevate privileges.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The application is designed to be run on a multi-user environment.</p>
</li>
<li>
<p>Corresponding files and directories may contain confidential information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The most restrictive possible permissions should be assigned to files and directories.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When creating a file or directory with permissions to "other group":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">open("myfile.txt", O_CREAT, S_IRWXU | S_IRWXG | S_IRWXO); // Sensitive: the process set 777 permissions to this newly created file

mkdir("myfolder", S_IRWXU | S_IRWXG | S_IRWXO); // Sensitive: the process try to set 777 permissions to this newly created directory</code></pre>
</div>
</div>
<div class="paragraph">
<p>When explicitly adding permissions to "other group" with <code>chmod</code>, <code>fchmod</code> or <code>filesystem::permissions</code> functions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">chmod("myfile.txt", S_IRWXU | S_IRWXG | S_IRWXO);  // Sensitive: the process set 777 permissions to this file

fchmod(fd, S_IRWXU | S_IRWXG | S_IRWXO); // Sensitive: the process set 777 permissions to this file descriptor</code></pre>
</div>
</div>
<div class="paragraph">
<p>When defining the <code>umask</code> without read, write and execute permissions for "other group":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">umask(S_IRWXU | S_IRWXG); // Sensitive: the further files and folders will be created with possible permissions to "other group"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When creating a file or directory, do not set permissions to "other group":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">open("myfile.txt", O_CREAT, S_IRWXU | S_IRWXG); // Compliant

mkdir("myfolder", S_IRWXU | S_IRWXG); // Compliant</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using <code>chmod</code>, <code>fchmod</code> or <code>filesystem::permissions</code> functions, do not add permissions to "other group":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">chmod("myfile.txt", S_IRWXU | S_IRWXG);  // Compliant

fchmod(fd, S_IRWXU | S_IRWXG); // Compliant</code></pre>
</div>
</div>
<div class="paragraph">
<p>When defining the <code>umask</code>, set read, write and execute permissions to other group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">umask(S_IRWXO); // Compliant: further created files or directories will not have permissions set for "other group"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">Top 10 2021 Category A1 - Broken Access Control</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">Top 10 2021 Category A4 - Insecure Design</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">Top 10 2017 Category A5 - Broken Access Control</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission">OWASP File Permission</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/732">CWE-732 - Incorrect Permission Assignment for Critical Resource</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/266">CWE-266 -  Incorrect Privilege Assignment</a></p>
</li>
<li>
<p><a href="https://wiki.sei.cmu.edu/confluence/display/c/FIO06-C.+Create+files+with+appropriate+access+permissions">CERT, FIO06-C.</a> - Create files with appropriate access permissions</p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222430">Application Security and Development: V-222430</a> - The application must execute without excessive account permissions.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure this permission is safe.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_15_jun_2020_162610_loïc_joly_wrote">on 15 Jun 2020, 16:26:10 Loïc Joly wrote:</h3>
<div class="paragraph">
<p>For now, we don&#8217;t consider the API <code>std::filesystem::permissions</code> or <code>std::filesystem::perm_options::replace</code>. See the comments in CPP-2516 to see what difficulties these not-very-used APIs could create.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_23_sep_2020_204444_ann_campbell_wrote">on 23 Sep 2020, 20:44:44 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>It&#8217;s funny to see my face as the reporter of this when the content are entirely new to me. :)</p>
</div>
<div class="paragraph">
<p>\[~eric.therond] not to be a PITA, but if <code>others</code> has access, then all access <em>is</em> authorized, and there can be no "unauthorized" access, right? Perhaps you meant "unintended"? Also, IMO this description could benefit from being fluffed up a little with a tiny bit reminder of how file permissions are granted to owner, group, others</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_24_sep_2020_085308_eric_therond_wrote">on 24 Sep 2020, 08:53:08 Eric Therond wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] You can put me as the reporter, I think I don&#8217;t have the permission or I didn&#8217;t find how to change it.</p>
</div>
<div class="paragraph">
<p>Indeed, "unintended" is more appropriate.</p>
</div>
<div class="paragraph">
<p>I prefer to have a short rule description rather than explaining how file permissions work, and the code examples in the different sub-tasks or the links in the "see section" can help the user figure this out.</p>
</div>
</div>
</div>
</div>