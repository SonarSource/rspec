<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Java 21 has introduced enhancements to switch statements and expressions, allowing them to operate on any type, not just specific ones, as in previous versions.
Furthermore, case labels have been upgraded to support patterns, providing an alternative to the previous restriction of only accepting constants.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// As of Java 21
String patternMatchSwitch(Object obj) {
    return switch (obj) {
        case String s  -&gt; String.format("String %s", s);
        case Integer i -&gt; String.format("int %d", i);
        default        -&gt; obj.toString();
    };
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This allows to use the <code>when</code> keyword to specify a condition for a case label, also called a guarded case label.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String guardedCaseSwitch(Object obj) {
    return switch (obj) {
        case String s when s.length() &gt; 0 -&gt; String.format("String %s", s);
        case Integer i when i &gt; 0 -&gt; String.format("int %d", i);
        default        -&gt; obj.toString();
    };
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This syntax is more readable and less error-prone than using an if statement inside the case block and should be preferred.</p>
</div>
<div class="paragraph">
<p>This rule reports an issue when a single <code>if</code> statement is used inside a case block.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Replace the <code>if</code> statement with a guarded case label.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void testObject(Object response) {
    switch (response) {
        case String s -&gt; {
            if(s.length() &gt; 80) { // Noncompliant; use the "when" keyword
                System.out.println("This string is too long");
            }
        }
        case Integer i -&gt; {
            if(i &gt; 80) { // Noncompliant; use the "when" keyword
                System.out.println("This integer is too big");
            }
        }
        default -&gt; System.out.println("Unknown type");
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">void testObject(Object response) {
    switch (response) {
        case String s when s.length() &gt; 80 -&gt; {
            System.out.println("This string is too long");
        }
        case Integer i when i &gt; 80 -&gt; {
            System.out.println("This integer is too big");
        }
        default -&gt; System.out.println("Unknown type");
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Java Documentation - <a href="https://openjdk.org/jeps/441">Pattern Matching for switch</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>