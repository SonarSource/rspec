<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring <code>@Component</code>, <code>@Controller</code>, <code>@RestController</code>,<code>@Service</code>, and <code>@Repository</code> classes are singletons by default, meaning only one instance of the class is ever instantiated in the application. Typically such a class might have a few <code>static</code> members, such as a logger, but all non-<code>static</code> members should be managed by Spring.</p>
</div>
<div class="paragraph">
<p>This rule raises an issue when a singleton <code>@Component</code>, <code>@Controller</code>, <code>@RestController</code>, <code>@Service</code>, or <code>@Repository</code>, not annotated with <code>@ConfigurationProperties</code>, has non-<code>static</code> members that are not annotated with one of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.springframework.beans.factory.annotation.Autowired</code></p>
</li>
<li>
<p><code>org.springframework.beans.factory.annotation.Value</code></p>
</li>
<li>
<p><code>javax.annotation.Inject</code></p>
</li>
<li>
<p><code>javax.annotation.Resource</code></p>
</li>
<li>
<p><code>javax.persistence.PersistenceContext</code></p>
</li>
<li>
<p><code>jakarta.annotation.Resource</code></p>
</li>
<li>
<p><code>jakarta.inject.Inject</code></p>
</li>
<li>
<p><code>jakarta.persistence.PersistenceContext</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add one of these annotations to all non-<code>static</code> members: <code>@Resource</code>, <code>@Inject</code>, <code>@Autowired</code> or <code>@Value</code>.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Controller
public class HelloWorld {

  private String name = null;

  @RequestMapping("/greet", method = GET)
  public String greet(String greetee) {

    if (greetee != null) {
      this.name = greetee;
    }

    return "Hello " + this.name;  // if greetee is null, you see the previous user's data
  }
}</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Annotate this member with "@Autowired", "@Resource", "@Inject", or "@Value", or remove it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_parameters">Parameters</h3>
<div class="sidebarblock">
<div class="content">
<div class="title">customInjectionAnnotations</div>
<div class="listingblock">
<div class="content">
<pre>""</pre>
</div>
</div>
<div class="paragraph">
<p>comma-separated list of annotation fully qualified names to consider as valid</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>member declaration</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_17_oct_2016_152337_ann_campbell_wrote">on 17 Oct 2016, 15:23:37 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Part of the idea is that constructor injection is declasse now, [~nicolas.peru]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_31_mar_2017_094029_yves_dubois_pèlerin_wrote">on 31 Mar 2017, 09:40:29 Yves Dubois-Pèlerin wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2]</p>
</div>
<div class="paragraph">
<p>This is about a <a href="https://groups.google.com/forum/#!topic/sonarqube/T-f83S9mvQU">question</a> on the Google group.</p>
</div>
<div class="paragraph">
<p>+1 for adding @Resource in this rule. Although annotation @Autowired is well-known among Java developers, it is Spring specific. The newer but standard @Resource annotation is mostly equivalent to @Autowire and should be added to the rule.</p>
</div>
<div class="paragraph">
<p>I don&#8217;t know about @Inject - maybe a Guice-specific annotation.</p>
</div>
<div class="paragraph">
<p>Suggestions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change the rule title into "Members of Spring components should be explicitly injected".</p>
</li>
<li>
<p>Give more emphasis to @Resource than to @Autowired, which is slightly outdated. For example, replace
"That is, they should have the @Autowired annotation"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>with</p>
</div>
<div class="paragraph">
<p>"That is, they should have the @Resource (or @Autowired) annotation"</p>
</div>
<div class="paragraph">
<p>Yves</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_4_apr_2017_152312_ann_campbell_wrote">on 4 Apr 2017, 15:23:12 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Updated [~yves.duboispelerin]</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_mar_2018_100150_sébastien_gioria_appsecfr_wrote">on 19 Mar 2018, 10:01:50 Sébastien GIORIA - AppSecFR wrote:</h3>
<div class="paragraph">
<p>Could be tagged OWASP A3:2017. This could leak sensitive data</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_19_mar_2018_101430_alexandre_gigleux_wrote">on 19 Mar 2018, 10:14:30 Alexandre Gigleux wrote:</h3>
<div class="paragraph">
<p>\[~SPoint]: thanks for the contribution - it&#8217;s already tagged OWASP A3:2017 in the RSPEC ticket - as soon as SonarJava 5.2 will be released, the OWASP tags will be updated in SonarQube UI thanks to this ticket: https://jira.sonarsource.com/browse/SONARJAVA-2682 - we reviewed all the OWASP tags of SonarJava rules to be sure they are aligned with OWASP TOP 10 2017.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_16_aug_2018_202721_ann_campbell_wrote">on 16 Aug 2018, 20:27:21 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.harraudeau] despite the fact that Jira can&#8217;t properly render its own code markdown when immediately followed by non-space characters, RuleAPI handles this correctly.</p>
</div>
<div class="paragraph">
<p>The current version is awkward IMO and should either get the 's&#8217;es back, or the word "classes" before "are singletons by default".</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_17_aug_2018_084128_nicolas_harraudeau_wrote">on 17 Aug 2018, 08:41:28 Nicolas Harraudeau wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Thanks for the info. I&#8217;ll add "classes" then so that it works in both Jira and RuleAPI.</p>
</div>
</div>
</div>
</div>