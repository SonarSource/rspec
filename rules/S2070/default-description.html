<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The MD5 algorithm and its successor, SHA-1, are no longer considered secure, because it is too easy to create hash collisions with them. That is, it takes too little computational effort to come up with a different input that produces the same MD5 or SHA-1 hash, and using the new, same-hash value gives an attacker the same access as if he had the originally-hashed value. This applies as well to the other Message-Digest algorithms: MD2, MD4, MD6, HAVAL-128, HMAC-MD5, DSA (which uses SHA-1), RIPEMD, RIPEMD-128, RIPEMD-160, HMACRIPEMD160.</p>
</div>
<div class="paragraph">
<p>Consider using safer alternatives, such as SHA-256, SHA-512 or SHA-3.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/328">CWE-328 - Reversible One-Way Hash</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/327">CWE-327 - Use of a Broken or Risky Cryptographic Algorithm</a></p>
</li>
<li>
<p><a href="https://shattered.io/">SHAttered</a> - The first concrete collision attack against SHA-1.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="literalblock">
<div class="content">
<pre>Use a stronger hashing algorithm than xxx.</pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_30_sep_2014_150651_ann_campbell_wrote">on 30 Sep 2014, 15:06:51 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~nicolas.peru] please review</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_30_sep_2014_154955_nicolas_peru_wrote">on 30 Sep 2014, 15:49:55 Nicolas Peru wrote:</h3>
<div class="paragraph">
<p>Reviewed, corrected typo and update example.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_oct_2014_172838_freddy_mallet_wrote">on 12 Oct 2014, 17:28:38 Freddy Mallet wrote:</h3>
<div class="paragraph">
<p>@Ann, I would make this rule also prevent use of MD5 which is even less secured than SHA-1.</p>
</div>
<div class="paragraph">
<p>The title of this rule could then become :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unsecured SHA-1 and MD5 hash algorithms should not be used</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Non Compliant Code Example could be :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>MessageDigest md = MessageDigest.getInstance("SHA-1");
String text = "This is some text";
md.update(text.getBytes("UTF-8"));
byte[] digest = md.digest();</pre>
</div>
</div>
<div class="paragraph">
<p>And in Java, replacing SHA-1 by SHA-256 is an available remediation action.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_12_dec_2014_205333_sébastien_gioria_wrote">on 12 Dec 2014, 20:53:33 Sébastien Gioria wrote:</h3>
<div class="paragraph">
<p>It&#8217;s not only MD5, but all the MD-series algorithms who are not safe</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_15_dec_2014_150434_ann_campbell_wrote">on 15 Dec 2014, 15:04:34 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>Thanks [~sebastien.gioria]. Updated.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_30_aug_2018_175357_andrei_epure_wrote">on 30 Aug 2018, 17:53:57 Andrei Epure wrote:</h3>
<div class="paragraph">
<p>This list should also contain HAVAL-128</p>
</div>
<div class="paragraph">
<p>Also, according to <a href="http://valerieaurora.org/hash.html">this graph</a>, RIPEMD-160 has not been found to have collisions and is in the same bucket with SHA-2 family algorithms - so it should be replaced in the list with RIPEMD-128 (which has been broken)</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_20_may_2020_152637_eric_therond_wrote">on 20 May 2020, 15:26:37 Eric Therond wrote:</h3>
<div class="paragraph">
<p>Deprecated by <a data-rspec-id="S4790" class="rspec-auto-link">S4790</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>we cannot guess the context where the weak hash function is used, so it&#8217;s better to raise an hotspot</p>
</li>
<li>
<p>we cannot maintain two rules on exactly the same subject</p>
</li>
</ul>
</div>
</div>
</div>
</div>