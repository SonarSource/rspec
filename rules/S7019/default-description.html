<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Dockerfiles, it is recommended to use the exec form for <code>CMD</code> and <code>ENTRYPOINT</code> instructions.
The exec form, which is represented as a JSON array, ensures that the process runs directly without being wrapped in a shell.
This allows OS signals like SIGTERM and SIGINT to be received by the process. This practice enhances the reliability and control of your Docker containers.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using the shell form instead of the exec form for CMD and ENTRYPOINT instructions in Dockerfiles can lead to several issues.
When you use the shell form, the executable runs as a child process to a shell, which does not pass OS signals.
This can cause problems when trying to gracefully stop containers because the main process will not receive the signal intended to terminate it.
Moreover, the exec form provides more control and predictability over the execution of the command.
It does not invoke a command shell, which means it does not have the potential side effects of shell processing.</p>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>The exec form does not allow shell features such as variable expansion, piping (<code>|</code>) and command chaining (<code>&amp;&amp;</code>, <code>||</code>, <code>;</code>).
In case you need to use these features, there are a few alternatives:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creation of a wrapper script</p>
</li>
<li>
<p>Explicitly specify the shell to use with the <code>SHELL</code> instruction before <code>CMD</code> or <code>ENTRYPOINT</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This rule will not raise an issue if the <code>SHELL</code> instruction is used before the <code>CMD</code> or <code>ENTRYPOINT</code> instruction, as we consider this a conscious decision.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-docker" data-lang="docker">FROM scratch
ENTRYPOINT echo "Welcome!"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-docker" data-lang="docker">FROM scratch
ENTRYPOINT echo "Long script with chaining commands" \
  &amp;&amp; echo "Welcome!" \
  &amp;&amp; echo "Goodbye"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-docker" data-lang="docker">FROM scratch
ENTRYPOINT ["echo", "Welcome!"]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-docker" data-lang="docker">FROM scratch
SHELL ["/bin/bash", "-c"]
ENTRYPOINT echo "Long script with chaining commands" \
  &amp;&amp; echo "Welcome!" \
  &amp;&amp; echo "Goodbye"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-docker" data-lang="docker">FROM scratch
ENTRYPOINT ["/entrypoint.sh"]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Docker Build Checks - <a href="https://docs.docker.com/reference/build-checks/json-args-recommended/">JSONArgsRecommended</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Replace this shell form with exec form.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Highlight the value of the CMD or ENTRYPOINT instruction.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
</div>
</div>