<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Enabling public network access to cloud resources can affect an organization&#8217;s
ability to protect its data or internal operations from data theft or
disruption.</p>
</div>
<div class="paragraph">
<p>Depending on the component, inbound access from the Internet can be enabled
via:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a boolean value that explicitly allows access to the public network.</p>
</li>
<li>
<p>the assignment of a public IP address.</p>
</li>
<li>
<p>database firewall rules that allow public IP ranges.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Deciding to allow public access may happen for various reasons such as for
quick maintenance, time saving, or by accident.</p>
</div>
<div class="paragraph">
<p>This decision increases the likelihood of attacks on the organization, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>data breaches.</p>
</li>
<li>
<p>intrusions into the infrastructure to permanently steal from it.</p>
</li>
<li>
<p>and various malicious traffic, such as DDoS attacks.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This cloud resource:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>should be publicly accessible to any Internet user.</p>
</li>
<li>
<p>requires inbound traffic from the Internet to function properly.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered no to any of those questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Avoid publishing cloud services on the Internet unless they are intended to be
publicly accessible, such as customer portals or e-commerce sites.</p>
</div>
<div class="paragraph">
<p>Use private networks (and associated private IP addresses) and VPC peering or
other secure communication tunnels to communicate with other cloud components.</p>
</div>
<div class="paragraph">
<p>The goal is to prevent the component from intercepting traffic coming in via
the public IP address.
If the cloud resource does not support the absence of a public IP address,
assign a public IP address to it, but do not create listeners for the public IP
address.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using <code>publicNetworkAccess</code> to control access to resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bicep" data-lang="bicep">resource exampleSite 'Microsoft.Web/sites@2020-12-01' = {
  name: 'example-site'
  properties: {
    publicNetworkAccess: 'Enabled'
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "resources": [
    {
      "type": "Microsoft.Web/sites",
      "apiVersion": "2020-12-01",
      "name": "example-site",
      "properties": {
        "siteConfig": {
          "publicNetworkAccess": "Enabled"
        }
      }
    }
  ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "resources": [
    {
      "type": "Microsoft.Web/sites",
      "apiVersion": "2020-12-01",
      "name": "example",
      "resources": [
        {
          "type": "config",
          "apiVersion": "2020-12-01",
          "name": "example-config",
          "properties": {
            "publicNetworkAccess": "Enabled"
          }
        }
      ]
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using IP address ranges to control access to resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bicep" data-lang="bicep">resource exampleFirewall 'Microsoft.Sql/servers/firewallRules@2014-04-01' = {
  name: 'example-firewall'
  properties: {
    startIpAddress: '0.0.0.0'
    endIpAddress: '255.255.255.255'
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "resources": [
    {
      "type": "Microsoft.Sql/servers/firewallRules",
      "apiVersion": "2014-04-01",
      "name": "example-firewall",
      "properties": {
        "startIpAddress": "0.0.0.0",
        "endIpAddress": "255.255.255.255"
      }
    }
  ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "resources": [
    {
      "type": "Microsoft.Sql/servers",
      "apiVersion": "2014-04-01",
      "name": "example-database",
      "resources": [
        {
          "type": "firewallRules",
          "apiVersion": "2014-04-01",
          "name": "example-firewall",
          "properties": {
            "startIpAddress": "0.0.0.0",
            "endIpAddress": "255.255.255.255"
          }
        }
      ]
    }
  ]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using <code>publicNetworkAccess</code> to control access to resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bicep" data-lang="bicep">resource exampleSite 'Microsoft.Web/sites@2020-12-01' = {
  name: 'example-site'
  properties: {
    publicNetworkAccess: 'Disabled'
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "resources": [
    {
      "type": "Microsoft.Web/sites",
      "apiVersion": "2020-12-01",
      "name": "example-site",
      "properties": {
        "siteConfig": {
          "publicNetworkAccess": "Disabled"
        }
      }
    }
  ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "resources": [
    {
      "type": "Microsoft.Web/sites",
      "apiVersion": "2020-12-01",
      "name": "example-site",
      "resources": [
        {
          "type": "config",
          "apiVersion": "2020-12-01",
          "name": "example-config",
          "properties": {
            "publicNetworkAccess": "Disabled"
          }
        }
      ]
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using IP address ranges to control access to resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bicep" data-lang="bicep">resource exampleFirewall 'Microsoft.Sql/servers/firewallRules@2014-04-01' = {
  name: 'example-firewall'
  properties: {
    startIpAddress: '192.168.0.0'
    endIpAddress: '192.168.255.255'
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "resources": [
    {
      "type": "Microsoft.Sql/servers/firewallRules",
      "apiVersion": "2014-04-01",
      "name": "example-firewall",
      "properties": {
        "startIpAddress": "192.168.0.0",
        "endIpAddress": "192.168.255.255"
      }
    }
  ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "resources": [
    {
      "type": "Microsoft.Sql/servers",
      "apiVersion": "2014-04-01",
      "name": "example-database",
      "resources": [
        {
          "type": "firewallRules",
          "apiVersion": "2014-04-01",
          "name": "example-firewall",
          "properties": {
            "startIpAddress": "192.168.0.0",
            "endIpAddress": "192.168.255.255"
          }
        }
      ]
    }
  ]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html">AWS Documentation</a> - Amazon EC2 instance IP addressing</p>
</li>
<li>
<p><a href="https://docs.aws.amazon.com/dms/latest/userguide/CHAP_ReplicationInstance.PublicPrivate.html">AWS Documentation</a> - Public and private replication instances</p>
</li>
<li>
<p><a href="https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html">AWS Documentation</a> - VPC Peering</p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/284">CWE-284 - Improper Access Control</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/668">CWE-668 - Exposure of Resource to Wrong Sphere</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222620">Application Security and Development: V-222620</a> - Application web servers must be on a separate network segment from the application and database servers.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>When the <code>publicNetworkAccess</code> property is specified:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make sure allowing public network access is safe here.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When an IP address range using <code>startIpAddress</code> or <code>endIpAddress</code> is specified:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make sure that allowing public IP addresses is safe here.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlight">Highlight</h3>
<div class="paragraph">
<p>When the <code>publicNetworkAccess</code> property is specified and is not set to
<code>Disabled</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Highlight the <code>publicNetworkAccess</code> property.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When an IP address range using <code>startIpddress</code> or <code>endIpAddress</code> is specified:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If either of these properties is set to a public IP address, highlight the
property.</p>
</li>
<li>
<p>If both properties are set to private IP addresses but the range contains
public addresses,  e.g. 10.0.0.0 - 192.168.255.255, highlight both
properties.</p>
</li>
<li>
<p>If only one of <code>startIpAddress</code> or <code>endIpAddress</code> are specified, highlight
the property.</p>
</li>
</ul>
</div>
</div>
</div>
</div>