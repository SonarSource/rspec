<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Session IDs are used to identify a user session. They are usually stored in cookies, URL parameters, or hidden form fields.</p>
</div>
<div class="paragraph">
<p>If a session ID can be guessed (not generated with a secure pseudo random generator, or with insufficient length &#8230;&#8203;) an attacker may be able to hijack another user&#8217;s session.</p>
</div>
<div class="paragraph">
<p>If an application allows users to specify their own session ID (for example via URL parameters or form fields), an attacker may be able to set a known session ID for a victim user, and then hijack the victim&#8217;s session (session fixation attack).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Don&#8217;t manually generate session IDs, use instead language based native functionality.
In PHP, use session_regenerate_id() to generate a new session ID, or use session_id() with a securely generated random value of sufficient length (at least 16 bytes).</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code Examples</h3>

</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant Code Example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">session_id(bin2hex(random_bytes(4))); // Noncompliant, 4 bytes is too short
session_id($_POST["session_id"]); // Noncompliant, session ID can be specified by the user</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-php" data-lang="php">session_regenerate_id(); ; // Compliant
session_id(bin2hex(random_bytes(16))); // Compliant</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">Top 10 2021 Category A4 - Insecure Design</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">Top 10 2021 Category A7 - Identification and Authentication Failures</a></p>
</li>
<li>
<p>OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security Misconfiguration</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-community/attacks/Session_fixation">OWASP Sesssion Fixation</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/330">CWE-330 - Use of Insufficiently Random Values</a></p>
</li>
<li>
<p>CWE - <a href="https://cwe.mitre.org/data/definitions/340">CWE-340 - Generation of Predictable Numbers or Identifiers</a></p>
</li>
<li>
<p><a href="https://www.php.net/random-bytes">PHP: random_bytes()</a></p>
</li>
<li>
<p><a href="https://www.php.net/session-regenerate-id">PHP: session_regenerate_id()</a></p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222579">Application Security and Development: V-222579</a> - Applications must use system-generated session identifiers that protect against session fixation.</p>
</li>
<li>
<p>STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222582">Application Security and Development: V-222582</a> - The application must not re-use or recycle session IDs.</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure the generation of the session ID is safe here.</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_19_jan_2021_092732_costin_zaharia_wrote">on 19 Jan 2021, 09:27:32 Costin Zaharia wrote:</h3>
<div class="paragraph">
<p>As far as I can tell, this rule does not apply for Asp.Net. According to documentation: "The SessionID value is randomly generated by ASP.NET and stored in a non-expiring session cookie in the browser." Source: <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.sessionstate.httpsessionstate.sessionid?view=netframework-4.8#System_Web_SessionState_HttpSessionState_SessionID">HttpSessionState.SessionID Property</a></p>
</div>
<div class="paragraph">
<p>This property is read-only (does not have a setter) and the class is sealed so this behavior cannot be easily changed.</p>
</div>
<div class="paragraph">
<p>For Asp.Net Core the behavior is similar. An implementation of <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.isession.id?view=aspnetcore-5.0#Microsoft_AspNetCore_Http_ISession_Id">ISession</a> is provided by the framework and the <strong>Id</strong> is read-only.</p>
</div>
</div>
</div>
</div>