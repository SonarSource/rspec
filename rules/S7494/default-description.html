<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when <code>list()</code>, <code>set()</code> or <code>dict()</code> is unnecessarily used around a generator expression.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using <code>list()</code>, <code>set()</code>, or <code>dict()</code> around a generator expression is redundant when a corresponding comprehension can directly express the same operation. Comprehensions are clearer, more concise, and often more readable than the equivalent constructor/generator expression combination.</p>
</div>
<div class="paragraph">
<p>This principle applies to all three built-in collection types: <code>list</code>, <code>set</code>, and <code>dict</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use <code>[f(x) for x in foo]</code> instead of <code>list(f(x) for x in foo)</code></p>
</li>
<li>
<p>Use <code>{f(x) for x in foo}</code> instead of <code>set(f(x) for x in foo)</code></p>
</li>
<li>
<p>Use <code>{k: v for k, v in items}</code> instead of <code>dict((k, v) for k, v in items)</code></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_exceptions">Exceptions</h3>
<div class="paragraph">
<p>If the generator expression doesn&#8217;t filter or modify the collection, the rule does not raise.
For example, <code>list(x for x in foo)</code> is simply copying the iterable <code>foo</code> into a list, which is equivalent to <code>list(foo)</code> and covered by a different rule.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Replace the collection constructor with the appropriate comprehension syntax.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def f(x):
    return x * 2

list(f(x) for x in range(5))  # Noncompliant</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def f(x):
    return x * 2

[f(x) for x in range(5)] # Compliant</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>Python Documentation - <a href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions">List Comprehensions</a></p>
</li>
<li>
<p>Python Documentation - <a href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries">Dictionaries</a></p>
</li>
<li>
<p>Python Documentation - <a href="https://docs.python.org/3/tutorial/datastructures.html#sets">Sets</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="paragraph">
<p>The rule implementation must only raise if the generator expression is actually changing the iterable. This means that one of the following must be true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The generator expression maps items: <code>f(x) for x in foo</code> or <code>x + 1 for x in foo</code></p>
</li>
<li>
<p>In case of a dictionary, either the key or the value must be changed, or reversed (<code>v: k for k, v in items</code>).</p>
</li>
<li>
<p>The generator expression filters items</p>
</li>
<li>
<p>There are multiple <code>for</code> keywords: <code>[ (i,j) for i in range(1,3) for j in range(1,5) ]</code></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="ulist">
<ul>
<li>
<p>Replace list constructor call with a list comprehension.</p>
</li>
<li>
<p>Replace set constructor call with a set comprehension.</p>
</li>
<li>
<p>Replace dict constructor call with a dictionary comprehension.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>The list/set/dict constructor call.</p>
</div>
</div>
</div>
</div>