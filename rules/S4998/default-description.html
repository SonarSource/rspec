<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you use <code>std::unique_ptr&lt;T&gt; const &amp;</code> for a function parameter type, it means that the function will not be able to alter the ownership of the pointed-to object by the <code>unique_ptr</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It cannot acquire ownership of the pointed-to object (this would require a parameter of type <code>std::unique_ptr&lt;T&gt;</code>)</p>
</li>
<li>
<p>It cannot transfer the object ownership to someone else (this would require a <code>std::unique_ptr&lt;T&gt; &amp;</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>That means the function can only observe the pointed-to object, and in this case, passing a <code>T*</code> (if the <code>unique_ptr</code> can be null) or a <code>T&amp;</code> (if it cannot) provides the same features, while also allowing the function to work with objects that are not handled by a <code>unique_ptr</code> (e.g., objects on the stack, in a <code>vector</code>, or in another kind of smart pointer), thus making the function more general-purpose.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">void draw(std::unique_ptr&lt;Shape&gt; const &amp;shape); // Noncompliant

void drawAll(std::vector&lt;std::unique_ptr&lt;Shape&gt;&gt; v)
{
  for (auto &amp;shape : v) {
      if (shape) {
        draw(shape);
      }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cpp" data-lang="cpp">void draw(Shape const &amp;shape); // Compliant

void drawAll(std::vector&lt;std::unique_ptr&lt;Shape&gt;&gt; v)
{
  for (auto &amp;shape : v) {
      if (shape) {
        draw(*shape);
      }
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>C&#43;&#43; reference - <a href="https://en.cppreference.com/w/cpp/memory/unique_ptr">std::unique_ptr</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_external_coding_guidelines">External coding guidelines</h3>
<div class="ulist">
<ul>
<li>
<p>C&#43;&#43; Core Guidelines - <a href="https://github.com/isocpp/CppCoreGuidelines/blob/e49158a/CppCoreGuidelines.md#r32-take-a-unique_ptrwidget-parameter-to-express-that-a-function-assumes-ownership-of-a-widget">R.32: Take a <code>unique_ptr&lt;widget&gt;</code> parameter to express that a function assumes ownership of a <code>widget</code></a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Replace this use of "unique_ptr" by a raw pointer or a reference (possibly const).</p>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_on_6_nov_2018_195955_ann_campbell_wrote">on 6 Nov 2018, 19:59:55 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>I&#8217;ve reworded slightly [~loic.joly]. Double-check me, please.</p>
</div>
<div class="paragraph">
<p>Also, it would be useful to give a "such as" here:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>objects that are not handled by a <code>unique_ptr</code></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Or to expand a little on the topic in general</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_7_nov_2018_092750_lo誰c_joly_wrote">on 7 Nov 2018, 09:27:50 Lo誰c Joly wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] I partially reverted your changes, could you review please (maybe we need to talk about it if you disagree)?</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_7_nov_2018_201141_ann_campbell_wrote">on 7 Nov 2018, 20:11:41 Ann Campbell wrote:</h3>
<div class="paragraph">
<p>\[~loic.joly] it&#8217;s not clear to me how "will not be able to impact the lifetime of the pointed-to object" is a summary/grouping/superset of the two bullet points that follow it, which is why in my edit I struggled, and then combined the three into a single list.</p>
</div>
</div>
<div class="sect2">
<h3 id="_on_8_nov_2018_095613_lo誰c_joly_wrote">on 8 Nov 2018, 09:56:13 Lo誰c Joly wrote:</h3>
<div class="paragraph">
<p>\[~ann.campbell.2] Lifetime and ownership are deeply linked subject: If A has ownership of B, it means that A is responsible for killing B at some time (at the very least, before its own lifetime ends).</p>
</div>
<div class="paragraph">
<p>Is the new version clearer?</p>
</div>
</div>
</div>
</div>