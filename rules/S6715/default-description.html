<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This rule raises an issue when the dimensions of the input arrays for the <code>numpy.dot</code> function are not compatible for matrix multiplication.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>numpy.dot()</code> function (or equivalently, the @ operator for matrix multiplication) performs matrix multiplication between two arrays.</p>
</div>
<div class="paragraph">
<p>Matrix multiplication is a binary operation that produces a matrix from two matrices. The resulting matrix, known as the matrix product, has the number of rows of the first and the number of columns of the second matrix.</p>
</div>
<div class="paragraph">
<p>If <code>A</code> is an <code>m x n</code> matrix and <code>B</code> is an <code>n x p</code> matrix,
then the resulting matrix will be <code>C</code> with <code>m x p</code> shape where each value is calculated by the formula:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">for i = 1, ..., m and j = 1, ..., p
C[i, j] = A[i, 1] * B[1, j] + A[i, 2] * B[2, j] + ... + A[i, n] * B[n, j]</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import numpy as np

a = [[1, 2],
     [3, 4],
     [5, 6]]
b = [[1, 2, 3],
     [4, 5, 6]]
# Perform matrix multiplication using np.dot() or @ operator
result = np.dot(a, b)
print(result)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output will be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">[[ 9 12 15]
 [19 26 33]
 [29 40 51]]</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a matrix multiplication to be valid, the number of columns in the first matrix must be equal to the number of rows in the second matrix.
You can use <code>numpy.shape()</code> function to check the dimensions of the arrays before performing the operation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hot_to_fix_it">Hot to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Make sure that the number of columns in the first matrix is equal to the number of rows in the second matrix.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import numpy as np

a = [[1, 2, 3], [4, 5, 6]]
b = [1, 2, 3, 4]
c = np.dot(a, b) # Noncompliant: ValueError: shapes (2,3) and (4,) not aligned: 3 (dim 1) != 4 (dim 0)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import numpy as np

a = [[1, 2, 3], [4, 5, 6]]
b = [1, 2, 3]
c = np.dot(a, b) # Compliant</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p>NumPy Documentation - <a href="https://numpy.org/doc/stable/reference/generated/numpy.dot.html">numpy.dot</a></p>
</li>
<li>
<p>PSU - Matrix algebra review - <a href="https://online.stat.psu.edu/statprogram/reviews/matrix-algebra/arithmetic#paragraph&#8212;&#8203;2761">Matrix Multiplication</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_comments_and_links">Comments And Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
</div>
</div>