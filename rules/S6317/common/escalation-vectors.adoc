=== Privilege escalation vectors

This rule detects the following privilege escalation vectors in AWS IAM policies:

[cols="1,1"]
|===
|Vector name |Summary

|Create Policy Version
|Create a new IAM policy and set it as the default

|Set Default Policy Version
|Set a different IAM policy version as the default

|Create AccessKey
|Create a new access key for any user

|Create Login Profile
|Create a login profile with a password chosen by the attacker

|Update Login Profile 
|Update the existing password with one chosen by the attacker

|Attach User Policy
|Attach a permissive IAM policy like "AdministratorAccess" to a user the attacker controls

|Attach Group Policy
|Attach a permissive IAM policy like "AdministratorAccess" to a group containing a user the attacker controls

|Attach Role Policy
|Attach a permissive IAM policy like "AdministratorAccess" to a role that can be assumed by the user the attacker controls

|Put User Policy
|Alter the existing inline IAM policy from a user the attacker controls

|Put Group Policy
|Alter the existing inline IAM policy from a group containing a user that the attacker controls

|Put Role Policy
|Alter an existing inline IAM role policy. The rule will then be assumed by the user that the attacker controls

|Add User to Group
|Add a user that the attacker controls to a group that has a larger range of permissions

|Update Assume Role Policy
|Update a role's "AssumeRolePolicyDocument" to allow a user the attacker controls to assume it

|EC2
|Create an EC2 instance that will execute with high privileges

|Lambda Create and Invoke
|Create a Lambda function that will execute with high privileges and invoke it

|Lambda Create and Add Permission
|Create a Lambda function that will execute with high privileges and grant permission to invoke it to a user or a service

|Lambda triggered with an external event
|Create a Lambda function that will execute with high privileges and link it to an external event

|Update Lambda code
|Update the code of a Lambda function executing with high privileges

|CloudFormation
|Create a CloudFormation stack that will execute with high privileges

|Data Pipeline
|Create a Pipeline that will execute with high privileges

|Glue Development Endpoint
|Create a Glue Development Endpoint that will execute with high privileges

|Update Glue Dev Endpoint
|Update the associated SSH key for the Glue endpoint

|===
